import"./style-CMkGO_Nm.js";import{r as s,j as t,c as E}from"./index-rQnCqdvM.js";import{c as w,C as j,M as A,O as S,a as v,b as I,d as b,e as D}from"./common-C27bv5jd.js";import{C as y,a as r,G as T,F as L,M as N}from"./miro-BztXybb3.js";const O=100,_=4,G=w(O,_);function R(){const[m,p]=s.useState(""),[x,n]=s.useState(!1),i=s.useContext(j);if(!i)throw new Error("ChartDataContext is not provided");const{data:u,columns:C,setData:c,setColumns:g,spec:h,setSpec:M}=i,l=s.useContext(A);if(!l)throw new Error("MessageContext is not provided");const{setMessage:d}=l;s.useEffect(()=>{(async()=>{const a=(await miro.board.getSelection())[0];if(a){p(a.id);const o=await y.fromMetaData({data:await a.getMetadata(r.VEGA_DATA),columns:await a.getMetadata(r.COL_NAMES),spec:await a.getMetadata(r.VEGA_SPEC)});g(o.columns),c(o.data),M(o.prettierSpec())}else c(G)})()},[]);async function f(){try{const e=new T;n(!0),await e.updateGraph(m,C,u,h),await miro.board.ui.closeModal()}catch(e){console.warn(e),e instanceof L?(alert(e.message),await miro.board.ui.closeModal()):e instanceof N?d({error:e,detail:e}):d({message:"Vega-Lite specification is invalid.",detail:e}),n(!1)}}return t.jsxs(t.Fragment,{children:[x&&t.jsx(S,{}),t.jsx("div",{style:{textAlign:"right"},children:t.jsx("button",{className:"button button-primary button-small",style:{marginBottom:3},onClick:f,children:"Update Chart"})})]})}const P=()=>t.jsx("div",{className:"",children:t.jsxs(v,{children:[t.jsx(I,{}),t.jsxs(b,{children:[t.jsx(R,{}),t.jsx(D,{})]})]})}),V=document.getElementById("root"),F=E.createRoot(V);F.render(t.jsx(P,{}));
