import"./style.a87c9e06.js";import{r as a,j as n,F as w,a as t,c as E}from"./jsx-runtime.9f138595.js";import{c as S,C as I,M as v,O as b,a as y,b as D,d as N,e as T}from"./common.4c673f71.js";import{C as _,M as r,G}from"./miro.a87bf8a1.js";const L=100,O=4,P=S(L,O);function j(){const[p,m]=a.exports.useState(""),[C,c]=a.exports.useState(!1),i=a.exports.useContext(I);if(!i)throw new Error("ChartDataContext is not provided");const{data:u,columns:g,setData:d,setColumns:h,spec:x,setSpec:M}=i,l=a.exports.useContext(v);if(!l)throw new Error("MessageContext is not provided");const{setMessage:f}=l;a.exports.useEffect(()=>{(async()=>{const e=(await miro.board.getSelection())[0];if(e){m(e.id);const o=await _.fromMetaData({data:await e.getMetadata(r.VEGA_DATA),columns:await e.getMetadata(r.COL_NAMES),spec:await e.getMetadata(r.VEGA_SPEC)});h(o.columns),d(o.data),M(o.prettierSpec())}else d(P)})()},[]);async function A(){try{const s=new G;c(!0),await s.updateGraph(p,g,u,x),await miro.board.ui.closeModal()}catch(s){f({message:"Invalid specificatin",detail:s}),c(!1)}}return n(w,{children:[C&&t(b,{}),t("div",{style:{textAlign:"right"},children:t("button",{className:"button button-primary button-small",style:{marginBottom:3},onClick:A,children:"Update Chart"})})]})}const R=()=>t("div",{className:"",children:n(y,{children:[t(D,{}),n(N,{children:[t(j,{}),t(T,{})]})]})}),V=document.getElementById("root"),B=E(V);B.render(t(R,{}));
