import"./style-CMkGO_Nm.js";import{r as s,j as t,c as E}from"./index-rQnCqdvM.js";import{c as j,C as w,M as A,O as S,a as v,b as D,d as I,e as b}from"./common-CrnN6jwM.js";import{C as y,a as r,G as L,M as N}from"./miro-D1GjGSgM.js";const T=100,_=4,G=j(T,_);function O(){const[m,p]=s.useState(""),[x,n]=s.useState(!1),i=s.useContext(w);if(!i)throw new Error("ChartDataContext is not provided");const{data:u,columns:C,setData:c,setColumns:g,spec:h,setSpec:M}=i,d=s.useContext(A);if(!d)throw new Error("MessageContext is not provided");const{setMessage:l}=d;s.useEffect(()=>{(async()=>{const a=(await miro.board.getSelection())[0];if(a){p(a.id);const o=await y.fromMetaData({data:await a.getMetadata(r.VEGA_DATA),columns:await a.getMetadata(r.COL_NAMES),spec:await a.getMetadata(r.VEGA_SPEC)});g(o.columns),c(o.data),M(o.prettierSpec())}else c(G)})()},[]);async function f(){try{const e=new L;n(!0),await e.updateGraph(m,C,u,h),await miro.board.ui.closeModal()}catch(e){console.warn(e),e instanceof N?l({error:e,detail:e}):l({message:"Vega-Lite specification is invalid.",detail:e}),n(!1)}}return t.jsxs(t.Fragment,{children:[x&&t.jsx(S,{}),t.jsx("div",{style:{textAlign:"right"},children:t.jsx("button",{className:"button button-primary button-small",style:{marginBottom:3},onClick:f,children:"Update Chart"})})]})}const P=()=>t.jsx("div",{className:"",children:t.jsxs(v,{children:[t.jsx(D,{}),t.jsxs(I,{children:[t.jsx(O,{}),t.jsx(b,{})]})]})}),R=document.getElementById("root"),V=E.createRoot(R);V.render(t.jsx(P,{}));
