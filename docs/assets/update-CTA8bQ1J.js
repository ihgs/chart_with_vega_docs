import"./style-CMkGO_Nm.js";import{r as s,j as t,c as E}from"./index-rQnCqdvM.js";import{c as j,C as w,M as A,O as S,a as v,b as I,d as D,e as b}from"./common-D5PxIvuc.js";import{C as y,a as n,G as T,F as L,M as N}from"./miro-B5L8lpVz.js";const O=100,_=4,G=j(O,_);function R(){const[m,p]=s.useState(""),[x,i]=s.useState(!1),c=s.useContext(w);if(!c)throw new Error("ChartDataContext is not provided");const{data:u,columns:C,setData:d,setColumns:g,spec:h,setSpec:f}=c,l=s.useContext(A);if(!l)throw new Error("MessageContext is not provided");const{setMessage:o}=l;s.useEffect(()=>{(async()=>{const a=(await miro.board.getSelection())[0];if(a){p(a.id);const r=await y.fromMetaData({data:await a.getMetadata(n.VEGA_DATA),columns:await a.getMetadata(n.COL_NAMES),spec:await a.getMetadata(n.VEGA_SPEC)});g(r.columns),d(r.data),f(r.prettierSpec())}else d(G)})()},[]);async function M(){try{const e=new T;i(!0),await e.updateGraph(m,C,u,h),await miro.board.ui.closeModal()}catch(e){console.warn(e),e instanceof L?o({error:e,detail:e}):e instanceof N?o({error:e,detail:e}):o({message:"Vega-Lite specification is invalid.",detail:e}),i(!1)}}return t.jsxs(t.Fragment,{children:[x&&t.jsx(S,{}),t.jsx("div",{style:{textAlign:"right"},children:t.jsx("button",{className:"button button-primary button-small",style:{marginBottom:3},onClick:M,children:"Update Chart"})})]})}const P=()=>t.jsx("div",{className:"",children:t.jsxs(v,{children:[t.jsx(I,{}),t.jsxs(D,{children:[t.jsx(R,{}),t.jsx(b,{})]})]})}),V=document.getElementById("root"),F=E.createRoot(V);F.render(t.jsx(P,{}));
