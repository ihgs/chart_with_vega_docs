import{r as N,a as k,b as Mu,g as Hd,d as gi,j as Se,t as Wd,w as zd,W as rt,F as Ra}from"./jsx-runtime.9f138595.js";import{G as qd}from"./miro.39761233.js";const Zr=N.exports.createContext(null),_N=({children:e})=>{const[t,n]=N.exports.useState(""),[r,o]=N.exports.useState([]),[i,c]=N.exports.useState([]);return k(Zr.Provider,{value:{spec:t,setSpec:n,data:r,setData:o,columns:i,setColumns:c},children:e})};var bu={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function n(){for(var i="",c=0;c<arguments.length;c++){var f=arguments[c];f&&(i=o(i,r(f)))}return i}function r(i){if(typeof i=="string"||typeof i=="number")return i;if(typeof i!="object")return"";if(Array.isArray(i))return n.apply(null,i);if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]"))return i.toString();var c="";for(var f in i)t.call(i,f)&&i[f]&&(c=o(c,f));return c}function o(i,c){return c?i?i+" "+c:i+c:i}e.exports?(n.default=n,e.exports=n):window.classNames=n})()})(bu);const $n=bu.exports;class Kd{constructor(t,n){if(t==null&&n==null)this._data=[],this._refs=[];else{if(t.length!==n.length)throw Error("Collection: data length should match references length.");this._data=t,this._refs=n}}get data(){return this._data}get refs(){return this._refs}get length(){return this._data.length}add(t,n){this._data.push(t),this._refs.push(n)}}var Ei=Kd,$i,Us;function Xe(){if(Us)return $i;Us=1;const e=We(),t=Ei,n={NUMBER:0,ARRAY:1,BOOLEAN:2,STRING:3,RANGE_REF:4,CELL_REF:5,COLLECTIONS:6,NUMBER_NO_BOOLEAN:10},r=[1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,6227020800,87178291200,1307674368e3,20922789888e3,355687428096e3,6402373705728e3,121645100408832e3,243290200817664e4,5109094217170944e4,11240007277776077e5,2585201673888498e7,6204484017332394e8,15511210043330986e9,40329146112660565e10,10888869450418352e12,30488834461171387e13,8841761993739702e15,26525285981219107e16,8222838654177922e18,2631308369336935e20,8683317618811886e21,29523279903960416e22,10333147966386145e24,37199332678990125e25,13763753091226346e27,5230226174666011e29,20397882081197444e30,8159152832478977e32,3345252661316381e34,140500611775288e37,6041526306337383e37,2658271574788449e39,11962222086548019e40,5502622159812089e42,25862324151116818e43,12413915592536073e45,6082818640342675e47,30414093201713376e48,15511187532873822e50,8065817517094388e52,42748832840600255e53,2308436973392414e56,12696403353658276e57,7109985878048635e59,40526919504877214e60,23505613312828785e62,13868311854568984e64,832098711274139e67,5075802138772248e68,3146997326038794e70,198260831540444e73,12688693218588417e73,8247650592082472e75,5443449390774431e77,3647111091818868e79,24800355424368305e80,1711224524281413e83,11978571669969892e84,8504785885678623e86,61234458376886085e87,44701154615126844e89,3307885441519386e92,248091408113954e95,18854947016660504e95,14518309202828587e97,11324281178206297e99,8946182130782976e101,7156945704626381e103,5797126020747368e105,4753643337012842e107,3945523969720659e109,3314240134565353e111,281710411438055e114,24227095383672734e114,2107757298379528e117,18548264225739844e118,1650795516090846e121,14857159644817615e122,1352001527678403e125,12438414054641308e126,11567725070816416e128,1087366156656743e131,1032997848823906e133,9916779348709496e134,9619275968248212e136,9426890448883248e138,9332621544394415e140,9332621544394415e142],o={};Object.keys(n).forEach(a=>{o[n[a]]=a});class i{constructor(){this.Types=n,this.type2Number={number:n.NUMBER,boolean:n.BOOLEAN,string:n.STRING,object:-1}}checkFunctionResult(s){if(typeof s==="number"){if(isNaN(s))return e.VALUE;if(!isFinite(s))return e.NUM}return s==null?e.NULL:s}flattenDeep(s){return s.reduce((l,d)=>Array.isArray(d)?l.concat(this.flattenDeep(d)):l.concat(d),[])}acceptNumber(s,l=!0,d=!0){if(s instanceof e)return s;let v;if(typeof s=="number")v=s;else if(typeof s=="boolean")if(d)v=Number(s);else throw e.VALUE;else if(typeof s=="string"){if(s.length===0||(v=Number(s),v!==v))throw e.VALUE}else if(Array.isArray(s))if(l)v=this.acceptNumber(s[0][0]);else if(s[0].length===1)v=this.acceptNumber(s[0][0]);else throw e.VALUE;else throw Error("Unknown type in FormulaHelpers.acceptNumber");return v}flattenParams(s,l,d,v,p=null,m=1){if(s.length<m)throw e.ARG_MISSING([l]);p==null&&(p=l===n.NUMBER?0:l==null?null:""),s.forEach(g=>{const{isCellRef:E,isRangeRef:y,isArray:w}=g,T=g.value instanceof t,R=!E&&!y&&!w&&!T,A={isLiteral:R,isCellRef:E,isRangeRef:y,isArray:w,isUnion:T};if(R)g.omitted?g=p:g=this.accept(g,l,p),v(g,A);else if(E)v(g.value,A);else if(T){if(!d)throw e.VALUE;g=g.value.data,g=this.flattenDeep(g),g.forEach(C=>{v(C,A)})}else(y||w)&&(g=this.flattenDeep(g.value),g.forEach(C=>{v(C,A)}))})}accept(s,l=null,d,v=!0,p=!1){if(Array.isArray(l)&&(l=l[0]),s==null&&d===void 0)throw e.ARG_MISSING([l]);if(s==null)return d;if(typeof s!="object"||Array.isArray(s))return s;const m=s.isArray;if(s.value!=null&&(s=s.value),l==null)return s;if(s instanceof e)throw s;if(l===n.ARRAY){if(Array.isArray(s))return v?this.flattenDeep(s):s;if(s instanceof t)throw e.VALUE;if(p)return v?[s]:[[s]];throw e.VALUE}else if(l===n.COLLECTIONS)return s;m&&(s=s[0][0]);const g=this.type(s);if(l===n.STRING)g===n.BOOLEAN?s=s?"TRUE":"FALSE":s=`${s}`;else if(l===n.BOOLEAN){if(g===n.STRING)throw e.VALUE;g===n.NUMBER&&(s=Boolean(s))}else if(l===n.NUMBER)s=this.acceptNumber(s,!1);else if(l===n.NUMBER_NO_BOOLEAN)s=this.acceptNumber(s,!1,!1);else throw e.VALUE;return s}type(s){let l=this.type2Number[typeof s];return l===-1&&(Array.isArray(s)?l=n.ARRAY:s.ref?s.ref.from?l=n.RANGE_REF:l=n.CELL_REF:s instanceof t&&(l=n.COLLECTIONS)),l}isRangeRef(s){return s.ref&&s.ref.from}isCellRef(s){return s.ref&&!s.ref.from}retrieveRanges(s,l,d){return d=u.extend(l,d),l=this.retrieveArg(s,l),l=c.accept(l,n.ARRAY,void 0,!1,!0),d!==l?(d=this.retrieveArg(s,d),d=c.accept(d,n.ARRAY,void 0,!1,!0)):d=l,[l,d]}retrieveArg(s,l){if(l===null)return{value:0,isArray:!1,omitted:!0};const d=s.utils.extractRefValue(l);return{value:d.val,isArray:d.isArray,ref:l.ref}}}const c=new i,f={isWildCard:a=>typeof a=="string"?/[*?]/.test(a):!1,toRegex:(a,s)=>RegExp(a.replace(/[.+^${}()|[\]\\]/g,"\\$&").replace(/([^~]??)[?]/g,"$1.").replace(/([^~]??)[*]/g,"$1.*").replace(/~([?*])/g,"$1"),s)},h={parse:a=>{const s=typeof a;if(s==="string"){const l=a.toUpperCase();if(l==="TRUE"||l==="FALSE")return{op:"=",value:l==="TRUE"};const d=a.match(/(<>|>=|<=|>|<|=)(.*)/);if(d){let v=d[1],p;if(isNaN(d[2])){const m=d[2].toUpperCase();if(m==="TRUE"||m==="FALSE")p=m==="TRUE";else if(/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A|#REF!/.test(d[2]))p=new e(d[2]);else if(p=d[2],f.isWildCard(p))return{op:"wc",value:f.toRegex(p),match:v==="="}}else p=Number(d[2]);return{op:v,value:p}}else return f.isWildCard(a)?{op:"wc",value:f.toRegex(a),match:!0}:{op:"=",value:a}}else{if(s==="boolean"||s==="number"||Array.isArray(a)||a instanceof e)return{op:"=",value:a};throw Error(`Criteria.parse: type ${typeof a} not support`)}}},u={columnNumberToName:a=>{let s=a,l="",d=0;for(;s>0;)d=(s-1)%26,l=String.fromCharCode("A".charCodeAt(0)+d)+l,s=Math.floor((s-d)/26);return l},columnNameToNumber:a=>{a=a.toUpperCase();const s=a.length;let l=0;for(let d=0;d<s;d++){const v=a.charCodeAt(d);isNaN(v)||(l+=(v-64)*26**(s-d-1))}return l},extend:(a,s)=>{if(s==null)return a;let l,d;if(c.isCellRef(a))l=0,d=0;else if(c.isRangeRef(a))l=a.ref.to.row-a.ref.from.row,d=a.ref.to.col-a.ref.from.col;else throw Error("Address.extend should not reach here.");return c.isCellRef(s)?(l>0||d>0)&&(s={ref:{from:{col:s.ref.col,row:s.ref.row},to:{row:s.ref.row+l,col:s.ref.col+d}}}):(s.ref.to.row=s.ref.from.row+l,s.ref.to.col=s.ref.from.col+d),s}};return $i={FormulaHelpers:c,Types:n,ReversedTypes:o,Factorials:r,WildCard:f,Criteria:h,Address:u},$i}var Vi,ks;function We(){if(ks)return Vi;ks=1;class e extends Error{constructor(n,r,o){if(super(r),r==null&&o==null&&e.errorMap.has(n))return e.errorMap.get(n);r==null&&o==null?(this._error=n,e.errorMap.set(n,this)):this._error=n,this.details=o}get error(){return this._error}get name(){return this._error}equals(n){return n instanceof e&&n._error===this._error}toString(){return this._error}}return e.errorMap=new Map,e.DIV0=new e("#DIV/0!"),e.NA=new e("#N/A"),e.NAME=new e("#NAME?"),e.NULL=new e("#NULL!"),e.NUM=new e("#NUM!"),e.REF=new e("#REF!"),e.VALUE=new e("#VALUE!"),e.NOT_IMPLEMENTED=t=>new e("#NAME?",`Function ${t} is not implemented.`),e.TOO_MANY_ARGS=t=>new e("#N/A",`Function ${t} has too many arguments.`),e.ARG_MISSING=t=>{const{Types:n}=Xe();return new e("#N/A",`Argument type ${t.map(r=>n[r]).join(", ")} is missing.`)},e.ERROR=(t,n)=>new e("#ERROR!",t,n),Vi=e,Vi}class vt{}vt.version="0.10.3";function sr(e){let t="",n=e.length-1;for(;n>=0;)t+=e.charAt(n--);return t}function gt(e,t){let n="";for(;n.length<t;)n+=e;return n}function Gt(e,t){let n=""+e;return n.length>=t?n:gt("0",t-n.length)+n}function Gi(e,t){let n=""+e;return n.length>=t?n:gt(" ",t-n.length)+n}function po(e,t){let n=""+e;return n.length>=t?n:n+gt(" ",t-n.length)}function Yd(e,t){let n=""+Math.round(e);return n.length>=t?n:gt("0",t-n.length)+n}function Xd(e,t){let n=""+e;return n.length>=t?n:gt("0",t-n.length)+n}const Ps=Math.pow(2,32);function cr(e,t){if(e>Ps||e<-Ps)return Yd(e,t);const n=Math.round(e);return Xd(n,t)}function Xo(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}const Ss=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Hi=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Lu(e){e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',e[65535]="General"}const jn={};Lu(jn);function vo(e,t,n){const r=e<0?-1:1;let o=e*r,i=0,c=1,f=0,h=1,u=0,a=0,s=Math.floor(o);for(;u<t&&(s=Math.floor(o),f=s*c+i,a=s*u+h,!(o-s<5e-8));)o=1/(o-s),i=c,c=f,h=u,u=a;if(a>t&&(u>t?(a=h,f=i):(a=u,f=c)),!n)return[0,r*f,a];const l=Math.floor(r*f/a);return[l,r*f-l*a,a]}function Ur(e,t,n){if(e>2958465||e<0)return null;let r=e|0,o=Math.floor(86400*(e-r)),i=0,c=[];const f={D:r,T:o,u:86400*(e-r)-o,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(f.u)<1e-6&&(f.u=0),t&&t.date1904&&(r+=1462),f.u>.9999&&(f.u=0,++o===86400&&(f.T=o=0,++r,++f.D)),r===60)c=n?[1317,10,29]:[1900,2,29],i=3;else if(r===0)c=n?[1317,8,29]:[1900,1,0],i=6;else{r>60&&--r;const h=new Date(1900,0,1);h.setDate(h.getDate()+r-1),c=[h.getFullYear(),h.getMonth()+1,h.getDate()],i=h.getDay(),r<60&&(i=(i+6)%7),n&&(i=Jd())}return f.y=c[0],f.m=c[1],f.d=c[2],f.S=o%60,o=Math.floor(o/60),f.M=o%60,o=Math.floor(o/60),f.H=o,f.q=i,f}vt.parse_date_code=Ur;const Uu=new Date(1899,11,31,0,0,0),Qd=Uu.getTime(),Zd=new Date(1900,2,1,0,0,0);function ku(e,t){let n=e.getTime();return t?n-=1461*24*60*60*1e3:e>=Zd&&(n+=24*60*60*1e3),(n-(Qd+(e.getTimezoneOffset()-Uu.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Pu(e){return e.toString(10)}vt._general_int=Pu;const Su=function(){const t=/\.(\d*[1-9])0+$/,n=/\.0*$/,r=/\.(\d*[1-9])0+/,o=/\.0*[Ee]/,i=/(E[+-])(\d)$/;function c(a){const s=a<0?12:11;let l=u(a.toFixed(12));return l.length<=s||(l=a.toPrecision(10),l.length<=s)?l:a.toExponential(5)}function f(a){let s=a.toFixed(11).replace(t,".$1");return s.length>(a<0?12:11)&&(s=a.toPrecision(6)),s}function h(a){for(let s=0;s!==a.length;++s)if((a.charCodeAt(s)|32)===101)return a.replace(r,".$1").replace(o,"E").replace("e","E").replace(i,"$10$2");return a}function u(a){return a.indexOf(".")>-1?a.replace(n,"").replace(t,".$1"):a}return function(s){let l=Math.floor(Math.log(Math.abs(s))*Math.LOG10E),d;return l>=-4&&l<=-1?d=s.toPrecision(10+l):Math.abs(l)<=9?d=c(s):l===10?d=s.toFixed(10).substr(0,12):d=f(s),u(h(d))}}();vt._general_num=Su;function Qo(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?Pu(e):Su(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Vu(14,ku(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}vt._general=Qo;function Jd(){return 0}function jd(e,t,n,r){let o="",i=0,c=0,f=n.y,h,u=0;switch(e){case 98:f=n.y+543;case 121:switch(t.length){case 1:case 2:h=f%100,u=2;break;default:h=f%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:h=n.m,u=t.length;break;case 3:return Hi[n.m-1][1];case 5:return Hi[n.m-1][0];default:return Hi[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:h=n.d,u=t.length;break;case 3:return Ss[n.q][0];default:return Ss[n.q][1]}break;case 104:switch(t.length){case 1:case 2:h=1+(n.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:h=n.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:h=n.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!=="s"&&t!=="ss"&&t!==".0"&&t!==".00"&&t!==".000")throw"bad second format: "+t;return n.u===0&&(t==="s"||t==="ss")?Gt(n.S,t.length):(r>=2?c=r===3?1e3:100:c=r===1?10:1,i=Math.round(c*(n.S+n.u)),i>=60*c&&(i=0),t==="s"?i===0?"0":""+i/c:(o=Gt(i,2+r),t==="ss"?o.substr(0,2):"."+o.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":h=n.D*24+n.H;break;case"[m]":case"[mm]":h=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":h=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:h=f,u=1}return u>0?Gt(h,u):""}function On(e){if(e.length<=3)return e;let n=e.length%3,r=e.substr(0,n);for(;n!==e.length;n+=3)r+=(r.length>0?",":"")+e.substr(n,3);return r}const hn=function(){const t=/%/g;function n(T,R,A){const C=R.replace(t,""),x=R.length-C.length;return hn(T,C,A*Math.pow(10,2*x))+gt("%",x)}function r(T,R,A){let C=R.length-1;for(;R.charCodeAt(C-1)===44;)--C;return hn(T,R.substr(0,C),A/Math.pow(10,3*(R.length-C)))}function o(T,R){let A,C=T.indexOf("E")-T.indexOf(".")-1;if(T.match(/^#+0.0E\+0$/)){if(R===0)return"0.0E+0";if(R<0)return"-"+o(T,-R);let x=T.indexOf(".");x===-1&&(x=T.indexOf("E"));let O=Math.floor(Math.log(R)*Math.LOG10E)%x;if(O<0&&(O+=x),A=(R/Math.pow(10,O)).toPrecision(C+1+(x+O)%x),A.indexOf("e")===-1){const I=Math.floor(Math.log(R)*Math.LOG10E);for(A.indexOf(".")===-1?A=A.charAt(0)+"."+A.substr(1)+"E+"+(I-A.length+O):A+="E+"+(I-O);A.substr(0,2)==="0.";)A=A.charAt(0)+A.substr(2,x)+"."+A.substr(2+x),A=A.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");A=A.replace(/\+-/,"-")}A=A.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(I,P,B,S){return P+B+S.substr(0,(x+O)%x)+"."+S.substr(O)+"E"})}else A=R.toExponential(C);return T.match(/E\+00$/)&&A.match(/e[+-]\d$/)&&(A=A.substr(0,A.length-1)+"0"+A.charAt(A.length-1)),T.match(/E\-/)&&A.match(/e\+/)&&(A=A.replace(/e\+/,"e")),A.replace("e","E")}const i=/# (\?+)( ?)\/( ?)(\d+)/;function c(T,R,A){const C=parseInt(T[4],10),x=Math.round(R*C),O=Math.floor(x/C);let I=x-O*C,P=C;return A+(O===0?"":""+O)+" "+(I===0?gt(" ",T[1].length+1+T[4].length):Gi(I,T[1].length)+T[2]+"/"+T[3]+Gt(P,T[4].length))}function f(T,R,A){return A+(R===0?"":""+R)+gt(" ",T[1].length+2+T[4].length)}const h=/^#*0*\.([0#]+)/,u=/\).*[0#]/,a=/\(###\) ###\\?-####/;function s(T){let R="",A;for(let C=0;C!==T.length;++C)switch(A=T.charCodeAt(C)){case 35:break;case 63:R+=" ";break;case 48:R+="0";break;default:R+=String.fromCharCode(A)}return R}function l(T,R){const A=Math.pow(10,R);return""+Math.round(T*A)/A}function d(T,R){return R<(""+Math.round((T-Math.floor(T))*Math.pow(10,R))).length?0:Math.round((T-Math.floor(T))*Math.pow(10,R))}function v(T,R){return R<(""+Math.round((T-Math.floor(T))*Math.pow(10,R))).length?1:0}function p(T){return T<2147483647&&T>-2147483648?""+(T>=0?T|0:T-1|0):""+Math.floor(T)}function m(T,R,A){if(T.charCodeAt(0)===40&&!R.match(u)){const b=R.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return A>=0?m("n",b,A):"("+m("n",b,-A)+")"}if(R.charCodeAt(R.length-1)===44)return r(T,R,A);if(R.indexOf("%")!==-1)return n(T,R,A);if(R.indexOf("E")!==-1)return o(R,A);if(R.charCodeAt(0)===36)return"$"+m(T,R.substr(R.charAt(1)==" "?2:1),A);let C,x,O,I,P=Math.abs(A),B=A<0?"-":"";if(R.match(/^00+$/))return B+cr(P,R.length);if(R.match(/^[#?]+$/))return C=cr(A,0),C==="0"&&(C=""),C.length>R.length?C:s(R.substr(0,R.length-C.length))+C;if(x=R.match(i))return c(x,P,B);if(R.match(/^#+0+$/))return B+cr(P,R.length-R.indexOf("0"));if(x=R.match(h))return C=l(A,x[1].length).replace(/^([^\.]+)$/,"$1."+s(x[1])).replace(/\.$/,"."+s(x[1])).replace(/\.(\d*)$/,function(b,_){return"."+_+gt("0",s(x[1]).length-_.length)}),R.indexOf("0.")!==-1?C:C.replace(/^0\./,".");if(R=R.replace(/^#+([0.])/,"$1"),x=R.match(/^(0*)\.(#*)$/))return B+l(P,x[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,x[1].length?"0.":".");if(x=R.match(/^#{1,3},##0(\.?)$/))return B+On(cr(P,0));if(x=R.match(/^#,##0\.([#0]*0)$/))return A<0?"-"+m(T,R,-A):On(""+(Math.floor(A)+v(A,x[1].length)))+"."+Gt(d(A,x[1].length),x[1].length);if(x=R.match(/^#,#*,#0/))return m(T,R.replace(/^#,#*,/,""),A);if(x=R.match(/^([0#]+)(\\?-([0#]+))+$/))return C=sr(m(T,R.replace(/[\\-]/g,""),A)),O=0,sr(sr(R.replace(/\\/g,"")).replace(/[0#]/g,function(b){return O<C.length?C.charAt(O++):b==="0"?"0":""}));if(R.match(a))return C=m(T,"##########",A),"("+C.substr(0,3)+") "+C.substr(3,3)+"-"+C.substr(6);let S="";if(x=R.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return O=Math.min(x[4].length,7),I=vo(P,Math.pow(10,O)-1,!1),C=""+B,S=hn("n",x[1],I[1]),S.charAt(S.length-1)===" "&&(S=S.substr(0,S.length-1)+"0"),C+=S+x[2]+"/"+x[3],S=po(I[2],O),S.length<x[4].length&&(S=s(x[4].substr(x[4].length-S.length))+S),C+=S,C;if(x=R.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return O=Math.min(Math.max(x[1].length,x[4].length),7),I=vo(P,Math.pow(10,O)-1,!0),B+(I[0]||(I[1]?"":"0"))+" "+(I[1]?Gi(I[1],O)+x[2]+"/"+x[3]+po(I[2],O):gt(" ",2*O+1+x[2].length+x[3].length));if(x=R.match(/^[#0?]+$/))return C=cr(A,0),R.length<=C.length?C:s(R.substr(0,R.length-C.length))+C;if(x=R.match(/^([#0?]+)\.([#0]+)$/)){C=""+A.toFixed(Math.min(x[2].length,10)).replace(/([^0])0+$/,"$1"),O=C.indexOf(".");const b=R.indexOf(".")-O,_=R.length-C.length-b;return s(R.substr(0,b)+C+R.substr(R.length-_))}if(x=R.match(/^00,000\.([#0]*0)$/))return O=d(A,x[1].length),A<0?"-"+m(T,R,-A):On(p(A)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Gt(0,3-b.length):"")+b})+"."+Gt(O,x[1].length);switch(R){case"###,##0.00":return m(T,"#,##0.00",A);case"###,###":case"##,###":case"#,###":const b=On(cr(P,0));return b!=="0"?B+b:"";case"###,###.00":return m(T,"###,##0.00",A).replace(/^0\./,".");case"#,###.00":return m(T,"#,##0.00",A).replace(/^0\./,".")}throw new Error("unsupported format |"+R+"|")}function g(T,R,A){let C=R.length-1;for(;R.charCodeAt(C-1)===44;)--C;return hn(T,R.substr(0,C),A/Math.pow(10,3*(R.length-C)))}function E(T,R,A){const C=R.replace(t,""),x=R.length-C.length;return hn(T,C,A*Math.pow(10,2*x))+gt("%",x)}function y(T,R){let A,C=T.indexOf("E")-T.indexOf(".")-1;if(T.match(/^#+0.0E\+0$/)){if(R===0)return"0.0E+0";if(R<0)return"-"+y(T,-R);let x=T.indexOf(".");x===-1&&(x=T.indexOf("E"));let O=Math.floor(Math.log(R)*Math.LOG10E)%x;if(O<0&&(O+=x),A=(R/Math.pow(10,O)).toPrecision(C+1+(x+O)%x),!A.match(/[Ee]/)){const I=Math.floor(Math.log(R)*Math.LOG10E);A.indexOf(".")===-1?A=A.charAt(0)+"."+A.substr(1)+"E+"+(I-A.length+O):A+="E+"+(I-O),A=A.replace(/\+-/,"-")}A=A.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(I,P,B,S){return P+B+S.substr(0,(x+O)%x)+"."+S.substr(O)+"E"})}else A=R.toExponential(C);return T.match(/E\+00$/)&&A.match(/e[+-]\d$/)&&(A=A.substr(0,A.length-1)+"0"+A.charAt(A.length-1)),T.match(/E\-/)&&A.match(/e\+/)&&(A=A.replace(/e\+/,"e")),A.replace("e","E")}function w(T,R,A){if(T.charCodeAt(0)===40&&!R.match(u)){const b=R.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return A>=0?w("n",b,A):"("+w("n",b,-A)+")"}if(R.charCodeAt(R.length-1)===44)return g(T,R,A);if(R.indexOf("%")!==-1)return E(T,R,A);if(R.indexOf("E")!==-1)return y(R,A);if(R.charCodeAt(0)===36)return"$"+w(T,R.substr(R.charAt(1)==" "?2:1),A);let C,x,O,I,P=Math.abs(A),B=A<0?"-":"";if(R.match(/^00+$/))return B+Gt(P,R.length);if(R.match(/^[#?]+$/))return C=""+A,A===0&&(C=""),C.length>R.length?C:s(R.substr(0,R.length-C.length))+C;if(x=R.match(i))return f(x,P,B);if(R.match(/^#+0+$/))return B+Gt(P,R.length-R.indexOf("0"));if(x=R.match(h))return C=(""+A).replace(/^([^\.]+)$/,"$1."+s(x[1])).replace(/\.$/,"."+s(x[1])),C=C.replace(/\.(\d*)$/,function(b,_){return"."+_+gt("0",s(x[1]).length-_.length)}),R.indexOf("0.")!==-1?C:C.replace(/^0\./,".");if(R=R.replace(/^#+([0.])/,"$1"),x=R.match(/^(0*)\.(#*)$/))return B+(""+P).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,x[1].length?"0.":".");if(x=R.match(/^#{1,3},##0(\.?)$/))return B+On(""+P);if(x=R.match(/^#,##0\.([#0]*0)$/))return A<0?"-"+w(T,R,-A):On(""+A)+"."+gt("0",x[1].length);if(x=R.match(/^#,#*,#0/))return w(T,R.replace(/^#,#*,/,""),A);if(x=R.match(/^([0#]+)(\\?-([0#]+))+$/))return C=sr(w(T,R.replace(/[\\-]/g,""),A)),O=0,sr(sr(R.replace(/\\/g,"")).replace(/[0#]/g,function(b){return O<C.length?C.charAt(O++):b==="0"?"0":""}));if(R.match(a))return C=w(T,"##########",A),"("+C.substr(0,3)+") "+C.substr(3,3)+"-"+C.substr(6);let S="";if(x=R.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return O=Math.min(x[4].length,7),I=vo(P,Math.pow(10,O)-1,!1),C=""+B,S=hn("n",x[1],I[1]),S.charAt(S.length-1)==" "&&(S=S.substr(0,S.length-1)+"0"),C+=S+x[2]+"/"+x[3],S=po(I[2],O),S.length<x[4].length&&(S=s(x[4].substr(x[4].length-S.length))+S),C+=S,C;if(x=R.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return O=Math.min(Math.max(x[1].length,x[4].length),7),I=vo(P,Math.pow(10,O)-1,!0),B+(I[0]||(I[1]?"":"0"))+" "+(I[1]?Gi(I[1],O)+x[2]+"/"+x[3]+po(I[2],O):gt(" ",2*O+1+x[2].length+x[3].length));if(x=R.match(/^[#0?]+$/))return C=""+A,R.length<=C.length?C:s(R.substr(0,R.length-C.length))+C;if(x=R.match(/^([#0]+)\.([#0]+)$/)){C=""+A.toFixed(Math.min(x[2].length,10)).replace(/([^0])0+$/,"$1"),O=C.indexOf(".");let b=R.indexOf(".")-O,_=R.length-C.length-b;return s(R.substr(0,b)+C+R.substr(R.length-_))}if(x=R.match(/^00,000\.([#0]*0)$/))return A<0?"-"+w(T,R,-A):On(""+A).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Gt(0,3-b.length):"")+b})+"."+Gt(0,x[1].length);switch(R){case"###,###":case"##,###":case"#,###":const b=On(""+P);return b!=="0"?B+b:"";default:if(R.match(/\.[0#?]*$/))return w(T,R.slice(0,R.lastIndexOf(".")),A)+s(R.slice(R.lastIndexOf(".")))}throw new Error("unsupported format |"+R+"|")}return function(R,A,C){return(C|0)===C?w(R,A,C):m(R,A,C)}}();function Fu(e){const t=[];let n=!1,r=0;for(let o=0;o<e.length;++o)switch(e.charCodeAt(o)){case 34:n=!n;break;case 95:case 42:case 92:++o;break;case 59:t[t.length]=e.substr(r,o-r),r=o+1}if(t[t.length]=e.substr(r),n===!0)throw new Error("Format |"+e+"| unterminated string ");return t}vt._split=Fu;const Bu=/\[[HhMmSs]*\]/;function Du(e){let t=0,n="",r="";for(;t<e.length;)switch(n=e.charAt(t)){case"G":Xo(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;)++t;++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM")return!0;++t;break;case"[":for(r=n;e.charAt(t++)!=="]"&&t<e.length;)r+=e.charAt(t);if(r.match(Bu))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||n=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t,(e.charAt(t)===" "||e.charAt(t)==="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}vt.is_date=Du;function $u(e,t,n,r){let o=[],i="",c=0,f="",h="t",u,a,s,l="H";for(;c<e.length;)switch(f=e.charAt(c)){case"G":if(!Xo(e,c))throw new Error("unrecognized character "+f+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(i="";(s=e.charCodeAt(++c))!==34&&c<e.length;)i+=String.fromCharCode(s);o[o.length]={t:"t",v:i},++c;break;case"\\":const R=e.charAt(++c),A=R==="("||R===")"?R:"t";o[o.length]={t:A,v:R},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if(e.charAt(c+1)==="1"||e.charAt(c+1)==="2"){if(u==null&&(u=Ur(t,n,e.charAt(c+1)==="2"),u==null))return"";o[o.length]={t:"X",v:e.substr(c,2)},h=f,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":f=f.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Ur(t,n),u==null))return"";for(i=f;++c<e.length&&e.charAt(c).toLowerCase()===f;)i+=f;f==="m"&&h.toLowerCase()==="h"&&(f="M"),f==="h"&&(f=l),o[o.length]={t:f,v:i},h=f;break;case"A":case"a":const C={t:f,v:f};if(u==null&&(u=Ur(t,n)),e.substr(c,3).toUpperCase()==="A/P"?(u!=null&&(C.v=u.H>=12?"P":"A"),C.t="T",l="h",c+=3):e.substr(c,5).toUpperCase()==="AM/PM"?(u!=null&&(C.v=u.H>=12?"PM":"AM"),C.t="T",c+=5,l="h"):(C.t="t",++c),u==null&&C.t==="T")return"";o[o.length]=C,h=f;break;case"[":for(i=f;e.charAt(c++)!=="]"&&c<e.length;)i+=e.charAt(c);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(Bu)){if(u==null&&(u=Ur(t,n),u==null))return"";o[o.length]={t:"Z",v:i.toLowerCase()},h=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Du(e)||(o[o.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=f;++c<e.length&&(f=e.charAt(c))==="0";)i+=f;o[o.length]={t:"s",v:i};break}case"0":case"#":for(i=f;++c<e.length&&"0#?.,E+-%".indexOf(f=e.charAt(c))>-1||f=="\\"&&e.charAt(c+1)=="-"&&c<e.length-2&&"0#".indexOf(e.charAt(c+2))>-1;)i+=f;o[o.length]={t:"n",v:i};break;case"?":for(i=f;e.charAt(++c)===f;)i+=f;o[o.length]={t:f,v:i},h=f;break;case"*":++c,(e.charAt(c)===" "||e.charAt(c)==="*")&&++c;break;case"(":case")":o[o.length]={t:r===1||typeof t=="number"&&t<0?"t":f,v:f},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=f;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)i+=e.charAt(c);o[o.length]={t:"D",v:i};break;case" ":o[o.length]={t:f,v:f},++c;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(f)===-1)throw new Error("unrecognized character "+f+" in "+e);o[o.length]={t:"t",v:f},++c;break}let d=0,v=0,p;for(c=o.length-1,h="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=l,h="h",d<1&&(d=1);break;case"s":(p=o[c].v.match(/\.0+$/))&&(v=Math.max(v,p[0].length-1)),d<3&&(d=3);case"d":case"y":case"M":case"e":h=o[c].t;break;case"m":h==="s"&&(o[c].t="M",d<2&&(d=2));break;case"X":break;case"Z":d<1&&o[c].v.match(/[Hh]/)&&(d=1),d<2&&o[c].v.match(/[Mm]/)&&(d=2),d<3&&o[c].v.match(/[Ss]/)&&(d=3)}switch(d){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}let m="",g;for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=jd(o[c].t.charCodeAt(0),o[c].v,u,v),o[c].t="t";break;case"n":case"(":case"?":for(g=c+1;o[g]!=null&&((f=o[g].t)==="?"||f==="D"||(f===" "||f==="t")&&o[g+1]!=null&&(o[g+1].t==="?"||o[g+1].t==="t"&&o[g+1].v==="/")||o[c].t==="("&&(f===" "||f==="n"||f===")")||f==="t"&&(o[g].v==="/"||o[g].v===" "&&o[g+1]!=null&&o[g+1].t==="?"));)o[c].v+=o[g].v,o[g]={v:"",t:";"},++g;m+=o[c].v,c=g-1;break;case"G":o[c].t="t",o[c].v=Qo(t,n);break}let E="",y,w;if(m.length>0){m.charCodeAt(0)===40?(y=t<0&&m.charCodeAt(0)===45?-t:t,w=hn("(",m,y)):(y=t<0&&r>1?-t:t,w=hn("n",m,y),y<0&&o[0]&&o[0].t==="t"&&(w=w.substr(1),o[0].v="-"+o[0].v)),g=w.length-1;let R=o.length;for(c=0;c<o.length;++c)if(o[c]!=null&&o[c].t!=="t"&&o[c].v.indexOf(".")>-1){R=c;break}let A=o.length;if(R===o.length&&w.indexOf("E")===-1){for(c=o.length-1;c>=0;--c)o[c]==null||"n?(".indexOf(o[c].t)===-1||(g>=o[c].v.length-1?(g-=o[c].v.length,o[c].v=w.substr(g+1,o[c].v.length)):g<0?o[c].v="":(o[c].v=w.substr(0,g+1),g=-1),o[c].t="t",A=c);g>=0&&A<o.length&&(o[A].v=w.substr(0,g+1)+o[A].v)}else if(R!==o.length&&w.indexOf("E")===-1){for(g=w.indexOf(".")-1,c=R;c>=0;--c)if(!(o[c]==null||"n?(".indexOf(o[c].t)===-1)){for(a=o[c].v.indexOf(".")>-1&&c===R?o[c].v.indexOf(".")-1:o[c].v.length-1,E=o[c].v.substr(a+1);a>=0;--a)g>=0&&(o[c].v.charAt(a)==="0"||o[c].v.charAt(a)==="#")&&(E=w.charAt(g--)+E);o[c].v=E,o[c].t="t",A=c}for(g>=0&&A<o.length&&(o[A].v=w.substr(0,g+1)+o[A].v),g=w.indexOf(".")+1,c=R;c<o.length;++c)if(!(o[c]==null||"n?(".indexOf(o[c].t)===-1&&c!==R)){for(a=o[c].v.indexOf(".")>-1&&c===R?o[c].v.indexOf(".")+1:0,E=o[c].v.substr(0,a);a<o[c].v.length;++a)g<w.length&&(E+=w.charAt(g++));o[c].v=E,o[c].t="t",A=c}}}for(c=0;c<o.length;++c)o[c]!=null&&"n(?".indexOf(o[c].t)>-1&&(y=r>1&&t<0&&c>0&&o[c-1].v==="-"?-t:t,o[c].v=hn(o[c].t,o[c].v,y),o[c].t="t");let T="";for(c=0;c!==o.length;++c)o[c]!=null&&(T+=o[c].v);return T}vt._eval=$u;const Fs=/\[[=<>]/,Bs=/\[([=<>]*)(-?\d+\.?\d*)\]/;function Ds(e,t){if(t==null)return!1;const n=parseFloat(t[2]);switch(t[1]){case"=":if(e===n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!==n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0;break}return!1}function eh(e,t){let n=Fu(e),r=n.length,o=n[r-1].indexOf("@");if(r<4&&o>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof t!="number")return[4,n.length===4||o>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=o>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=o>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=o>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}const i=t>0?n[0]:t<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,i];if(n[0].match(Fs)!=null||n[1].match(Fs)!=null){const c=n[0].match(Bs),f=n[1].match(Bs);return Ds(t,c)?[r,n[0]]:Ds(t,f)?[r,n[1]]:[r,n[c!=null&&f!=null?2:1]]}return[r,i]}function Vu(e,t,n){n==null&&(n={});let r="";switch(typeof e){case"string":e==="m/d/yy"&&n.dateNF?r=n.dateNF:r=e;break;case"number":e===14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:jn)[e];break}if(Xo(r,0))return Qo(t,n);t instanceof Date&&(t=ku(t,n.date1904));const o=eh(r,t);if(Xo(o[1]))return Qo(t,n);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return $u(o[1],t,n,o[0])}function Gu(e,t){if(typeof t!="number"){t=+t||-1;for(let n=0;n<392;++n){if(jn[n]===void 0){t<0&&(t=n);continue}if(jn[n]===e){t=n;break}}t<0&&(t=391)}return jn[t]=e,t}vt.load=Gu;vt._table=jn;vt.get_table=function(){return jn};vt.load_table=function(t){for(let n=0;n!==392;++n)t[n]!==void 0&&Gu(t[n],n)};vt.init_table=Lu;vt.format=Vu;var Hu=vt,Wu={exports:{}};(function(e){const t="\u0E28\u0E39\u0E19\u0E22\u0E4C\u0E1A\u0E32\u0E17\u0E16\u0E49\u0E27\u0E19",n=["","\u0E2B\u0E19\u0E36\u0E48\u0E07","\u0E2A\u0E2D\u0E07","\u0E2A\u0E32\u0E21","\u0E2A\u0E35\u0E48","\u0E2B\u0E49\u0E32","\u0E2B\u0E01","\u0E40\u0E08\u0E47\u0E14","\u0E41\u0E1B\u0E14","\u0E40\u0E01\u0E49\u0E32"],r=["","\u0E2A\u0E34\u0E1A","\u0E23\u0E49\u0E2D\u0E22","\u0E1E\u0E31\u0E19","\u0E2B\u0E21\u0E37\u0E48\u0E19","\u0E41\u0E2A\u0E19","\u0E25\u0E49\u0E32\u0E19"];function o(h){let u="";const a=h.length,s=7;if(a>s){const l=a-s+1,d=h.slice(0,l),v=h.slice(l);return o(d)+"\u0E25\u0E49\u0E32\u0E19"+o(v)}else for(let l=0;l<a;l++){const d=h[l];d>0&&(u+=n[d]+r[a-l-1])}return u}function i(h){let u=h;u=u.replace("\u0E2B\u0E19\u0E36\u0E48\u0E07\u0E2A\u0E34\u0E1A","\u0E2A\u0E34\u0E1A"),u=u.replace("\u0E2A\u0E2D\u0E07\u0E2A\u0E34\u0E1A","\u0E22\u0E35\u0E48\u0E2A\u0E34\u0E1A");const a=5;return u.length>a&&u.length-u.lastIndexOf("\u0E2B\u0E19\u0E36\u0E48\u0E07")===a&&(u=u.substr(0,u.length-a)+"\u0E40\u0E2D\u0E47\u0E14"),u}function c(h,u){let a="";return h===""&&u===""?a=t:h!==""&&u===""?a=h+"\u0E1A\u0E32\u0E17\u0E16\u0E49\u0E27\u0E19":h===""&&u!==""?a=u+"\u0E2A\u0E15\u0E32\u0E07\u0E04\u0E4C":a=h+"\u0E1A\u0E32\u0E17"+u+"\u0E2A\u0E15\u0E32\u0E07\u0E04\u0E4C",a}function f(h){let u=t;if(isNaN(h)||h>=Number.MAX_SAFE_INTEGER)return u;const a=Math.floor(h).toString(),s=Math.round(h%1*100).toString(),l=Array.from(a).map(Number),d=Array.from(s).map(Number);let v=o(l),p=o(d);return v=i(v),p=i(p),u=c(v,p),u}e.exports!=null&&(e.exports=f)})(Wu);const ct=We(),{FormulaHelpers:th,Types:ie,WildCard:$s}=Xe(),oe=th,Wi=Hu,nh=Wu.exports,Vs={latin:{halfRE:/[!-~]/g,fullRE:/[！-～]/g,delta:65248},hangul1:{halfRE:/[ﾡ-ﾾ]/g,fullRE:/[ᆨ-ᇂ]/g,delta:-60921},hangul2:{halfRE:/[ￂ-ￜ]/g,fullRE:/[ᅡ-ᅵ]/g,delta:-61025},kana:{delta:0,half:"\uFF61\uFF62\uFF63\uFF64\uFF65\uFF66\uFF67\uFF68\uFF69\uFF6A\uFF6B\uFF6C\uFF6D\uFF6E\uFF6F\uFF70\uFF71\uFF72\uFF73\uFF74\uFF75\uFF76\uFF77\uFF78\uFF79\uFF7A\uFF7B\uFF7C\uFF7D\uFF7E\uFF7F\uFF80\uFF81\uFF82\uFF83\uFF84\uFF85\uFF86\uFF87\uFF88\uFF89\uFF8A\uFF8B\uFF8C\uFF8D\uFF8E\uFF8F\uFF90\uFF91\uFF92\uFF93\uFF94\uFF95\uFF96\uFF97\uFF98\uFF99\uFF9A\uFF9B\uFF9C\uFF9D\uFF9E\uFF9F",full:"\u3002\u300C\u300D\u3001\u30FB\u30F2\u30A1\u30A3\u30A5\u30A7\u30A9\u30E3\u30E5\u30E7\u30C3\u30FC\u30A2\u30A4\u30A6\u30A8\u30AA\u30AB\u30AD\u30AF\u30B1\u30B3\u30B5\u30B7\u30B9\u30BB\u30BD\u30BF\u30C1\u30C4\u30C6\u30C8\u30CA\u30CB\u30CC\u30CD\u30CE\u30CF\u30D2\u30D5\u30D8\u30DB\u30DE\u30DF\u30E0\u30E1\u30E2\u30E4\u30E6\u30E8\u30E9\u30EA\u30EB\u30EC\u30ED\u30EF\u30F3\u309B\u309C"},extras:{delta:0,half:"\xA2\xA3\xAC\xAF\xA6\xA5\u20A9 |\u2190\u2191\u2192\u2193\u25A0\xB0",full:"\uFFE0\uFFE1\uFFE2\uFFE3\uFFE4\uFFE5\uFFE6\u3000\uFFE8\uFFE9\uFFEA\uFFEB\uFFEC\uFFED\uFFEE"}},rh=e=>t=>e.delta?String.fromCharCode(t.charCodeAt(0)+e.delta):[...e.full][[...e.half].indexOf(t)],oh=e=>t=>e.delta?String.fromCharCode(t.charCodeAt(0)-e.delta):[...e.half][[...e.full].indexOf(t)],zu=(e,t)=>e[t+"RE"]||new RegExp("["+e[t]+"]","g"),qu=Object.keys(Vs).map(e=>Vs[e]),ih=e=>qu.reduce((t,n)=>t.replace(zu(n,"half"),rh(n)),e),ah=e=>qu.reduce((t,n)=>t.replace(zu(n,"full"),oh(n)),e),dn={ASC:e=>(e=oe.accept(e,ie.STRING),ah(e)),BAHTTEXT:e=>{e=oe.accept(e,ie.NUMBER);try{return nh(e)}catch(t){throw Error(`Error in https://github.com/jojoee/bahttext 
${t.toString()}`)}},CHAR:e=>{if(e=oe.accept(e,ie.NUMBER),e>255||e<1)throw ct.VALUE;return String.fromCharCode(e)},CLEAN:e=>(e=oe.accept(e,ie.STRING),e.replace(/[\x00-\x1F]/g,"")),CODE:e=>{if(e=oe.accept(e,ie.STRING),e.length===0)throw ct.VALUE;return e.charCodeAt(0)},CONCAT:(...e)=>{let t="";return oe.flattenParams(e,ie.STRING,!1,n=>{n=oe.accept(n,ie.STRING),t+=n}),t},CONCATENATE:(...e)=>{let t="";if(e.length===0)throw Error("CONCATENATE need at least one argument.");return e.forEach(n=>{n=oe.accept(n,ie.STRING),t+=n}),t},DBCS:e=>(e=oe.accept(e,ie.STRING),ih(e)),DOLLAR:(e,t)=>{e=oe.accept(e,ie.NUMBER),t=oe.accept(t,ie.NUMBER,2);const n=Array(t).fill("0").join("");return Wi.format(`$#,##0.${n}_);($#,##0.${n})`,e).trim()},EXACT:(e,t)=>(e=oe.accept(e,[ie.STRING]),t=oe.accept(t,[ie.STRING]),e===t),FIND:(e,t,n)=>{if(e=oe.accept(e,ie.STRING),t=oe.accept(t,ie.STRING),n=oe.accept(n,ie.NUMBER,1),n<1||n>t.length)throw ct.VALUE;const r=t.indexOf(e,n-1);if(r===-1)throw ct.VALUE;return r+1},FINDB:(...e)=>dn.FIND(...e),FIXED:(e,t,n)=>{e=oe.accept(e,ie.NUMBER),t=oe.accept(t,ie.NUMBER,2),n=oe.accept(n,ie.BOOLEAN,!1);const r=Array(t).fill("0").join(""),o=n?"":"#,";return Wi.format(`${o}##0.${r}_);(${o}##0.${r})`,e).trim()},LEFT:(e,t)=>{if(e=oe.accept(e,ie.STRING),t=oe.accept(t,ie.NUMBER,1),t<0)throw ct.VALUE;return t>e.length?e:e.slice(0,t)},LEFTB:(...e)=>dn.LEFT(...e),LEN:e=>(e=oe.accept(e,ie.STRING),e.length),LENB:(...e)=>dn.LEN(...e),LOWER:e=>(e=oe.accept(e,ie.STRING),e.toLowerCase()),MID:(e,t,n)=>{if(e=oe.accept(e,ie.STRING),t=oe.accept(t,ie.NUMBER),n=oe.accept(n,ie.NUMBER),t>e.length)return"";if(t<1||n<1)throw ct.VALUE;return e.slice(t-1,t+n-1)},MIDB:(...e)=>dn.MID(...e),NUMBERVALUE:(e,t,n)=>{if(e=oe.accept(e,ie.STRING),t=oe.accept(t,ie.STRING,"."),n=oe.accept(n,ie.STRING,","),e.length===0)return 0;if(t.length===0||n.length===0||(t=t[0],n=n[0],t===n||e.indexOf(t)<e.lastIndexOf(n)))throw ct.VALUE;const r=e.replace(n,"").replace(t,".").replace(/[^\-0-9.%()]/g,"").match(/([(-]*)([0-9]*[.]*[0-9]+)([)]?)([%]*)/);if(!r)throw ct.VALUE;const o=r[1].length,i=r[3].length,c=r[4].length;let f=Number(r[2]);if(o>1||o&&!i||!o&&i||isNaN(f))throw ct.VALUE;return f=f/100**c,o?-f:f},PHONETIC:()=>{},PROPER:e=>(e=oe.accept(e,[ie.STRING]),e=e.toLowerCase(),e=e.charAt(0).toUpperCase()+e.slice(1),e.replace(/(?:[^a-zA-Z])([a-zA-Z])/g,t=>t.toUpperCase())),REPLACE:(e,t,n,r)=>{e=oe.accept(e,[ie.STRING]),t=oe.accept(t,[ie.NUMBER]),n=oe.accept(n,[ie.NUMBER]),r=oe.accept(r,[ie.STRING]);let o=e.split("");return o.splice(t-1,n,r),o.join("")},REPLACEB:(...e)=>dn.REPLACE(...e),REPT:(e,t)=>{e=oe.accept(e,ie.STRING),t=oe.accept(t,ie.NUMBER);let n="";for(let r=0;r<t;r++)n+=e;return n},RIGHT:(e,t)=>{if(e=oe.accept(e,ie.STRING),t=oe.accept(t,ie.NUMBER,1),t<0)throw ct.VALUE;const n=e.length;return t>n?e:e.slice(n-t)},RIGHTB:(...e)=>dn.RIGHT(...e),SEARCH:(e,t,n)=>{if(e=oe.accept(e,ie.STRING),t=oe.accept(t,ie.STRING),n=oe.accept(n,ie.NUMBER,1),n<1||n>t.length)throw ct.VALUE;let r=$s.isWildCard(e)?$s.toRegex(e,"i"):e;const o=t.slice(n-1).search(r);if(o===-1)throw ct.VALUE;return o+n},SEARCHB:(...e)=>dn.SEARCH(...e),SUBSTITUTE:(...e)=>{},T:e=>(e=oe.accept(e),typeof e=="string"?e:""),TEXT:(e,t)=>{e=oe.accept(e,ie.NUMBER),t=oe.accept(t,ie.STRING);try{return Wi.format(t,e)}catch(n){throw console.error(n),ct.VALUE}},TEXTJOIN:(...e)=>{},TRIM:e=>(e=oe.accept(e,[ie.STRING]),e.replace(/^\s+|\s+$/g,"")),UNICHAR:e=>{if(e=oe.accept(e,[ie.NUMBER]),e<=0)throw ct.VALUE;return String.fromCharCode(e)},UNICODE:e=>dn.CODE(e)};var Ku=dn;const Dr=We(),{FormulaHelpers:Zo}=Xe(),sh={unaryOp:(e,t,n)=>{let r=1;if(e.forEach(o=>{if(o!=="+")if(o==="-")r=-r;else throw new Error(`Unrecognized prefix: ${o}`)}),t==null&&(t=0),r===1)return t;try{t=Zo.acceptNumber(t,n)}catch(o){if(o instanceof Dr)Array.isArray(t)&&(t=t[0][0]);else throw o}return typeof t=="number"&&isNaN(t)?Dr.VALUE:-t}},ch={percentOp:(e,t,n)=>{try{e=Zo.acceptNumber(e,n)}catch(r){if(r instanceof Dr)return r;throw r}if(t==="%")return e/100;throw new Error(`Unrecognized postfix: ${t}`)}},In={boolean:3,string:2,number:1},uh={compareOp:(e,t,n,r,o)=>{e==null&&(e=0),n==null&&(n=0),r&&(e=e[0][0]),o&&(n=n[0][0]);const i=typeof e,c=typeof n;if(i===c)switch(t){case"=":return e===n;case">":return e>n;case"<":return e<n;case"<>":return e!==n;case"<=":return e<=n;case">=":return e>=n}else switch(t){case"=":return!1;case">":return In[i]>In[c];case"<":return In[i]<In[c];case"<>":return!0;case"<=":return In[i]<=In[c];case">=":return In[i]>=In[c]}throw Error("Infix.compareOp: Should not reach here.")},concatOp:(e,t,n,r,o)=>{e==null&&(e=""),n==null&&(n=""),r&&(e=e[0][0]),o&&(n=n[0][0]);const i=typeof e,c=typeof n;return i==="boolean"&&(e=e?"TRUE":"FALSE"),c==="boolean"&&(n=n?"TRUE":"FALSE"),""+e+n},mathOp:(e,t,n,r,o)=>{e==null&&(e=0),n==null&&(n=0);try{e=Zo.acceptNumber(e,r),n=Zo.acceptNumber(n,o)}catch(i){if(i instanceof Dr)return i;throw i}switch(t){case"+":return e+n;case"-":return e-n;case"*":return e*n;case"/":return n===0?Dr.DIV0:e/n;case"^":return e**n}throw Error("Infix.mathOp: Should not reach here.")}};var Za={Prefix:sh,Postfix:ch,Infix:uh,Operators:{compareOp:["<",">","=","<>","<=",">="],concatOp:["&"],mathOp:["+","-","*","/","^"]}};const me=We(),{FormulaHelpers:lh,Types:q,Factorials:Yu,Criteria:fh}=Xe(),{Infix:dh}=Za,G=lh,zi=[],qi=[];function Fo(e){return e<=100?Yu[e]:zi[e]>0?zi[e]:zi[e]=Fo(e-1)*e}function Xu(e){return e===1||e===0?1:e===2?2:qi[e]>0?qi[e]:qi[e]=Xu(e-2)*e}const mt={ABS:e=>(e=G.accept(e,q.NUMBER),Math.abs(e)),AGGREGATE:(e,t,n,...r)=>{},ARABIC:e=>{if(e=G.accept(e,q.STRING).toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))throw new me("#VALUE!","Invalid roman numeral in ARABIC evaluation.");let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(n){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[n]}),t},BASE:(e,t,n)=>{if(e=G.accept(e,q.NUMBER),e<0||e>=2**53||(t=G.accept(t,q.NUMBER),t<2||t>36)||(n=G.accept(n,q.NUMBER,0),n<0))throw me.NUM;const r=e.toString(t).toUpperCase();return new Array(Math.max(n+1-r.length,0)).join("0")+r},CEILING:(e,t)=>{if(e=G.accept(e,q.NUMBER),t=G.accept(t,q.NUMBER),t===0)return 0;if(e/t%1===0)return e;const n=Math.abs(t),r=Math.floor(Math.abs(e)/n);return e<0?t<0?-n*(r+1):-n*r:(r+1)*n},"CEILING.MATH":(e,t,n)=>{if(e=G.accept(e,q.NUMBER),t=G.accept(t,q.NUMBER,e>0?1:-1),n=G.accept(n,q.NUMBER,0),e>=0)return mt.CEILING(e,t);const r=n?t:0;return mt.CEILING(e,t)-r},"CEILING.PRECISE":(e,t)=>(e=G.accept(e,q.NUMBER),t=G.accept(t,q.NUMBER,1),mt.CEILING(e,Math.abs(t))),COMBIN:(e,t)=>{if(e=G.accept(e,q.NUMBER),t=G.accept(t,q.NUMBER),e<0||t<0||e<t)throw me.NUM;const n=mt.FACT(e),r=mt.FACT(t);return n/r/mt.FACT(e-t)},COMBINA:(e,t)=>{if(e=G.accept(e,q.NUMBER),t=G.accept(t,q.NUMBER),(e===0||e===1)&&t===0)return 1;if(e<0||t<0)throw me.NUM;return mt.COMBIN(e+t-1,e-1)},DECIMAL:(e,t)=>{if(e=G.accept(e,q.STRING),t=G.accept(t,q.NUMBER),t=Math.trunc(t),t<2||t>36)throw me.NUM;const n=parseInt(e,t);if(isNaN(n))throw me.NUM;return n},DEGREES:e=>(e=G.accept(e,q.NUMBER),e*(180/Math.PI)),EVEN:e=>mt.CEILING(e,-2),EXP:e=>(e=G.accept(e,q.NUMBER),Math.exp(e)),FACT:e=>{if(e=G.accept(e,q.NUMBER),e=Math.trunc(e),e>170||e<0)throw me.NUM;return e<=100?Yu[e]:Fo(e)},FACTDOUBLE:e=>{if(e=G.accept(e,q.NUMBER),e=Math.trunc(e),e<-1)throw me.NUM;return e===-1?1:Xu(e)},FLOOR:(e,t)=>{if(e=G.accept(e,q.NUMBER),t=G.accept(t,q.NUMBER),t===0)return 0;if(e>0&&t<0)throw me.NUM;if(e/t%1===0)return e;const n=Math.abs(t),r=Math.floor(Math.abs(e)/n);return e<0?t<0?-n*r:-n*(r+1):r*n},"FLOOR.MATH":(e,t,n)=>(e=G.accept(e,q.NUMBER),t=G.accept(t,q.NUMBER,e>0?1:-1),n=G.accept(n,q.NUMBER,0),n===0||e>=0?mt.FLOOR(e,Math.abs(t)):mt.FLOOR(e,t)+t),"FLOOR.PRECISE":(e,t)=>(e=G.accept(e,q.NUMBER),t=G.accept(t,q.NUMBER,1),mt.FLOOR(e,Math.abs(t))),GCD:(...e)=>{const t=[];G.flattenParams(e,null,!1,c=>{if(c=typeof c=="boolean"?NaN:Number(c),isNaN(c))throw me.VALUE;if(c<0||c>9007199254740990)throw me.NUM;t.push(Math.trunc(c))},0);let n,r,o=e.length,i=Math.abs(t[0]);for(n=1;n<o;n++){for(r=Math.abs(t[n]);i&&r;)i>r?i%=r:r%=i;i+=r}return i},INT:e=>(e=G.accept(e,q.NUMBER),Math.floor(e)),"ISO.CEILING":(...e)=>mt["CEILING.PRECISE"](...e),LCM:(...e)=>{const t=[];G.flattenParams(e,null,!1,o=>{if(o=typeof o=="boolean"?NaN:Number(o),isNaN(o))throw me.VALUE;if(o<0||o>9007199254740990)throw me.NUM;t.push(Math.trunc(o))},1);let n=t.length,r=Math.abs(t[0]);for(let o=1;o<n;o++){let i=Math.abs(t[o]),c=r;for(;r&&i;)r>i?r%=i:i%=r;r=Math.abs(c*t[o])/(r+i)}return r},LN:e=>(e=G.accept(e,q.NUMBER),Math.log(e)),LOG:(e,t)=>(e=G.accept(e,q.NUMBER),t=G.accept(t,q.NUMBER,10),Math.log(e)/Math.log(t)),LOG10:e=>(e=G.accept(e,q.NUMBER),Math.log10(e)),MDETERM:e=>{if(e=G.accept(e,q.ARRAY,void 0,!1,!0),e[0].length!==e.length)throw me.VALUE;const t=e.length,n=e[0].length;let r=0,o,i;if(t===1)return e[0][0];if(t===2)return e[0][0]*e[1][1]-e[0][1]*e[1][0];for(let c=0;c<n;c++){o=e[0][c],i=e[0][c];for(let f=1;f<t;f++)i*=e[f][((c+f)%n+n)%n],o*=e[f][((c-f)%n+n)%n];r+=i-o}return r},MINVERSE:e=>{},MMULT:(e,t)=>{e=G.accept(e,q.ARRAY,void 0,!1,!0),t=G.accept(t,q.ARRAY,void 0,!1,!0);const n=e.length,r=e[0].length,o=t.length,i=t[0].length,c=new Array(n);if(r!==o)throw me.VALUE;for(let f=0;f<n;f++){c[f]=new Array(i);for(let h=0;h<i;h++){c[f][h]=0;for(let u=0;u<r;u++){const a=e[f][u],s=t[u][h];if(typeof a!="number"||typeof s!="number")throw me.VALUE;c[f][h]+=e[f][u]*t[u][h]}}}return c},MOD:(e,t)=>{if(e=G.accept(e,q.NUMBER),t=G.accept(t,q.NUMBER),t===0)throw me.DIV0;return e-t*mt.INT(e/t)},MROUND:(e,t)=>{if(e=G.accept(e,q.NUMBER),t=G.accept(t,q.NUMBER),t===0)return 0;if(e>0&&t<0||e<0&&t>0)throw me.NUM;return e/t%1===0?e:Math.round(e/t)*t},MULTINOMIAL:(...e)=>{let t=0,n=1;return G.flattenParams(e,q.NUMBER,!1,r=>{if(r<0)throw me.NUM;t+=r,n*=Fo(r)}),Fo(t)/n},MUNIT:e=>{e=G.accept(e,q.NUMBER);const t=[];for(let n=0;n<e;n++){const r=[];for(let o=0;o<e;o++)n===o?r.push(1):r.push(0);t.push(r)}return t},ODD:e=>{if(e=G.accept(e,q.NUMBER),e===0)return 1;let t=Math.ceil(Math.abs(e));return t=t&1?t:t+1,e>0?t:-t},PI:()=>Math.PI,POWER:(e,t)=>(e=G.accept(e,q.NUMBER),t=G.accept(t,q.NUMBER),e**t),PRODUCT:(...e)=>{let t=1;return G.flattenParams(e,null,!0,(n,r)=>{const o=Number(n);r.isLiteral&&!isNaN(o)?t*=o:typeof n=="number"&&(t*=n)},1),t},QUOTIENT:(e,t)=>(e=G.accept(e,q.NUMBER),t=G.accept(t,q.NUMBER),Math.trunc(e/t)),RADIANS:e=>(e=G.accept(e,q.NUMBER),e/180*Math.PI),RAND:()=>Math.random(),RANDBETWEEN:(e,t)=>(e=G.accept(e,q.NUMBER),t=G.accept(t,q.NUMBER),Math.floor(Math.random()*(t-e+1)+e)),ROMAN:(e,t)=>{if(e=G.accept(e,q.NUMBER),t=G.accept(t,q.NUMBER,0),t!==0)throw Error("ROMAN: only allows form=0 (classic form).");const n=String(e).split(""),r=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let o="",i=3;for(;i--;)o=(r[+n.pop()+i*10]||"")+o;return new Array(+n.join("")+1).join("M")+o},ROUND:(e,t)=>{e=G.accept(e,q.NUMBER),t=G.accept(t,q.NUMBER);const n=Math.pow(10,Math.abs(t)),r=e>0?1:-1;return t>0?r*Math.round(Math.abs(e)*n)/n:t===0?r*Math.round(Math.abs(e)):r*Math.round(Math.abs(e)/n)*n},ROUNDDOWN:(e,t)=>{e=G.accept(e,q.NUMBER),t=G.accept(t,q.NUMBER);const n=Math.pow(10,Math.abs(t)),r=e>0?1:-1;if(t>0){const o=1/n*.5;return r*Math.round((Math.abs(e)-o)*n)/n}else{if(t===0)return r*Math.round(Math.abs(e)-.5);{const o=n*.5;return r*Math.round((Math.abs(e)-o)/n)*n}}},ROUNDUP:(e,t)=>{e=G.accept(e,q.NUMBER),t=G.accept(t,q.NUMBER);const n=Math.pow(10,Math.abs(t)),r=e>0?1:-1;if(t>0){const o=1/n*.5;return r*Math.round((Math.abs(e)+o)*n)/n}else{if(t===0)return r*Math.round(Math.abs(e)+.5);{const o=n*.5;return r*Math.round((Math.abs(e)+o)/n)*n}}},SERIESSUM:(e,t,n,r)=>{e=G.accept(e,q.NUMBER),t=G.accept(t,q.NUMBER),n=G.accept(n,q.NUMBER);let o=0,i;return G.flattenParams([r],q.NUMBER,!1,c=>{if(typeof c!="number")throw me.VALUE;o===0?i=c*Math.pow(e,t):i+=c*Math.pow(e,t+o*n),o++}),i},SIGN:e=>(e=G.accept(e,q.NUMBER),e>0?1:e===0?0:-1),SQRT:e=>{if(e=G.accept(e,q.NUMBER),e<0)throw me.NUM;return Math.sqrt(e)},SQRTPI:e=>{if(e=G.accept(e,q.NUMBER),e<0)throw me.NUM;return Math.sqrt(e*Math.PI)},SUBTOTAL:()=>{},SUM:(...e)=>{let t=0;return G.flattenParams(e,q.NUMBER,!0,(n,r)=>{(r.isLiteral||typeof n=="number")&&(t+=n)}),t},SUMIF:(e,t,n,r)=>{const o=G.retrieveRanges(e,t,r);t=o[0],r=o[1],n=G.retrieveArg(e,n);const i=n.isArray;n=fh.parse(G.accept(n));let c=0;return t.forEach((f,h)=>{f.forEach((u,a)=>{const s=r[h][a];typeof s=="number"&&(n.op==="wc"?n.match===n.value.test(u)&&(c+=s):dh.compareOp(u,n.op,n.value,Array.isArray(u),i)&&(c+=s))})}),c},SUMIFS:()=>{},SUMPRODUCT:(e,...t)=>{e=G.accept(e,q.ARRAY,void 0,!1,!0),t.forEach(r=>{if(r=G.accept(r,q.ARRAY,void 0,!1,!0),e[0].length!==r[0].length||e.length!==r.length)throw me.VALUE;for(let o=0;o<e.length;o++)for(let i=0;i<e[0].length;i++)typeof e[o][i]!="number"&&(e[o][i]=0),typeof r[o][i]!="number"&&(r[o][i]=0),e[o][i]*=r[o][i]});let n=0;return e.forEach(r=>{r.forEach(o=>{n+=o})}),n},SUMSQ:(...e)=>{let t=0;return G.flattenParams(e,q.NUMBER,!0,(n,r)=>{(r.isLiteral||typeof n=="number")&&(t+=n**2)}),t},SUMX2MY2:(e,t)=>{const n=[],r=[];let o=0;if(G.flattenParams([e],null,!1,(i,c)=>{n.push(i)}),G.flattenParams([t],null,!1,(i,c)=>{r.push(i)}),n.length!==r.length)throw me.NA;for(let i=0;i<n.length;i++)typeof n[i]=="number"&&typeof r[i]=="number"&&(o+=n[i]**2-r[i]**2);return o},SUMX2PY2:(e,t)=>{const n=[],r=[];let o=0;if(G.flattenParams([e],null,!1,(i,c)=>{n.push(i)}),G.flattenParams([t],null,!1,(i,c)=>{r.push(i)}),n.length!==r.length)throw me.NA;for(let i=0;i<n.length;i++)typeof n[i]=="number"&&typeof r[i]=="number"&&(o+=n[i]**2+r[i]**2);return o},SUMXMY2:(e,t)=>{const n=[],r=[];let o=0;if(G.flattenParams([e],null,!1,(i,c)=>{n.push(i)}),G.flattenParams([t],null,!1,(i,c)=>{r.push(i)}),n.length!==r.length)throw me.NA;for(let i=0;i<n.length;i++)typeof n[i]=="number"&&typeof r[i]=="number"&&(o+=(n[i]-r[i])**2);return o},TRUNC:e=>(e=G.accept(e,q.NUMBER),Math.trunc(e))};var Qu=mt;const ut=We(),{FormulaHelpers:hh,Types:be}=Xe(),Le=hh,ur=2**27-1,ph={ACOS:e=>{if(e=Le.accept(e,be.NUMBER),e>1||e<-1)throw ut.NUM;return Math.acos(e)},ACOSH:e=>{if(e=Le.accept(e,be.NUMBER),e<1)throw ut.NUM;return Math.acosh(e)},ACOT:e=>(e=Le.accept(e,be.NUMBER),Math.PI/2-Math.atan(e)),ACOTH:e=>{if(e=Le.accept(e,be.NUMBER),Math.abs(e)<=1)throw ut.NUM;return Math.atanh(1/e)},ASIN:e=>{if(e=Le.accept(e,be.NUMBER),e>1||e<-1)throw ut.NUM;return Math.asin(e)},ASINH:e=>(e=Le.accept(e,be.NUMBER),Math.asinh(e)),ATAN:e=>(e=Le.accept(e,be.NUMBER),Math.atan(e)),ATAN2:(e,t)=>{if(e=Le.accept(e,be.NUMBER),t=Le.accept(t,be.NUMBER),t===0&&e===0)throw ut.DIV0;return Math.atan2(t,e)},ATANH:e=>{if(e=Le.accept(e,be.NUMBER),Math.abs(e)>1)throw ut.NUM;return Math.atanh(e)},COS:e=>{if(e=Le.accept(e,be.NUMBER),Math.abs(e)>ur)throw ut.NUM;return Math.cos(e)},COSH:e=>(e=Le.accept(e,be.NUMBER),Math.cosh(e)),COT:e=>{if(e=Le.accept(e,be.NUMBER),Math.abs(e)>ur)throw ut.NUM;if(e===0)throw ut.DIV0;return 1/Math.tan(e)},COTH:e=>{if(e=Le.accept(e,be.NUMBER),e===0)throw ut.DIV0;return 1/Math.tanh(e)},CSC:e=>{if(e=Le.accept(e,be.NUMBER),Math.abs(e)>ur)throw ut.NUM;return 1/Math.sin(e)},CSCH:e=>{if(e=Le.accept(e,be.NUMBER),e===0)throw ut.DIV0;return 1/Math.sinh(e)},SEC:e=>{if(e=Le.accept(e,be.NUMBER),Math.abs(e)>ur)throw ut.NUM;return 1/Math.cos(e)},SECH:e=>(e=Le.accept(e,be.NUMBER),1/Math.cosh(e)),SIN:e=>{if(e=Le.accept(e,be.NUMBER),Math.abs(e)>ur)throw ut.NUM;return Math.sin(e)},SINH:e=>(e=Le.accept(e,be.NUMBER),Math.sinh(e)),TAN:e=>{if(e=Le.accept(e,be.NUMBER),Math.abs(e)>ur)throw ut.NUM;return Math.tan(e)},TANH:e=>(e=Le.accept(e,be.NUMBER),Math.tanh(e))};var vh=ph;const _n=We(),{FormulaHelpers:mh,Types:Ki}=Xe(),Vt=mh;function Yi(e){let t=0,n=0;return Vt.flattenParams(e,null,!0,r=>{const o=typeof r;o==="string"?r==="TRUE"?r=!0:r==="FALSE"&&(r=!1):o==="number"&&(r=Boolean(r)),typeof r=="boolean"&&(r===!0?t++:n++)}),[t,n]}const gh={AND:(...e)=>{const[t,n]=Yi(e);return t===0&&n===0?_n.VALUE:t>0&&n===0},FALSE:()=>!1,IF:(e,t,n,r)=>(t=Vt.accept(t,Ki.BOOLEAN),n=Vt.accept(n),r=Vt.accept(r,null,!1),t?n:r),IFERROR:(e,t)=>e.value instanceof _n?Vt.accept(t):Vt.accept(e),IFNA:function(e,t){if(arguments.length>2)throw _n.TOO_MANY_ARGS("IFNA");return _n.NA.equals(e.value)?Vt.accept(t):Vt.accept(e)},IFS:(...e)=>{if(e.length%2!==0)return new _n("#N/A","IFS expects all arguments after position 0 to be in pairs.");for(let t=0;t<e.length/2;t++){const n=Vt.accept(e[t*2],Ki.BOOLEAN),r=Vt.accept(e[t*2+1]);if(n)return r}return _n.NA},NOT:e=>(e=Vt.accept(e,Ki.BOOLEAN),!e),OR:(...e)=>{const[t,n]=Yi(e);return t===0&&n===0?_n.VALUE:t>0},SWITCH:(...e)=>{},TRUE:()=>!0,XOR:(...e)=>{const[t,n]=Yi(e);return t===0&&n===0?_n.VALUE:t%2===1}};var Eh=gh,Zu={};(function(e){(function(t){t(typeof DO_NOT_EXPORT_BESSEL>"u"?e:{})})(function(t){t.version="1.0.2";var n=Math;function r(a,s){for(var l=0,d=0;l<a.length;++l)d=s*d+a[l];return d}function o(a,s,l,d,v){if(s===0)return l;if(s===1)return d;for(var p=2/a,m=d,g=1;g<s;++g)m=d*g*p+v*l,l=d,d=m;return m}function i(a,s,l,d,v){return function(m,g){if(d){if(m===0)return d==1?-1/0:1/0;if(m<0)return NaN}if(g===0)return a(m);if(g===1)return s(m);if(g<0)return NaN;g|=0;var E=a(m),y=s(m);return o(m,g,E,y,v)}}var c=function(){var a=.636619772,s=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),l=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),d=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),v=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function p(T){var R=0,A=0,C=0,x=T*T;if(T<8)A=r(s,x),C=r(l,x),R=A/C;else{var O=T-.785398164;x=64/x,A=r(d,x),C=r(v,x),R=n.sqrt(a/T)*(n.cos(O)*A-n.sin(O)*C*8/T)}return R}var m=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),g=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),E=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),y=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function w(T){var R=0,A=0,C=0,x=T*T,O=n.abs(T)-2.356194491;return Math.abs(T)<8?(A=T*r(m,x),C=r(g,x),R=A/C):(x=64/x,A=r(E,x),C=r(y,x),R=n.sqrt(a/n.abs(T))*(n.cos(O)*A-n.sin(O)*C*8/n.abs(T)),T<0&&(R=-R)),R}return function T(R,A){if(A=Math.round(A),!isFinite(R))return isNaN(R)?R:0;if(A<0)return(A%2?-1:1)*T(R,-A);if(R<0)return(A%2?-1:1)*T(-R,A);if(A===0)return p(R);if(A===1)return w(R);if(R===0)return 0;var C=0;if(R>A)C=o(R,A,p(R),w(R),-1);else{for(var x=2*n.floor((A+n.floor(n.sqrt(40*A)))/2),O=!1,I=0,P=0,B=1,S=0,b=2/R,_=x;_>0;_--)S=_*b*B-I,I=B,B=S,n.abs(B)>1e10&&(B*=1e-10,I*=1e-10,C*=1e-10,P*=1e-10),O&&(P+=B),O=!O,_==A&&(C=I);P=2*P-B,C/=P}return C}}(),f=function(){var a=.636619772,s=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),l=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),d=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),v=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function p(T){var R=0,A=0,C=0,x=T*T,O=T-.785398164;return T<8?(A=r(s,x),C=r(l,x),R=A/C+a*c(T,0)*n.log(T)):(x=64/x,A=r(d,x),C=r(v,x),R=n.sqrt(a/T)*(n.sin(O)*A+n.cos(O)*C*8/T)),R}var m=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),g=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),E=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),y=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function w(T){var R=0,A=0,C=0,x=T*T,O=T-2.356194491;return T<8?(A=T*r(m,x),C=r(g,x),R=A/C+a*(c(T,1)*n.log(T)-1/T)):(x=64/x,A=r(E,x),C=r(y,x),R=n.sqrt(a/T)*(n.sin(O)*A+n.cos(O)*C*8/T)),R}return i(p,w,"BESSELY",1,-1)}(),h=function(){var a=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),s=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function l(m){return m<=3.75?r(a,m*m/(3.75*3.75)):n.exp(n.abs(m))/n.sqrt(n.abs(m))*r(s,3.75/n.abs(m))}var d=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),v=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function p(m){return m<3.75?m*r(d,m*m/(3.75*3.75)):(m<0?-1:1)*n.exp(n.abs(m))/n.sqrt(n.abs(m))*r(v,3.75/n.abs(m))}return function m(g,E){if(E=Math.round(E),E===0)return l(g);if(E===1)return p(g);if(E<0)return NaN;if(n.abs(g)===0)return 0;if(g==1/0)return 1/0;var y=0,w,T=2/n.abs(g),R=0,A=1,C=0,x=2*n.round((E+n.round(n.sqrt(40*E)))/2);for(w=x;w>0;w--)C=w*T*A+R,R=A,A=C,n.abs(A)>1e10&&(A*=1e-10,R*=1e-10,y*=1e-10),w==E&&(y=R);return y*=m(g,0)/A,g<0&&E%2?-y:y}}(),u=function(){var a=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),s=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function l(m){return m<=2?-n.log(m/2)*h(m,0)+r(a,m*m/4):n.exp(-m)/n.sqrt(m)*r(s,2/m)}var d=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),v=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function p(m){return m<=2?n.log(m/2)*h(m,1)+1/m*r(d,m*m/4):n.exp(-m)/n.sqrt(m)*r(v,2/m)}return i(l,p,"BESSELK",2,1)}();t.besselj=c,t.bessely=f,t.besseli=h,t.besselk=u})})(Zu);var Ja={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(Mu,function(){var n=function(r,o){var i=Array.prototype.concat,c=Array.prototype.slice,f=Object.prototype.toString;function h(E,y){var w=E>y?E:y;return r.pow(10,17-~~(r.log(w>0?w:-w)*r.LOG10E))}var u=Array.isArray||function(y){return f.call(y)==="[object Array]"};function a(E){return f.call(E)==="[object Function]"}function s(E){return typeof E=="number"?E-E===0:!1}function l(E){return i.apply([],E)}function d(){return new d._init(arguments)}d.fn=d.prototype,d._init=function(y){if(u(y[0]))if(u(y[0][0])){a(y[1])&&(y[0]=d.map(y[0],y[1]));for(var w=0;w<y[0].length;w++)this[w]=y[0][w];this.length=y[0].length}else this[0]=a(y[1])?d.map(y[0],y[1]):y[0],this.length=1;else if(s(y[0]))this[0]=d.seq.apply(null,y),this.length=1;else{if(y[0]instanceof d)return d(y[0].toArray());this[0]=[],this.length=1}return this},d._init.prototype=d.prototype,d._init.constructor=d,d.utils={calcRdx:h,isArray:u,isFunction:a,isNumber:s,toVector:l},d._random_fn=r.random,d.setRandom=function(y){if(typeof y!="function")throw new TypeError("fn is not a function");d._random_fn=y},d.extend=function(y){var w,T;if(arguments.length===1){for(T in y)d[T]=y[T];return this}for(w=1;w<arguments.length;w++)for(T in arguments[w])y[T]=arguments[w][T];return y},d.rows=function(y){return y.length||1},d.cols=function(y){return y[0].length||1},d.dimensions=function(y){return{rows:d.rows(y),cols:d.cols(y)}},d.row=function(y,w){return u(w)?w.map(function(T){return d.row(y,T)}):y[w]},d.rowa=function(y,w){return d.row(y,w)},d.col=function(y,w){if(u(w)){var T=d.arange(y.length).map(function(){return new Array(w.length)});return w.forEach(function(C,x){d.arange(y.length).forEach(function(O){T[O][x]=y[O][C]})}),T}for(var R=new Array(y.length),A=0;A<y.length;A++)R[A]=[y[A][w]];return R},d.cola=function(y,w){return d.col(y,w).map(function(T){return T[0]})},d.diag=function(y){for(var w=d.rows(y),T=new Array(w),R=0;R<w;R++)T[R]=[y[R][R]];return T},d.antidiag=function(y){for(var w=d.rows(y)-1,T=new Array(w),R=0;w>=0;w--,R++)T[R]=[y[R][w]];return T},d.transpose=function(y){var w=[],T,R,A,C,x;for(u(y[0])||(y=[y]),R=y.length,A=y[0].length,x=0;x<A;x++){for(T=new Array(R),C=0;C<R;C++)T[C]=y[C][x];w.push(T)}return w.length===1?w[0]:w},d.map=function(y,w,T){var R,A,C,x,O;for(u(y[0])||(y=[y]),A=y.length,C=y[0].length,x=T?y:new Array(A),R=0;R<A;R++)for(x[R]||(x[R]=new Array(C)),O=0;O<C;O++)x[R][O]=w(y[R][O],R,O);return x.length===1?x[0]:x},d.cumreduce=function(y,w,T){var R,A,C,x,O;for(u(y[0])||(y=[y]),A=y.length,C=y[0].length,x=T?y:new Array(A),R=0;R<A;R++)for(x[R]||(x[R]=new Array(C)),C>0&&(x[R][0]=y[R][0]),O=1;O<C;O++)x[R][O]=w(x[R][O-1],y[R][O]);return x.length===1?x[0]:x},d.alter=function(y,w){return d.map(y,w,!0)},d.create=function(y,w,T){var R=new Array(y),A,C;for(a(w)&&(T=w,w=y),A=0;A<y;A++)for(R[A]=new Array(w),C=0;C<w;C++)R[A][C]=T(A,C);return R};function v(){return 0}d.zeros=function(y,w){return s(w)||(w=y),d.create(y,w,v)};function p(){return 1}d.ones=function(y,w){return s(w)||(w=y),d.create(y,w,p)},d.rand=function(y,w){return s(w)||(w=y),d.create(y,w,d._random_fn)};function m(E,y){return E===y?1:0}d.identity=function(y,w){return s(w)||(w=y),d.create(y,w,m)},d.symmetric=function(y){var w=y.length,T,R;if(y.length!==y[0].length)return!1;for(T=0;T<w;T++)for(R=0;R<w;R++)if(y[R][T]!==y[T][R])return!1;return!0},d.clear=function(y){return d.alter(y,v)},d.seq=function(y,w,T,R){a(R)||(R=!1);var A=[],C=h(y,w),x=(w*C-y*C)/((T-1)*C),O=y,I;for(I=0;O<=w&&I<T;I++,O=(y*C+x*C*I)/C)A.push(R?R(O,I):O);return A},d.arange=function(y,w,T){var R=[],A;if(T=T||1,w===o&&(w=y,y=0),y===w||T===0)return[];if(y<w&&T<0)return[];if(y>w&&T>0)return[];if(T>0)for(A=y;A<w;A+=T)R.push(A);else for(A=y;A>w;A+=T)R.push(A);return R},d.slice=function(){function E(w,T,R,A){var C,x=[],O=w.length;if(T===o&&R===o&&A===o)return d.copy(w);if(T=T||0,R=R||w.length,T=T>=0?T:O+T,R=R>=0?R:O+R,A=A||1,T===R||A===0)return[];if(T<R&&A<0)return[];if(T>R&&A>0)return[];if(A>0)for(C=T;C<R;C+=A)x.push(w[C]);else for(C=T;C>R;C+=A)x.push(w[C]);return x}function y(w,T){var R,A;if(T=T||{},s(T.row)){if(s(T.col))return w[T.row][T.col];var C=d.rowa(w,T.row);return R=T.col||{},E(C,R.start,R.end,R.step)}if(s(T.col)){var x=d.cola(w,T.col);return A=T.row||{},E(x,A.start,A.end,A.step)}A=T.row||{},R=T.col||{};var O=E(w,A.start,A.end,A.step);return O.map(function(I){return E(I,R.start,R.end,R.step)})}return y}(),d.sliceAssign=function(y,w,T){var R,A;if(s(w.row)){if(s(w.col))return y[w.row][w.col]=T;w.col=w.col||{},w.col.start=w.col.start||0,w.col.end=w.col.end||y[0].length,w.col.step=w.col.step||1,R=d.arange(w.col.start,r.min(y.length,w.col.end),w.col.step);var C=w.row;return R.forEach(function(O,I){y[C][O]=T[I]}),y}if(s(w.col)){w.row=w.row||{},w.row.start=w.row.start||0,w.row.end=w.row.end||y.length,w.row.step=w.row.step||1,A=d.arange(w.row.start,r.min(y[0].length,w.row.end),w.row.step);var x=w.col;return A.forEach(function(O,I){y[O][x]=T[I]}),y}return T[0].length===o&&(T=[T]),w.row.start=w.row.start||0,w.row.end=w.row.end||y.length,w.row.step=w.row.step||1,w.col.start=w.col.start||0,w.col.end=w.col.end||y[0].length,w.col.step=w.col.step||1,A=d.arange(w.row.start,r.min(y.length,w.row.end),w.row.step),R=d.arange(w.col.start,r.min(y[0].length,w.col.end),w.col.step),A.forEach(function(O,I){R.forEach(function(P,B){y[O][P]=T[I][B]})}),y},d.diagonal=function(y){var w=d.zeros(y.length,y.length);return y.forEach(function(T,R){w[R][R]=T}),w},d.copy=function(y){return y.map(function(w){return s(w)?w:w.map(function(T){return T})})};var g=d.prototype;return g.length=0,g.push=Array.prototype.push,g.sort=Array.prototype.sort,g.splice=Array.prototype.splice,g.slice=Array.prototype.slice,g.toArray=function(){return this.length>1?c.call(this):c.call(this)[0]},g.map=function(y,w){return d(d.map(this,y,w))},g.cumreduce=function(y,w){return d(d.cumreduce(this,y,w))},g.alter=function(y){return d.alter(this,y),this},function(E){for(var y=0;y<E.length;y++)(function(w){g[w]=function(T){var R=this,A;return T?(setTimeout(function(){T.call(R,g[w].call(R))}),this):(A=d[w](this),u(A)?d(A):A)}})(E[y])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(E){for(var y=0;y<E.length;y++)(function(w){g[w]=function(T,R){var A=this;return R?(setTimeout(function(){R.call(A,g[w].call(A,T))}),this):d(d[w](this,T))}})(E[y])}("row col".split(" ")),function(E){for(var y=0;y<E.length;y++)(function(w){g[w]=function(){return d(d[w].apply(null,arguments))}})(E[y])}("create zeros ones rand identity".split(" ")),d}(Math);return function(r,o){var i=r.utils.isFunction;function c(u,a){return u-a}function f(u,a,s){return o.max(a,o.min(u,s))}r.sum=function(a){for(var s=0,l=a.length;--l>=0;)s+=a[l];return s},r.sumsqrd=function(a){for(var s=0,l=a.length;--l>=0;)s+=a[l]*a[l];return s},r.sumsqerr=function(a){for(var s=r.mean(a),l=0,d=a.length,v;--d>=0;)v=a[d]-s,l+=v*v;return l},r.sumrow=function(a){for(var s=0,l=a.length;--l>=0;)s+=a[l];return s},r.product=function(a){for(var s=1,l=a.length;--l>=0;)s*=a[l];return s},r.min=function(a){for(var s=a[0],l=0;++l<a.length;)a[l]<s&&(s=a[l]);return s},r.max=function(a){for(var s=a[0],l=0;++l<a.length;)a[l]>s&&(s=a[l]);return s},r.unique=function(a){for(var s={},l=[],d=0;d<a.length;d++)s[a[d]]||(s[a[d]]=!0,l.push(a[d]));return l},r.mean=function(a){return r.sum(a)/a.length},r.meansqerr=function(a){return r.sumsqerr(a)/a.length},r.geomean=function(a){var s=a.map(o.log),l=r.mean(s);return o.exp(l)},r.median=function(a){var s=a.length,l=a.slice().sort(c);return s&1?l[s/2|0]:(l[s/2-1]+l[s/2])/2},r.cumsum=function(a){return r.cumreduce(a,function(s,l){return s+l})},r.cumprod=function(a){return r.cumreduce(a,function(s,l){return s*l})},r.diff=function(a){var s=[],l=a.length,d;for(d=1;d<l;d++)s.push(a[d]-a[d-1]);return s},r.rank=function(u){var a,s=[],l={};for(a=0;a<u.length;a++){var d=u[a];l[d]?l[d]++:(l[d]=1,s.push(d))}var v=s.sort(c),p={},m=1;for(a=0;a<v.length;a++){var d=v[a],g=l[d],E=m,y=m+g-1,w=(E+y)/2;p[d]=w,m+=g}return u.map(function(T){return p[T]})},r.mode=function(a){var s=a.length,l=a.slice().sort(c),d=1,v=0,p=0,m=[],g;for(g=0;g<s;g++)l[g]===l[g+1]?d++:(d>v?(m=[l[g]],v=d,p=0):d===v&&(m.push(l[g]),p++),d=1);return p===0?m[0]:m},r.range=function(a){return r.max(a)-r.min(a)},r.variance=function(a,s){return r.sumsqerr(a)/(a.length-(s?1:0))},r.pooledvariance=function(a){var s=a.reduce(function(d,v){return d+r.sumsqerr(v)},0),l=a.reduce(function(d,v){return d+v.length},0);return s/(l-a.length)},r.deviation=function(u){for(var a=r.mean(u),s=u.length,l=new Array(s),d=0;d<s;d++)l[d]=u[d]-a;return l},r.stdev=function(a,s){return o.sqrt(r.variance(a,s))},r.pooledstdev=function(a){return o.sqrt(r.pooledvariance(a))},r.meandev=function(a){for(var s=r.mean(a),l=[],d=a.length-1;d>=0;d--)l.push(o.abs(a[d]-s));return r.mean(l)},r.meddev=function(a){for(var s=r.median(a),l=[],d=a.length-1;d>=0;d--)l.push(o.abs(a[d]-s));return r.median(l)},r.coeffvar=function(a){return r.stdev(a)/r.mean(a)},r.quartiles=function(a){var s=a.length,l=a.slice().sort(c);return[l[o.round(s/4)-1],l[o.round(s/2)-1],l[o.round(s*3/4)-1]]},r.quantiles=function(a,s,l,d){var v=a.slice().sort(c),p=[s.length],m=a.length,g,E,y,w,T,R;for(typeof l>"u"&&(l=3/8),typeof d>"u"&&(d=3/8),g=0;g<s.length;g++)E=s[g],y=l+E*(1-l-d),w=m*E+y,T=o.floor(f(w,1,m-1)),R=f(w-T,0,1),p[g]=(1-R)*v[T-1]+R*v[T];return p},r.percentile=function(a,s,l){var d=a.slice().sort(c),v=s*(d.length+(l?1:-1))+(l?0:1),p=parseInt(v),m=v-p;return p+1<d.length?d[p-1]+m*(d[p]-d[p-1]):d[p-1]},r.percentileOfScore=function(a,s,l){var d=0,v=a.length,p=!1,m,g;for(l==="strict"&&(p=!0),g=0;g<v;g++)m=a[g],(p&&m<s||!p&&m<=s)&&d++;return d/v},r.histogram=function(a,s){s=s||4;var l=r.min(a),d=(r.max(a)-l)/s,v=a.length,p=[],m;for(m=0;m<s;m++)p[m]=0;for(m=0;m<v;m++)p[o.min(o.floor((a[m]-l)/d),s-1)]+=1;return p},r.covariance=function(a,s){var l=r.mean(a),d=r.mean(s),v=a.length,p=new Array(v),m;for(m=0;m<v;m++)p[m]=(a[m]-l)*(s[m]-d);return r.sum(p)/(v-1)},r.corrcoeff=function(a,s){return r.covariance(a,s)/r.stdev(a,1)/r.stdev(s,1)},r.spearmancoeff=function(u,a){return u=r.rank(u),a=r.rank(a),r.corrcoeff(u,a)},r.stanMoment=function(a,s){for(var l=r.mean(a),d=r.stdev(a),v=a.length,p=0,m=0;m<v;m++)p+=o.pow((a[m]-l)/d,s);return p/a.length},r.skewness=function(a){return r.stanMoment(a,3)},r.kurtosis=function(a){return r.stanMoment(a,4)-3};var h=r.prototype;(function(u){for(var a=0;a<u.length;a++)(function(s){h[s]=function(l,d){var v=[],p=0,m=this;if(i(l)&&(d=l,l=!1),d)return setTimeout(function(){d.call(m,h[s].call(m,l))}),this;if(this.length>1){for(m=l===!0?this:this.transpose();p<m.length;p++)v[p]=r[s](m[p]);return v}return r[s](this[0],l)}})(u[a])})("cumsum cumprod".split(" ")),function(u){for(var a=0;a<u.length;a++)(function(s){h[s]=function(l,d){var v=[],p=0,m=this;if(i(l)&&(d=l,l=!1),d)return setTimeout(function(){d.call(m,h[s].call(m,l))}),this;if(this.length>1){for(s!=="sumrow"&&(m=l===!0?this:this.transpose());p<m.length;p++)v[p]=r[s](m[p]);return l===!0?r[s](r.utils.toVector(v)):v}return r[s](this[0],l)}})(u[a])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(u){for(var a=0;a<u.length;a++)(function(s){h[s]=function(){var l=[],d=0,v=this,p=Array.prototype.slice.call(arguments),m;if(i(p[p.length-1])){m=p[p.length-1];var g=p.slice(0,p.length-1);return setTimeout(function(){m.call(v,h[s].apply(v,g))}),this}else{m=void 0;var E=function(w){return r[s].apply(v,[w].concat(p))}}if(this.length>1){for(v=v.transpose();d<v.length;d++)l[d]=E(v[d]);return l}return E(this[0])}})(u[a])}("quantiles percentileOfScore".split(" "))}(n,Math),function(r,o){r.gammaln=function(c){var f=0,h=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],u=1.000000000190015,a,s,l;for(l=(s=a=c)+5.5,l-=(a+.5)*o.log(l);f<6;f++)u+=h[f]/++s;return o.log(2.5066282746310007*u/a)-l},r.loggam=function(c){var f,h,u,a,s,l,d,v=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(f=c,d=0,c==1||c==2)return 0;for(c<=7&&(d=o.floor(7-c),f=c+d),h=1/(f*f),u=2*o.PI,s=v[9],l=8;l>=0;l--)s*=h,s+=v[l];if(a=s/f+.5*o.log(u)+(f-.5)*o.log(f)-f,c<=7)for(l=1;l<=d;l++)a-=o.log(f-1),f-=1;return a},r.gammafn=function(c){var f=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],h=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],u=!1,a=0,s=0,l=0,d=c,v,p,m,g;if(c>171.6243769536076)return 1/0;if(d<=0)if(g=d%1+36e-17,g)u=(d&1?-1:1)*o.PI/o.sin(o.PI*g),d=1-d;else return 1/0;for(m=d,d<1?p=d++:p=(d-=a=(d|0)-1)-1,v=0;v<8;++v)l=(l+f[v])*p,s=s*p+h[v];if(g=l/s+1,m<d)g/=m;else if(m>d)for(v=0;v<a;++v)g*=d,d++;return u&&(g=u/g),g},r.gammap=function(c,f){return r.lowRegGamma(c,f)*r.gammafn(c)},r.lowRegGamma=function(c,f){var h=r.gammaln(c),u=c,a=1/c,s=a,l=f+1-c,d=1/1e-30,v=1/l,p=v,m=1,g=-~(o.log(c>=1?c:1/c)*8.5+c*.4+17),E;if(f<0||c<=0)return NaN;if(f<c+1){for(;m<=g;m++)a+=s*=f/++u;return a*o.exp(-f+c*o.log(f)-h)}for(;m<=g;m++)E=-m*(m-c),l+=2,v=E*v+l,d=l+E/d,v=1/v,p*=v*d;return 1-p*o.exp(-f+c*o.log(f)-h)},r.factorialln=function(c){return c<0?NaN:r.gammaln(c+1)},r.factorial=function(c){return c<0?NaN:r.gammafn(c+1)},r.combination=function(c,f){return c>170||f>170?o.exp(r.combinationln(c,f)):r.factorial(c)/r.factorial(f)/r.factorial(c-f)},r.combinationln=function(c,f){return r.factorialln(c)-r.factorialln(f)-r.factorialln(c-f)},r.permutation=function(c,f){return r.factorial(c)/r.factorial(c-f)},r.betafn=function(c,f){if(!(c<=0||f<=0))return c+f>170?o.exp(r.betaln(c,f)):r.gammafn(c)*r.gammafn(f)/r.gammafn(c+f)},r.betaln=function(c,f){return r.gammaln(c)+r.gammaln(f)-r.gammaln(c+f)},r.betacf=function(c,f,h){var u=1e-30,a=1,s=f+h,l=f+1,d=f-1,v=1,p=1-s*c/l,m,g,E,y;for(o.abs(p)<u&&(p=u),p=1/p,y=p;a<=100&&(m=2*a,g=a*(h-a)*c/((d+m)*(f+m)),p=1+g*p,o.abs(p)<u&&(p=u),v=1+g/v,o.abs(v)<u&&(v=u),p=1/p,y*=p*v,g=-(f+a)*(s+a)*c/((f+m)*(l+m)),p=1+g*p,o.abs(p)<u&&(p=u),v=1+g/v,o.abs(v)<u&&(v=u),p=1/p,E=p*v,y*=E,!(o.abs(E-1)<3e-7));a++);return y},r.gammapinv=function(c,f){var h=0,u=f-1,a=1e-8,s=r.gammaln(f),l,d,v,p,m,g,E;if(c>=1)return o.max(100,f+100*o.sqrt(f));if(c<=0)return 0;for(f>1?(g=o.log(u),E=o.exp(u*(g-1)-s),m=c<.5?c:1-c,v=o.sqrt(-2*o.log(m)),l=(2.30753+v*.27061)/(1+v*(.99229+v*.04481))-v,c<.5&&(l=-l),l=o.max(.001,f*o.pow(1-1/(9*f)-l/(3*o.sqrt(f)),3))):(v=1-f*(.253+f*.12),c<v?l=o.pow(c/v,1/f):l=1-o.log(1-(c-v)/(1-v)));h<12;h++){if(l<=0)return 0;if(d=r.lowRegGamma(f,l)-c,f>1?v=E*o.exp(-(l-u)+u*(o.log(l)-g)):v=o.exp(-l+u*o.log(l)-s),p=d/v,l-=v=p/(1-.5*o.min(1,p*((f-1)/l-1))),l<=0&&(l=.5*(l+v)),o.abs(v)<a*l)break}return l},r.erf=function(c){var f=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],h=f.length-1,u=!1,a=0,s=0,l,d,v,p;for(c<0&&(c=-c,u=!0),l=2/(2+c),d=4*l-2;h>0;h--)v=a,a=d*a-s+f[h],s=v;return p=l*o.exp(-c*c+.5*(f[0]+d*a)-s),u?p-1:1-p},r.erfc=function(c){return 1-r.erf(c)},r.erfcinv=function(c){var f=0,h,u,a,s;if(c>=2)return-100;if(c<=0)return 100;for(s=c<1?c:2-c,a=o.sqrt(-2*o.log(s/2)),h=-.70711*((2.30753+a*.27061)/(1+a*(.99229+a*.04481))-a);f<2;f++)u=r.erfc(h)-s,h+=u/(1.1283791670955126*o.exp(-h*h)-h*u);return c<1?h:-h},r.ibetainv=function(c,f,h){var u=1e-8,a=f-1,s=h-1,l=0,d,v,p,m,g,E,y,w,T,R,A;if(c<=0)return 0;if(c>=1)return 1;for(f>=1&&h>=1?(p=c<.5?c:1-c,m=o.sqrt(-2*o.log(p)),y=(2.30753+m*.27061)/(1+m*(.99229+m*.04481))-m,c<.5&&(y=-y),w=(y*y-3)/6,T=2/(1/(2*f-1)+1/(2*h-1)),R=y*o.sqrt(w+T)/T-(1/(2*h-1)-1/(2*f-1))*(w+5/6-2/(3*T)),y=f/(f+h*o.exp(2*R))):(d=o.log(f/(f+h)),v=o.log(h/(f+h)),m=o.exp(f*d)/f,g=o.exp(h*v)/h,R=m+g,c<m/R?y=o.pow(f*R*c,1/f):y=1-o.pow(h*R*(1-c),1/h)),A=-r.gammaln(f)-r.gammaln(h)+r.gammaln(f+h);l<10;l++){if(y===0||y===1)return y;if(E=r.ibeta(y,f,h)-c,m=o.exp(a*o.log(y)+s*o.log(1-y)+A),g=E/m,y-=m=g/(1-.5*o.min(1,g*(a/y-s/(1-y)))),y<=0&&(y=.5*(y+m)),y>=1&&(y=.5*(y+m+1)),o.abs(m)<u*y&&l>0)break}return y},r.ibeta=function(c,f,h){var u=c===0||c===1?0:o.exp(r.gammaln(f+h)-r.gammaln(f)-r.gammaln(h)+f*o.log(c)+h*o.log(1-c));return c<0||c>1?!1:c<(f+1)/(f+h+2)?u*r.betacf(c,f,h)/f:1-u*r.betacf(1-c,h,f)/h},r.randn=function(c,f){var h,u,a,s,l;if(f||(f=c),c)return r.create(c,f,function(){return r.randn()});do h=r._random_fn(),u=1.7156*(r._random_fn()-.5),a=h-.449871,s=o.abs(u)+.386595,l=a*a+s*(.196*s-.25472*a);while(l>.27597&&(l>.27846||u*u>-4*o.log(h)*h*h));return u/h},r.randg=function(c,f,h){var u=c,a,s,l,d,v,p;if(h||(h=f),c||(c=1),f)return p=r.zeros(f,h),p.alter(function(){return r.randg(c)}),p;c<1&&(c+=1),a=c-1/3,s=1/o.sqrt(9*a);do{do v=r.randn(),d=1+s*v;while(d<=0);d=d*d*d,l=r._random_fn()}while(l>1-.331*o.pow(v,4)&&o.log(l)>.5*v*v+a*(1-d+o.log(d)));if(c==u)return a*d;do l=r._random_fn();while(l===0);return o.pow(l,1/u)*a*d},function(i){for(var c=0;c<i.length;c++)(function(f){r.fn[f]=function(){return r(r.map(this,function(h){return r[f](h)}))}})(i[c])}("gammaln gammafn factorial factorialln".split(" ")),function(i){for(var c=0;c<i.length;c++)(function(f){r.fn[f]=function(){return r(r[f].apply(null,arguments))}})(i[c])}("randn".split(" "))}(n,Math),function(r,o){(function(u){for(var a=0;a<u.length;a++)(function(s){r[s]=function l(d,v,p){return this instanceof l?(this._a=d,this._b=v,this._c=p,this):new l(d,v,p)},r.fn[s]=function(l,d,v){var p=r[s](l,d,v);return p.data=this,p},r[s].prototype.sample=function(l){var d=this._a,v=this._b,p=this._c;return l?r.alter(l,function(){return r[s].sample(d,v,p)}):r[s].sample(d,v,p)},function(l){for(var d=0;d<l.length;d++)(function(v){r[s].prototype[v]=function(p){var m=this._a,g=this._b,E=this._c;return!p&&p!==0&&(p=this.data),typeof p!="number"?r.fn.map.call(p,function(y){return r[s][v](y,m,g,E)}):r[s][v](p,m,g,E)}})(l[d])}("pdf cdf inv".split(" ")),function(l){for(var d=0;d<l.length;d++)(function(v){r[s].prototype[v]=function(){return r[s][v](this._a,this._b,this._c)}})(l[d])}("mean median mode variance".split(" "))})(u[a])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),r.extend(r.beta,{pdf:function(a,s,l){return a>1||a<0?0:s==1&&l==1?1:s<512&&l<512?o.pow(a,s-1)*o.pow(1-a,l-1)/r.betafn(s,l):o.exp((s-1)*o.log(a)+(l-1)*o.log(1-a)-r.betaln(s,l))},cdf:function(a,s,l){return a>1||a<0?(a>1)*1:r.ibeta(a,s,l)},inv:function(a,s,l){return r.ibetainv(a,s,l)},mean:function(a,s){return a/(a+s)},median:function(a,s){return r.ibetainv(.5,a,s)},mode:function(a,s){return(a-1)/(a+s-2)},sample:function(a,s){var l=r.randg(a);return l/(l+r.randg(s))},variance:function(a,s){return a*s/(o.pow(a+s,2)*(a+s+1))}}),r.extend(r.centralF,{pdf:function(a,s,l){var d,v,p;return a<0?0:s<=2?a===0&&s<2?1/0:a===0&&s===2?1:1/r.betafn(s/2,l/2)*o.pow(s/l,s/2)*o.pow(a,s/2-1)*o.pow(1+s/l*a,-(s+l)/2):(d=s*a/(l+a*s),v=l/(l+a*s),p=s*v/2,p*r.binomial.pdf((s-2)/2,(s+l-2)/2,d))},cdf:function(a,s,l){return a<0?0:r.ibeta(s*a/(s*a+l),s/2,l/2)},inv:function(a,s,l){return l/(s*(1/r.ibetainv(a,s/2,l/2)-1))},mean:function(a,s){return s>2?s/(s-2):void 0},mode:function(a,s){return a>2?s*(a-2)/(a*(s+2)):void 0},sample:function(a,s){var l=r.randg(a/2)*2,d=r.randg(s/2)*2;return l/a/(d/s)},variance:function(a,s){if(!(s<=4))return 2*s*s*(a+s-2)/(a*(s-2)*(s-2)*(s-4))}}),r.extend(r.cauchy,{pdf:function(a,s,l){return l<0?0:l/(o.pow(a-s,2)+o.pow(l,2))/o.PI},cdf:function(a,s,l){return o.atan((a-s)/l)/o.PI+.5},inv:function(u,a,s){return a+s*o.tan(o.PI*(u-.5))},median:function(a){return a},mode:function(a){return a},sample:function(a,s){return r.randn()*o.sqrt(1/(2*r.randg(.5)))*s+a}}),r.extend(r.chisquare,{pdf:function(a,s){return a<0?0:a===0&&s===2?.5:o.exp((s/2-1)*o.log(a)-a/2-s/2*o.log(2)-r.gammaln(s/2))},cdf:function(a,s){return a<0?0:r.lowRegGamma(s/2,a/2)},inv:function(u,a){return 2*r.gammapinv(u,.5*a)},mean:function(u){return u},median:function(a){return a*o.pow(1-2/(9*a),3)},mode:function(a){return a-2>0?a-2:0},sample:function(a){return r.randg(a/2)*2},variance:function(a){return 2*a}}),r.extend(r.exponential,{pdf:function(a,s){return a<0?0:s*o.exp(-s*a)},cdf:function(a,s){return a<0?0:1-o.exp(-s*a)},inv:function(u,a){return-o.log(1-u)/a},mean:function(u){return 1/u},median:function(u){return 1/u*o.log(2)},mode:function(){return 0},sample:function(a){return-1/a*o.log(r._random_fn())},variance:function(u){return o.pow(u,-2)}}),r.extend(r.gamma,{pdf:function(a,s,l){return a<0?0:a===0&&s===1?1/l:o.exp((s-1)*o.log(a)-a/l-r.gammaln(s)-s*o.log(l))},cdf:function(a,s,l){return a<0?0:r.lowRegGamma(s,a/l)},inv:function(u,a,s){return r.gammapinv(u,a)*s},mean:function(u,a){return u*a},mode:function(a,s){if(a>1)return(a-1)*s},sample:function(a,s){return r.randg(a)*s},variance:function(a,s){return a*s*s}}),r.extend(r.invgamma,{pdf:function(a,s,l){return a<=0?0:o.exp(-(s+1)*o.log(a)-l/a-r.gammaln(s)+s*o.log(l))},cdf:function(a,s,l){return a<=0?0:1-r.lowRegGamma(s,l/a)},inv:function(u,a,s){return s/r.gammapinv(1-u,a)},mean:function(u,a){return u>1?a/(u-1):void 0},mode:function(a,s){return s/(a+1)},sample:function(a,s){return s/r.randg(a)},variance:function(a,s){if(!(a<=2))return s*s/((a-1)*(a-1)*(a-2))}}),r.extend(r.kumaraswamy,{pdf:function(a,s,l){return a===0&&s===1?l:a===1&&l===1?s:o.exp(o.log(s)+o.log(l)+(s-1)*o.log(a)+(l-1)*o.log(1-o.pow(a,s)))},cdf:function(a,s,l){return a<0?0:a>1?1:1-o.pow(1-o.pow(a,s),l)},inv:function(a,s,l){return o.pow(1-o.pow(1-a,1/l),1/s)},mean:function(u,a){return a*r.gammafn(1+1/u)*r.gammafn(a)/r.gammafn(1+1/u+a)},median:function(a,s){return o.pow(1-o.pow(2,-1/s),1/a)},mode:function(a,s){if(a>=1&&s>=1&&a!==1&&s!==1)return o.pow((a-1)/(a*s-1),1/a)},variance:function(){throw new Error("variance not yet implemented")}}),r.extend(r.lognormal,{pdf:function(a,s,l){return a<=0?0:o.exp(-o.log(a)-.5*o.log(2*o.PI)-o.log(l)-o.pow(o.log(a)-s,2)/(2*l*l))},cdf:function(a,s,l){return a<0?0:.5+.5*r.erf((o.log(a)-s)/o.sqrt(2*l*l))},inv:function(u,a,s){return o.exp(-1.4142135623730951*s*r.erfcinv(2*u)+a)},mean:function(a,s){return o.exp(a+s*s/2)},median:function(a){return o.exp(a)},mode:function(a,s){return o.exp(a-s*s)},sample:function(a,s){return o.exp(r.randn()*s+a)},variance:function(a,s){return(o.exp(s*s)-1)*o.exp(2*a+s*s)}}),r.extend(r.noncentralt,{pdf:function(a,s,l){var d=1e-14;return o.abs(l)<d?r.studentt.pdf(a,s):o.abs(a)<d?o.exp(r.gammaln((s+1)/2)-l*l/2-.5*o.log(o.PI*s)-r.gammaln(s/2)):s/a*(r.noncentralt.cdf(a*o.sqrt(1+2/s),s+2,l)-r.noncentralt.cdf(a,s,l))},cdf:function(a,s,l){var d=1e-14,v=200;if(o.abs(l)<d)return r.studentt.cdf(a,s);var p=!1;a<0&&(p=!0,l=-l);for(var m=r.normal.cdf(-l,0,1),g=d+1,E=g,y=a*a/(a*a+s),w=0,T=o.exp(-l*l/2),R=o.exp(-l*l/2-.5*o.log(2)-r.gammaln(3/2))*l;w<v||E>d||g>d;)E=g,w>0&&(T*=l*l/(2*w),R*=l*l/(2*(w+1/2))),g=T*r.beta.cdf(y,w+.5,s/2)+R*r.beta.cdf(y,w+1,s/2),m+=.5*g,w++;return p?1-m:m}}),r.extend(r.normal,{pdf:function(a,s,l){return o.exp(-.5*o.log(2*o.PI)-o.log(l)-o.pow(a-s,2)/(2*l*l))},cdf:function(a,s,l){return .5*(1+r.erf((a-s)/o.sqrt(2*l*l)))},inv:function(u,a,s){return-1.4142135623730951*s*r.erfcinv(2*u)+a},mean:function(u){return u},median:function(a){return a},mode:function(u){return u},sample:function(a,s){return r.randn()*s+a},variance:function(u,a){return a*a}}),r.extend(r.pareto,{pdf:function(a,s,l){return a<s?0:l*o.pow(s,l)/o.pow(a,l+1)},cdf:function(a,s,l){return a<s?0:1-o.pow(s/a,l)},inv:function(a,s,l){return s/o.pow(1-a,1/l)},mean:function(a,s){if(!(s<=1))return s*o.pow(a,s)/(s-1)},median:function(a,s){return a*(s*o.SQRT2)},mode:function(a){return a},variance:function(u,a){if(!(a<=2))return u*u*a/(o.pow(a-1,2)*(a-2))}}),r.extend(r.studentt,{pdf:function(a,s){return s=s>1e100?1e100:s,1/(o.sqrt(s)*r.betafn(.5,s/2))*o.pow(1+a*a/s,-((s+1)/2))},cdf:function(a,s){var l=s/2;return r.ibeta((a+o.sqrt(a*a+s))/(2*o.sqrt(a*a+s)),l,l)},inv:function(u,a){var s=r.ibetainv(2*o.min(u,1-u),.5*a,.5);return s=o.sqrt(a*(1-s)/s),u>.5?s:-s},mean:function(a){return a>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(a){return r.randn()*o.sqrt(a/(2*r.randg(a/2)))},variance:function(a){return a>2?a/(a-2):a>1?1/0:void 0}}),r.extend(r.weibull,{pdf:function(a,s,l){return a<0||s<0||l<0?0:l/s*o.pow(a/s,l-1)*o.exp(-o.pow(a/s,l))},cdf:function(a,s,l){return a<0?0:1-o.exp(-o.pow(a/s,l))},inv:function(u,a,s){return a*o.pow(-o.log(1-u),1/s)},mean:function(u,a){return u*r.gammafn(1+1/a)},median:function(a,s){return a*o.pow(o.log(2),1/s)},mode:function(a,s){return s<=1?0:a*o.pow((s-1)/s,1/s)},sample:function(a,s){return a*o.pow(-o.log(r._random_fn()),1/s)},variance:function(a,s){return a*a*r.gammafn(1+2/s)-o.pow(r.weibull.mean(a,s),2)}}),r.extend(r.uniform,{pdf:function(a,s,l){return a<s||a>l?0:1/(l-s)},cdf:function(a,s,l){return a<s?0:a<l?(a-s)/(l-s):1},inv:function(u,a,s){return a+u*(s-a)},mean:function(a,s){return .5*(a+s)},median:function(a,s){return r.mean(a,s)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(a,s){return a/2+s/2+(s/2-a/2)*(2*r._random_fn()-1)},variance:function(a,s){return o.pow(s-a,2)/12}});function i(u,a,s,l){for(var d=0,v=1,p=1,m=1,g=0,E=0,y;o.abs((p-E)/p)>l;)E=p,y=-(a+g)*(a+s+g)*u/(a+2*g)/(a+2*g+1),d=p+y*d,v=m+y*v,g=g+1,y=g*(s-g)*u/(a+2*g-1)/(a+2*g),p=d+y*p,m=v+y*m,d=d/m,v=v/m,p=p/m,m=1;return p/a}r.extend(r.binomial,{pdf:function(a,s,l){return l===0||l===1?s*l===a?1:0:r.combination(s,a)*o.pow(l,a)*o.pow(1-l,s-a)},cdf:function(a,s,l){var d,v=1e-10;if(a<0)return 0;if(a>=s)return 1;if(l<0||l>1||s<=0)return NaN;a=o.floor(a);var p=l,m=a+1,g=s-a,E=m+g,y=o.exp(r.gammaln(E)-r.gammaln(g)-r.gammaln(m)+m*o.log(p)+g*o.log(1-p));return p<(m+1)/(E+2)?d=y*i(p,m,g,v):d=1-y*i(1-p,g,m,v),o.round((1-d)*(1/v))/(1/v)}}),r.extend(r.negbin,{pdf:function(a,s,l){return a!==a>>>0?!1:a<0?0:r.combination(a+s-1,s-1)*o.pow(1-l,a)*o.pow(l,s)},cdf:function(a,s,l){var d=0,v=0;if(a<0)return 0;for(;v<=a;v++)d+=r.negbin.pdf(v,s,l);return d}}),r.extend(r.hypgeom,{pdf:function(a,s,l,d){if(a!==a|0)return!1;if(a<0||a<l-(s-d))return 0;if(a>d||a>l)return 0;if(l*2>s)return d*2>s?r.hypgeom.pdf(s-l-d+a,s,s-l,s-d):r.hypgeom.pdf(d-a,s,s-l,d);if(d*2>s)return r.hypgeom.pdf(l-a,s,l,s-d);if(l<d)return r.hypgeom.pdf(a,s,d,l);for(var v=1,p=0,m=0;m<a;m++){for(;v>1&&p<d;)v*=1-l/(s-p),p++;v*=(d-m)*(l-m)/((m+1)*(s-l-d+m+1))}for(;p<d;p++)v*=1-l/(s-p);return o.min(1,o.max(0,v))},cdf:function(a,s,l,d){if(a<0||a<l-(s-d))return 0;if(a>=d||a>=l)return 1;if(l*2>s)return d*2>s?r.hypgeom.cdf(s-l-d+a,s,s-l,s-d):1-r.hypgeom.cdf(d-a-1,s,s-l,d);if(d*2>s)return 1-r.hypgeom.cdf(l-a-1,s,l,s-d);if(l<d)return r.hypgeom.cdf(a,s,d,l);for(var v=1,p=1,m=0,g=0;g<a;g++){for(;v>1&&m<d;){var E=1-l/(s-m);p*=E,v*=E,m++}p*=(d-g)*(l-g)/((g+1)*(s-l-d+g+1)),v+=p}for(;m<d;m++)v*=1-l/(s-m);return o.min(1,o.max(0,v))}}),r.extend(r.poisson,{pdf:function(a,s){return s<0||a%1!==0||a<0?0:o.pow(s,a)*o.exp(-s)/r.factorial(a)},cdf:function(a,s){var l=[],d=0;if(a<0)return 0;for(;d<=a;d++)l.push(r.poisson.pdf(d,s));return r.sum(l)},mean:function(u){return u},variance:function(u){return u},sampleSmall:function(a){var s=1,l=0,d=o.exp(-a);do l++,s*=r._random_fn();while(s>d);return l-1},sampleLarge:function(a){var s=a,l,d,v,p,m,g,E,y,w,T;for(p=o.sqrt(s),m=o.log(s),E=.931+2.53*p,g=-.059+.02483*E,y=1.1239+1.1328/(E-3.4),w=.9277-3.6224/(E-2);;){if(d=o.random()-.5,v=o.random(),T=.5-o.abs(d),l=o.floor((2*g/T+E)*d+s+.43),T>=.07&&v<=w)return l;if(!(l<0||T<.013&&v>T)&&o.log(v)+o.log(y)-o.log(g/(T*T)+E)<=-s+l*m-r.loggam(l+1))return l}},sample:function(a){return a<10?this.sampleSmall(a):this.sampleLarge(a)}}),r.extend(r.triangular,{pdf:function(a,s,l,d){return l<=s||d<s||d>l?NaN:a<s||a>l?0:a<d?2*(a-s)/((l-s)*(d-s)):a===d?2/(l-s):2*(l-a)/((l-s)*(l-d))},cdf:function(a,s,l,d){return l<=s||d<s||d>l?NaN:a<=s?0:a>=l?1:a<=d?o.pow(a-s,2)/((l-s)*(d-s)):1-o.pow(l-a,2)/((l-s)*(l-d))},inv:function(a,s,l,d){return l<=s||d<s||d>l?NaN:a<=(d-s)/(l-s)?s+(l-s)*o.sqrt(a*((d-s)/(l-s))):s+(l-s)*(1-o.sqrt((1-a)*(1-(d-s)/(l-s))))},mean:function(a,s,l){return(a+s+l)/3},median:function(a,s,l){if(l<=(a+s)/2)return s-o.sqrt((s-a)*(s-l))/o.sqrt(2);if(l>(a+s)/2)return a+o.sqrt((s-a)*(l-a))/o.sqrt(2)},mode:function(a,s,l){return l},sample:function(a,s,l){var d=r._random_fn();return d<(l-a)/(s-a)?a+o.sqrt(d*(s-a)*(l-a)):s-o.sqrt((1-d)*(s-a)*(s-l))},variance:function(a,s,l){return(a*a+s*s+l*l-a*s-a*l-s*l)/18}}),r.extend(r.arcsine,{pdf:function(a,s,l){return l<=s?NaN:a<=s||a>=l?0:2/o.PI*o.pow(o.pow(l-s,2)-o.pow(2*a-s-l,2),-.5)},cdf:function(a,s,l){return a<s?0:a<l?2/o.PI*o.asin(o.sqrt((a-s)/(l-s))):1},inv:function(u,a,s){return a+(.5-.5*o.cos(o.PI*u))*(s-a)},mean:function(a,s){return s<=a?NaN:(a+s)/2},median:function(a,s){return s<=a?NaN:(a+s)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(a,s){return(a+s)/2+(s-a)/2*o.sin(2*o.PI*r.uniform.sample(0,1))},variance:function(a,s){return s<=a?NaN:o.pow(s-a,2)/8}});function c(u){return u/o.abs(u)}r.extend(r.laplace,{pdf:function(a,s,l){return l<=0?0:o.exp(-o.abs(a-s)/l)/(2*l)},cdf:function(a,s,l){return l<=0?0:a<s?.5*o.exp((a-s)/l):1-.5*o.exp(-(a-s)/l)},mean:function(u){return u},median:function(u){return u},mode:function(u){return u},variance:function(u,a){return 2*a*a},sample:function(a,s){var l=r._random_fn()-.5;return a-s*c(l)*o.log(1-2*o.abs(l))}});function f(u,a,s){var l=12,d=6,v=-30,p=-50,m=60,g=8,E=3,y=2,w=3,T=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],R=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],A=u*.5;if(A>=g)return 1;var C=2*r.normal.cdf(A,0,1,1,0)-1;C>=o.exp(p/s)?C=o.pow(C,s):C=0;var x;u>E?x=y:x=w;for(var O=A,I=(g-A)/x,P=O+I,B=0,S=s-1,b=1;b<=x;b++){for(var _=0,F=.5*(P+O),V=.5*(P-O),z=1;z<=l;z++){var M,$;d<z?(M=l-z+1,$=T[M-1]):(M=z,$=-T[M-1]);var H=V*$,W=F+H,Q=W*W;if(Q>m)break;var te=2*r.normal.cdf(W,0,1,1,0),he=2*r.normal.cdf(W,u,1,1,0),ue=te*.5-he*.5;ue>=o.exp(v/S)&&(ue=R[M-1]*o.exp(-(.5*Q))*o.pow(ue,S),_+=ue)}_*=2*V*s/o.sqrt(2*o.PI),B+=_,O=P,P+=I}return C+=B,C<=o.exp(v/a)?0:(C=o.pow(C,a),C>=1?1:C)}function h(u,a,s){var l=.322232421088,d=.099348462606,v=-1,p=.588581570495,m=-.342242088547,g=.531103462366,E=-.204231210125,y=.10353775285,w=-453642210148e-16,T=.0038560700634,R=.8832,A=.2368,C=1.214,x=1.208,O=1.4142,I=120,P=.5-.5*u,B=o.sqrt(o.log(1/(P*P))),S=B+((((B*w+E)*B+m)*B+v)*B+l)/((((B*T+y)*B+g)*B+p)*B+d);s<I&&(S+=(S*S*S+S)/s/4);var b=R-A*S;return s<I&&(b+=-C/s+x*S/s),S*(b*o.log(a-1)+O)}r.extend(r.tukey,{cdf:function(a,s,l){var d=1,v=s,p=16,m=8,g=-30,E=1e-14,y=100,w=800,T=5e3,R=25e3,A=1,C=.5,x=.25,O=.125,I=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],P=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(a<=0)return 0;if(l<2||d<1||v<2)return NaN;if(!Number.isFinite(a))return 1;if(l>R)return f(a,d,v);var B=l*.5,S=B*o.log(l)-l*o.log(2)-r.gammaln(B),b=B-1,_=l*.25,F;l<=y?F=A:l<=w?F=C:l<=T?F=x:F=O,S+=o.log(F);for(var V=0,z=1;z<=50;z++){for(var M=0,$=(2*z-1)*F,H=1;H<=p;H++){var W,Q;m<H?(W=H-m-1,Q=S+b*o.log($+I[W]*F)-(I[W]*F+$)*_):(W=H-1,Q=S+b*o.log($-I[W]*F)+(I[W]*F-$)*_);var te;if(Q>=g){m<H?te=a*o.sqrt((I[W]*F+$)*.5):te=a*o.sqrt((-(I[W]*F)+$)*.5);var he=f(te,d,v),ue=he*P[W]*o.exp(Q);M+=ue}}if(z*F>=1&&M<=E)break;V+=M}if(M>E)throw new Error("tukey.cdf failed to converge");return V>1&&(V=1),V},inv:function(u,a,s){var l=1,d=a,v=1e-4,p=50;if(s<2||l<1||d<2)return NaN;if(u<0||u>1)return NaN;if(u===0)return 0;if(u===1)return 1/0;var m=h(u,d,s),g=r.tukey.cdf(m,a,s)-u,E;g>0?E=o.max(0,m-1):E=m+1;for(var y=r.tukey.cdf(E,a,s)-u,w,T=1;T<p;T++){w=E-y*(E-m)/(y-g),g=y,m=E,w<0&&(w=0,y=-u),y=r.tukey.cdf(w,a,s)-u,E=w;var R=o.abs(E-m);if(R<v)return w}throw new Error("tukey.inv failed to converge")}})}(n,Math),function(r,o){var i=Array.prototype.push,c=r.utils.isArray;function f(h){return c(h)||h instanceof r}r.extend({add:function(u,a){return f(a)?(f(a[0])||(a=[a]),r.map(u,function(s,l,d){return s+a[l][d]})):r.map(u,function(s){return s+a})},subtract:function(u,a){return f(a)?(f(a[0])||(a=[a]),r.map(u,function(s,l,d){return s-a[l][d]||0})):r.map(u,function(s){return s-a})},divide:function(u,a){return f(a)?(f(a[0])||(a=[a]),r.multiply(u,r.inv(a))):r.map(u,function(s){return s/a})},multiply:function(u,a){var s,l,d,v,p,m,g,E;if(u.length===void 0&&a.length===void 0)return u*a;if(p=u.length,m=u[0].length,g=r.zeros(p,d=f(a)?a[0].length:m),E=0,f(a)){for(;E<d;E++)for(s=0;s<p;s++){for(v=0,l=0;l<m;l++)v+=u[s][l]*a[l][E];g[s][E]=v}return p===1&&E===1?g[0][0]:g}return r.map(u,function(y){return y*a})},outer:function(u,a){return r.multiply(u.map(function(s){return[s]}),[a])},dot:function(u,a){f(u[0])||(u=[u]),f(a[0])||(a=[a]);for(var s=u[0].length===1&&u.length!==1?r.transpose(u):u,l=a[0].length===1&&a.length!==1?r.transpose(a):a,d=[],v=0,p=s.length,m=s[0].length,g,E;v<p;v++){for(d[v]=[],g=0,E=0;E<m;E++)g+=s[v][E]*l[v][E];d[v]=g}return d.length===1?d[0]:d},pow:function(u,a){return r.map(u,function(s){return o.pow(s,a)})},exp:function(u){return r.map(u,function(a){return o.exp(a)})},log:function(u){return r.map(u,function(a){return o.log(a)})},abs:function(u){return r.map(u,function(a){return o.abs(a)})},norm:function(u,a){var s=0,l=0;for(isNaN(a)&&(a=2),f(u[0])&&(u=u[0]);l<u.length;l++)s+=o.pow(o.abs(u[l]),a);return o.pow(s,1/a)},angle:function(u,a){return o.acos(r.dot(u,a)/(r.norm(u)*r.norm(a)))},aug:function(u,a){var s=[],l;for(l=0;l<u.length;l++)s.push(u[l].slice());for(l=0;l<s.length;l++)i.apply(s[l],a[l]);return s},inv:function(u){for(var a=u.length,s=u[0].length,l=r.identity(a,s),d=r.gauss_jordan(u,l),v=[],p=0,m;p<a;p++)for(v[p]=[],m=s;m<d[0].length;m++)v[p][m-s]=d[p][m];return v},det:function h(u){if(u.length===2)return u[0][0]*u[1][1]-u[0][1]*u[1][0];for(var a=0,s=0;s<u.length;s++){for(var l=[],d=1;d<u.length;d++){l[d-1]=[];for(var v=0;v<u.length;v++)v<s?l[d-1][v]=u[d][v]:v>s&&(l[d-1][v-1]=u[d][v])}var p=s%2?-1:1;a+=h(l)*u[0][s]*p}return a},gauss_elimination:function(u,a){var s=0,l=0,d=u.length,v=u[0].length,p=1,m=0,g=[],E,y,w,T;for(u=r.aug(u,a),E=u[0].length,s=0;s<d;s++){for(y=u[s][s],l=s,T=s+1;T<v;T++)y<o.abs(u[T][s])&&(y=u[T][s],l=T);if(l!=s)for(T=0;T<E;T++)w=u[s][T],u[s][T]=u[l][T],u[l][T]=w;for(l=s+1;l<d;l++)for(p=u[l][s]/u[s][s],T=s;T<E;T++)u[l][T]=u[l][T]-p*u[s][T]}for(s=d-1;s>=0;s--){for(m=0,l=s+1;l<=d-1;l++)m=m+g[l]*u[s][l];g[s]=(u[s][E-1]-m)/u[s][s]}return g},gauss_jordan:function(u,a){var s=r.aug(u,a),l=s.length,d=s[0].length,v=0,p,m,g;for(m=0;m<l;m++){var E=m;for(g=m+1;g<l;g++)o.abs(s[g][m])>o.abs(s[E][m])&&(E=g);var y=s[m];for(s[m]=s[E],s[E]=y,g=m+1;g<l;g++)for(v=s[g][m]/s[m][m],p=m;p<d;p++)s[g][p]-=s[m][p]*v}for(m=l-1;m>=0;m--){for(v=s[m][m],g=0;g<m;g++)for(p=d-1;p>m-1;p--)s[g][p]-=s[m][p]*s[g][m]/v;for(s[m][m]/=v,p=l;p<d;p++)s[m][p]/=v}return s},triaUpSolve:function(u,a){var s=u[0].length,l=r.zeros(1,s)[0],d,v=!1;return a[0].length!=null&&(a=a.map(function(p){return p[0]}),v=!0),r.arange(s-1,-1,-1).forEach(function(p){d=r.arange(p+1,s).map(function(m){return l[m]*u[p][m]}),l[p]=(a[p]-r.sum(d))/u[p][p]}),v?l.map(function(p){return[p]}):l},triaLowSolve:function(u,a){var s=u[0].length,l=r.zeros(1,s)[0],d,v=!1;return a[0].length!=null&&(a=a.map(function(p){return p[0]}),v=!0),r.arange(s).forEach(function(p){d=r.arange(p).map(function(m){return u[p][m]*l[m]}),l[p]=(a[p]-r.sum(d))/u[p][p]}),v?l.map(function(p){return[p]}):l},lu:function(u){var a=u.length,s=r.identity(a),l=r.zeros(u.length,u[0].length),d;return r.arange(a).forEach(function(v){l[0][v]=u[0][v]}),r.arange(1,a).forEach(function(v){r.arange(v).forEach(function(p){d=r.arange(p).map(function(m){return s[v][m]*l[m][p]}),s[v][p]=(u[v][p]-r.sum(d))/l[p][p]}),r.arange(v,a).forEach(function(p){d=r.arange(v).map(function(m){return s[v][m]*l[m][p]}),l[v][p]=u[d.length][p]-r.sum(d)})}),[s,l]},cholesky:function(u){var a=u.length,s=r.zeros(u.length,u[0].length),l;return r.arange(a).forEach(function(d){l=r.arange(d).map(function(v){return o.pow(s[d][v],2)}),s[d][d]=o.sqrt(u[d][d]-r.sum(l)),r.arange(d+1,a).forEach(function(v){l=r.arange(d).map(function(p){return s[d][p]*s[v][p]}),s[v][d]=(u[d][v]-r.sum(l))/s[d][d]})}),s},gauss_jacobi:function(u,a,s,l){for(var d=0,v=0,p=u.length,m=[],g=[],E=[],y,w,T,R;d<p;d++)for(m[d]=[],g[d]=[],E[d]=[],v=0;v<p;v++)d>v?(m[d][v]=u[d][v],g[d][v]=E[d][v]=0):d<v?(g[d][v]=u[d][v],m[d][v]=E[d][v]=0):(E[d][v]=u[d][v],m[d][v]=g[d][v]=0);for(T=r.multiply(r.multiply(r.inv(E),r.add(m,g)),-1),w=r.multiply(r.inv(E),a),y=s,R=r.add(r.multiply(T,s),w),d=2;o.abs(r.norm(r.subtract(R,y)))>l;)y=R,R=r.add(r.multiply(T,y),w),d++;return R},gauss_seidel:function(u,a,s,l){for(var d=0,v=u.length,p=[],m=[],g=[],E,y,w,T,R;d<v;d++)for(p[d]=[],m[d]=[],g[d]=[],E=0;E<v;E++)d>E?(p[d][E]=u[d][E],m[d][E]=g[d][E]=0):d<E?(m[d][E]=u[d][E],p[d][E]=g[d][E]=0):(g[d][E]=u[d][E],p[d][E]=m[d][E]=0);for(T=r.multiply(r.multiply(r.inv(r.add(g,p)),m),-1),w=r.multiply(r.inv(r.add(g,p)),a),y=s,R=r.add(r.multiply(T,s),w),d=2;o.abs(r.norm(r.subtract(R,y)))>l;)y=R,R=r.add(r.multiply(T,y),w),d=d+1;return R},SOR:function(u,a,s,l,d){for(var v=0,p=u.length,m=[],g=[],E=[],y,w,T,R,A;v<p;v++)for(m[v]=[],g[v]=[],E[v]=[],y=0;y<p;y++)v>y?(m[v][y]=u[v][y],g[v][y]=E[v][y]=0):v<y?(g[v][y]=u[v][y],m[v][y]=E[v][y]=0):(E[v][y]=u[v][y],m[v][y]=g[v][y]=0);for(R=r.multiply(r.inv(r.add(E,r.multiply(m,d))),r.subtract(r.multiply(E,1-d),r.multiply(g,d))),T=r.multiply(r.multiply(r.inv(r.add(E,r.multiply(m,d))),a),d),w=s,A=r.add(r.multiply(R,s),T),v=2;o.abs(r.norm(r.subtract(A,w)))>l;)w=A,A=r.add(r.multiply(R,w),T),v++;return A},householder:function(u){for(var a=u.length,s=u[0].length,l=0,d=[],v=[],p,m,g,E,y;l<a-1;l++){for(p=0,E=l+1;E<s;E++)p+=u[E][l]*u[E][l];for(y=u[l+1][l]>0?-1:1,p=y*o.sqrt(p),m=o.sqrt((p*p-u[l+1][l]*p)/2),d=r.zeros(a,1),d[l+1][0]=(u[l+1][l]-p)/(2*m),g=l+2;g<a;g++)d[g][0]=u[g][l]/(2*m);v=r.subtract(r.identity(a,s),r.multiply(r.multiply(d,r.transpose(d)),2)),u=r.multiply(v,r.multiply(u,v))}return u},QR:function(){var h=r.sum,u=r.arange;function a(s){var l=s.length,d=s[0].length,v=r.zeros(d,d);s=r.copy(s);var p,m,g;for(m=0;m<d;m++){for(v[m][m]=o.sqrt(h(u(l).map(function(E){return s[E][m]*s[E][m]}))),p=0;p<l;p++)s[p][m]=s[p][m]/v[m][m];for(g=m+1;g<d;g++)for(v[m][g]=h(u(l).map(function(E){return s[E][m]*s[E][g]})),p=0;p<l;p++)s[p][g]=s[p][g]-s[p][m]*v[m][g]}return[s,v]}return a}(),lstsq:function(){function h(a){a=r.copy(a);var s=a.length,l=r.identity(s);return r.arange(s-1,-1,-1).forEach(function(d){r.sliceAssign(l,{row:d},r.divide(r.slice(l,{row:d}),a[d][d])),r.sliceAssign(a,{row:d},r.divide(r.slice(a,{row:d}),a[d][d])),r.arange(d).forEach(function(v){var p=r.multiply(a[v][d],-1),m=r.slice(a,{row:v}),g=r.multiply(r.slice(a,{row:d}),p);r.sliceAssign(a,{row:v},r.add(m,g));var E=r.slice(l,{row:v}),y=r.multiply(r.slice(l,{row:d}),p);r.sliceAssign(l,{row:v},r.add(E,y))})}),l}function u(a,s){var l=!1;s[0].length===void 0&&(s=s.map(function(R){return[R]}),l=!0);var d=r.QR(a),v=d[0],p=d[1],m=a[0].length,g=r.slice(v,{col:{end:m}}),E=r.slice(p,{row:{end:m}}),y=h(E),w=r.transpose(g);w[0].length===void 0&&(w=[w]);var T=r.multiply(r.multiply(y,w),s);return T.length===void 0&&(T=[[T]]),l?T.map(function(R){return R[0]}):T}return u}(),jacobi:function(u){for(var a=1,s=u.length,l=r.identity(s,s),d=[],v,p,m,g,E,y,w,T;a===1;){for(y=u[0][1],g=0,E=1,p=0;p<s;p++)for(m=0;m<s;m++)p!=m&&y<o.abs(u[p][m])&&(y=o.abs(u[p][m]),g=p,E=m);for(u[g][g]===u[E][E]?w=u[g][E]>0?o.PI/4:-o.PI/4:w=o.atan(2*u[g][E]/(u[g][g]-u[E][E]))/2,T=r.identity(s,s),T[g][g]=o.cos(w),T[g][E]=-o.sin(w),T[E][g]=o.sin(w),T[E][E]=o.cos(w),l=r.multiply(l,T),v=r.multiply(r.multiply(r.inv(T),u),T),u=v,a=0,p=1;p<s;p++)for(m=1;m<s;m++)p!=m&&o.abs(u[p][m])>.001&&(a=1)}for(p=0;p<s;p++)d.push(u[p][p]);return[l,d]},rungekutta:function(u,a,s,l,d,v){var p,m,g,E,y;if(v===2)for(;l<=s;)p=a*u(l,d),m=a*u(l+a,d+p),g=d+(p+m)/2,d=g,l=l+a;if(v===4)for(;l<=s;)p=a*u(l,d),m=a*u(l+a/2,d+p/2),E=a*u(l+a/2,d+m/2),y=a*u(l+a,d+E),g=d+(p+2*m+2*E+y)/6,d=g,l=l+a;return d},romberg:function(u,a,s,l){for(var d=0,v=(s-a)/2,p=[],m=[],g=[],E,y,w,T,R;d<l/2;){for(R=u(a),w=a,T=0;w<=s;w=w+v,T++)p[T]=w;for(E=p.length,w=1;w<E-1;w++)R+=(w%2!==0?4:2)*u(p[w]);R=v/3*(R+u(s)),g[d]=R,v/=2,d++}for(y=g.length,E=1;y!==1;){for(w=0;w<y-1;w++)m[w]=(o.pow(4,E)*g[w+1]-g[w])/(o.pow(4,E)-1);y=m.length,g=m,m=[],E++}return g},richardson:function(u,a,s,l){function d(A,C){for(var x=0,O=A.length,I;x<O;x++)A[x]===C&&(I=x);return I}for(var v=o.abs(s-u[d(u,s)+1]),p=0,m=[],g=[],E,y,w,T,R;l>=v;)E=d(u,s+l),y=d(u,s),m[p]=(a[E]-2*a[y]+a[2*y-E])/(l*l),l/=2,p++;for(T=m.length,w=1;T!=1;){for(R=0;R<T-1;R++)g[R]=(o.pow(4,w)*m[R+1]-m[R])/(o.pow(4,w)-1);T=g.length,m=g,g=[],w++}return m},simpson:function(u,a,s,l){for(var d=(s-a)/l,v=u(a),p=[],m=a,g=0,E=1,y;m<=s;m=m+d,g++)p[g]=m;for(y=p.length;E<y-1;E++)v+=(E%2!==0?4:2)*u(p[E]);return d/3*(v+u(s))},hermite:function(u,a,s,l){for(var d=u.length,v=0,p=0,m=[],g=[],E=[],y=[],w;p<d;p++){for(m[p]=1,w=0;w<d;w++)p!=w&&(m[p]*=(l-u[w])/(u[p]-u[w]));for(g[p]=0,w=0;w<d;w++)p!=w&&(g[p]+=1/(u[p]-u[w]));E[p]=(1-2*(l-u[p])*g[p])*(m[p]*m[p]),y[p]=(l-u[p])*(m[p]*m[p]),v+=E[p]*a[p]+y[p]*s[p]}return v},lagrange:function(u,a,s){for(var l=0,d=0,v,p,m=u.length;d<m;d++){for(p=a[d],v=0;v<m;v++)d!=v&&(p*=(s-u[v])/(u[d]-u[v]));l+=p}return l},cubic_spline:function(u,a,s){for(var l=u.length,d=0,v,p=[],m=[],g=[],E=[],y=[],w=[],T=[];d<l-1;d++)y[d]=u[d+1]-u[d];for(g[0]=0,d=1;d<l-1;d++)g[d]=3/y[d]*(a[d+1]-a[d])-3/y[d-1]*(a[d]-a[d-1]);for(d=1;d<l-1;d++)p[d]=[],m[d]=[],p[d][d-1]=y[d-1],p[d][d]=2*(y[d-1]+y[d]),p[d][d+1]=y[d],m[d][0]=g[d];for(E=r.multiply(r.inv(p),m),v=0;v<l-1;v++)w[v]=(a[v+1]-a[v])/y[v]-y[v]*(E[v+1][0]+2*E[v][0])/3,T[v]=(E[v+1][0]-E[v][0])/(3*y[v]);for(v=0;v<l&&!(u[v]>s);v++);return v-=1,a[v]+(s-u[v])*w[v]+r.sq(s-u[v])*E[v]+(s-u[v])*r.sq(s-u[v])*T[v]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(u){var a=u.length,s=u[0].length,l=0,d,v,p=[],m=[],g=[],E=[],y=[],w=[],T=[],R=[],A=[],C=[];for(l=0;l<a;l++)p[l]=r.sum(u[l])/s;for(l=0;l<s;l++)for(T[l]=[],d=0;d<a;d++)T[l][d]=u[d][l]-p[d];for(T=r.transpose(T),l=0;l<a;l++)for(R[l]=[],d=0;d<a;d++)R[l][d]=r.dot([T[l]],[T[d]])/(s-1);for(g=r.jacobi(R),A=g[0],m=g[1],C=r.transpose(A),l=0;l<m.length;l++)for(d=l;d<m.length;d++)m[l]<m[d]&&(v=m[l],m[l]=m[d],m[d]=v,E=C[l],C[l]=C[d],C[d]=E);for(w=r.transpose(T),l=0;l<a;l++)for(y[l]=[],d=0;d<w.length;d++)y[l][d]=r.dot([C[l]],[w[d]]);return[u,m,C,y]}}),function(h){for(var u=0;u<h.length;u++)(function(a){r.fn[a]=function(s,l){var d=this;return l?(setTimeout(function(){l.call(d,r.fn[a].call(d,s))},15),this):typeof r[a](this,s)=="number"?r[a](this,s):r(r[a](this,s))}})(h[u])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(n,Math),function(r,o){var i=[].slice,c=r.utils.isNumber,f=r.utils.isArray;r.extend({zscore:function(){var a=i.call(arguments);return c(a[1])?(a[0]-a[1])/a[2]:(a[0]-r.mean(a[1]))/r.stdev(a[1],a[2])},ztest:function(){var a=i.call(arguments),s;return f(a[1])?(s=r.zscore(a[0],a[1],a[3]),a[2]===1?r.normal.cdf(-o.abs(s),0,1):r.normal.cdf(-o.abs(s),0,1)*2):a.length>2?(s=r.zscore(a[0],a[1],a[2]),a[3]===1?r.normal.cdf(-o.abs(s),0,1):r.normal.cdf(-o.abs(s),0,1)*2):(s=a[0],a[1]===1?r.normal.cdf(-o.abs(s),0,1):r.normal.cdf(-o.abs(s),0,1)*2)}}),r.extend(r.fn,{zscore:function(a,s){return(a-this.mean())/this.stdev(s)},ztest:function(a,s,l){var d=o.abs(this.zscore(a,l));return s===1?r.normal.cdf(-d,0,1):r.normal.cdf(-d,0,1)*2}}),r.extend({tscore:function(){var a=i.call(arguments);return a.length===4?(a[0]-a[1])/(a[2]/o.sqrt(a[3])):(a[0]-r.mean(a[1]))/(r.stdev(a[1],!0)/o.sqrt(a[1].length))},ttest:function(){var a=i.call(arguments),s;return a.length===5?(s=o.abs(r.tscore(a[0],a[1],a[2],a[3])),a[4]===1?r.studentt.cdf(-s,a[3]-1):r.studentt.cdf(-s,a[3]-1)*2):c(a[1])?(s=o.abs(a[0]),a[2]==1?r.studentt.cdf(-s,a[1]-1):r.studentt.cdf(-s,a[1]-1)*2):(s=o.abs(r.tscore(a[0],a[1])),a[2]==1?r.studentt.cdf(-s,a[1].length-1):r.studentt.cdf(-s,a[1].length-1)*2)}}),r.extend(r.fn,{tscore:function(a){return(a-this.mean())/(this.stdev(!0)/o.sqrt(this.cols()))},ttest:function(a,s){return s===1?1-r.studentt.cdf(o.abs(this.tscore(a)),this.cols()-1):r.studentt.cdf(-o.abs(this.tscore(a)),this.cols()-1)*2}}),r.extend({anovafscore:function(){var a=i.call(arguments),s,l,d,v,p,m,g,E;if(a.length===1){for(p=new Array(a[0].length),g=0;g<a[0].length;g++)p[g]=a[0][g];a=p}for(l=new Array,g=0;g<a.length;g++)l=l.concat(a[g]);for(d=r.mean(l),s=0,g=0;g<a.length;g++)s=s+a[g].length*o.pow(r.mean(a[g])-d,2);for(s/=a.length-1,m=0,g=0;g<a.length;g++)for(v=r.mean(a[g]),E=0;E<a[g].length;E++)m+=o.pow(a[g][E]-v,2);return m/=l.length-a.length,s/m},anovaftest:function(){var a=i.call(arguments),s,l,d,v;if(c(a[0]))return 1-r.centralF.cdf(a[0],a[1],a[2]);var p=r.anovafscore(a);for(s=a.length-1,d=0,v=0;v<a.length;v++)d=d+a[v].length;return l=d-s-1,1-r.centralF.cdf(p,s,l)},ftest:function(a,s,l){return 1-r.centralF.cdf(a,s,l)}}),r.extend(r.fn,{anovafscore:function(){return r.anovafscore(this.toArray())},anovaftes:function(){var a=0,s;for(s=0;s<this.length;s++)a=a+this[s].length;return r.ftest(this.anovafscore(),this.length-1,a-this.length)}}),r.extend({qscore:function(){var a=i.call(arguments),s,l,d,v,p;return c(a[0])?(s=a[0],l=a[1],d=a[2],v=a[3],p=a[4]):(s=r.mean(a[0]),l=r.mean(a[1]),d=a[0].length,v=a[1].length,p=a[2]),o.abs(s-l)/(p*o.sqrt((1/d+1/v)/2))},qtest:function(){var a=i.call(arguments),s;a.length===3?(s=a[0],a=a.slice(1)):a.length===7?(s=r.qscore(a[0],a[1],a[2],a[3],a[4]),a=a.slice(5)):(s=r.qscore(a[0],a[1],a[2]),a=a.slice(3));var l=a[0],d=a[1];return 1-r.tukey.cdf(s,d,l-d)},tukeyhsd:function(a){for(var s=r.pooledstdev(a),l=a.map(function(E){return r.mean(E)}),d=a.reduce(function(E,y){return E+y.length},0),v=[],p=0;p<a.length;++p)for(var m=p+1;m<a.length;++m){var g=r.qtest(l[p],l[m],a[p].length,a[m].length,s,d,a.length);v.push([[p,m],g])}return v}}),r.extend({normalci:function(){var a=i.call(arguments),s=new Array(2),l;return a.length===4?l=o.abs(r.normal.inv(a[1]/2,0,1)*a[2]/o.sqrt(a[3])):l=o.abs(r.normal.inv(a[1]/2,0,1)*r.stdev(a[2])/o.sqrt(a[2].length)),s[0]=a[0]-l,s[1]=a[0]+l,s},tci:function(){var a=i.call(arguments),s=new Array(2),l;return a.length===4?l=o.abs(r.studentt.inv(a[1]/2,a[3]-1)*a[2]/o.sqrt(a[3])):l=o.abs(r.studentt.inv(a[1]/2,a[2].length-1)*r.stdev(a[2],!0)/o.sqrt(a[2].length)),s[0]=a[0]-l,s[1]=a[0]+l,s},significant:function(a,s){return a<s}}),r.extend(r.fn,{normalci:function(a,s){return r.normalci(a,s,this.toArray())},tci:function(a,s){return r.tci(a,s,this.toArray())}});function h(u,a,s,l){if(u>1||s>1||u<=0||s<=0)throw new Error("Proportions should be greater than 0 and less than 1");var d=(u*a+s*l)/(a+l),v=o.sqrt(d*(1-d)*(1/a+1/l));return(u-s)/v}r.extend(r.fn,{oneSidedDifferenceOfProportions:function(a,s,l,d){var v=h(a,s,l,d);return r.ztest(v,1)},twoSidedDifferenceOfProportions:function(a,s,l,d){var v=h(a,s,l,d);return r.ztest(v,2)}})}(n,Math),n.models=function(){function r(h){var u=h[0].length,a=n.arange(u).map(function(s){var l=n.arange(u).filter(function(d){return d!==s});return o(n.col(h,s).map(function(d){return d[0]}),n.col(h,l))});return a}function o(h,u){var a=h.length,s=u[0].length-1,l=a-s-1,d=n.lstsq(u,h),v=n.multiply(u,d.map(function(T){return[T]})).map(function(T){return T[0]}),p=n.subtract(h,v),m=n.mean(h),g=n.sum(v.map(function(T){return Math.pow(T-m,2)})),E=n.sum(h.map(function(T,R){return Math.pow(T-v[R],2)})),y=g+E,w=g/y;return{exog:u,endog:h,nobs:a,df_model:s,df_resid:l,coef:d,predict:v,resid:p,ybar:m,SST:y,SSE:g,SSR:E,R2:w}}function i(h){var u=r(h.exog),a=Math.sqrt(h.SSR/h.df_resid),s=u.map(function(m){var g=m.SST,E=m.R2;return a/Math.sqrt(g*(1-E))}),l=h.coef.map(function(m,g){return(m-0)/s[g]}),d=l.map(function(m){var g=n.studentt.cdf(m,h.df_resid);return(g>.5?1-g:g)*2}),v=n.studentt.inv(.975,h.df_resid),p=h.coef.map(function(m,g){var E=v*s[g];return[m-E,m+E]});return{se:s,t:l,p:d,sigmaHat:a,interval95:p}}function c(h){var u=h.R2/h.df_model/((1-h.R2)/h.df_resid),a=function(l,d,v){return n.beta.cdf(l/(v/d+l),d/2,v/2)},s=1-a(u,h.df_model,h.df_resid);return{F_statistic:u,pvalue:s}}function f(h,u){var a=o(h,u),s=i(a),l=c(a),d=1-(1-a.R2)*((a.nobs-1)/a.df_resid);return a.t=s,a.f=l,a.adjust_R2=d,a}return{ols:f}}(),n.extend({buildxmatrix:function(){for(var o=new Array(arguments.length),i=0;i<arguments.length;i++){var c=[1];o[i]=c.concat(arguments[i])}return n(o)},builddxmatrix:function(){for(var o=new Array(arguments[0].length),i=0;i<arguments[0].length;i++){var c=[1];o[i]=c.concat(arguments[0][i])}return n(o)},buildjxmatrix:function(o){for(var i=new Array(o.length),c=0;c<o.length;c++)i[c]=o[c];return n.builddxmatrix(i)},buildymatrix:function(o){return n(o).transpose()},buildjymatrix:function(o){return o.transpose()},matrixmult:function(o,i){var c,f,h,u,a;if(o.cols()==i.rows()){if(i.rows()>1){for(u=[],c=0;c<o.rows();c++)for(u[c]=[],f=0;f<i.cols();f++){for(a=0,h=0;h<o.cols();h++)a+=o.toArray()[c][h]*i.toArray()[h][f];u[c][f]=a}return n(u)}for(u=[],c=0;c<o.rows();c++)for(u[c]=[],f=0;f<i.cols();f++){for(a=0,h=0;h<o.cols();h++)a+=o.toArray()[c][h]*i.toArray()[f];u[c][f]=a}return n(u)}},regress:function(o,i){var c=n.xtranspxinv(o),f=o.transpose(),h=n.matrixmult(n(c),f);return n.matrixmult(h,i)},regresst:function(o,i,c){var f=n.regress(o,i),h={};h.anova={};var u=n.jMatYBar(o,f);h.yBar=u;var a=i.mean();h.anova.residuals=n.residuals(i,u),h.anova.ssr=n.ssr(u,a),h.anova.msr=h.anova.ssr/(o[0].length-1),h.anova.sse=n.sse(i,u),h.anova.mse=h.anova.sse/(i.length-(o[0].length-1)-1),h.anova.sst=n.sst(i,a),h.anova.mst=h.anova.sst/(i.length-1),h.anova.r2=1-h.anova.sse/h.anova.sst,h.anova.r2<0&&(h.anova.r2=0),h.anova.fratio=h.anova.msr/h.anova.mse,h.anova.pvalue=n.anovaftest(h.anova.fratio,o[0].length-1,i.length-(o[0].length-1)-1),h.anova.rmse=Math.sqrt(h.anova.mse),h.anova.r2adj=1-h.anova.mse/h.anova.mst,h.anova.r2adj<0&&(h.anova.r2adj=0),h.stats=new Array(o[0].length);for(var s=n.xtranspxinv(o),l,d,v,p=0;p<f.length;p++)l=Math.sqrt(h.anova.mse*Math.abs(s[p][p])),d=Math.abs(f[p]/l),v=n.ttest(d,i.length-o[0].length-1,c),h.stats[p]=[f[p],l,d,v];return h.regress=f,h},xtranspx:function(o){return n.matrixmult(o.transpose(),o)},xtranspxinv:function(o){var i=n.matrixmult(o.transpose(),o),c=n.inv(i);return c},jMatYBar:function(o,i){var c=n.matrixmult(o,i);return new n(c)},residuals:function(o,i){return n.matrixsubtract(o,i)},ssr:function(o,i){for(var c=0,f=0;f<o.length;f++)c+=Math.pow(o[f]-i,2);return c},sse:function(o,i){for(var c=0,f=0;f<o.length;f++)c+=Math.pow(o[f]-i[f],2);return c},sst:function(o,i){for(var c=0,f=0;f<o.length;f++)c+=Math.pow(o[f]-i,2);return c},matrixsubtract:function(o,i){for(var c=new Array(o.length),f=0;f<o.length;f++){c[f]=new Array(o[f].length);for(var h=0;h<o[f].length;h++)c[f][h]=o[f][h]-i[f][h]}return n(c)}}),n.jStat=n,n})})(Ja);const j=We(),$t=Ku,{FormulaHelpers:yh,Types:re}=Xe(),J=yh,mo=Zu,Gs=Ja.exports,wh=536870911,Rh=-536870912,Xi=511,go=-512,Nh=/^\s?[+-]?\s?[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?\s?$/,Th=/^\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)?)\s?[ij]\s?$/,Ah=/^\s?([+-]?\s?[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)?)\s?[ij]\s?$/;function xe(e){e=J.accept(e);let t=0,n=0,r="i";if(typeof e=="number")return{real:e,im:n,unit:r};if(typeof e=="boolean")throw j.VALUE;let o=e.match(Nh);if(o)return t=Number(o[0]),{real:t,im:n,unit:r};if(o=e.match(Th),o)return n=Number(/^\s?[+-]?\s?$/.test(o[1])?o[1]+"1":o[1]),r=o[0].slice(-1),{real:t,im:n,unit:r};if(o=e.match(Ah),o)return t=Number(o[1]),n=Number(/^\s?[+-]?\s?$/.test(o[3])?o[3]+"1":o[3]),r=o[0].slice(-1),{real:t,im:n,unit:r};throw j.NUM}const ae={BESSELI:(e,t)=>{if(e=J.accept(e,re.NUMBER_NO_BOOLEAN),t=J.accept(t,re.NUMBER_NO_BOOLEAN),t=Math.trunc(t),t<0)throw j.NUM;return mo.besseli(e,t)},BESSELJ:(e,t)=>{if(e=J.accept(e,re.NUMBER_NO_BOOLEAN),t=J.accept(t,re.NUMBER_NO_BOOLEAN),t=Math.trunc(t),t<0)throw j.NUM;return mo.besselj(e,t)},BESSELK:(e,t)=>{if(e=J.accept(e,re.NUMBER_NO_BOOLEAN),t=J.accept(t,re.NUMBER_NO_BOOLEAN),t=Math.trunc(t),t<0)throw j.NUM;return mo.besselk(e,t)},BESSELY:(e,t)=>{if(e=J.accept(e,re.NUMBER_NO_BOOLEAN),t=J.accept(t,re.NUMBER_NO_BOOLEAN),t=Math.trunc(t),t<0)throw j.NUM;return mo.bessely(e,t)},BIN2DEC:e=>{e=J.accept(e,re.NUMBER_NO_BOOLEAN);let t=e.toString();if(t.length>10)throw j.NUM;return t.length===10&&t.substring(0,1)==="1"?parseInt(t.substring(1),2)+go:parseInt(t,2)},BIN2HEX:(e,t)=>{e=J.accept(e,re.NUMBER_NO_BOOLEAN),t=J.accept(t,re.NUMBER_NO_BOOLEAN,null);const n=e.toString();if(n.length>10)throw j.NUM;if(n.length===10&&n.substring(0,1)==="1")return(parseInt(n.substring(1),2)+0xfffffffe00).toString(16).toUpperCase();const r=parseInt(e,2).toString(16);if(t==null)return r.toUpperCase();if(t<0)throw j.NUM;if(t=Math.trunc(t),t>=r.length)return($t.REPT("0",t-r.length)+r).toUpperCase();throw j.NUM},BIN2OCT:(e,t)=>{e=J.accept(e,re.NUMBER_NO_BOOLEAN),t=J.accept(t,re.NUMBER,null);let n=e.toString();if(n.length>10)throw j.NUM;if(n.length===10&&n.substr(0,1)==="1")return(parseInt(n.substr(1),2)+1073741312).toString(8);let r=parseInt(e,2).toString(8);if(t==null)return r.toUpperCase();if(t<0)throw j.NUM;if(t=Math.trunc(t),t>=r.length)return $t.REPT("0",t-r.length)+r;throw j.NUM},BITAND:(e,t)=>{if(e=J.accept(e,re.NUMBER),t=J.accept(t,re.NUMBER),e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff)throw j.NUM;return e&t},BITLSHIFT:(e,t)=>{if(e=J.accept(e,re.NUMBER),t=J.accept(t,re.NUMBER),t=Math.trunc(t),Math.abs(t)>53||e<0||Math.floor(e)!==e||e>0xffffffffffff)throw j.NUM;const n=t>=0?e*2**t:Math.trunc(e/2**-t);if(n>0xffffffffffff)throw j.NUM;return n},BITOR:(e,t)=>{if(e=J.accept(e,re.NUMBER),t=J.accept(t,re.NUMBER),e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff)throw j.NUM;return e|t},BITRSHIFT:(e,t)=>(e=J.accept(e,re.NUMBER),t=J.accept(t,re.NUMBER),ae.BITLSHIFT(e,-t)),BITXOR:(e,t)=>{if(e=J.accept(e,re.NUMBER),t=J.accept(t,re.NUMBER),e<0||e>0xffffffffffff||Math.floor(e)!==e||t<0||t>0xffffffffffff||Math.floor(t)!==t)throw j.NUM;return e^t},COMPLEX:(e,t,n)=>{if(e=J.accept(e,re.NUMBER_NO_BOOLEAN),t=J.accept(t,re.NUMBER_NO_BOOLEAN),n=J.accept(n,re.STRING,"i"),n!=="i"&&n!=="j")throw j.VALUE;if(e===0&&t===0)return 0;if(e===0)return t===1?n:t===-1?"-"+n:t.toString()+n;if(t===0)return e.toString();{let r=t>0?"+":"";return t===1?e.toString()+r+n:t===-1?e.toString()+r+"-"+n:e.toString()+r+t.toString()+n}},DEC2BIN:(e,t)=>{if(e=J.accept(e,re.NUMBER),t=J.accept(t,re.NUMBER,null),e<go||e>Xi)throw j.NUM;if(e<0)return"1"+$t.REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);let n=parseInt(e,10).toString(2);if(t==null)return n;if(t=Math.trunc(t),t<=0||t<n.length)throw j.NUM;return $t.REPT("0",t-n.length)+n},DEC2HEX:(e,t)=>{if(e=J.accept(e,re.NUMBER),t=J.accept(t,re.NUMBER,null),e<-549755813888||e>549755813888)throw j.NUM;if(e<0)return(1099511627776+e).toString(16).toUpperCase();let n=parseInt(e,10).toString(16);if(t==null)return n.toUpperCase();if(t=Math.trunc(t),t<=0||t<n.length)throw j.NUM;return $t.REPT("0",t-n.length)+n.toUpperCase()},DEC2OCT:(e,t)=>{if(e=J.accept(e,re.NUMBER),t=J.accept(t,re.NUMBER,null),e<-536870912||e>536870912)throw j.NUM;if(e<0)return(e+1073741824).toString(8);let n=parseInt(e,10).toString(8);if(t==null)return n.toUpperCase();if(t=Math.trunc(t),t<=0||t<n.length)throw j.NUM;return $t.REPT("0",t-n.length)+n},DELTA:(e,t)=>(e=J.accept(e,re.NUMBER_NO_BOOLEAN),t=J.accept(t,re.NUMBER_NO_BOOLEAN,0),e===t?1:0),ERF:(e,t)=>(e=J.accept(e,re.NUMBER_NO_BOOLEAN),t=J.accept(t,re.NUMBER_NO_BOOLEAN,0),Gs.erf(e)),ERFC:e=>(e=J.accept(e,re.NUMBER_NO_BOOLEAN),Gs.erfc(e)),GESTEP:(e,t)=>(e=J.accept(e,re.NUMBER_NO_BOOLEAN),t=J.accept(t,re.NUMBER_NO_BOOLEAN,0),e>=t?1:0),HEX2BIN:(e,t)=>{if(e=J.accept(e,re.STRING),t=J.accept(t,re.NUMBER,null),e.length>10||!/^[0-9a-fA-F]*$/.test(e))throw j.NUM;let n=e.length===10&&e.substr(0,1).toLowerCase()==="f",r=n?parseInt(e,16)-1099511627776:parseInt(e,16);if(r<go||r>Xi)throw j.NUM;if(n)return"1"+$t.REPT("0",9-(r+512).toString(2).length)+(r+512).toString(2);let o=r.toString(2);if(t==null)return o;if(t=Math.trunc(t),t<=0||t<o.length)throw j.NUM;return $t.REPT("0",t-o.length)+o},HEX2DEC:e=>{if(e=J.accept(e,re.STRING),e.length>10||!/^[0-9a-fA-F]*$/.test(e))throw j.NUM;let t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},HEX2OCT:(e,t)=>{if(e=J.accept(e,re.STRING),e.length>10||!/^[0-9a-fA-F]*$/.test(e))throw j.NUM;let n=ae.HEX2DEC(e);if(n>wh||n<Rh)throw j.NUM;return ae.DEC2OCT(n,t)},IMABS:e=>{const{real:t,im:n}=xe(e);return Math.sqrt(Math.pow(t,2)+Math.pow(n,2))},IMAGINARY:e=>xe(e).im,IMARGUMENT:e=>{const{real:t,im:n}=xe(e);if(t===0&&n===0)throw j.DIV0;return t===0&&n>0?Math.PI/2:t===0&&n<0?-Math.PI/2:t<0&&n===0?Math.PI:t>0&&n===0?0:t>0?Math.atan(n/t):t<0&&n>0?Math.atan(n/t)+Math.PI:Math.atan(n/t)-Math.PI},IMCONJUGATE:e=>{const{real:t,im:n,unit:r}=xe(e);return n!==0?ae.COMPLEX(t,-n,r):""+t},IMCOS:e=>{const{real:t,im:n,unit:r}=xe(e);let o=Math.cos(t)*(Math.exp(n)+Math.exp(-n))/2,i=-Math.sin(t)*(Math.exp(n)-Math.exp(-n))/2;return ae.COMPLEX(o,i,r)},IMCOSH:e=>{const{real:t,im:n,unit:r}=xe(e);let o=Math.cos(n)*(Math.exp(t)+Math.exp(-t))/2,i=-Math.sin(n)*(Math.exp(t)-Math.exp(-t))/2;return ae.COMPLEX(o,-i,r)},IMCOT:e=>{e=J.accept(e);let t=ae.IMCOS(e),n=ae.IMSIN(e);return ae.IMDIV(t,n)},IMCSC:e=>(e=J.accept(e),ae.IMDIV("1",ae.IMSIN(e))),IMCSCH:e=>(e=J.accept(e),ae.IMDIV("1",ae.IMSINH(e))),IMDIV:(e,t)=>{const n=xe(e),r=n.real,o=n.im,i=n.unit,c=xe(t),f=c.real,h=c.im,u=c.unit;if(f===0&&h===0||i!==u)throw j.NUM;let a=i,s=Math.pow(f,2)+Math.pow(h,2);return ae.COMPLEX((r*f+o*h)/s,(o*f-r*h)/s,a)},IMEXP:e=>{const{real:t,im:n,unit:r}=xe(e);let o=Math.exp(t);return ae.COMPLEX(o*Math.cos(n),o*Math.sin(n),r)},IMLN:e=>{const{real:t,im:n,unit:r}=xe(e);return ae.COMPLEX(Math.log(Math.sqrt(Math.pow(t,2)+Math.pow(n,2))),Math.atan(n/t),r)},IMLOG10:e=>{const{real:t,im:n,unit:r}=xe(e);let o=Math.log(Math.sqrt(Math.pow(t,2)+Math.pow(n,2)))/Math.log(10),i=Math.atan(n/t)/Math.log(10);return ae.COMPLEX(o,i,r)},IMLOG2:e=>{const{real:t,im:n,unit:r}=xe(e);let o=Math.log(Math.sqrt(Math.pow(t,2)+Math.pow(n,2)))/Math.log(2),i=Math.atan(n/t)/Math.log(2);return ae.COMPLEX(o,i,r)},IMPOWER:(e,t)=>{let{unit:n}=xe(e);t=J.accept(t,re.NUMBER_NO_BOOLEAN);let r=Math.pow(ae.IMABS(e),t),o=ae.IMARGUMENT(e),i=r*Math.cos(t*o),c=r*Math.sin(t*o);return ae.COMPLEX(i,c,n)},IMPRODUCT:(...e)=>{let t,n=0;return J.flattenParams(e,null,!1,r=>{if(n===0)t=J.accept(r),xe(t);else{const o=xe(t),i=o.real,c=o.im,f=o.unit,h=xe(r),u=h.real,a=h.im,s=h.unit;if(f!==s)throw j.VALUE;t=ae.COMPLEX(i*u-c*a,i*a+c*u)}n++},1),t},IMREAL:e=>xe(e).real,IMSEC:e=>ae.IMDIV("1",ae.IMCOS(e)),IMSECH:e=>ae.IMDIV("1",ae.IMCOSH(e)),IMSIN:e=>{const{real:t,im:n,unit:r}=xe(e);let o=Math.sin(t)*(Math.exp(n)+Math.exp(-n))/2,i=Math.cos(t)*(Math.exp(n)-Math.exp(-n))/2;return ae.COMPLEX(o,i,r)},IMSINH:e=>{const{real:t,im:n,unit:r}=xe(e);let o=Math.cos(n)*(Math.exp(t)-Math.exp(-t))/2,i=Math.sin(n)*(Math.exp(t)+Math.exp(-t))/2;return ae.COMPLEX(o,i,r)},IMSQRT:e=>{const{unit:t}=xe(e);let n=Math.sqrt(ae.IMABS(e)),r=ae.IMARGUMENT(e);return ae.COMPLEX(n*Math.cos(r/2),n*Math.sin(r/2),t)},IMSUB:(e,t)=>{const n=xe(e),r=n.real,o=n.im,i=n.unit,c=xe(t),f=c.real,h=c.im,u=c.unit;if(i!==u)throw j.VALUE;return ae.COMPLEX(r-f,o-h,i)},IMSUM:(...e)=>{let t=0,n=0,r;return J.flattenParams(e,null,!1,o=>{const{real:i,im:c,unit:f}=xe(o);if(r||(r=f),r!==f)throw j.VALUE;t+=i,n+=c}),ae.COMPLEX(t,n,r)},IMTAN:e=>{const{unit:t}=xe(e);return ae.IMDIV(ae.IMSIN(e),ae.IMCOS(e),t)},OCT2BIN:(e,t)=>{if(e=J.accept(e,re.STRING),t=J.accept(t,re.NUMBER,null),e.length>10||t>10||t!==null&&t<0)throw j.NUM;t=Math.trunc(t);let n=e.length===10&&e.substring(0,1)==="7",r=ae.OCT2DEC(e);if(r<go||r>Xi)return j.NUM;if(n)return"1"+$t.REPT("0",9-(512+r).toString(2).length)+(512+r).toString(2);let o=r.toString(2);if(t===0)return o;if(t<o.length)throw j.NUM;return $t.REPT("0",t-o.length)+o},OCT2DEC:e=>{if(e=J.accept(e,re.STRING),e.length>10)throw j.NUM;for(const n of e)if(n<"0"||n>"7")throw j.NUM;let t=parseInt(e,8);return t>=536870912?t-1073741824:t},OCT2HEX:(e,t)=>{if(e=J.accept(e,re.STRING),t=J.accept(t,re.NUMBER_NO_BOOLEAN,null),e.length>10)throw j.NUM;for(const o of e)if(o<"0"||o>"7")throw j.NUM;if(t=Math.trunc(t),t<0||t>10)throw j.NUM;let n=ae.OCT2DEC(e),r=ae.DEC2HEX(n);if(t===0)return r;if(t<r.length)throw j.NUM;return $t.REPT("0",t-r.length)+r}};var Ch=ae;const Ae=We(),{FormulaHelpers:xh,Types:lt,WildCard:Eo,Address:Oh}=Xe(),Hs=Ei,ve=xh,Ih={ADDRESS:(e,t,n,r,o)=>{if(e=ve.accept(e,lt.NUMBER),t=ve.accept(t,lt.NUMBER),n=ve.accept(n,lt.NUMBER,1),r=ve.accept(r,lt.BOOLEAN,!0),o=ve.accept(o,lt.STRING,""),e<1||t<1||n<1||n>4)throw Ae.VALUE;let i="";return o.length>0&&(/[^A-Za-z_.\d\u007F-\uFFFF]/.test(o)?i+=`'${o}'!`:i+=o+"!"),r?(i+=n===1||n===3?"$":"",i+=Oh.columnNumberToName(t),i+=n===1||n===2?"$":"",i+=e):(i+="R",i+=n===4||n===3?`[${e}]`:e,i+="C",i+=n===4||n===2?`[${t}]`:t),i},AREAS:e=>(e=ve.accept(e),e instanceof Hs?e.length:1),CHOOSE:(e,...t)=>{},COLUMN:(e,t)=>{if(t==null){if(e.position.col!=null)return e.position.col;throw Error("FormulaParser.parse is called without position parameter.")}else{if(typeof t!="object"||Array.isArray(t))throw Ae.VALUE;if(ve.isCellRef(t))return t.ref.col;if(ve.isRangeRef(t))return t.ref.from.col;throw Error("ReferenceFunctions.COLUMN should not reach here.")}},COLUMNS:(e,t)=>{if(t==null)throw Error("COLUMNS requires one argument");if(typeof t!="object"||Array.isArray(t))throw Ae.VALUE;if(ve.isCellRef(t))return 1;if(ve.isRangeRef(t))return Math.abs(t.ref.from.col-t.ref.to.col)+1;throw Error("ReferenceFunctions.COLUMNS should not reach here.")},HLOOKUP:(e,t,n,r)=>{e=ve.accept(e);try{t=ve.accept(t,lt.ARRAY,void 0,!1)}catch(i){throw i instanceof Ae?Ae.NA:i}if(n=ve.accept(n,lt.NUMBER),r=ve.accept(r,lt.BOOLEAN,!0),n<1)throw Ae.VALUE;if(t[n-1]===void 0)throw Ae.REF;const o=typeof e;if(r){let i=o===typeof t[0][0]?t[0][0]:null;for(let c=1;c<t[0].length;c++){const f=t[0][c];if(typeof f===o){if(i>e&&f>e)throw Ae.NA;if(f===e)return t[n-1][c];if(i!=null&&f>e&&i<=e)return t[n-1][c-1];i=f}}if(i==null)throw Ae.NA;return i}else{let i=-1;if(Eo.isWildCard(e)?i=t[0].findIndex(c=>Eo.toRegex(e,"i").test(c)):i=t[0].findIndex(c=>c===e),i===-1)throw Ae.NA;return t[n-1][i]}},INDEX:(e,t,n,r,o)=>{n=e.utils.extractRefValue(n),n={value:n.val,isArray:n.isArray},n=ve.accept(n,lt.NUMBER),n=Math.trunc(n),r==null?r=1:(r=e.utils.extractRefValue(r),r={value:r.val,isArray:r.isArray},r=ve.accept(r,lt.NUMBER,1),r=Math.trunc(r)),o==null?o=1:(o=e.utils.extractRefValue(o),o={value:o.val,isArray:o.isArray},o=ve.accept(o,lt.NUMBER,1),o=Math.trunc(o));let i=t;if(t instanceof Hs)i=t.refs[o-1];else if(o>1)throw Ae.REF;if(n===0&&r===0)return i;if(n===0){if(ve.isRangeRef(i)){if(i.ref.to.col-i.ref.from.col<r-1)throw Ae.REF;return i.ref.from.col+=r-1,i.ref.to.col=i.ref.from.col,i}else if(Array.isArray(i)){const c=[];return i.forEach(f=>c.push([f[r-1]])),c}}if(r===0){if(ve.isRangeRef(i)){if(i.ref.to.row-i.ref.from.row<n-1)throw Ae.REF;return i.ref.from.row+=n-1,i.ref.to.row=i.ref.from.row,i}else if(Array.isArray(i))return i[r-1]}if(n!==0&&r!==0){if(ve.isRangeRef(i)){if(i=i.ref,i.to.row-i.from.row<n-1||i.to.col-i.from.col<r-1)throw Ae.REF;return{ref:{row:i.from.row+n-1,col:i.from.col+r-1}}}else if(ve.isCellRef(i)){if(i=i.ref,n>1||r>1)throw Ae.REF;return{ref:{row:i.row+n-1,col:i.col+r-1}}}else if(Array.isArray(i)){if(i.length<n||i[0].length<r)throw Ae.REF;return i[n-1][r-1]}}},MATCH:()=>{},ROW:(e,t)=>{if(t==null){if(e.position.row!=null)return e.position.row;throw Error("FormulaParser.parse is called without position parameter.")}else{if(typeof t!="object"||Array.isArray(t))throw Ae.VALUE;if(ve.isCellRef(t))return t.ref.row;if(ve.isRangeRef(t))return t.ref.from.row;throw Error("ReferenceFunctions.ROW should not reach here.")}},ROWS:(e,t)=>{if(t==null)throw Error("ROWS requires one argument");if(typeof t!="object"||Array.isArray(t))throw Ae.VALUE;if(ve.isCellRef(t))return 1;if(ve.isRangeRef(t))return Math.abs(t.ref.from.row-t.ref.to.row)+1;throw Error("ReferenceFunctions.ROWS should not reach here.")},TRANSPOSE:e=>{e=ve.accept(e,lt.ARRAY,void 0,!1);const t=[];for(let n=0;n<e[0].length;n++){t[n]=[];for(let r=0;r<e.length;r++)t[n][r]=e[r][n]}return t},VLOOKUP:(e,t,n,r)=>{e=ve.accept(e);try{t=ve.accept(t,lt.ARRAY,void 0,!1)}catch(i){throw i instanceof Ae?Ae.NA:i}if(n=ve.accept(n,lt.NUMBER),r=ve.accept(r,lt.BOOLEAN,!0),n<1)throw Ae.VALUE;if(t[0][n-1]===void 0)throw Ae.REF;const o=typeof e;if(r){let i=o===typeof t[0][0]?t[0][0]:null;for(let c=1;c<t.length;c++){const f=t[c],h=t[c][0];if(typeof h===o){if(i>e&&h>e)throw Ae.NA;if(h===e)return f[n-1];if(i!=null&&h>e&&i<=e)return t[c-1][n-1];i=h}}if(i==null)throw Ae.NA;return i}else{let i=-1;if(Eo.isWildCard(e)?i=t.findIndex(c=>Eo.toRegex(e,"i").test(c[0])):i=t.findIndex(c=>c[0]===e),i===-1)throw Ae.NA;return t[i][n-1]}}};var _h=Ih;const ln=We(),{FormulaHelpers:Mh,Types:bh}=Xe(),je=Mh,Lh={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A":7},Uh={CELL:(e,t)=>{},"ERROR.TYPE":e=>{if(e=je.accept(e),e instanceof ln)return Lh[e.toString()];throw ln.NA},INFO:()=>{},ISBLANK:e=>e.ref?e.value==null||e.value==="":!1,ISERR:e=>(e=je.accept(e),e instanceof ln&&e.toString()!=="#N/A"),ISERROR:e=>(e=je.accept(e),e instanceof ln),ISEVEN:e=>(e=je.accept(e,bh.NUMBER),e=Math.trunc(e),e%2===0),ISLOGICAL:e=>(e=je.accept(e),typeof e=="boolean"),ISNA:e=>(e=je.accept(e),e instanceof ln&&e.toString()==="#N/A"),ISNONTEXT:e=>(e=je.accept(e),typeof e!="string"),ISNUMBER:e=>(e=je.accept(e),typeof e=="number"),ISREF:e=>!e.ref||je.isCellRef(e)&&(e.ref.row>1048576||e.ref.col>16384)||je.isRangeRef(e)&&(e.ref.from.row>1048576||e.ref.from.col>16384||e.ref.to.row>1048576||e.ref.to.col>16384)?!1:(e=je.accept(e),!(e instanceof ln&&e.toString()==="#REF!")),ISTEXT:e=>(e=je.accept(e),typeof e=="string"),N:e=>{e=je.accept(e);const t=typeof e;if(t==="number")return e;if(t==="boolean")return Number(e);if(e instanceof ln)throw e;return 0},NA:()=>{throw ln.NA},TYPE:e=>{if(e.ref){if(je.isRangeRef(e))return 16;if(je.isCellRef(e)&&(e=je.accept(e),typeof e=="string"&&e.length===0))return 1}e=je.accept(e);const t=typeof e;if(t==="number")return 1;if(t==="string")return 2;if(t==="boolean")return 4;if(e instanceof ln)return 16;if(Array.isArray(e))return 64}};var kh=Uh;const K=We(),{FormulaHelpers:Ph,Types:L}=Xe(),U=Ph,Z=Ja.exports,yo=Qu,Sh=2.5066282746310002,Ju={"BETA.DIST":(e,t,n,r,o,i)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),r=U.accept(r,L.BOOLEAN),o=U.accept(o,L.NUMBER,0),i=U.accept(i,L.NUMBER,1),t<=0||n<=0||e<o||e>i||o===i)throw K.NUM;return e=(e-o)/(i-o),r?Z.beta.cdf(e,t,n):Z.beta.pdf(e,t,n)/(i-o)},"BETA.INV":(e,t,n,r,o)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),r=U.accept(r,L.NUMBER,0),o=U.accept(o,L.NUMBER,1),t<=0||n<=0||e<=0||e>1)throw K.NUM;return Z.beta.inv(e,t,n)*(o-r)+r},"BINOM.DIST":(e,t,n,r)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),r=U.accept(r,L.BOOLEAN),t<0||n<0||n>1||e<0||e>t)throw K.NUM;return r?Z.binomial.cdf(e,t,n):Z.binomial.pdf(e,t,n)},"BINOM.DIST.RANGE":(e,t,n,r)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),r=U.accept(r,L.NUMBER,n),e<0||t<0||t>1||n<0||n>e||r<n||r>e)throw K.NUM;let o=0;for(let i=n;i<=r;i++)o+=yo.COMBIN(e,i)*Math.pow(t,i)*Math.pow(1-t,e-i);return o},"BINOM.INV":(e,t,n)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),e<0||t<0||t>1||n<0||n>1)throw K.NUM;let r=0;for(;r<=e;){if(Z.binomial.cdf(r,e,t)>=n)return r;r++}},"CHISQ.DIST":(e,t,n)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),t=Math.trunc(t),e<0||t<1||t>10**10)throw K.NUM;return n?Z.chisquare.cdf(e,t):Z.chisquare.pdf(e,t)},"CHISQ.DIST.RT":(e,t)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),t=Math.trunc(t),e<0||t<1||t>10**10)throw K.NUM;return 1-Z.chisquare.cdf(e,t)},"CHISQ.INV":(e,t)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),t=Math.trunc(t),e<0||e>1||t<1||t>10**10)throw K.NUM;return Z.chisquare.inv(e,t)},"CHISQ.INV.RT":(e,t)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),t=Math.trunc(t),e<0||e>1||t<1||t>10**10)throw K.NUM;return Z.chisquare.inv(1-e,t)},"CHISQ.TEST":(e,t)=>{const n=U.accept(e,L.ARRAY,void 0,!1,!1),r=U.accept(t,L.ARRAY,void 0,!1,!1);if(n.length!==r.length||n[0].length!==r[0].length||n.length===1&&n[0].length===1)throw K.NA;const o=n.length,i=n[0].length;let c=(o-1)*(i-1);o===1?c=i-1:c=o-1;let f=0;for(let l=0;l<o;l++)for(let d=0;d<i;d++)if(!(typeof n[l][d]!="number"||typeof r[l][d]!="number")){if(r[l][d]===0)throw K.DIV0;f+=Math.pow(n[l][d]-r[l][d],2)/r[l][d]}let h=Math.exp(-.5*f);c%2===1&&(h=h*Math.sqrt(2*f/Math.PI));let u=c;for(;u>=2;)h=h*f/u,u=u-2;let a=h,s=c;for(;a>1e-15*h;)s=s+2,a=a*f/s,h=h+a;return 1-h},"CONFIDENCE.NORM":(e,t,n)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),n=Math.trunc(n),e<=0||e>=1||t<=0||n<1)throw K.NUM;return Z.normalci(1,e,t,n)[1]-1},"CONFIDENCE.T":(e,t,n)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),n=Math.trunc(n),e<=0||e>=1||t<=0||n<1)throw K.NUM;if(n===1)throw K.DIV0;return Z.tci(1,e,t,n)[1]-1},CORREL:(e,t)=>{if(e=U.accept(e,L.ARRAY,void 0,!0,!0),t=U.accept(t,L.ARRAY,void 0,!0,!0),e.length!==t.length)throw K.NA;const n=[],r=[];for(let o=0;o<e.length;o++)typeof e[o]!="number"||typeof t[o]!="number"||(n.push(e[o]),r.push(t[o]));if(n.length<=1)throw K.DIV0;return Z.corrcoeff(n,r)},"COVARIANCE.P":(e,t)=>{if(e=U.accept(e,L.ARRAY,void 0,!0,!0),t=U.accept(t,L.ARRAY,void 0,!0,!0),e.length!==t.length)throw K.NA;const n=[],r=[];for(let f=0;f<e.length;f++)typeof e[f]!="number"||typeof t[f]!="number"||(n.push(e[f]),r.push(t[f]));const o=Z.mean(n),i=Z.mean(r);let c=0;for(let f=0;f<n.length;f++)c+=(n[f]-o)*(r[f]-i);return c/n.length},"COVARIANCE.S":(e,t)=>{if(e=U.accept(e,L.ARRAY,void 0,!0,!0),t=U.accept(t,L.ARRAY,void 0,!0,!0),e.length!==t.length)throw K.NA;const n=[],r=[];for(let o=0;o<e.length;o++)typeof e[o]!="number"||typeof t[o]!="number"||(n.push(e[o]),r.push(t[o]));if(n.length<=1)throw K.DIV0;return Z.covariance(n,r)},DEVSQ:(...e)=>{let t=0,n=[];U.flattenParams(e,L.NUMBER,!0,(o,i)=>{typeof o=="number"&&(t+=o,n.push(o))});const r=t/n.length;t=0;for(let o=0;o<n.length;o++)t+=(n[o]-r)**2;return t},"EXPON.DIST":(e,t,n)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.BOOLEAN),e<0||t<=0)throw K.NUM;return n?Z.exponential.cdf(e,t):Z.exponential.pdf(e,t)},"F.DIST":(e,t,n,r)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),r=U.accept(r,L.BOOLEAN),e<0||t<1||n<1)throw K.NUM;return t=Math.trunc(t),n=Math.trunc(n),r?Z.centralF.cdf(e,t,n):Z.centralF.pdf(e,t,n)},"F.DIST.RT":(e,t,n)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),e<0||t<1||n<1)throw K.NUM;return t=Math.trunc(t),n=Math.trunc(n),1-Z.centralF.cdf(e,t,n)},"F.INV":(e,t,n)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),e<0||e>1||t<1||n<1)throw K.NUM;return t=Math.trunc(t),n=Math.trunc(n),Z.centralF.inv(e,t,n)},"F.INV.RT":(e,t,n)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),e<0||e>1||t<1||t>=Math.pow(10,10)||n<1||n>=Math.pow(10,10))throw K.NUM;return t=Math.trunc(t),n=Math.trunc(n),Z.centralF.inv(1-e,t,n)},"F.TEST":(e,t)=>{e=U.accept(e,L.ARRAY,void 0,!0,!0),t=U.accept(t,L.ARRAY,void 0,!0,!0);const n=[],r=[];let o=0,i=0;for(let h=0;h<Math.max(e.length,t.length);h++)typeof e[h]=="number"&&(n.push(e[h]),o+=e[h]),typeof t[h]=="number"&&(r.push(t[h]),i+=t[h]);if(n.length<=1||r.length<=1)throw K.DIV0;o/=n.length,i/=r.length;let c=0,f=0;for(let h=0;h<n.length;h++)c+=(o-n[h])**2;c/=n.length-1;for(let h=0;h<r.length;h++)f+=(i-r[h])**2;return f/=r.length-1,Z.centralF.cdf(c/f,n.length-1,r.length-1)*2},FISHER:e=>{if(e=U.accept(e,L.NUMBER),e<=-1||e>=1)throw K.NUM;return Math.log((1+e)/(1-e))/2},FISHERINV:e=>{e=U.accept(e,L.NUMBER);let t=Math.exp(2*e);return(t-1)/(t+1)},FORECAST:(e,t,n)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.ARRAY,void 0,!0,!0),n=U.accept(n,L.ARRAY,void 0,!0,!0),n.length!==t.length)throw K.NA;const r=[],o=[];let i=!0;for(let l=0;l<t.length;l++)typeof t[l]!="number"||typeof n[l]!="number"||(r.push(t[l]),o.push(n[l]),n[l]!==n[0]&&(i=!1));if(i)throw K.DIV0;const c=Z.mean(r),f=Z.mean(o);let h=0,u=0;for(let l=0;l<r.length;l++)h+=(o[l]-f)*(r[l]-c),u+=(o[l]-f)**2;const a=h/u;return c-a*f+a*e},"FORECAST.ETS":()=>{},"FORECAST.ETS.CONFINT":()=>{},"FORECAST.ETS.SEASONALITY":()=>{},"FORECAST.ETS.STAT":()=>{},"FORECAST.LINEAR":(...e)=>Ju.FORECAST(...e),FREQUENCY:(e,t)=>{e=U.accept(e,L.ARRAY,void 0,!0,!0),t=U.accept(t,L.ARRAY,void 0,!0,!0);const n=[];for(let o=0;o<t.length;o++)typeof t[o]=="number"&&n.push(t[o]);n.sort(),n.push(1/0);const r=[];for(let o=0;o<n.length;o++){r[o]=[],r[o][0]=0;for(let i=0;i<e.length;i++){if(typeof e[i]!="number")continue;e[i]<=n[o]&&(r[o][0]++,e[i]=null)}}return r},GAMMA:e=>{if(e=U.accept(e,L.NUMBER),e===0||e<0&&e===Math.trunc(e))throw K.NUM;return Z.gammafn(e)},"GAMMA.DIST":(e,t,n,r)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),r=U.accept(r,L.BOOLEAN),e<0||t<=0||n<=0)throw K.NUM;return r?Z.gamma.cdf(e,t,n,!0):Z.gamma.pdf(e,t,n,!1)},"GAMMA.INV":(e,t,n)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),e<0||e>1||t<=0||n<=0)throw K.NUM;return Z.gamma.inv(e,t,n)},GAMMALN:e=>{if(e=U.accept(e,L.NUMBER),e<=0)throw K.NUM;return Z.gammaln(e)},"GAMMALN.PRECISE":e=>{if(e=U.accept(e,L.NUMBER),e<=0)throw K.NUM;return Z.gammaln(e)},GAUSS:e=>(e=U.accept(e,L.NUMBER),Z.normal.cdf(e,0,1)-.5),GEOMEAN:(...e)=>{const t=[];return U.flattenParams(e,L.NUMBER,!0,(n,r)=>{typeof n=="number"&&t.push(n)}),Z.geomean(t)},GROWTH:(e,t,n,r)=>{e=U.accept(e,L.ARRAY,void 0,!0,!0);for(let d=0;d<e.length;d++)if(typeof e[d]!="number")throw K.VALUE;t=U.accept(t,L.ARRAY,null,!0,!0);const o=t==null;if(t==null){t=[];for(let d=1;d<=e.length;d++)t.push(d)}else{if(t.length!==e.length)throw K.REF;for(let d=0;d<t.length;d++)if(typeof t[d]!="number")throw K.VALUE}if(n=U.accept(n,L.ARRAY,null,!1,!0),n==null&&o){n=[];for(let d=1;d<=e.length;d++)n.push(d);n=[n]}else n==null&&(n=Array.isArray(t[0])?t:[t]);r=U.accept(r,L.BOOLEAN,!0);const i=e.length;let c=0,f=0,h=0,u=0;for(let d=0;d<i;d++){const v=t[d],p=Math.log(e[d]);c+=v,f+=p,h+=v*p,u+=v*v}c/=i,f/=i,h/=i,u/=i;let a,s;r?(a=(h-c*f)/(u-c*c),s=f-a*c):(a=h/u,s=0);const l=[];for(let d=0;d<n.length;d++){l[d]=[];for(let v=0;v<n[0].length;v++){if(typeof n[d][v]!="number")throw K.VALUE;l[d][v]=Math.exp(s+a*n[d][v])}}return l},HARMEAN:(...e)=>{let t=0,n=0;return U.flattenParams(e,L.NUMBER,!0,(r,o)=>{typeof r=="number"&&(n+=1/r,t++)}),t/n},"HYPGEOM.DIST":(e,t,n,r,o)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),r=U.accept(r,L.NUMBER),o=U.accept(o,L.BOOLEAN),e=Math.trunc(e),t=Math.trunc(t),n=Math.trunc(n),r=Math.trunc(r),r<=0||e<0||t<=0||n<=0||t>r||n>r||t<e||n<e||e<t-r+n)throw K.NUM;function i(f,h,u,a){return yo.COMBIN(u,f)*yo.COMBIN(a-u,h-f)/yo.COMBIN(a,h)}function c(f,h,u,a){let s=0;for(let l=0;l<=f;l++)s+=i(l,h,u,a);return s}return o?c(e,t,n,r):i(e,t,n,r)},INTERCEPT:(e,t)=>{if(e=U.accept(e,L.ARRAY,void 0,!0,!0),t=U.accept(t,L.ARRAY,void 0,!0,!0),t.length!==e.length)throw K.NA;const n=[],r=[];for(let u=0;u<e.length;u++)typeof e[u]!="number"||typeof t[u]!="number"||(n.push(e[u]),r.push(t[u]));if(n.length<=1)throw K.DIV0;const o=Z.mean(n),i=Z.mean(r);let c=0,f=0;for(let u=0;u<n.length;u++)c+=(r[u]-i)*(n[u]-o),f+=(r[u]-i)**2;const h=c/f;return o-h*i},KURT:(...e)=>{let t=0,n=[];U.flattenParams(e,L.NUMBER,!0,(i,c)=>{typeof i=="number"&&(t+=i,n.push(i))});const r=n.length;t/=r;let o=0;for(let i=0;i<r;i++)o+=Math.pow(n[i]-t,4);return o=o/Math.pow(Z.stdev(n,!0),4),r*(r+1)/((r-1)*(r-2)*(r-3))*o-3*(r-1)*(r-1)/((r-2)*(r-3))},LINEST:()=>{},LOGEST:()=>{},"LOGNORM.DIST":(e,t,n,r)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),r=U.accept(r,L.BOOLEAN),e<=0||n<=0)throw K.NUM;return r?Z.lognormal.cdf(e,t,n):Z.lognormal.pdf(e,t,n)},"LOGNORM.INV":(e,t,n)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),e<=0||e>=1||n<=0)throw K.NUM;return Z.lognormal.inv(e,t,n)},"MODE.MULT":()=>{},"MODE.SNGL":()=>{},"NEGBINOM.DIST":(e,t,n,r)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),r=U.accept(r,L.BOOLEAN),e=Math.trunc(e),t=Math.trunc(t),n<0||n>1||e<0||t<1)throw K.NUM;return r?Z.negbin.cdf(e,t,n):Z.negbin.pdf(e,t,n)},"NORM.DIST":(e,t,n,r)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),r=U.accept(r,L.BOOLEAN),n<=0)throw K.NUM;return r?Z.normal.cdf(e,t,n):Z.normal.pdf(e,t,n)},"NORM.INV":(e,t,n)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),e<=0||e>=1||n<=0)throw K.NUM;return Z.normal.inv(e,t,n)},"NORM.S.DIST":(e,t)=>(e=U.accept(e,L.NUMBER),t=U.accept(t,L.BOOLEAN),t?Z.normal.cdf(e,0,1):Z.normal.pdf(e,0,1)),"NORM.S.INV":e=>{if(e=U.accept(e,L.NUMBER),e<=0||e>=1)throw K.NUM;return Z.normal.inv(e,0,1)},PEARSON:()=>{},"PERCENTILE.EXC":()=>{},"PERCENTILE.INC":()=>{},"PERCENTRANK.EXC":()=>{},"PERCENTRANK.INC":()=>{},PERMUTATIONA:()=>{},PHI:e=>(e=U.accept(e,L.NUMBER),Math.exp(-.5*e*e)/Sh),"POISSON.DIST":(e,t,n)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.BOOLEAN),e<0||t<0)throw K.NUM;return e=Math.trunc(e),n?Z.poisson.cdf(e,t):Z.poisson.pdf(e,t)},PROB:()=>{},"QUARTILE.EXC":()=>{},"QUARTILE.INC":()=>{},"RANK.AVG":()=>{},"RANK.EQ":()=>{},RSQ:()=>{},SKEW:()=>{},"SKEW.P":()=>{},SLOPE:()=>{},STANDARDIZE:(e,t,n)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),n<=0)throw K.NUM;return(e-t)/n},"STDEV.P":()=>{},"STDEV.S":()=>{},STDEVA:()=>{},STDEVPA:()=>{},STEYX:()=>{},"T.DIST":(e,t,n)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.BOOLEAN),t<1)throw K.NUM;return n?Z.studentt.cdf(e,t):Z.studentt.pdf(e,t)},"T.DIST.2T":(e,t)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),t<1||e<0)throw K.NUM;return(1-Z.studentt.cdf(e,t))*2},"T.DIST.RT":(e,t)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),t<1)throw K.NUM;return 1-Z.studentt.cdf(e,t)},"T.INV":(e,t)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),e<=0||e>1||t<1)throw K.NUM;return t=t%1===0?t:Math.trunc(t),Z.studentt.inv(e,t)},"T.INV.2T":(e,t)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),e<=0||e>1||t<1)throw K.NUM;return t=t%1===0?t:Math.trunc(t),Math.abs(Z.studentt.inv(e/2,t))},"T.TEST":()=>{},TREND:()=>{},TRIMMEAN:()=>{},"VAR.P":()=>{},"VAR.S":()=>{},VARA:()=>{},VARPA:()=>{},"WEIBULL.DIST":(e,t,n,r)=>{if(e=U.accept(e,L.NUMBER),t=U.accept(t,L.NUMBER),n=U.accept(n,L.NUMBER),r=U.accept(r,L.BOOLEAN),e<0||t<=0||n<=0)throw K.NUM;return r?1-Math.exp(-Math.pow(e/n,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/n,t))*t/Math.pow(n,t)},"Z.TEST":()=>{}};var Fh={DistributionFunctions:Ju};const Bh=We(),{FormulaHelpers:Dh,Types:wo,Criteria:Ws,Address:MN}=Xe(),{Infix:zs}=Za,fn=Dh,{DistributionFunctions:$h}=Fh,Vh={AVEDEV:(...e)=>{let t=0;const n=[];fn.flattenParams(e,wo.NUMBER,!0,(o,i)=>{typeof o=="number"&&(t+=o,n.push(o))});const r=t/n.length;t=0;for(let o=0;o<n.length;o++)t+=Math.abs(n[o]-r);return t/n.length},AVERAGE:(...e)=>{let t=0,n=0;return fn.flattenParams(e,wo.NUMBER,!0,(r,o)=>{typeof r=="number"&&(t+=r,n++)}),t/n},AVERAGEA:(...e)=>{let t=0,n=0;return fn.flattenParams(e,wo.NUMBER,!0,(r,o)=>{const i=typeof r;i==="number"?(t+=r,n++):i==="string"&&n++}),t/n},AVERAGEIF:(e,t,n,r)=>{const o=fn.retrieveRanges(e,t,r);t=o[0],r=o[1],n=fn.retrieveArg(e,n);const i=n.isArray;n=Ws.parse(fn.accept(n));let c=0,f=0;if(t.forEach((h,u)=>{h.forEach((a,s)=>{const l=r[u][s];typeof l=="number"&&(n.op==="wc"?n.match===n.value.test(a)&&(c+=l,f++):zs.compareOp(a,n.op,n.value,Array.isArray(a),i)&&(c+=l,f++))})}),f===0)throw Bh.DIV0;return c/f},AVERAGEIFS:()=>{},COUNT:(...e)=>{let t=0;return fn.flattenParams(e,null,!0,(n,r)=>{(r.isLiteral&&!isNaN(n)||typeof n=="number")&&t++}),t},COUNTIF:(e,t)=>{e=fn.accept(e,wo.ARRAY,void 0,!1,!0);const n=t.isArray;t=fn.accept(t);let r=0;return t=Ws.parse(t),e.forEach(o=>{o.forEach(i=>{t.op==="wc"?t.match===t.value.test(i)&&r++:zs.compareOp(i,t.op,t.value,Array.isArray(i),n)&&r++})}),r},LARGE:()=>{},MAX:()=>{},MAXA:()=>{},MAXIFS:()=>{},MEDIAN:()=>{},MIN:()=>{},MINA:()=>{},MINIFS:()=>{},PERMUT:()=>{},PERMUTATIONA:()=>{},SMALL:()=>{}};var Gh=Object.assign(Vh,$h);const Nt=We(),{FormulaHelpers:Hh,Types:qe}=Xe(),Pe=Hh,Ro=1e3*60*60*24,Na=new Date(Date.UTC(1900,0,1)),Wh=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],zh=[void 0,[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],void 0,void 0,void 0,void 0,void 0,void 0,void 0,[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],qs=[void 0,[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0],[1],[2],[3],[4],[5],[6]],qh=/^\s*(\d\d?)\s*(:\s*\d\d?)?\s*(:\s*\d\d?)?\s*(pm|am)?\s*$/i,Kh=/^\s*((\d\d?)\s*([-\/])\s*(\d\d?))([\d:.apm\s]*)$/i,Yh=/^\s*((\d\d?)\s*([-/])\s*(jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*))([\d:.apm\s]*)$/i,Xh=/^\s*((jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*)\s*([-/])\s*(\d\d?))([\d:.apm\s]*)$/i;function Qh(e){const t=e.match(Kh),n=e.match(Yh),r=e.match(Xh);return t?e=t[1]+t[3]+new Date().getFullYear()+t[5]:n?e=n[1]+n[3]+new Date().getFullYear()+n[5]:r&&(e=r[1]+r[3]+new Date().getFullYear()+r[5]),new Date(Date.parse(`${e} UTC`))}function Zh(e){const t=e.match(qh);if(!t)return;const n=t[2]?t[2]:":00",r=t[3]?t[3]:":00",o=t[4]?" "+t[4]:"",i=new Date(Date.parse(`1/1/1900 ${t[1]+n+r+o} UTC`));let c=new Date;return c=new Date(Date.UTC(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds(),c.getMilliseconds())),new Date(Date.UTC(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds(),i.getUTCMilliseconds()))}function Yn(e){const t=e>-22038912e5?2:1;return Math.floor((e-Na)/864e5)+t}function Jh(e){if(e<0)throw Nt.VALUE;return e<=60?new Date(Na.getTime()+(e-1)*864e5):new Date(Na.getTime()+(e-2)*864e5)}function ju(e){if(e instanceof Date)return{date:e};e=Pe.accept(e);let t=!0,n;return isNaN(e)?(n=Zh(e),n?t=!1:n=Qh(e)):(e=Number(e),n=Jh(e)),{date:n,isDateGiven:t}}function ge(e){return ju(e).date}function Qi(e,t){return e.getUTCFullYear()===t.getUTCFullYear()&&e.getUTCMonth()===t.getUTCMonth()&&e.getUTCDate()===t.getUTCDate()}function jh(e){return e===1900?!0:new Date(e,1,29).getMonth()===1}const Xn={DATE:(e,t,n)=>{if(e=Pe.accept(e,qe.NUMBER),t=Pe.accept(t,qe.NUMBER),n=Pe.accept(n,qe.NUMBER),e<0||e>=1e4)throw Nt.NUM;return e<1900&&(e+=1900),Yn(Date.UTC(e,t-1,n))},DATEDIF:(e,t,n)=>{if(e=ge(e),t=ge(t),n=Pe.accept(n,qe.STRING).toLowerCase(),e>t)throw Nt.NUM;const r=t.getUTCFullYear()-e.getUTCFullYear(),o=t.getUTCMonth()-e.getUTCMonth(),i=t.getUTCDate()-e.getUTCDate();let c;switch(n){case"y":return c=o<0||o===0&&i<0?-1:0,c+r;case"m":return c=i<0?-1:0,r*12+o+c;case"d":return Math.floor(t-e)/Ro;case"md":return e.setUTCFullYear(t.getUTCFullYear()),i<0?e.setUTCMonth(t.getUTCMonth()-1):e.setUTCMonth(t.getUTCMonth()),Math.floor(t-e)/Ro;case"ym":return c=i<0?-1:0,(c+r*12+o)%12;case"yd":return o<0||o===0&&i<0?e.setUTCFullYear(t.getUTCFullYear()-1):e.setUTCFullYear(t.getUTCFullYear()),Math.floor(t-e)/Ro}},DATEVALUE:e=>{e=Pe.accept(e,qe.STRING);const{date:t,isDateGiven:n}=ju(e);if(!n)return 0;const r=Yn(t);if(r<0||r>2958465)throw Nt.VALUE;return r},DAY:e=>ge(e).getUTCDate(),DAYS:(e,t)=>{e=ge(e),t=ge(t);let n=0;return t<-22038912e5&&-22038912e5<e&&(n=1),Math.floor(e-t)/Ro+n},DAYS360:(e,t,n)=>{e=ge(e),t=ge(t),n=Pe.accept(n,qe.BOOLEAN,!1),e.getUTCDate()===31&&e.setUTCDate(30),!n&&e.getUTCDate()<30&&t.getUTCDate()>30?t.setUTCMonth(t.getUTCMonth()+1,1):t.getUTCDate()===31&&t.setUTCDate(30);const r=t.getUTCFullYear()-e.getUTCFullYear(),o=t.getUTCMonth()-e.getUTCMonth(),i=t.getUTCDate()-e.getUTCDate();return o*30+i+r*12*30},EDATE:(e,t)=>(e=ge(e),t=Pe.accept(t,qe.NUMBER),e.setUTCMonth(e.getUTCMonth()+t),Yn(e)),EOMONTH:(e,t)=>(e=ge(e),t=Pe.accept(t,qe.NUMBER),e.setUTCMonth(e.getUTCMonth()+t+1,0),Yn(e)),HOUR:e=>ge(e).getUTCHours(),ISOWEEKNUM:e=>{const t=ge(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),r=n.getUTCDay();n.setUTCDate(n.getUTCDate()+4-r);const o=new Date(Date.UTC(n.getUTCFullYear(),0,1));return Math.ceil(((n-o)/864e5+1)/7)},MINUTE:e=>ge(e).getUTCMinutes(),MONTH:e=>ge(e).getUTCMonth()+1,NETWORKDAYS:(e,t,n)=>{e=ge(e),t=ge(t);let r=1;if(e>t){r=-1;const c=e;e=t,t=c}const o=[];n!=null&&Pe.flattenParams([n],qe.NUMBER,!1,c=>{o.push(ge(c))});let i=0;for(;e<=t;){if(e.getUTCDay()!==0&&e.getUTCDay()!==6){let c=!1;for(let f=0;f<o.length;f++)if(Qi(e,o[f])){c=!0;break}c||i++}e.setUTCDate(e.getUTCDate()+1)}return r*i},"NETWORKDAYS.INTL":(e,t,n,r)=>{e=ge(e),t=ge(t);let o=1;if(e>t){o=-1;const f=e;e=t,t=f}if(n=Pe.accept(n,null,1),n==="1111111")return 0;if(typeof n=="string"&&Number(n).toString()!==n){if(n.length!==7)throw Nt.VALUE;n=n.charAt(6)+n.slice(0,6);const f=[];for(let h=0;h<n.length;h++)n.charAt(h)==="1"&&f.push(h);n=f}else{if(typeof n!="number")throw Nt.VALUE;n=qs[n]}const i=[];r!=null&&Pe.flattenParams([r],qe.NUMBER,!1,f=>{i.push(ge(f))});let c=0;for(;e<=t;){let f=!1;for(let h=0;h<n.length;h++)if(n[h]===e.getUTCDay()){f=!0;break}if(!f){let h=!1;for(let u=0;u<i.length;u++)if(Qi(e,i[u])){h=!0;break}h||c++}e.setUTCDate(e.getUTCDate()+1)}return o*c},NOW:()=>{const e=new Date;return Yn(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))+(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},SECOND:e=>ge(e).getUTCSeconds(),TIME:(e,t,n)=>{if(e=Pe.accept(e,qe.NUMBER),t=Pe.accept(t,qe.NUMBER),n=Pe.accept(n,qe.NUMBER),e<0||e>32767||t<0||t>32767||n<0||n>32767)throw Nt.NUM;return(3600*e+60*t+n)/86400},TIMEVALUE:e=>(e=ge(e),(3600*e.getUTCHours()+60*e.getUTCMinutes()+e.getUTCSeconds())/86400),TODAY:()=>{const e=new Date;return Yn(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))},WEEKDAY:(e,t)=>{const n=ge(e);t=Pe.accept(t,qe.NUMBER,1);const r=n.getUTCDay(),o=zh[t];if(!o)throw Nt.NUM;return o[r]},WEEKNUM:(e,t)=>{const n=ge(e);if(t=Pe.accept(t,qe.NUMBER,1),t===21)return Xn.ISOWEEKNUM(e);const r=Wh[t],o=new Date(Date.UTC(n.getUTCFullYear(),0,1)),i=o.getUTCDay()<r?1:0;return Math.ceil(((n-o)/864e5+1)/7)+i},WORKDAY:(e,t,n)=>Xn["WORKDAY.INTL"](e,t,1,n),"WORKDAY.INTL":(e,t,n,r)=>{if(e=ge(e),t=Pe.accept(t,qe.NUMBER),n=Pe.accept(n,null,1),n==="1111111")throw Nt.VALUE;if(typeof n=="string"&&Number(n).toString()!==n){if(n.length!==7)throw Nt.VALUE;n=n.charAt(6)+n.slice(0,6);const c=[];for(let f=0;f<n.length;f++)n.charAt(f)==="1"&&c.push(f);n=c}else{if(typeof n!="number")throw Nt.VALUE;if(n=qs[n],n==null)throw Nt.NUM}const o=[];r!=null&&Pe.flattenParams([r],qe.NUMBER,!1,c=>{o.push(ge(c))}),e.setUTCDate(e.getUTCDate()+1);let i=0;for(;i<t;){let c=!1;for(let f=0;f<n.length;f++)if(n[f]===e.getUTCDay()){c=!0;break}if(!c){let f=!1;for(let h=0;h<o.length;h++)if(Qi(e,o[h])){f=!0;break}f||i++}e.setUTCDate(e.getUTCDate()+1)}return Yn(e)-1},YEAR:e=>ge(e).getUTCFullYear(),YEARFRAC:(e,t,n)=>{if(e=ge(e),t=ge(t),e>t){const u=e;e=t,t=u}if(n=Pe.accept(n,qe.NUMBER,0),n=Math.trunc(n),n<0||n>4)throw Nt.VALUE;let r=e.getUTCDate();const o=e.getUTCMonth()+1,i=e.getUTCFullYear();let c=t.getUTCDate();const f=t.getUTCMonth()+1,h=t.getUTCFullYear();switch(n){case 0:return r===31&&c===31?(r=30,c=30):r===31?r=30:r===30&&c===31&&(c=30),Math.abs(c+f*30+h*360-(r+o*30+i*360))/360;case 1:if(h-i<2){const u=jh(i)&&i!==1900?366:365;return Xn.DAYS(t,e)/u}else{const u=h-i+1,s=(new Date(h+1,0,1)-new Date(i,0,1))/1e3/60/60/24/u;return Xn.DAYS(t,e)/s}case 2:return Math.abs(Xn.DAYS(t,e)/360);case 3:return Math.abs(Xn.DAYS(t,e)/365);case 4:return Math.abs(c+f*30+h*360-(r+o*30+i*360))/360}}};var ep=Xn;const tp=We(),{FormulaHelpers:np,Types:rp}=Xe(),op=np,ip={ENCODEURL:e=>encodeURIComponent(op.accept(e,rp.STRING)),FILTERXML:()=>{},WEBSERVICE:(e,t)=>{throw tp.ERROR("WEBSERVICE is not supported in sync mode.")}};var ap=ip,Ta="7.1.2";function Re(e){return e&&e.length===0}function Wt(e){return e==null?[]:Object.keys(e)}function Et(e){for(var t=[],n=Object.keys(e),r=0;r<n.length;r++)t.push(e[n[r]]);return t}function sp(e,t){for(var n=[],r=Wt(e),o=0;o<r.length;o++){var i=r[o];n.push(t.call(null,e[i],i))}return n}function Y(e,t){for(var n=[],r=0;r<e.length;r++)n.push(t.call(null,e[r],r));return n}function Ot(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?t=t.concat(Ot(r)):t.push(r)}return t}function zt(e){return Re(e)?void 0:e[0]}function el(e){var t=e&&e.length;return t?e[t-1]:void 0}function ee(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t.call(null,e[n],n);else if(es(e))for(var r=Wt(e),n=0;n<r.length;n++){var o=r[n],i=e[o];t.call(null,i,o)}else throw Error("non exhaustive match")}function nn(e){return typeof e=="string"}function Rn(e){return e===void 0}function Vn(e){return e instanceof Function}function et(e,t){return t===void 0&&(t=1),e.slice(t,e.length)}function $r(e,t){return t===void 0&&(t=1),e.slice(0,e.length-t)}function qt(e,t){var n=[];if(Array.isArray(e))for(var r=0;r<e.length;r++){var o=e[r];t.call(null,o)&&n.push(o)}return n}function Rr(e,t){return qt(e,function(n){return!t(n)})}function Kt(e,t){for(var n=Object.keys(e),r={},o=0;o<n.length;o++){var i=n[o],c=e[i];t(c)&&(r[i]=c)}return r}function ne(e,t){return es(e)?e.hasOwnProperty(t):!1}function He(e,t){return Er(e,function(n){return n===t})!==void 0}function yt(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}function Jr(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function Er(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(t.call(null,r))return r}}function cp(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r];t.call(null,o)&&n.push(o)}return n}function tt(e,t,n){for(var r=Array.isArray(e),o=r?e:Et(e),i=r?[]:Wt(e),c=n,f=0;f<o.length;f++)c=t.call(null,c,o[f],r?f:i[f]);return c}function jr(e){return Rr(e,function(t){return t==null})}function ja(e,t){t===void 0&&(t=function(r){return r});var n=[];return tt(e,function(r,o){var i=t(o);return He(n,i)?r:(n.push(i),r.concat(o))},[])}function en(e){return Array.isArray(e)}function Nn(e){return e instanceof RegExp}function es(e){return e instanceof Object}function Ut(e,t){for(var n=0;n<e.length;n++)if(!t(e[n],n))return!1;return!0}function yi(e,t){return Rr(e,function(n){return He(t,n)})}function tl(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return!0;return!1}function up(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}function Yt(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++)for(var o=t[r],i=Wt(o),c=0;c<i.length;c++){var f=i[c];e[f]=o[f]}return e}function lp(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++)for(var o=t[r],i=Wt(o),c=0;c<i.length;c++){var f=i[c];ne(e,f)||(e[f]=o[f])}return e}function ts(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return lp.apply(null,[{}].concat(e))}function fp(e,t){var n={};return ee(e,function(r){var o=t(r),i=n[o];i?i.push(r):n[o]=[r]}),n}function Ks(e,t){for(var n=Jr(e),r=Wt(t),o=0;o<r.length;o++){var i=r[o],c=t[i];n[i]=c}return n}function Ke(){}function Ys(e){return e}function dp(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];t.push(r!==void 0?r:void 0)}return t}function Aa(e){console&&console.error&&console.error("Error: "+e)}function nl(e){console&&console.warn&&console.warn("Warning: "+e)}function Xs(){return typeof Map=="function"}function hp(e,t){t.forEach(function(n){var r=n.prototype;Object.getOwnPropertyNames(r).forEach(function(o){if(o!=="constructor"){var i=Object.getOwnPropertyDescriptor(r,o);i&&(i.get||i.set)?Object.defineProperty(e.prototype,o,i):e.prototype[o]=n.prototype[o]}})})}function rl(e){function t(){}t.prototype=e;var n=new t;function r(){return typeof n.bar}return r(),r(),e}function Jo(e){return e[e.length-1]}function ol(e){var t=new Date().getTime(),n=e(),r=new Date().getTime(),o=r-t;return{time:o,value:n}}var Nr={exports:{}};(function(e){(function(t,n){e.exports?e.exports=n():t.regexpToAst=n()})(typeof self<"u"?self:Mu,function(){function t(){}t.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},t.prototype.restoreState=function(p){this.idx=p.idx,this.input=p.input,this.groupIdx=p.groupIdx},t.prototype.pattern=function(p){this.idx=0,this.input=p,this.groupIdx=0,this.consumeChar("/");var m=this.disjunction();this.consumeChar("/");for(var g={type:"Flags",loc:{begin:this.idx,end:p.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":f(g,"global");break;case"i":f(g,"ignoreCase");break;case"m":f(g,"multiLine");break;case"u":f(g,"unicode");break;case"y":f(g,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:g,value:m,loc:this.loc(0)}},t.prototype.disjunction=function(){var p=[],m=this.idx;for(p.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),p.push(this.alternative());return{type:"Disjunction",value:p,loc:this.loc(m)}},t.prototype.alternative=function(){for(var p=[],m=this.idx;this.isTerm();)p.push(this.term());return{type:"Alternative",value:p,loc:this.loc(m)}},t.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},t.prototype.assertion=function(){var p=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(p)};case"$":return{type:"EndAnchor",loc:this.loc(p)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(p)};case"B":return{type:"NonWordBoundary",loc:this.loc(p)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var m;switch(this.popChar()){case"=":m="Lookahead";break;case"!":m="NegativeLookahead";break}h(m);var g=this.disjunction();return this.consumeChar(")"),{type:m,value:g,loc:this.loc(p)}}u()},t.prototype.quantifier=function(p){var m,g=this.idx;switch(this.popChar()){case"*":m={atLeast:0,atMost:1/0};break;case"+":m={atLeast:1,atMost:1/0};break;case"?":m={atLeast:0,atMost:1};break;case"{":var E=this.integerIncludingZero();switch(this.popChar()){case"}":m={atLeast:E,atMost:E};break;case",":var y;this.isDigit()?(y=this.integerIncludingZero(),m={atLeast:E,atMost:y}):m={atLeast:E,atMost:1/0},this.consumeChar("}");break}if(p===!0&&m===void 0)return;h(m);break}if(!(p===!0&&m===void 0))return h(m),this.peekChar(0)==="?"?(this.consumeChar("?"),m.greedy=!1):m.greedy=!0,m.type="Quantifier",m.loc=this.loc(g),m},t.prototype.atom=function(){var p,m=this.idx;switch(this.peekChar()){case".":p=this.dotAll();break;case"\\":p=this.atomEscape();break;case"[":p=this.characterClass();break;case"(":p=this.group();break}return p===void 0&&this.isPatternCharacter()&&(p=this.patternCharacter()),h(p),p.loc=this.loc(m),this.isQuantifier()&&(p.quantifier=this.quantifier()),p},t.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[i(`
`),i("\r"),i("\u2028"),i("\u2029")]}},t.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},t.prototype.decimalEscapeAtom=function(){var p=this.positiveInteger();return{type:"GroupBackReference",value:p}},t.prototype.characterClassEscape=function(){var p,m=!1;switch(this.popChar()){case"d":p=s;break;case"D":p=s,m=!0;break;case"s":p=d;break;case"S":p=d,m=!0;break;case"w":p=l;break;case"W":p=l,m=!0;break}return h(p),{type:"Set",value:p,complement:m}},t.prototype.controlEscapeAtom=function(){var p;switch(this.popChar()){case"f":p=i("\f");break;case"n":p=i(`
`);break;case"r":p=i("\r");break;case"t":p=i("	");break;case"v":p=i("\v");break}return h(p),{type:"Character",value:p}},t.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var p=this.popChar();if(/[a-zA-Z]/.test(p)===!1)throw Error("Invalid ");var m=p.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:m}},t.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:i("\0")}},t.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},t.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},t.prototype.identityEscapeAtom=function(){var p=this.popChar();return{type:"Character",value:i(p)}},t.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var p=this.popChar();return{type:"Character",value:i(p)}}},t.prototype.characterClass=function(){var p=[],m=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),m=!0);this.isClassAtom();){var g=this.classAtom(),E=g.type==="Character";if(E&&this.isRangeDash()){this.consumeChar("-");var y=this.classAtom(),w=y.type==="Character";if(w){if(y.value<g.value)throw Error("Range out of order in character class");p.push({from:g.value,to:y.value})}else c(g.value,p),p.push(i("-")),c(y.value,p)}else c(g.value,p)}return this.consumeChar("]"),{type:"Set",complement:m,value:p}},t.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},t.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:i("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},t.prototype.group=function(){var p=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),p=!1;break;default:this.groupIdx++;break}var m=this.disjunction();this.consumeChar(")");var g={type:"Group",capturing:p,value:m};return p&&(g.idx=this.groupIdx),g},t.prototype.positiveInteger=function(){var p=this.popChar();if(o.test(p)===!1)throw Error("Expecting a positive integer");for(;r.test(this.peekChar(0));)p+=this.popChar();return parseInt(p,10)},t.prototype.integerIncludingZero=function(){var p=this.popChar();if(r.test(p)===!1)throw Error("Expecting an integer");for(;r.test(this.peekChar(0));)p+=this.popChar();return parseInt(p,10)},t.prototype.patternCharacter=function(){var p=this.popChar();switch(p){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:i(p)}}},t.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},t.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},t.prototype.isDigit=function(){return r.test(this.peekChar(0))},t.prototype.isClassAtom=function(p){switch(p===void 0&&(p=0),this.peekChar(p)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},t.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},t.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},t.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},t.prototype.isQuantifier=function(){var p=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(p)}},t.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},t.prototype.parseHexDigits=function(p){for(var m="",g=0;g<p;g++){var E=this.popChar();if(n.test(E)===!1)throw Error("Expecting a HexDecimal digits");m+=E}var y=parseInt(m,16);return{type:"Character",value:y}},t.prototype.peekChar=function(p){return p===void 0&&(p=0),this.input[this.idx+p]},t.prototype.popChar=function(){var p=this.peekChar(0);return this.consumeChar(),p},t.prototype.consumeChar=function(p){if(p!==void 0&&this.input[this.idx]!==p)throw Error("Expected: '"+p+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++},t.prototype.loc=function(p){return{begin:p,end:this.idx}};var n=/[0-9a-fA-F]/,r=/[0-9]/,o=/[1-9]/;function i(p){return p.charCodeAt(0)}function c(p,m){p.length!==void 0?p.forEach(function(g){m.push(g)}):m.push(p)}function f(p,m){if(p[m]===!0)throw"duplicate flag "+m;p[m]=!0}function h(p){if(p===void 0)throw Error("Internal Error - Should never get here!")}function u(){throw Error("Internal Error - Should never get here!")}var a,s=[];for(a=i("0");a<=i("9");a++)s.push(a);var l=[i("_")].concat(s);for(a=i("a");a<=i("z");a++)l.push(a);for(a=i("A");a<=i("Z");a++)l.push(a);var d=[i(" "),i("\f"),i(`
`),i("\r"),i("	"),i("\v"),i("	"),i("\xA0"),i("\u1680"),i("\u2000"),i("\u2001"),i("\u2002"),i("\u2003"),i("\u2004"),i("\u2005"),i("\u2006"),i("\u2007"),i("\u2008"),i("\u2009"),i("\u200A"),i("\u2028"),i("\u2029"),i("\u202F"),i("\u205F"),i("\u3000"),i("\uFEFF")];function v(){}return v.prototype.visitChildren=function(p){for(var m in p){var g=p[m];p.hasOwnProperty(m)&&(g.type!==void 0?this.visit(g):Array.isArray(g)&&g.forEach(function(E){this.visit(E)},this))}},v.prototype.visit=function(p){switch(p.type){case"Pattern":this.visitPattern(p);break;case"Flags":this.visitFlags(p);break;case"Disjunction":this.visitDisjunction(p);break;case"Alternative":this.visitAlternative(p);break;case"StartAnchor":this.visitStartAnchor(p);break;case"EndAnchor":this.visitEndAnchor(p);break;case"WordBoundary":this.visitWordBoundary(p);break;case"NonWordBoundary":this.visitNonWordBoundary(p);break;case"Lookahead":this.visitLookahead(p);break;case"NegativeLookahead":this.visitNegativeLookahead(p);break;case"Character":this.visitCharacter(p);break;case"Set":this.visitSet(p);break;case"Group":this.visitGroup(p);break;case"GroupBackReference":this.visitGroupBackReference(p);break;case"Quantifier":this.visitQuantifier(p);break}this.visitChildren(p)},v.prototype.visitPattern=function(p){},v.prototype.visitFlags=function(p){},v.prototype.visitDisjunction=function(p){},v.prototype.visitAlternative=function(p){},v.prototype.visitStartAnchor=function(p){},v.prototype.visitEndAnchor=function(p){},v.prototype.visitWordBoundary=function(p){},v.prototype.visitNonWordBoundary=function(p){},v.prototype.visitLookahead=function(p){},v.prototype.visitNegativeLookahead=function(p){},v.prototype.visitCharacter=function(p){},v.prototype.visitSet=function(p){},v.prototype.visitGroup=function(p){},v.prototype.visitGroupBackReference=function(p){},v.prototype.visitQuantifier=function(p){},{RegExpParser:t,BaseRegExpVisitor:v,VERSION:"0.5.0"}})})(Nr);var Bo={},pp=new Nr.exports.RegExpParser;function wi(e){var t=e.toString();if(Bo.hasOwnProperty(t))return Bo[t];var n=pp.pattern(t);return Bo[t]=n,n}function vp(){Bo={}}var mp=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r[i]=o[i])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),il="Complement Sets are not supported for first char optimization",jo=`Unable to use "first char" lexer optimizations:
`;function gp(e,t){t===void 0&&(t=!1);try{var n=wi(e),r=Ca(n.value,{},n.flags.ignoreCase);return r}catch(i){if(i.message===il)t&&nl(""+jo+("	Unable to optimize: < "+e.toString()+` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var o="";t&&(o=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),Aa(jo+`
`+("	Failed parsing: < "+e.toString()+` >
`)+("	Using the regexp-to-ast library version: "+Nr.exports.VERSION+`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+o)}}return[]}function Ca(e,t,n){switch(e.type){case"Disjunction":for(var r=0;r<e.value.length;r++)Ca(e.value[r],t,n);break;case"Alternative":for(var o=e.value,r=0;r<o.length;r++){var i=o[r];switch(i.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var c=i;switch(c.type){case"Character":No(c.value,t,n);break;case"Set":if(c.complement===!0)throw Error(il);ee(c.value,function(u){if(typeof u=="number")No(u,t,n);else{var a=u;if(n===!0)for(var s=a.from;s<=a.to;s++)No(s,t,n);else{for(var s=a.from;s<=a.to&&s<kr;s++)No(s,t,n);if(a.to>=kr)for(var l=a.from>=kr?a.from:kr,d=a.to,v=kn(l),p=kn(d),m=v;m<=p;m++)t[m]=m}}});break;case"Group":Ca(c.value,t,n);break;default:throw Error("Non Exhaustive Match")}var f=c.quantifier!==void 0&&c.quantifier.atLeast===0;if(c.type==="Group"&&xa(c)===!1||c.type!=="Group"&&f===!1)break}break;default:throw Error("non exhaustive match!")}return Et(t)}function No(e,t,n){var r=kn(e);t[r]=r,n===!0&&Ep(e,t)}function Ep(e,t){var n=String.fromCharCode(e),r=n.toUpperCase();if(r!==n){var o=kn(r.charCodeAt(0));t[o]=o}else{var i=n.toLowerCase();if(i!==n){var o=kn(i.charCodeAt(0));t[o]=o}}}function Qs(e,t){return Er(e.value,function(n){if(typeof n=="number")return He(t,n);var r=n;return Er(t,function(o){return r.from<=o&&o<=r.to})!==void 0})}function xa(e){return e.quantifier&&e.quantifier.atLeast===0?!0:e.value?en(e.value)?Ut(e.value,xa):xa(e.value):!1}var yp=function(e){mp(t,e);function t(n){var r=e.call(this)||this;return r.targetCharCodes=n,r.found=!1,r}return t.prototype.visitChildren=function(n){if(this.found!==!0){switch(n.type){case"Lookahead":this.visitLookahead(n);return;case"NegativeLookahead":this.visitNegativeLookahead(n);return}e.prototype.visitChildren.call(this,n)}},t.prototype.visitCharacter=function(n){He(this.targetCharCodes,n.value)&&(this.found=!0)},t.prototype.visitSet=function(n){n.complement?Qs(n,this.targetCharCodes)===void 0&&(this.found=!0):Qs(n,this.targetCharCodes)!==void 0&&(this.found=!0)},t}(Nr.exports.BaseRegExpVisitor);function ns(e,t){if(t instanceof RegExp){var n=wi(t),r=new yp(e);return r.visit(n),r.found}else return Er(t,function(o){return He(e,o.charCodeAt(0))})!==void 0}var al=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r[i]=o[i])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),rn="PATTERN",Jn="defaultMode",To="modes",sl=typeof new RegExp("(?:)").sticky=="boolean";function wp(e,t){t=ts(t,{useSticky:sl,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(E,y){return y()}});var n=t.tracer;n("initCharCodeToOptimizedIndexMap",function(){Hp()});var r;n("Reject Lexer.NA",function(){r=Rr(e,function(E){return E[rn]===Ht.NA})});var o=!1,i;n("Transform Patterns",function(){o=!1,i=Y(r,function(E){var y=E[rn];if(Nn(y)){var w=y.source;return w.length===1&&w!=="^"&&w!=="$"&&w!=="."&&!y.ignoreCase?w:w.length===2&&w[0]==="\\"&&!He(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],w[1])?w[1]:t.useSticky?Js(y):Zs(y)}else{if(Vn(y))return o=!0,{exec:y};if(ne(y,"exec"))return o=!0,y;if(typeof y=="string"){if(y.length===1)return y;var T=y.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),R=new RegExp(T);return t.useSticky?Js(R):Zs(R)}else throw Error("non exhaustive match")}})});var c,f,h,u,a;n("misc mapping",function(){c=Y(r,function(E){return E.tokenTypeIdx}),f=Y(r,function(E){var y=E.GROUP;if(y!==Ht.SKIPPED){if(nn(y))return y;if(Rn(y))return!1;throw Error("non exhaustive match")}}),h=Y(r,function(E){var y=E.LONGER_ALT;if(y){var w=up(r,y);return w}}),u=Y(r,function(E){return E.PUSH_MODE}),a=Y(r,function(E){return ne(E,"POP_MODE")})});var s;n("Line Terminator Handling",function(){var E=ll(t.lineTerminatorCharacters);s=Y(r,function(y){return!1}),t.positionTracking!=="onlyOffset"&&(s=Y(r,function(y){if(ne(y,"LINE_BREAKS"))return y.LINE_BREAKS;if(ul(y,E)===!1)return ns(E,y.PATTERN)}))});var l,d,v,p;n("Misc Mapping #2",function(){l=Y(r,cl),d=Y(i,$p),v=tt(r,function(E,y){var w=y.GROUP;return nn(w)&&w!==Ht.SKIPPED&&(E[w]=[]),E},{}),p=Y(i,function(E,y){return{pattern:i[y],longerAlt:h[y],canLineTerminator:s[y],isCustom:l[y],short:d[y],group:f[y],push:u[y],pop:a[y],tokenTypeIdx:c[y],tokenType:r[y]}})});var m=!0,g=[];return t.safeMode||n("First Char Optimization",function(){g=tt(r,function(E,y,w){if(typeof y.PATTERN=="string"){var T=y.PATTERN.charCodeAt(0),R=kn(T);Zi(E,R,p[w])}else if(en(y.START_CHARS_HINT)){var A;ee(y.START_CHARS_HINT,function(x){var O=typeof x=="string"?x.charCodeAt(0):x,I=kn(O);A!==I&&(A=I,Zi(E,I,p[w]))})}else if(Nn(y.PATTERN))if(y.PATTERN.unicode)m=!1,t.ensureOptimizations&&Aa(""+jo+("	Unable to analyze < "+y.PATTERN.toString()+` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var C=gp(y.PATTERN,t.ensureOptimizations);Re(C)&&(m=!1),ee(C,function(x){Zi(E,x,p[w])})}else t.ensureOptimizations&&Aa(""+jo+("	TokenType: <"+y.name+`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),m=!1;return E},[])}),n("ArrayPacking",function(){g=dp(g)}),{emptyGroups:v,patternIdxToConfig:p,charCodeToPatternIdxToConfig:g,hasCustom:o,canBeOptimized:m}}function Rp(e,t){var n=[],r=Tp(e);n=n.concat(r.errors);var o=Ap(r.valid),i=o.valid;return n=n.concat(o.errors),n=n.concat(Np(i)),n=n.concat(Lp(i)),n=n.concat(Up(i,t)),n=n.concat(kp(i)),n}function Np(e){var t=[],n=qt(e,function(r){return Nn(r[rn])});return t=t.concat(xp(n)),t=t.concat(_p(n)),t=t.concat(Mp(n)),t=t.concat(bp(n)),t=t.concat(Op(n)),t}function Tp(e){var t=qt(e,function(o){return!ne(o,rn)}),n=Y(t,function(o){return{message:"Token Type: ->"+o.name+"<- missing static 'PATTERN' property",type:Ue.MISSING_PATTERN,tokenTypes:[o]}}),r=yi(e,t);return{errors:n,valid:r}}function Ap(e){var t=qt(e,function(o){var i=o[rn];return!Nn(i)&&!Vn(i)&&!ne(i,"exec")&&!nn(i)}),n=Y(t,function(o){return{message:"Token Type: ->"+o.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:Ue.INVALID_PATTERN,tokenTypes:[o]}}),r=yi(e,t);return{errors:n,valid:r}}var Cp=/[^\\][\$]/;function xp(e){var t=function(o){al(i,o);function i(){var c=o!==null&&o.apply(this,arguments)||this;return c.found=!1,c}return i.prototype.visitEndAnchor=function(c){this.found=!0},i}(Nr.exports.BaseRegExpVisitor),n=qt(e,function(o){var i=o[rn];try{var c=wi(i),f=new t;return f.visit(c),f.found}catch{return Cp.test(i.source)}}),r=Y(n,function(o){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+o.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Ue.EOI_ANCHOR_FOUND,tokenTypes:[o]}});return r}function Op(e){var t=qt(e,function(r){var o=r[rn];return o.test("")}),n=Y(t,function(r){return{message:"Token Type: ->"+r.name+"<- static 'PATTERN' must not match an empty string",type:Ue.EMPTY_MATCH_PATTERN,tokenTypes:[r]}});return n}var Ip=/[^\\[][\^]|^\^/;function _p(e){var t=function(o){al(i,o);function i(){var c=o!==null&&o.apply(this,arguments)||this;return c.found=!1,c}return i.prototype.visitStartAnchor=function(c){this.found=!0},i}(Nr.exports.BaseRegExpVisitor),n=qt(e,function(o){var i=o[rn];try{var c=wi(i),f=new t;return f.visit(c),f.found}catch{return Ip.test(i.source)}}),r=Y(n,function(o){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+o.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Ue.SOI_ANCHOR_FOUND,tokenTypes:[o]}});return r}function Mp(e){var t=qt(e,function(r){var o=r[rn];return o instanceof RegExp&&(o.multiline||o.global)}),n=Y(t,function(r){return{message:"Token Type: ->"+r.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:Ue.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[r]}});return n}function bp(e){var t=[],n=Y(e,function(i){return tt(e,function(c,f){return i.PATTERN.source===f.PATTERN.source&&!He(t,f)&&f.PATTERN!==Ht.NA&&(t.push(f),c.push(f)),c},[])});n=jr(n);var r=qt(n,function(i){return i.length>1}),o=Y(r,function(i){var c=Y(i,function(h){return h.name}),f=zt(i).PATTERN;return{message:"The same RegExp pattern ->"+f+"<-"+("has been used in all of the following Token Types: "+c.join(", ")+" <-"),type:Ue.DUPLICATE_PATTERNS_FOUND,tokenTypes:i}});return o}function Lp(e){var t=qt(e,function(r){if(!ne(r,"GROUP"))return!1;var o=r.GROUP;return o!==Ht.SKIPPED&&o!==Ht.NA&&!nn(o)}),n=Y(t,function(r){return{message:"Token Type: ->"+r.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:Ue.INVALID_GROUP_TYPE_FOUND,tokenTypes:[r]}});return n}function Up(e,t){var n=qt(e,function(o){return o.PUSH_MODE!==void 0&&!He(t,o.PUSH_MODE)}),r=Y(n,function(o){var i="Token Type: ->"+o.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+o.PUSH_MODE+"<-which does not exist";return{message:i,type:Ue.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[o]}});return r}function kp(e){var t=[],n=tt(e,function(r,o,i){var c=o.PATTERN;return c===Ht.NA||(nn(c)?r.push({str:c,idx:i,tokenType:o}):Nn(c)&&Sp(c)&&r.push({str:c.source,idx:i,tokenType:o})),r},[]);return ee(e,function(r,o){ee(n,function(i){var c=i.str,f=i.idx,h=i.tokenType;if(o<f&&Pp(c,r.PATTERN)){var u="Token: ->"+h.name+`<- can never be matched.
`+("Because it appears AFTER the Token Type ->"+r.name+"<-")+`in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;t.push({message:u,type:Ue.UNREACHABLE_PATTERN,tokenTypes:[r,h]})}})}),t}function Pp(e,t){if(Nn(t)){var n=t.exec(e);return n!==null&&n.index===0}else{if(Vn(t))return t(e,0,[],{});if(ne(t,"exec"))return t.exec(e,0,[],{});if(typeof t=="string")return t===e;throw Error("non exhaustive match")}}function Sp(e){var t=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return Er(t,function(n){return e.source.indexOf(n)!==-1})===void 0}function Zs(e){var t=e.ignoreCase?"i":"";return new RegExp("^(?:"+e.source+")",t)}function Js(e){var t=e.ignoreCase?"iy":"y";return new RegExp(""+e.source,t)}function Fp(e,t,n){var r=[];return ne(e,Jn)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+Jn+`> property in its definition
`,type:Ue.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),ne(e,To)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+To+`> property in its definition
`,type:Ue.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),ne(e,To)&&ne(e,Jn)&&!ne(e.modes,e.defaultMode)&&r.push({message:"A MultiMode Lexer cannot be initialized with a "+Jn+": <"+e.defaultMode+`>which does not exist
`,type:Ue.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),ne(e,To)&&ee(e.modes,function(o,i){ee(o,function(c,f){Rn(c)&&r.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+("<"+i+"> at index: <"+f+`>
`),type:Ue.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),r}function Bp(e,t,n){var r=[],o=!1,i=jr(Ot(sp(e.modes,function(h){return h}))),c=Rr(i,function(h){return h[rn]===Ht.NA}),f=ll(n);return t&&ee(c,function(h){var u=ul(h,f);if(u!==!1){var a=Gp(h,u),s={message:a,type:u.issue,tokenType:h};r.push(s)}else ne(h,"LINE_BREAKS")?h.LINE_BREAKS===!0&&(o=!0):ns(f,h.PATTERN)&&(o=!0)}),t&&!o&&r.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:Ue.NO_LINE_BREAKS_FLAGS}),r}function Dp(e){var t={},n=Wt(e);return ee(n,function(r){var o=e[r];if(en(o))t[r]=[];else throw Error("non exhaustive match")}),t}function cl(e){var t=e.PATTERN;if(Nn(t))return!1;if(Vn(t))return!0;if(ne(t,"exec"))return!0;if(nn(t))return!1;throw Error("non exhaustive match")}function $p(e){return nn(e)&&e.length===1?e.charCodeAt(0):!1}var Vp={test:function(e){for(var t=e.length,n=this.lastIndex;n<t;n++){var r=e.charCodeAt(n);if(r===10)return this.lastIndex=n+1,!0;if(r===13)return e.charCodeAt(n+1)===10?this.lastIndex=n+2:this.lastIndex=n+1,!0}return!1},lastIndex:0};function ul(e,t){if(ne(e,"LINE_BREAKS"))return!1;if(Nn(e.PATTERN)){try{ns(t,e.PATTERN)}catch(n){return{issue:Ue.IDENTIFY_TERMINATOR,errMsg:n.message}}return!1}else{if(nn(e.PATTERN))return!1;if(cl(e))return{issue:Ue.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function Gp(e,t){if(t.issue===Ue.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+("	The problem is in the <"+e.name+`> Token Type
`)+("	 Root cause: "+t.errMsg+`.
`)+"	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(t.issue===Ue.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+("	The problem is in the <"+e.name+`> Token Type
`)+"	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function ll(e){var t=Y(e,function(n){return nn(n)&&n.length>0?n.charCodeAt(0):n});return t}function Zi(e,t,n){e[t]===void 0?e[t]=[n]:e[t].push(n)}var kr=256;function kn(e){return e<kr?e:Do[e]}var Do=[];function Hp(){if(Re(Do)){Do=new Array(65536);for(var e=0;e<65536;e++)Do[e]=e>255?255+~~(e/255):e}}function Ri(e,t){var n=e.tokenTypeIdx;return n===t.tokenTypeIdx?!0:t.isParent===!0&&t.categoryMatchesMap[n]===!0}function ei(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}var js=1,fl={};function eo(e){var t=Wp(e);zp(t),Kp(t),qp(t),ee(t,function(n){n.isParent=n.categoryMatches.length>0})}function Wp(e){for(var t=yt(e),n=e,r=!0;r;){n=jr(Ot(Y(n,function(i){return i.CATEGORIES})));var o=yi(n,t);t=t.concat(o),Re(o)?r=!1:n=o}return t}function zp(e){ee(e,function(t){hl(t)||(fl[js]=t,t.tokenTypeIdx=js++),ec(t)&&!en(t.CATEGORIES)&&(t.CATEGORIES=[t.CATEGORIES]),ec(t)||(t.CATEGORIES=[]),Yp(t)||(t.categoryMatches=[]),Xp(t)||(t.categoryMatchesMap={})})}function qp(e){ee(e,function(t){t.categoryMatches=[],ee(t.categoryMatchesMap,function(n,r){t.categoryMatches.push(fl[r].tokenTypeIdx)})})}function Kp(e){ee(e,function(t){dl([],t)})}function dl(e,t){ee(e,function(n){t.categoryMatchesMap[n.tokenTypeIdx]=!0}),ee(t.CATEGORIES,function(n){var r=e.concat(t);He(r,n)||dl(r,n)})}function hl(e){return ne(e,"tokenTypeIdx")}function ec(e){return ne(e,"CATEGORIES")}function Yp(e){return ne(e,"categoryMatches")}function Xp(e){return ne(e,"categoryMatchesMap")}function Qp(e){return ne(e,"tokenTypeIdx")}var pl={buildUnableToPopLexerModeMessage:function(e){return"Unable to pop Lexer Mode after encountering Token ->"+e.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(e,t,n,r,o){return"unexpected character: ->"+e.charAt(t)+"<- at offset: "+t+","+(" skipped "+n+" characters.")}},Ue;(function(e){e[e.MISSING_PATTERN=0]="MISSING_PATTERN",e[e.INVALID_PATTERN=1]="INVALID_PATTERN",e[e.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",e[e.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",e[e.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",e[e.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",e[e.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",e[e.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",e[e.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",e[e.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",e[e.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",e[e.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",e[e.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",e[e.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",e[e.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",e[e.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",e[e.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})(Ue||(Ue={}));var Pr={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:pl,traceInitPerf:!1,skipValidations:!1};Object.freeze(Pr);var Ht=function(){function e(t,n){var r=this;if(n===void 0&&(n=Pr),this.lexerDefinition=t,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},typeof n=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=Ks(Pr,n);var o=this.config.traceInitPerf;o===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof o=="number"&&(this.traceInitMaxIdent=o,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var i,c=!0;r.TRACE_INIT("Lexer Config handling",function(){if(r.config.lineTerminatorsPattern===Pr.lineTerminatorsPattern)r.config.lineTerminatorsPattern=Vp;else if(r.config.lineTerminatorCharacters===Pr.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(n.safeMode&&n.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');r.trackStartLines=/full|onlyStart/i.test(r.config.positionTracking),r.trackEndLines=/full/i.test(r.config.positionTracking),en(t)?(i={modes:{}},i.modes[Jn]=yt(t),i[Jn]=Jn):(c=!1,i=Jr(t))}),r.config.skipValidations===!1&&(r.TRACE_INIT("performRuntimeChecks",function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(Fp(i,r.trackStartLines,r.config.lineTerminatorCharacters))}),r.TRACE_INIT("performWarningRuntimeChecks",function(){r.lexerDefinitionWarning=r.lexerDefinitionWarning.concat(Bp(i,r.trackStartLines,r.config.lineTerminatorCharacters))})),i.modes=i.modes?i.modes:{},ee(i.modes,function(a,s){i.modes[s]=Rr(a,function(l){return Rn(l)})});var f=Wt(i.modes);if(ee(i.modes,function(a,s){r.TRACE_INIT("Mode: <"+s+"> processing",function(){if(r.modes.push(s),r.config.skipValidations===!1&&r.TRACE_INIT("validatePatterns",function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(Rp(a,f))}),Re(r.lexerDefinitionErrors)){eo(a);var l;r.TRACE_INIT("analyzeTokenTypes",function(){l=wp(a,{lineTerminatorCharacters:r.config.lineTerminatorCharacters,positionTracking:n.positionTracking,ensureOptimizations:n.ensureOptimizations,safeMode:n.safeMode,tracer:r.TRACE_INIT.bind(r)})}),r.patternIdxToConfig[s]=l.patternIdxToConfig,r.charCodeToPatternIdxToConfig[s]=l.charCodeToPatternIdxToConfig,r.emptyGroups=Ks(r.emptyGroups,l.emptyGroups),r.hasCustom=l.hasCustom||r.hasCustom,r.canModeBeOptimized[s]=l.canBeOptimized}})}),r.defaultMode=i.defaultMode,!Re(r.lexerDefinitionErrors)&&!r.config.deferDefinitionErrorsHandling){var h=Y(r.lexerDefinitionErrors,function(a){return a.message}),u=h.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+u)}ee(r.lexerDefinitionWarning,function(a){nl(a.message)}),r.TRACE_INIT("Choosing sub-methods implementations",function(){if(sl?(r.chopInput=Ys,r.match=r.matchWithTest):(r.updateLastIndex=Ke,r.match=r.matchWithExec),c&&(r.handleModes=Ke),r.trackStartLines===!1&&(r.computeNewColumn=Ys),r.trackEndLines===!1&&(r.updateTokenEndLineColumnLocation=Ke),/full/i.test(r.config.positionTracking))r.createTokenInstance=r.createFullToken;else if(/onlyStart/i.test(r.config.positionTracking))r.createTokenInstance=r.createStartOnlyToken;else if(/onlyOffset/i.test(r.config.positionTracking))r.createTokenInstance=r.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+r.config.positionTracking+'"');r.hasCustom?(r.addToken=r.addTokenUsingPush,r.handlePayload=r.handlePayloadWithCustom):(r.addToken=r.addTokenUsingMemberAccess,r.handlePayload=r.handlePayloadNoCustom)}),r.TRACE_INIT("Failed Optimization Warnings",function(){var a=tt(r.canModeBeOptimized,function(s,l,d){return l===!1&&s.push(d),s},[]);if(n.ensureOptimizations&&!Re(a))throw Error("Lexer Modes: < "+a.join(", ")+` > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),r.TRACE_INIT("clearRegExpParserCache",function(){vp()}),r.TRACE_INIT("toFastProperties",function(){rl(r)})})}return e.prototype.tokenize=function(t,n){if(n===void 0&&(n=this.defaultMode),!Re(this.lexerDefinitionErrors)){var r=Y(this.lexerDefinitionErrors,function(c){return c.message}),o=r.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+o)}var i=this.tokenizeInternal(t,n);return i},e.prototype.tokenizeInternal=function(t,n){var r=this,o,i,c,f,h,u,a,s,l,d,v,p,m,g,E=t,y=E.length,w=0,T=0,R=this.hasCustom?0:Math.floor(t.length/10),A=new Array(R),C=[],x=this.trackStartLines?1:void 0,O=this.trackStartLines?1:void 0,I=Dp(this.emptyGroups),P=this.trackStartLines,B=this.config.lineTerminatorsPattern,S=0,b=[],_=[],F=[],V=[];Object.freeze(V);var z=void 0;function M(){return b}function $(ye){var Ge=kn(ye),at=_[Ge];return at===void 0?V:at}var H=function(ye){if(F.length===1&&ye.tokenType.PUSH_MODE===void 0){var Ge=r.config.errorMessageProvider.buildUnableToPopLexerModeMessage(ye);C.push({offset:ye.startOffset,line:ye.startLine!==void 0?ye.startLine:void 0,column:ye.startColumn!==void 0?ye.startColumn:void 0,length:ye.image.length,message:Ge})}else{F.pop();var at=el(F);b=r.patternIdxToConfig[at],_=r.charCodeToPatternIdxToConfig[at],S=b.length;var bt=r.canModeBeOptimized[at]&&r.config.safeMode===!1;_&&bt?z=$:z=M}};function W(ye){F.push(ye),_=this.charCodeToPatternIdxToConfig[ye],b=this.patternIdxToConfig[ye],S=b.length,S=b.length;var Ge=this.canModeBeOptimized[ye]&&this.config.safeMode===!1;_&&Ge?z=$:z=M}W.call(this,n);for(var Q;w<y;){h=null;var te=E.charCodeAt(w),he=z(te),ue=he.length;for(o=0;o<ue;o++){Q=he[o];var Te=Q.pattern;u=null;var fe=Q.short;if(fe!==!1?te===fe&&(h=Te):Q.isCustom===!0?(g=Te.exec(E,w,A,I),g!==null?(h=g[0],g.payload!==void 0&&(u=g.payload)):h=null):(this.updateLastIndex(Te,w),h=this.match(Te,t,w)),h!==null){if(f=Q.longerAlt,f!==void 0){var Oe=b[f],Be=Oe.pattern;a=null,Oe.isCustom===!0?(g=Be.exec(E,w,A,I),g!==null?(c=g[0],g.payload!==void 0&&(a=g.payload)):c=null):(this.updateLastIndex(Be,w),c=this.match(Be,t,w)),c&&c.length>h.length&&(h=c,u=a,Q=Oe)}break}}if(h!==null){if(s=h.length,l=Q.group,l!==void 0&&(d=Q.tokenTypeIdx,v=this.createTokenInstance(h,w,d,Q.tokenType,x,O,s),this.handlePayload(v,u),l===!1?T=this.addToken(A,T,v):I[l].push(v)),t=this.chopInput(t,s),w=w+s,O=this.computeNewColumn(O,s),P===!0&&Q.canLineTerminator===!0){var ze=0,Ze=void 0,nt=void 0;B.lastIndex=0;do Ze=B.test(h),Ze===!0&&(nt=B.lastIndex-1,ze++);while(Ze===!0);ze!==0&&(x=x+ze,O=s-nt,this.updateTokenEndLineColumnLocation(v,l,nt,ze,x,O,s))}this.handleModes(Q,H,W,v)}else{for(var pe=w,ke=x,Ee=O,De=!1;!De&&w<y;)for(E.charCodeAt(w),t=this.chopInput(t,1),w++,i=0;i<S;i++){var Ie=b[i],Te=Ie.pattern,fe=Ie.short;if(fe!==!1?E.charCodeAt(w)===fe&&(De=!0):Ie.isCustom===!0?De=Te.exec(E,w,A,I)!==null:(this.updateLastIndex(Te,w),De=Te.exec(t)!==null),De===!0)break}p=w-pe,m=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(E,pe,p,ke,Ee),C.push({offset:pe,line:ke,column:Ee,length:p,message:m})}}return this.hasCustom||(A.length=T),{tokens:A,groups:I,errors:C}},e.prototype.handleModes=function(t,n,r,o){if(t.pop===!0){var i=t.push;n(o),i!==void 0&&r.call(this,i)}else t.push!==void 0&&r.call(this,t.push)},e.prototype.chopInput=function(t,n){return t.substring(n)},e.prototype.updateLastIndex=function(t,n){t.lastIndex=n},e.prototype.updateTokenEndLineColumnLocation=function(t,n,r,o,i,c,f){var h,u;n!==void 0&&(h=r===f-1,u=h?-1:0,o===1&&h===!0||(t.endLine=i+u,t.endColumn=c-1+-u))},e.prototype.computeNewColumn=function(t,n){return t+n},e.prototype.createTokenInstance=function(){return null},e.prototype.createOffsetOnlyToken=function(t,n,r,o){return{image:t,startOffset:n,tokenTypeIdx:r,tokenType:o}},e.prototype.createStartOnlyToken=function(t,n,r,o,i,c){return{image:t,startOffset:n,startLine:i,startColumn:c,tokenTypeIdx:r,tokenType:o}},e.prototype.createFullToken=function(t,n,r,o,i,c,f){return{image:t,startOffset:n,endOffset:n+f-1,startLine:i,endLine:i,startColumn:c,endColumn:c+f-1,tokenTypeIdx:r,tokenType:o}},e.prototype.addToken=function(t,n,r){return 666},e.prototype.addTokenUsingPush=function(t,n,r){return t.push(r),n},e.prototype.addTokenUsingMemberAccess=function(t,n,r){return t[n]=r,n++,n},e.prototype.handlePayload=function(t,n){},e.prototype.handlePayloadNoCustom=function(t,n){},e.prototype.handlePayloadWithCustom=function(t,n){n!==null&&(t.payload=n)},e.prototype.match=function(t,n,r){return null},e.prototype.matchWithTest=function(t,n,r){var o=t.test(n);return o===!0?n.substring(r,t.lastIndex):null},e.prototype.matchWithExec=function(t,n){var r=t.exec(n);return r!==null?r[0]:r},e.prototype.TRACE_INIT=function(t,n){if(this.traceInitPerf===!0){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+t+">");var o=ol(n),i=o.time,c=o.value,f=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&f(r+"<-- <"+t+"> time: "+i+"ms"),this.traceInitIndent--,c}else return n()},e.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",e.NA=/NOT_APPLICABLE/,e}();function er(e){return vl(e)?e.LABEL:e.name}function Zp(e){return e.name}function vl(e){return nn(e.LABEL)&&e.LABEL!==""}var Jp="parent",tc="categories",nc="label",rc="group",oc="push_mode",ic="pop_mode",ac="longer_alt",sc="line_breaks",cc="start_chars_hint";function rs(e){return jp(e)}function jp(e){var t=e.pattern,n={};if(n.name=e.name,Rn(t)||(n.PATTERN=t),ne(e,Jp))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return ne(e,tc)&&(n.CATEGORIES=e[tc]),eo([n]),ne(e,nc)&&(n.LABEL=e[nc]),ne(e,rc)&&(n.GROUP=e[rc]),ne(e,ic)&&(n.POP_MODE=e[ic]),ne(e,oc)&&(n.PUSH_MODE=e[oc]),ne(e,ac)&&(n.LONGER_ALT=e[ac]),ne(e,sc)&&(n.LINE_BREAKS=e[sc]),ne(e,cc)&&(n.START_CHARS_HINT=e[cc]),n}var Pn=rs({name:"EOF",pattern:Ht.NA});eo([Pn]);function Ni(e,t,n,r,o,i,c,f){return{image:t,startOffset:n,endOffset:r,startLine:o,endLine:i,startColumn:c,endColumn:f,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}}function e0(e,t){return Ri(e,t)}var Cn=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r[i]=o[i])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),an=function(){function e(t){this._definition=t}return Object.defineProperty(e.prototype,"definition",{get:function(){return this._definition},set:function(t){this._definition=t},enumerable:!1,configurable:!0}),e.prototype.accept=function(t){t.visit(this),ee(this.definition,function(n){n.accept(t)})},e}(),ht=function(e){Cn(t,e);function t(n){var r=e.call(this,[])||this;return r.idx=1,Yt(r,Kt(n,function(o){return o!==void 0})),r}return Object.defineProperty(t.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(n){},enumerable:!1,configurable:!0}),t.prototype.accept=function(n){n.visit(this)},t}(an),nr=function(e){Cn(t,e);function t(n){var r=e.call(this,n.definition)||this;return r.orgText="",Yt(r,Kt(n,function(o){return o!==void 0})),r}return t}(an),it=function(e){Cn(t,e);function t(n){var r=e.call(this,n.definition)||this;return r.ignoreAmbiguities=!1,Yt(r,Kt(n,function(o){return o!==void 0})),r}return t}(an),ot=function(e){Cn(t,e);function t(n){var r=e.call(this,n.definition)||this;return r.idx=1,Yt(r,Kt(n,function(o){return o!==void 0})),r}return t}(an),Pt=function(e){Cn(t,e);function t(n){var r=e.call(this,n.definition)||this;return r.idx=1,Yt(r,Kt(n,function(o){return o!==void 0})),r}return t}(an),St=function(e){Cn(t,e);function t(n){var r=e.call(this,n.definition)||this;return r.idx=1,Yt(r,Kt(n,function(o){return o!==void 0})),r}return t}(an),Fe=function(e){Cn(t,e);function t(n){var r=e.call(this,n.definition)||this;return r.idx=1,Yt(r,Kt(n,function(o){return o!==void 0})),r}return t}(an),_t=function(e){Cn(t,e);function t(n){var r=e.call(this,n.definition)||this;return r.idx=1,Yt(r,Kt(n,function(o){return o!==void 0})),r}return t}(an),Mt=function(e){Cn(t,e);function t(n){var r=e.call(this,n.definition)||this;return r.idx=1,r.ignoreAmbiguities=!1,r.hasPredicates=!1,Yt(r,Kt(n,function(o){return o!==void 0})),r}return Object.defineProperty(t.prototype,"definition",{get:function(){return this._definition},set:function(n){this._definition=n},enumerable:!1,configurable:!0}),t}(an),Ce=function(){function e(t){this.idx=1,Yt(this,Kt(t,function(n){return n!==void 0}))}return e.prototype.accept=function(t){t.visit(this)},e}();function ml(e){return Y(e,Fr)}function Fr(e){function t(o){return Y(o,Fr)}if(e instanceof ht)return{type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};if(e instanceof it)return{type:"Alternative",definition:t(e.definition)};if(e instanceof ot)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof Pt)return{type:"RepetitionMandatory",idx:e.idx,definition:t(e.definition)};if(e instanceof St)return{type:"RepetitionMandatoryWithSeparator",idx:e.idx,separator:Fr(new Ce({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof _t)return{type:"RepetitionWithSeparator",idx:e.idx,separator:Fr(new Ce({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof Fe)return{type:"Repetition",idx:e.idx,definition:t(e.definition)};if(e instanceof Mt)return{type:"Alternation",idx:e.idx,definition:t(e.definition)};if(e instanceof Ce){var n={type:"Terminal",name:e.terminalType.name,label:er(e.terminalType),idx:e.idx},r=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(n.pattern=Nn(r)?r.source:r),n}else{if(e instanceof nr)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}}var Ti=function(){function e(){}return e.prototype.walk=function(t,n){var r=this;n===void 0&&(n=[]),ee(t.definition,function(o,i){var c=et(t.definition,i+1);if(o instanceof ht)r.walkProdRef(o,c,n);else if(o instanceof Ce)r.walkTerminal(o,c,n);else if(o instanceof it)r.walkFlat(o,c,n);else if(o instanceof ot)r.walkOption(o,c,n);else if(o instanceof Pt)r.walkAtLeastOne(o,c,n);else if(o instanceof St)r.walkAtLeastOneSep(o,c,n);else if(o instanceof _t)r.walkManySep(o,c,n);else if(o instanceof Fe)r.walkMany(o,c,n);else if(o instanceof Mt)r.walkOr(o,c,n);else throw Error("non exhaustive match")})},e.prototype.walkTerminal=function(t,n,r){},e.prototype.walkProdRef=function(t,n,r){},e.prototype.walkFlat=function(t,n,r){var o=n.concat(r);this.walk(t,o)},e.prototype.walkOption=function(t,n,r){var o=n.concat(r);this.walk(t,o)},e.prototype.walkAtLeastOne=function(t,n,r){var o=[new ot({definition:t.definition})].concat(n,r);this.walk(t,o)},e.prototype.walkAtLeastOneSep=function(t,n,r){var o=uc(t,n,r);this.walk(t,o)},e.prototype.walkMany=function(t,n,r){var o=[new ot({definition:t.definition})].concat(n,r);this.walk(t,o)},e.prototype.walkManySep=function(t,n,r){var o=uc(t,n,r);this.walk(t,o)},e.prototype.walkOr=function(t,n,r){var o=this,i=n.concat(r);ee(t.definition,function(c){var f=new it({definition:[c]});o.walk(f,i)})},e}();function uc(e,t,n){var r=[new ot({definition:[new Ce({terminalType:e.separator})].concat(e.definition)})],o=r.concat(t,n);return o}var rr=function(){function e(){}return e.prototype.visit=function(t){var n=t;switch(n.constructor){case ht:return this.visitNonTerminal(n);case it:return this.visitAlternative(n);case ot:return this.visitOption(n);case Pt:return this.visitRepetitionMandatory(n);case St:return this.visitRepetitionMandatoryWithSeparator(n);case _t:return this.visitRepetitionWithSeparator(n);case Fe:return this.visitRepetition(n);case Mt:return this.visitAlternation(n);case Ce:return this.visitTerminal(n);case nr:return this.visitRule(n);default:throw Error("non exhaustive match")}},e.prototype.visitNonTerminal=function(t){},e.prototype.visitAlternative=function(t){},e.prototype.visitOption=function(t){},e.prototype.visitRepetition=function(t){},e.prototype.visitRepetitionMandatory=function(t){},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){},e.prototype.visitRepetitionWithSeparator=function(t){},e.prototype.visitAlternation=function(t){},e.prototype.visitTerminal=function(t){},e.prototype.visitRule=function(t){},e}(),t0=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r[i]=o[i])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();function n0(e){return e instanceof it||e instanceof ot||e instanceof Fe||e instanceof Pt||e instanceof St||e instanceof _t||e instanceof Ce||e instanceof nr}function ti(e,t){t===void 0&&(t=[]);var n=e instanceof ot||e instanceof Fe||e instanceof _t;return n?!0:e instanceof Mt?tl(e.definition,function(r){return ti(r,t)}):e instanceof ht&&He(t,e)?!1:e instanceof an?(e instanceof ht&&t.push(e),Ut(e.definition,function(r){return ti(r,t)})):!1}function r0(e){return e instanceof Mt}function Jt(e){if(e instanceof ht)return"SUBRULE";if(e instanceof ot)return"OPTION";if(e instanceof Mt)return"OR";if(e instanceof Pt)return"AT_LEAST_ONE";if(e instanceof St)return"AT_LEAST_ONE_SEP";if(e instanceof _t)return"MANY_SEP";if(e instanceof Fe)return"MANY";if(e instanceof Ce)return"CONSUME";throw Error("non exhaustive match")}var gl=function(e){t0(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.separator="-",n.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},n}return t.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},t.prototype.visitTerminal=function(n){var r=n.terminalType.name+this.separator+"Terminal";ne(this.dslMethods,r)||(this.dslMethods[r]=[]),this.dslMethods[r].push(n)},t.prototype.visitNonTerminal=function(n){var r=n.nonTerminalName+this.separator+"Terminal";ne(this.dslMethods,r)||(this.dslMethods[r]=[]),this.dslMethods[r].push(n)},t.prototype.visitOption=function(n){this.dslMethods.option.push(n)},t.prototype.visitRepetitionWithSeparator=function(n){this.dslMethods.repetitionWithSeparator.push(n)},t.prototype.visitRepetitionMandatory=function(n){this.dslMethods.repetitionMandatory.push(n)},t.prototype.visitRepetitionMandatoryWithSeparator=function(n){this.dslMethods.repetitionMandatoryWithSeparator.push(n)},t.prototype.visitRepetition=function(n){this.dslMethods.repetition.push(n)},t.prototype.visitAlternation=function(n){this.dslMethods.alternation.push(n)},t}(rr),Ao=new gl;function o0(e){Ao.reset(),e.accept(Ao);var t=Ao.dslMethods;return Ao.reset(),t}function to(e){if(e instanceof ht)return to(e.referencedRule);if(e instanceof Ce)return s0(e);if(n0(e))return i0(e);if(r0(e))return a0(e);throw Error("non exhaustive match")}function i0(e){for(var t=[],n=e.definition,r=0,o=n.length>r,i,c=!0;o&&c;)i=n[r],c=ti(i),t=t.concat(to(i)),r=r+1,o=n.length>r;return ja(t)}function a0(e){var t=Y(e.definition,function(n){return to(n)});return ja(Ot(t))}function s0(e){return[e.terminalType]}var El="_~IN~_",c0=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r[i]=o[i])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),u0=function(e){c0(t,e);function t(n){var r=e.call(this)||this;return r.topProd=n,r.follows={},r}return t.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},t.prototype.walkTerminal=function(n,r,o){},t.prototype.walkProdRef=function(n,r,o){var i=f0(n.referencedRule,n.idx)+this.topProd.name,c=r.concat(o),f=new it({definition:c}),h=to(f);this.follows[i]=h},t}(Ti);function l0(e){var t={};return ee(e,function(n){var r=new u0(n).startWalking();Yt(t,r)}),t}function f0(e,t){return e.name+t+El}var os={buildMismatchTokenMessage:function(e){var t=e.expected,n=e.actual;e.previous,e.ruleName;var r=vl(t),o=r?"--> "+er(t)+" <--":"token of type --> "+t.name+" <--",i="Expecting "+o+" but found --> '"+n.image+"' <--";return i},buildNotAllInputParsedMessage:function(e){var t=e.firstRedundant;return e.ruleName,"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage:function(e){var t=e.expectedPathsPerAlt,n=e.actual;e.previous;var r=e.customUserDescription;e.ruleName;var o="Expecting: ",i=zt(n).image,c=`
but found: '`+i+"'";if(r)return o+r+c;var f=tt(t,function(s,l){return s.concat(l)},[]),h=Y(f,function(s){return"["+Y(s,function(l){return er(l)}).join(", ")+"]"}),u=Y(h,function(s,l){return"  "+(l+1)+". "+s}),a=`one of these possible Token sequences:
`+u.join(`
`);return o+a+c},buildEarlyExitMessage:function(e){var t=e.expectedIterationPaths,n=e.actual,r=e.customUserDescription;e.ruleName;var o="Expecting: ",i=zt(n).image,c=`
but found: '`+i+"'";if(r)return o+r+c;var f=Y(t,function(u){return"["+Y(u,function(a){return er(a)}).join(",")+"]"}),h=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+("<"+f.join(" ,")+">");return o+h+c}};Object.freeze(os);var yl={buildRuleNotFoundError:function(e,t){var n="Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+`<-
inside top level rule: ->`+e.name+"<-";return n}},Ai={buildDuplicateFoundError:function(e,t){function n(a){return a instanceof Ce?a.terminalType.name:a instanceof ht?a.nonTerminalName:""}var r=e.name,o=zt(t),i=o.idx,c=Jt(o),f=n(o),h=i>0,u="->"+c+(h?i:"")+"<- "+(f?"with argument: ->"+f+"<-":"")+`
                  appears more than once (`+t.length+" times) in the top level rule: ->"+r+`<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return u=u.replace(/[ \t]+/g," "),u=u.replace(/\s\s+/g,`
`),u},buildNamespaceConflictError:function(e){var t=`Namespace conflict found in grammar.
`+("The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+e.name+`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return t},buildAlternationPrefixAmbiguityError:function(e){var t=Y(e.prefixPath,function(o){return er(o)}).join(", "),n=e.alternation.idx===0?"":e.alternation.idx,r="Ambiguous alternatives: <"+e.ambiguityIndices.join(" ,")+`> due to common lookahead prefix
`+("in <OR"+n+"> inside <"+e.topLevelRule.name+`> Rule,
`)+("<"+t+`> may appears as a prefix path in all these alternatives.
`)+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return r},buildAlternationAmbiguityError:function(e){var t=Y(e.prefixPath,function(o){return er(o)}).join(", "),n=e.alternation.idx===0?"":e.alternation.idx,r="Ambiguous Alternatives Detected: <"+e.ambiguityIndices.join(" ,")+"> in <OR"+n+">"+(" inside <"+e.topLevelRule.name+`> Rule,
`)+("<"+t+`> may appears as a prefix path in all these alternatives.
`);return r=r+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,r},buildEmptyRepetitionError:function(e){var t=Jt(e.repetition);e.repetition.idx!==0&&(t+=e.repetition.idx);var n="The repetition <"+t+"> within Rule <"+e.topLevelRule.name+`> can never consume any tokens.
This could lead to an infinite loop.`;return n},buildTokenNameError:function(e){return"deprecated"},buildEmptyAlternationError:function(e){var t="Ambiguous empty alternative: <"+(e.emptyChoiceIdx+1)+">"+(" in <OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+`> Rule.
`)+"Only the last alternative may be an empty alternative.";return t},buildTooManyAlternativesError:function(e){var t=`An Alternation cannot have more than 256 alternatives:
`+("<OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+`> Rule.
 has `+(e.alternation.definition.length+1)+" alternatives.");return t},buildLeftRecursionError:function(e){var t=e.topLevelRule.name,n=Y(e.leftRecursionPath,function(i){return i.name}),r=t+" --> "+n.concat([t]).join(" --> "),o=`Left Recursion found in grammar.
`+("rule: <"+t+`> can be invoked from itself (directly or indirectly)
`)+(`without consuming any Tokens. The grammar path that causes this is: 
 `+r+`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.`;return o},buildInvalidRuleNameError:function(e){return"deprecated"},buildDuplicateRuleNameError:function(e){var t;e.topLevelRule instanceof nr?t=e.topLevelRule.name:t=e.topLevelRule;var n="Duplicate definition, rule: ->"+t+"<- is already defined in the grammar: ->"+e.grammarName+"<-";return n}},d0=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r[i]=o[i])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();function h0(e,t){var n=new p0(e,t);return n.resolveRefs(),n.errors}var p0=function(e){d0(t,e);function t(n,r){var o=e.call(this)||this;return o.nameToTopRule=n,o.errMsgProvider=r,o.errors=[],o}return t.prototype.resolveRefs=function(){var n=this;ee(Et(this.nameToTopRule),function(r){n.currTopLevel=r,r.accept(n)})},t.prototype.visitNonTerminal=function(n){var r=this.nameToTopRule[n.nonTerminalName];if(r)n.referencedRule=r;else{var o=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,n);this.errors.push({message:o,type:pt.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:n.nonTerminalName})}},t}(rr),or=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r[i]=o[i])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),v0=function(e){or(t,e);function t(n,r){var o=e.call(this)||this;return o.topProd=n,o.path=r,o.possibleTokTypes=[],o.nextProductionName="",o.nextProductionOccurrence=0,o.found=!1,o.isAtEndOfPath=!1,o}return t.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=yt(this.path.ruleStack).reverse(),this.occurrenceStack=yt(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},t.prototype.walk=function(n,r){r===void 0&&(r=[]),this.found||e.prototype.walk.call(this,n,r)},t.prototype.walkProdRef=function(n,r,o){if(n.referencedRule.name===this.nextProductionName&&n.idx===this.nextProductionOccurrence){var i=r.concat(o);this.updateExpectedNext(),this.walk(n.referencedRule,i)}},t.prototype.updateExpectedNext=function(){Re(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},t}(Ti),m0=function(e){or(t,e);function t(n,r){var o=e.call(this,n,r)||this;return o.path=r,o.nextTerminalName="",o.nextTerminalOccurrence=0,o.nextTerminalName=o.path.lastTok.name,o.nextTerminalOccurrence=o.path.lastTokOccurrence,o}return t.prototype.walkTerminal=function(n,r,o){if(this.isAtEndOfPath&&n.terminalType.name===this.nextTerminalName&&n.idx===this.nextTerminalOccurrence&&!this.found){var i=r.concat(o),c=new it({definition:i});this.possibleTokTypes=to(c),this.found=!0}},t}(v0),Ci=function(e){or(t,e);function t(n,r){var o=e.call(this)||this;return o.topRule=n,o.occurrence=r,o.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},o}return t.prototype.startWalking=function(){return this.walk(this.topRule),this.result},t}(Ti),g0=function(e){or(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.walkMany=function(n,r,o){if(n.idx===this.occurrence){var i=zt(r.concat(o));this.result.isEndOfRule=i===void 0,i instanceof Ce&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkMany.call(this,n,r,o)},t}(Ci),lc=function(e){or(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.walkManySep=function(n,r,o){if(n.idx===this.occurrence){var i=zt(r.concat(o));this.result.isEndOfRule=i===void 0,i instanceof Ce&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkManySep.call(this,n,r,o)},t}(Ci),E0=function(e){or(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.walkAtLeastOne=function(n,r,o){if(n.idx===this.occurrence){var i=zt(r.concat(o));this.result.isEndOfRule=i===void 0,i instanceof Ce&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOne.call(this,n,r,o)},t}(Ci),fc=function(e){or(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.walkAtLeastOneSep=function(n,r,o){if(n.idx===this.occurrence){var i=zt(r.concat(o));this.result.isEndOfRule=i===void 0,i instanceof Ce&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOneSep.call(this,n,r,o)},t}(Ci);function Oa(e,t,n){n===void 0&&(n=[]),n=yt(n);var r=[],o=0;function i(u){return u.concat(et(e,o+1))}function c(u){var a=Oa(i(u),t,n);return r.concat(a)}for(;n.length<t&&o<e.length;){var f=e[o];if(f instanceof it)return c(f.definition);if(f instanceof ht)return c(f.definition);if(f instanceof ot)r=c(f.definition);else if(f instanceof Pt){var h=f.definition.concat([new Fe({definition:f.definition})]);return c(h)}else if(f instanceof St){var h=[new it({definition:f.definition}),new Fe({definition:[new Ce({terminalType:f.separator})].concat(f.definition)})];return c(h)}else if(f instanceof _t){var h=f.definition.concat([new Fe({definition:[new Ce({terminalType:f.separator})].concat(f.definition)})]);r=c(h)}else if(f instanceof Fe){var h=f.definition.concat([new Fe({definition:f.definition})]);r=c(h)}else{if(f instanceof Mt)return ee(f.definition,function(u){Re(u.definition)===!1&&(r=c(u.definition))}),r;if(f instanceof Ce)n.push(f.terminalType);else throw Error("non exhaustive match")}o++}return r.push({partialPath:n,suffixDef:et(e,o)}),r}function wl(e,t,n,r){var o="EXIT_NONE_TERMINAL",i=[o],c="EXIT_ALTERNATIVE",f=!1,h=t.length,u=h-r-1,a=[],s=[];for(s.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!Re(s);){var l=s.pop();if(l===c){f&&el(s).idx<=u&&s.pop();continue}var d=l.def,v=l.idx,p=l.ruleStack,m=l.occurrenceStack;if(!Re(d)){var g=d[0];if(g===o){var E={idx:v,def:et(d),ruleStack:$r(p),occurrenceStack:$r(m)};s.push(E)}else if(g instanceof Ce)if(v<h-1){var y=v+1,w=t[y];if(n(w,g.terminalType)){var E={idx:y,def:et(d),ruleStack:p,occurrenceStack:m};s.push(E)}}else if(v===h-1)a.push({nextTokenType:g.terminalType,nextTokenOccurrence:g.idx,ruleStack:p,occurrenceStack:m}),f=!0;else throw Error("non exhaustive match");else if(g instanceof ht){var T=yt(p);T.push(g.nonTerminalName);var R=yt(m);R.push(g.idx);var E={idx:v,def:g.definition.concat(i,et(d)),ruleStack:T,occurrenceStack:R};s.push(E)}else if(g instanceof ot){var A={idx:v,def:et(d),ruleStack:p,occurrenceStack:m};s.push(A),s.push(c);var C={idx:v,def:g.definition.concat(et(d)),ruleStack:p,occurrenceStack:m};s.push(C)}else if(g instanceof Pt){var x=new Fe({definition:g.definition,idx:g.idx}),O=g.definition.concat([x],et(d)),E={idx:v,def:O,ruleStack:p,occurrenceStack:m};s.push(E)}else if(g instanceof St){var I=new Ce({terminalType:g.separator}),x=new Fe({definition:[I].concat(g.definition),idx:g.idx}),O=g.definition.concat([x],et(d)),E={idx:v,def:O,ruleStack:p,occurrenceStack:m};s.push(E)}else if(g instanceof _t){var A={idx:v,def:et(d),ruleStack:p,occurrenceStack:m};s.push(A),s.push(c);var I=new Ce({terminalType:g.separator}),P=new Fe({definition:[I].concat(g.definition),idx:g.idx}),O=g.definition.concat([P],et(d)),C={idx:v,def:O,ruleStack:p,occurrenceStack:m};s.push(C)}else if(g instanceof Fe){var A={idx:v,def:et(d),ruleStack:p,occurrenceStack:m};s.push(A),s.push(c);var P=new Fe({definition:g.definition,idx:g.idx}),O=g.definition.concat([P],et(d)),C={idx:v,def:O,ruleStack:p,occurrenceStack:m};s.push(C)}else if(g instanceof Mt)for(var B=g.definition.length-1;B>=0;B--){var S=g.definition[B],b={idx:v,def:S.definition.concat(et(d)),ruleStack:p,occurrenceStack:m};s.push(b),s.push(c)}else if(g instanceof it)s.push({idx:v,def:g.definition.concat(et(d)),ruleStack:p,occurrenceStack:m});else if(g instanceof nr)s.push(y0(g,v,p,m));else throw Error("non exhaustive match")}}return a}function y0(e,t,n,r){var o=yt(n);o.push(e.name);var i=yt(r);return i.push(1),{idx:t,def:e.definition,ruleStack:o,occurrenceStack:i}}var Rl=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r[i]=o[i])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),we;(function(e){e[e.OPTION=0]="OPTION",e[e.REPETITION=1]="REPETITION",e[e.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",e[e.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",e[e.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",e[e.ALTERNATION=5]="ALTERNATION"})(we||(we={}));function w0(e){if(e instanceof ot)return we.OPTION;if(e instanceof Fe)return we.REPETITION;if(e instanceof Pt)return we.REPETITION_MANDATORY;if(e instanceof St)return we.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof _t)return we.REPETITION_WITH_SEPARATOR;if(e instanceof Mt)return we.ALTERNATION;throw Error("non exhaustive match")}function R0(e,t,n,r,o,i){var c=is(e,t,n),f=Al(c)?ei:Ri;return i(c,r,f,o)}function N0(e,t,n,r,o,i){var c=as(e,t,o,n),f=Al(c)?ei:Ri;return i(c[0],f,r)}function T0(e,t,n,r){var o=e.length,i=Ut(e,function(h){return Ut(h,function(u){return u.length===1})});if(t)return function(h){for(var u=Y(h,function(y){return y.GATE}),a=0;a<o;a++){var s=e[a],l=s.length,d=u[a];if(d!==void 0&&d.call(this)===!1)continue;e:for(var v=0;v<l;v++){for(var p=s[v],m=p.length,g=0;g<m;g++){var E=this.LA(g+1);if(n(E,p[g])===!1)continue e}return a}}};if(i&&!r){var c=Y(e,function(h){return Ot(h)}),f=tt(c,function(h,u,a){return ee(u,function(s){ne(h,s.tokenTypeIdx)||(h[s.tokenTypeIdx]=a),ee(s.categoryMatches,function(l){ne(h,l)||(h[l]=a)})}),h},[]);return function(){var h=this.LA(1);return f[h.tokenTypeIdx]}}else return function(){for(var h=0;h<o;h++){var u=e[h],a=u.length;e:for(var s=0;s<a;s++){for(var l=u[s],d=l.length,v=0;v<d;v++){var p=this.LA(v+1);if(n(p,l[v])===!1)continue e}return h}}}}function A0(e,t,n){var r=Ut(e,function(u){return u.length===1}),o=e.length;if(r&&!n){var i=Ot(e);if(i.length===1&&Re(i[0].categoryMatches)){var c=i[0],f=c.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===f}}else{var h=tt(i,function(u,a,s){return u[a.tokenTypeIdx]=!0,ee(a.categoryMatches,function(l){u[l]=!0}),u},[]);return function(){var u=this.LA(1);return h[u.tokenTypeIdx]===!0}}}else return function(){e:for(var u=0;u<o;u++){for(var a=e[u],s=a.length,l=0;l<s;l++){var d=this.LA(l+1);if(t(d,a[l])===!1)continue e}return!0}return!1}}var C0=function(e){Rl(t,e);function t(n,r,o){var i=e.call(this)||this;return i.topProd=n,i.targetOccurrence=r,i.targetProdType=o,i}return t.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},t.prototype.checkIsTarget=function(n,r,o,i){return n.idx===this.targetOccurrence&&this.targetProdType===r?(this.restDef=o.concat(i),!0):!1},t.prototype.walkOption=function(n,r,o){this.checkIsTarget(n,we.OPTION,r,o)||e.prototype.walkOption.call(this,n,r,o)},t.prototype.walkAtLeastOne=function(n,r,o){this.checkIsTarget(n,we.REPETITION_MANDATORY,r,o)||e.prototype.walkOption.call(this,n,r,o)},t.prototype.walkAtLeastOneSep=function(n,r,o){this.checkIsTarget(n,we.REPETITION_MANDATORY_WITH_SEPARATOR,r,o)||e.prototype.walkOption.call(this,n,r,o)},t.prototype.walkMany=function(n,r,o){this.checkIsTarget(n,we.REPETITION,r,o)||e.prototype.walkOption.call(this,n,r,o)},t.prototype.walkManySep=function(n,r,o){this.checkIsTarget(n,we.REPETITION_WITH_SEPARATOR,r,o)||e.prototype.walkOption.call(this,n,r,o)},t}(Ti),Nl=function(e){Rl(t,e);function t(n,r,o){var i=e.call(this)||this;return i.targetOccurrence=n,i.targetProdType=r,i.targetRef=o,i.result=[],i}return t.prototype.checkIsTarget=function(n,r){n.idx===this.targetOccurrence&&this.targetProdType===r&&(this.targetRef===void 0||n===this.targetRef)&&(this.result=n.definition)},t.prototype.visitOption=function(n){this.checkIsTarget(n,we.OPTION)},t.prototype.visitRepetition=function(n){this.checkIsTarget(n,we.REPETITION)},t.prototype.visitRepetitionMandatory=function(n){this.checkIsTarget(n,we.REPETITION_MANDATORY)},t.prototype.visitRepetitionMandatoryWithSeparator=function(n){this.checkIsTarget(n,we.REPETITION_MANDATORY_WITH_SEPARATOR)},t.prototype.visitRepetitionWithSeparator=function(n){this.checkIsTarget(n,we.REPETITION_WITH_SEPARATOR)},t.prototype.visitAlternation=function(n){this.checkIsTarget(n,we.ALTERNATION)},t}(rr);function dc(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=[];return t}function Ji(e){for(var t=[""],n=0;n<e.length;n++){for(var r=e[n],o=[],i=0;i<t.length;i++){var c=t[i];o.push(c+"_"+r.tokenTypeIdx);for(var f=0;f<r.categoryMatches.length;f++){var h="_"+r.categoryMatches[f];o.push(c+h)}}t=o}return t}function x0(e,t,n){for(var r=0;r<e.length;r++)if(r!==n)for(var o=e[r],i=0;i<t.length;i++){var c=t[i];if(o[c]===!0)return!1}return!0}function Tl(e,t){for(var n=Y(e,function(a){return Oa([a],1)}),r=dc(n.length),o=Y(n,function(a){var s={};return ee(a,function(l){var d=Ji(l.partialPath);ee(d,function(v){s[v]=!0})}),s}),i=n,c=1;c<=t;c++){var f=i;i=dc(f.length);for(var h=function(a){for(var s=f[a],l=0;l<s.length;l++){var d=s[l].partialPath,v=s[l].suffixDef,p=Ji(d),m=x0(o,p,a);if(m||Re(v)||d.length===t){var g=r[a];if(Ia(g,d)===!1){g.push(d);for(var E=0;E<p.length;E++){var y=p[E];o[a][y]=!0}}}else{var w=Oa(v,c+1,d);i[a]=i[a].concat(w),ee(w,function(T){var R=Ji(T.partialPath);ee(R,function(A){o[a][A]=!0})})}}},u=0;u<f.length;u++)h(u)}return r}function is(e,t,n,r){var o=new Nl(e,we.ALTERNATION,r);return t.accept(o),Tl(o.result,n)}function as(e,t,n,r){var o=new Nl(e,n);t.accept(o);var i=o.result,c=new C0(t,e,n),f=c.startWalking(),h=new it({definition:i}),u=new it({definition:f});return Tl([h,u],r)}function Ia(e,t){e:for(var n=0;n<e.length;n++){var r=e[n];if(r.length===t.length){for(var o=0;o<r.length;o++){var i=t[o],c=r[o],f=i===c||c.categoryMatchesMap[i.tokenTypeIdx]!==void 0;if(f===!1)continue e}return!0}}return!1}function O0(e,t){return e.length<t.length&&Ut(e,function(n,r){var o=t[r];return n===o||o.categoryMatchesMap[n.tokenTypeIdx]})}function Al(e){return Ut(e,function(t){return Ut(t,function(n){return Ut(n,function(r){return Re(r.categoryMatches)})})})}var ss=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r[i]=o[i])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();function I0(e,t,n,r,o){var i=Y(e,function(d){return _0(d,r)}),c=Y(e,function(d){return xl(d,d,r)}),f=[],h=[],u=[];Ut(c,Re)&&(f=Y(e,function(d){return k0(d,r)}),h=Y(e,function(d){return P0(d,t,r)}),u=B0(e,t,r));var a=V0(e,n,r),s=Y(e,function(d){return F0(d,r)}),l=Y(e,function(d){return L0(d,e,o,r)});return Ot(i.concat(u,c,f,h,a,s,l))}function _0(e,t){var n=new b0;e.accept(n);var r=n.allProductions,o=fp(r,M0),i=Kt(o,function(f){return f.length>1}),c=Y(Et(i),function(f){var h=zt(f),u=t.buildDuplicateFoundError(e,f),a=Jt(h),s={message:u,type:pt.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:a,occurrence:h.idx},l=Cl(h);return l&&(s.parameter=l),s});return c}function M0(e){return Jt(e)+"_#_"+e.idx+"_#_"+Cl(e)}function Cl(e){return e instanceof Ce?e.terminalType.name:e instanceof ht?e.nonTerminalName:""}var b0=function(e){ss(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.allProductions=[],n}return t.prototype.visitNonTerminal=function(n){this.allProductions.push(n)},t.prototype.visitOption=function(n){this.allProductions.push(n)},t.prototype.visitRepetitionWithSeparator=function(n){this.allProductions.push(n)},t.prototype.visitRepetitionMandatory=function(n){this.allProductions.push(n)},t.prototype.visitRepetitionMandatoryWithSeparator=function(n){this.allProductions.push(n)},t.prototype.visitRepetition=function(n){this.allProductions.push(n)},t.prototype.visitAlternation=function(n){this.allProductions.push(n)},t.prototype.visitTerminal=function(n){this.allProductions.push(n)},t}(rr);function L0(e,t,n,r){var o=[],i=tt(t,function(f,h){return h.name===e.name?f+1:f},0);if(i>1){var c=r.buildDuplicateRuleNameError({topLevelRule:e,grammarName:n});o.push({message:c,type:pt.DUPLICATE_RULE_NAME,ruleName:e.name})}return o}function U0(e,t,n){var r=[],o;return He(t,e)||(o="Invalid rule override, rule: ->"+e+"<- cannot be overridden in the grammar: ->"+n+"<-as it is not defined in any of the super grammars ",r.push({message:o,type:pt.INVALID_RULE_OVERRIDE,ruleName:e})),r}function xl(e,t,n,r){r===void 0&&(r=[]);var o=[],i=$o(t.definition);if(Re(i))return[];var c=e.name,f=He(i,e);f&&o.push({message:n.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:r}),type:pt.LEFT_RECURSION,ruleName:c});var h=yi(i,r.concat([e])),u=Y(h,function(a){var s=yt(r);return s.push(a),xl(e,a,n,s)});return o.concat(Ot(u))}function $o(e){var t=[];if(Re(e))return t;var n=zt(e);if(n instanceof ht)t.push(n.referencedRule);else if(n instanceof it||n instanceof ot||n instanceof Pt||n instanceof St||n instanceof _t||n instanceof Fe)t=t.concat($o(n.definition));else if(n instanceof Mt)t=Ot(Y(n.definition,function(c){return $o(c.definition)}));else if(!(n instanceof Ce))throw Error("non exhaustive match");var r=ti(n),o=e.length>1;if(r&&o){var i=et(e);return t.concat($o(i))}else return t}var cs=function(e){ss(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.alternations=[],n}return t.prototype.visitAlternation=function(n){this.alternations.push(n)},t}(rr);function k0(e,t){var n=new cs;e.accept(n);var r=n.alternations,o=tt(r,function(i,c){var f=$r(c.definition),h=Y(f,function(u,a){var s=wl([u],[],null,1);return Re(s)?{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:c,emptyChoiceIdx:a}),type:pt.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:c.idx,alternative:a+1}:null});return i.concat(jr(h))},[]);return o}function P0(e,t,n){var r=new cs;e.accept(r);var o=r.alternations;o=Rr(o,function(c){return c.ignoreAmbiguities===!0});var i=tt(o,function(c,f){var h=f.idx,u=f.maxLookahead||t,a=is(h,e,u,f),s=D0(a,f,e,n),l=$0(a,f,e,n);return c.concat(s,l)},[]);return i}var S0=function(e){ss(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.allProductions=[],n}return t.prototype.visitRepetitionWithSeparator=function(n){this.allProductions.push(n)},t.prototype.visitRepetitionMandatory=function(n){this.allProductions.push(n)},t.prototype.visitRepetitionMandatoryWithSeparator=function(n){this.allProductions.push(n)},t.prototype.visitRepetition=function(n){this.allProductions.push(n)},t}(rr);function F0(e,t){var n=new cs;e.accept(n);var r=n.alternations,o=tt(r,function(i,c){return c.definition.length>255&&i.push({message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:c}),type:pt.TOO_MANY_ALTS,ruleName:e.name,occurrence:c.idx}),i},[]);return o}function B0(e,t,n){var r=[];return ee(e,function(o){var i=new S0;o.accept(i);var c=i.allProductions;ee(c,function(f){var h=w0(f),u=f.maxLookahead||t,a=f.idx,s=as(a,o,h,u),l=s[0];if(Re(Ot(l))){var d=n.buildEmptyRepetitionError({topLevelRule:o,repetition:f});r.push({message:d,type:pt.NO_NON_EMPTY_LOOKAHEAD,ruleName:o.name})}})}),r}function D0(e,t,n,r){var o=[],i=tt(e,function(f,h,u){return t.definition[u].ignoreAmbiguities===!0||ee(h,function(a){var s=[u];ee(e,function(l,d){u!==d&&Ia(l,a)&&t.definition[d].ignoreAmbiguities!==!0&&s.push(d)}),s.length>1&&!Ia(o,a)&&(o.push(a),f.push({alts:s,path:a}))}),f},[]),c=Y(i,function(f){var h=Y(f.alts,function(a){return a+1}),u=r.buildAlternationAmbiguityError({topLevelRule:n,alternation:t,ambiguityIndices:h,prefixPath:f.path});return{message:u,type:pt.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:t.idx,alternatives:[f.alts]}});return c}function $0(e,t,n,r){var o=[],i=tt(e,function(c,f,h){var u=Y(f,function(a){return{idx:h,path:a}});return c.concat(u)},[]);return ee(i,function(c){var f=t.definition[c.idx];if(f.ignoreAmbiguities!==!0){var h=c.idx,u=c.path,a=cp(i,function(l){return t.definition[l.idx].ignoreAmbiguities!==!0&&l.idx<h&&O0(l.path,u)}),s=Y(a,function(l){var d=[l.idx+1,h+1],v=t.idx===0?"":t.idx,p=r.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:t,ambiguityIndices:d,prefixPath:l.path});return{message:p,type:pt.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:v,alternatives:d}});o=o.concat(s)}}),o}function V0(e,t,n){var r=[],o=Y(t,function(i){return i.name});return ee(e,function(i){var c=i.name;if(He(o,c)){var f=n.buildNamespaceConflictError(i);r.push({message:f,type:pt.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:c})}}),r}function Ol(e){e=ts(e,{errMsgProvider:yl});var t={};return ee(e.rules,function(n){t[n.name]=n}),h0(t,e.errMsgProvider)}function Il(e){return e=ts(e,{errMsgProvider:Ai}),I0(e.rules,e.maxLookahead,e.tokenTypes,e.errMsgProvider,e.grammarName)}function G0(e){ee(e.rules,function(t){var n=new gl;t.accept(n),ee(n.dslMethods,function(r){ee(r,function(o,i){o.idx=i+1})})})}var no=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r[i]=o[i])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),_l="MismatchedTokenException",Ml="NoViableAltException",bl="EarlyExitException",Ll="NotAllInputParsedException",Ul=[_l,Ml,bl,Ll];Object.freeze(Ul);function Vr(e){return He(Ul,e.name)}var xi=function(e){no(t,e);function t(n,r){var o=this.constructor,i=e.call(this,n)||this;return i.token=r,i.resyncedTokens=[],Object.setPrototypeOf(i,o.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,i.constructor),i}return t}(Error),us=function(e){no(t,e);function t(n,r,o){var i=e.call(this,n,r)||this;return i.previousToken=o,i.name=_l,i}return t}(xi),kl=function(e){no(t,e);function t(n,r,o){var i=e.call(this,n,r)||this;return i.previousToken=o,i.name=Ml,i}return t}(xi),Pl=function(e){no(t,e);function t(n,r){var o=e.call(this,n,r)||this;return o.name=Ll,o}return t}(xi),Sl=function(e){no(t,e);function t(n,r,o){var i=e.call(this,n,r)||this;return i.previousToken=o,i.name=bl,i}return t}(xi),ji={},Fl="InRuleRecoveryException";function Bl(e){this.name=Fl,this.message=e}Bl.prototype=Error.prototype;var H0=function(){function e(){}return e.prototype.initRecoverable=function(t){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=ne(t,"recoveryEnabled")?t.recoveryEnabled:Tn.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=W0)},e.prototype.getTokenToInsert=function(t){var n=Ni(t,"",NaN,NaN,NaN,NaN,NaN,NaN);return n.isInsertedInRecovery=!0,n},e.prototype.canTokenTypeBeInsertedInRecovery=function(t){return!0},e.prototype.tryInRepetitionRecovery=function(t,n,r,o){for(var i=this,c=this.findReSyncTokenType(),f=this.exportLexerState(),h=[],u=!1,a=this.LA(1),s=this.LA(1),l=function(){var d=i.LA(0),v=i.errorMessageProvider.buildMismatchTokenMessage({expected:o,actual:a,previous:d,ruleName:i.getCurrRuleFullName()}),p=new us(v,a,i.LA(0));p.resyncedTokens=$r(h),i.SAVE_ERROR(p)};!u;)if(this.tokenMatcher(s,o)){l();return}else if(r.call(this)){l(),t.apply(this,n);return}else this.tokenMatcher(s,c)?u=!0:(s=this.SKIP_TOKEN(),this.addToResyncTokens(s,h));this.importLexerState(f)},e.prototype.shouldInRepetitionRecoveryBeTried=function(t,n,r){return!(r===!1||t===void 0||n===void 0||this.tokenMatcher(this.LA(1),t)||this.isBackTracking()||this.canPerformInRuleRecovery(t,this.getFollowsForInRuleRecovery(t,n)))},e.prototype.getFollowsForInRuleRecovery=function(t,n){var r=this.getCurrentGrammarPath(t,n),o=this.getNextPossibleTokenTypes(r);return o},e.prototype.tryInRuleRecovery=function(t,n){if(this.canRecoverWithSingleTokenInsertion(t,n)){var r=this.getTokenToInsert(t);return r}if(this.canRecoverWithSingleTokenDeletion(t)){var o=this.SKIP_TOKEN();return this.consumeToken(),o}throw new Bl("sad sad panda")},e.prototype.canPerformInRuleRecovery=function(t,n){return this.canRecoverWithSingleTokenInsertion(t,n)||this.canRecoverWithSingleTokenDeletion(t)},e.prototype.canRecoverWithSingleTokenInsertion=function(t,n){var r=this;if(!this.canTokenTypeBeInsertedInRecovery(t)||Re(n))return!1;var o=this.LA(1),i=Er(n,function(c){return r.tokenMatcher(o,c)})!==void 0;return i},e.prototype.canRecoverWithSingleTokenDeletion=function(t){var n=this.tokenMatcher(this.LA(2),t);return n},e.prototype.isInCurrentRuleReSyncSet=function(t){var n=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(n);return He(r,t)},e.prototype.findReSyncTokenType=function(){for(var t=this.flattenFollowSet(),n=this.LA(1),r=2;;){var o=n.tokenType;if(He(t,o))return o;n=this.LA(r),r++}},e.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return ji;var t=this.getLastExplicitRuleShortName(),n=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(t),idxInCallingRule:n,inRule:this.shortRuleNameToFullName(r)}},e.prototype.buildFullFollowKeyStack=function(){var t=this,n=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return Y(n,function(o,i){return i===0?ji:{ruleName:t.shortRuleNameToFullName(o),idxInCallingRule:r[i],inRule:t.shortRuleNameToFullName(n[i-1])}})},e.prototype.flattenFollowSet=function(){var t=this,n=Y(this.buildFullFollowKeyStack(),function(r){return t.getFollowSetFromFollowKey(r)});return Ot(n)},e.prototype.getFollowSetFromFollowKey=function(t){if(t===ji)return[Pn];var n=t.ruleName+t.idxInCallingRule+El+t.inRule;return this.resyncFollows[n]},e.prototype.addToResyncTokens=function(t,n){return this.tokenMatcher(t,Pn)||n.push(t),n},e.prototype.reSyncTo=function(t){for(var n=[],r=this.LA(1);this.tokenMatcher(r,t)===!1;)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,n);return $r(n)},e.prototype.attemptInRepetitionRecovery=function(t,n,r,o,i,c,f){},e.prototype.getCurrentGrammarPath=function(t,n){var r=this.getHumanReadableRuleStack(),o=yt(this.RULE_OCCURRENCE_STACK),i={ruleStack:r,occurrenceStack:o,lastTok:t,lastTokOccurrence:n};return i},e.prototype.getHumanReadableRuleStack=function(){var t=this;return Y(this.RULE_STACK,function(n){return t.shortRuleNameToFullName(n)})},e}();function W0(e,t,n,r,o,i,c){var f=this.getKeyForAutomaticLookahead(r,o),h=this.firstAfterRepMap[f];if(h===void 0){var u=this.getCurrRuleFullName(),a=this.getGAstProductions()[u],s=new i(a,o);h=s.startWalking(),this.firstAfterRepMap[f]=h}var l=h.token,d=h.occurrence,v=h.isEndOfRule;this.RULE_STACK.length===1&&v&&l===void 0&&(l=Pn,d=1),this.shouldInRepetitionRecoveryBeTried(l,d,c)&&this.tryInRepetitionRecovery(e,t,n,l)}var z0=4,Gn=8,Dl=1<<Gn,$l=2<<Gn,_a=3<<Gn,Ma=4<<Gn,ba=5<<Gn,Vo=6<<Gn;function ea(e,t,n){return n|t|e}var q0=function(){function e(){}return e.prototype.initLooksAhead=function(t){this.dynamicTokensEnabled=ne(t,"dynamicTokensEnabled")?t.dynamicTokensEnabled:Tn.dynamicTokensEnabled,this.maxLookahead=ne(t,"maxLookahead")?t.maxLookahead:Tn.maxLookahead,this.lookAheadFuncsCache=Xs()?new Map:[],Xs()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},e.prototype.preComputeLookaheadFunctions=function(t){var n=this;ee(t,function(r){n.TRACE_INIT(r.name+" Rule Lookahead",function(){var o=o0(r),i=o.alternation,c=o.repetition,f=o.option,h=o.repetitionMandatory,u=o.repetitionMandatoryWithSeparator,a=o.repetitionWithSeparator;ee(i,function(s){var l=s.idx===0?"":s.idx;n.TRACE_INIT(""+Jt(s)+l,function(){var d=R0(s.idx,r,s.maxLookahead||n.maxLookahead,s.hasPredicates,n.dynamicTokensEnabled,n.lookAheadBuilderForAlternatives),v=ea(n.fullRuleNameToShort[r.name],Dl,s.idx);n.setLaFuncCache(v,d)})}),ee(c,function(s){n.computeLookaheadFunc(r,s.idx,_a,we.REPETITION,s.maxLookahead,Jt(s))}),ee(f,function(s){n.computeLookaheadFunc(r,s.idx,$l,we.OPTION,s.maxLookahead,Jt(s))}),ee(h,function(s){n.computeLookaheadFunc(r,s.idx,Ma,we.REPETITION_MANDATORY,s.maxLookahead,Jt(s))}),ee(u,function(s){n.computeLookaheadFunc(r,s.idx,Vo,we.REPETITION_MANDATORY_WITH_SEPARATOR,s.maxLookahead,Jt(s))}),ee(a,function(s){n.computeLookaheadFunc(r,s.idx,ba,we.REPETITION_WITH_SEPARATOR,s.maxLookahead,Jt(s))})})})},e.prototype.computeLookaheadFunc=function(t,n,r,o,i,c){var f=this;this.TRACE_INIT(""+c+(n===0?"":n),function(){var h=N0(n,t,i||f.maxLookahead,f.dynamicTokensEnabled,o,f.lookAheadBuilderForOptional),u=ea(f.fullRuleNameToShort[t.name],r,n);f.setLaFuncCache(u,h)})},e.prototype.lookAheadBuilderForOptional=function(t,n,r){return A0(t,n,r)},e.prototype.lookAheadBuilderForAlternatives=function(t,n,r,o){return T0(t,n,r,o)},e.prototype.getKeyForAutomaticLookahead=function(t,n){var r=this.getLastExplicitRuleShortName();return ea(r,t,n)},e.prototype.getLaFuncFromCache=function(t){},e.prototype.getLaFuncFromMap=function(t){return this.lookAheadFuncsCache.get(t)},e.prototype.getLaFuncFromObj=function(t){return this.lookAheadFuncsCache[t]},e.prototype.setLaFuncCache=function(t,n){},e.prototype.setLaFuncCacheUsingMap=function(t,n){this.lookAheadFuncsCache.set(t,n)},e.prototype.setLaFuncUsingObj=function(t,n){this.lookAheadFuncsCache[t]=n},e}();function hc(e,t){isNaN(e.startOffset)===!0?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset&&(e.endOffset=t.endOffset)}function pc(e,t){isNaN(e.startOffset)===!0?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)}function K0(e,t,n){e.children[n]===void 0?e.children[n]=[t]:e.children[n].push(t)}function Y0(e,t,n){e.children[t]===void 0?e.children[t]=[n]:e.children[t].push(n)}function X0(e){return Oi(e.constructor)}var vc="name";function Oi(e){var t=e.name;return t||"anonymous"}function Vl(e,t){var n=Object.getOwnPropertyDescriptor(e,vc);return Rn(n)||n.configurable?(Object.defineProperty(e,vc,{enumerable:!1,configurable:!0,writable:!1,value:t}),!0):!1}function Q0(e,t){for(var n=Wt(e),r=n.length,o=0;o<r;o++)for(var i=n[o],c=e[i],f=c.length,h=0;h<f;h++){var u=c[h];u.tokenTypeIdx===void 0&&this[u.name](u.children,t)}}function Z0(e,t){var n=function(){};Vl(n,e+"BaseSemantics");var r={visit:function(o,i){if(en(o)&&(o=o[0]),!Rn(o))return this[o.name](o.children,i)},validateVisitor:function(){var o=j0(this,t);if(!Re(o)){var i=Y(o,function(c){return c.msg});throw Error("Errors Detected in CST Visitor <"+Oi(this.constructor)+`>:
	`+(""+i.join(`

`).replace(/\n/g,`
	`)))}}};return n.prototype=r,n.prototype.constructor=n,n._RULE_NAMES=t,n}function J0(e,t,n){var r=function(){};Vl(r,e+"BaseSemanticsWithDefaults");var o=Object.create(n.prototype);return ee(t,function(i){o[i]=Q0}),r.prototype=o,r.prototype.constructor=r,r}var ni;(function(e){e[e.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",e[e.MISSING_METHOD=1]="MISSING_METHOD"})(ni||(ni={}));function j0(e,t){var n=ev(e,t),r=nv(e,t);return n.concat(r)}function ev(e,t){var n=Y(t,function(r){if(!Vn(e[r]))return{msg:"Missing visitor method: <"+r+"> on "+Oi(e.constructor)+" CST Visitor.",type:ni.MISSING_METHOD,methodName:r}});return jr(n)}var tv=["constructor","visit","validateVisitor"];function nv(e,t){var n=[];for(var r in e)Vn(e[r])&&!He(tv,r)&&!He(t,r)&&n.push({msg:"Redundant visitor method: <"+r+"> on "+Oi(e.constructor)+` CST Visitor
There is no Grammar Rule corresponding to this method's name.
`,type:ni.REDUNDANT_METHOD,methodName:r});return n}var rv=function(){function e(){}return e.prototype.initTreeBuilder=function(t){if(this.CST_STACK=[],this.outputCst=t.outputCst,this.nodeLocationTracking=ne(t,"nodeLocationTracking")?t.nodeLocationTracking:Tn.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=Ke,this.cstFinallyStateUpdate=Ke,this.cstPostTerminal=Ke,this.cstPostNonTerminal=Ke,this.cstPostRule=Ke;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=pc,this.setNodeLocationFromNode=pc,this.cstPostRule=Ke,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=Ke,this.setNodeLocationFromNode=Ke,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=hc,this.setNodeLocationFromNode=hc,this.cstPostRule=Ke,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=Ke,this.setNodeLocationFromNode=Ke,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=Ke,this.setNodeLocationFromNode=Ke,this.cstPostRule=Ke,this.setInitialNodeLocation=Ke;else throw Error('Invalid <nodeLocationTracking> config option: "'+t.nodeLocationTracking+'"')},e.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(t){t.location={startOffset:NaN,endOffset:NaN}},e.prototype.setInitialNodeLocationOnlyOffsetRegular=function(t){t.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},e.prototype.setInitialNodeLocationFullRecovery=function(t){t.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.setInitialNodeLocationFullRegular=function(t){var n=this.LA(1);t.location={startOffset:n.startOffset,startLine:n.startLine,startColumn:n.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.cstInvocationStateUpdate=function(t,n){var r={name:t,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},e.prototype.cstFinallyStateUpdate=function(){this.CST_STACK.pop()},e.prototype.cstPostRuleFull=function(t){var n=this.LA(0),r=t.location;r.startOffset<=n.startOffset?(r.endOffset=n.endOffset,r.endLine=n.endLine,r.endColumn=n.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)},e.prototype.cstPostRuleOnlyOffset=function(t){var n=this.LA(0),r=t.location;r.startOffset<=n.startOffset?r.endOffset=n.endOffset:r.startOffset=NaN},e.prototype.cstPostTerminal=function(t,n){var r=this.CST_STACK[this.CST_STACK.length-1];K0(r,n,t),this.setNodeLocationFromToken(r.location,n)},e.prototype.cstPostNonTerminal=function(t,n){var r=this.CST_STACK[this.CST_STACK.length-1];Y0(r,n,t),this.setNodeLocationFromNode(r.location,t.location)},e.prototype.getBaseCstVisitorConstructor=function(){if(Rn(this.baseCstVisitorConstructor)){var t=Z0(this.className,Wt(this.gastProductionsCache));return this.baseCstVisitorConstructor=t,t}return this.baseCstVisitorConstructor},e.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(Rn(this.baseCstVisitorWithDefaultsConstructor)){var t=J0(this.className,Wt(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=t,t}return this.baseCstVisitorWithDefaultsConstructor},e.prototype.getLastExplicitRuleShortName=function(){var t=this.RULE_STACK;return t[t.length-1]},e.prototype.getPreviousExplicitRuleShortName=function(){var t=this.RULE_STACK;return t[t.length-2]},e.prototype.getLastExplicitRuleOccurrenceIndex=function(){var t=this.RULE_OCCURRENCE_STACK;return t[t.length-1]},e}(),ov=function(){function e(){}return e.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(e.prototype,"input",{get:function(){return this.tokVector},set:function(t){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=t,this.tokVectorLength=t.length},enumerable:!1,configurable:!0}),e.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):oi},e.prototype.LA=function(t){var n=this.currIdx+t;return n<0||this.tokVectorLength<=n?oi:this.tokVector[n]},e.prototype.consumeToken=function(){this.currIdx++},e.prototype.exportLexerState=function(){return this.currIdx},e.prototype.importLexerState=function(t){this.currIdx=t},e.prototype.resetLexerState=function(){this.currIdx=-1},e.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},e.prototype.getLexerPosition=function(){return this.exportLexerState()},e}(),iv=function(){function e(){}return e.prototype.ACTION=function(t){return t.call(this)},e.prototype.consume=function(t,n,r){return this.consumeInternal(n,t,r)},e.prototype.subrule=function(t,n,r){return this.subruleInternal(n,t,r)},e.prototype.option=function(t,n){return this.optionInternal(n,t)},e.prototype.or=function(t,n){return this.orInternal(n,t)},e.prototype.many=function(t,n){return this.manyInternal(t,n)},e.prototype.atLeastOne=function(t,n){return this.atLeastOneInternal(t,n)},e.prototype.CONSUME=function(t,n){return this.consumeInternal(t,0,n)},e.prototype.CONSUME1=function(t,n){return this.consumeInternal(t,1,n)},e.prototype.CONSUME2=function(t,n){return this.consumeInternal(t,2,n)},e.prototype.CONSUME3=function(t,n){return this.consumeInternal(t,3,n)},e.prototype.CONSUME4=function(t,n){return this.consumeInternal(t,4,n)},e.prototype.CONSUME5=function(t,n){return this.consumeInternal(t,5,n)},e.prototype.CONSUME6=function(t,n){return this.consumeInternal(t,6,n)},e.prototype.CONSUME7=function(t,n){return this.consumeInternal(t,7,n)},e.prototype.CONSUME8=function(t,n){return this.consumeInternal(t,8,n)},e.prototype.CONSUME9=function(t,n){return this.consumeInternal(t,9,n)},e.prototype.SUBRULE=function(t,n){return this.subruleInternal(t,0,n)},e.prototype.SUBRULE1=function(t,n){return this.subruleInternal(t,1,n)},e.prototype.SUBRULE2=function(t,n){return this.subruleInternal(t,2,n)},e.prototype.SUBRULE3=function(t,n){return this.subruleInternal(t,3,n)},e.prototype.SUBRULE4=function(t,n){return this.subruleInternal(t,4,n)},e.prototype.SUBRULE5=function(t,n){return this.subruleInternal(t,5,n)},e.prototype.SUBRULE6=function(t,n){return this.subruleInternal(t,6,n)},e.prototype.SUBRULE7=function(t,n){return this.subruleInternal(t,7,n)},e.prototype.SUBRULE8=function(t,n){return this.subruleInternal(t,8,n)},e.prototype.SUBRULE9=function(t,n){return this.subruleInternal(t,9,n)},e.prototype.OPTION=function(t){return this.optionInternal(t,0)},e.prototype.OPTION1=function(t){return this.optionInternal(t,1)},e.prototype.OPTION2=function(t){return this.optionInternal(t,2)},e.prototype.OPTION3=function(t){return this.optionInternal(t,3)},e.prototype.OPTION4=function(t){return this.optionInternal(t,4)},e.prototype.OPTION5=function(t){return this.optionInternal(t,5)},e.prototype.OPTION6=function(t){return this.optionInternal(t,6)},e.prototype.OPTION7=function(t){return this.optionInternal(t,7)},e.prototype.OPTION8=function(t){return this.optionInternal(t,8)},e.prototype.OPTION9=function(t){return this.optionInternal(t,9)},e.prototype.OR=function(t){return this.orInternal(t,0)},e.prototype.OR1=function(t){return this.orInternal(t,1)},e.prototype.OR2=function(t){return this.orInternal(t,2)},e.prototype.OR3=function(t){return this.orInternal(t,3)},e.prototype.OR4=function(t){return this.orInternal(t,4)},e.prototype.OR5=function(t){return this.orInternal(t,5)},e.prototype.OR6=function(t){return this.orInternal(t,6)},e.prototype.OR7=function(t){return this.orInternal(t,7)},e.prototype.OR8=function(t){return this.orInternal(t,8)},e.prototype.OR9=function(t){return this.orInternal(t,9)},e.prototype.MANY=function(t){this.manyInternal(0,t)},e.prototype.MANY1=function(t){this.manyInternal(1,t)},e.prototype.MANY2=function(t){this.manyInternal(2,t)},e.prototype.MANY3=function(t){this.manyInternal(3,t)},e.prototype.MANY4=function(t){this.manyInternal(4,t)},e.prototype.MANY5=function(t){this.manyInternal(5,t)},e.prototype.MANY6=function(t){this.manyInternal(6,t)},e.prototype.MANY7=function(t){this.manyInternal(7,t)},e.prototype.MANY8=function(t){this.manyInternal(8,t)},e.prototype.MANY9=function(t){this.manyInternal(9,t)},e.prototype.MANY_SEP=function(t){this.manySepFirstInternal(0,t)},e.prototype.MANY_SEP1=function(t){this.manySepFirstInternal(1,t)},e.prototype.MANY_SEP2=function(t){this.manySepFirstInternal(2,t)},e.prototype.MANY_SEP3=function(t){this.manySepFirstInternal(3,t)},e.prototype.MANY_SEP4=function(t){this.manySepFirstInternal(4,t)},e.prototype.MANY_SEP5=function(t){this.manySepFirstInternal(5,t)},e.prototype.MANY_SEP6=function(t){this.manySepFirstInternal(6,t)},e.prototype.MANY_SEP7=function(t){this.manySepFirstInternal(7,t)},e.prototype.MANY_SEP8=function(t){this.manySepFirstInternal(8,t)},e.prototype.MANY_SEP9=function(t){this.manySepFirstInternal(9,t)},e.prototype.AT_LEAST_ONE=function(t){this.atLeastOneInternal(0,t)},e.prototype.AT_LEAST_ONE1=function(t){return this.atLeastOneInternal(1,t)},e.prototype.AT_LEAST_ONE2=function(t){this.atLeastOneInternal(2,t)},e.prototype.AT_LEAST_ONE3=function(t){this.atLeastOneInternal(3,t)},e.prototype.AT_LEAST_ONE4=function(t){this.atLeastOneInternal(4,t)},e.prototype.AT_LEAST_ONE5=function(t){this.atLeastOneInternal(5,t)},e.prototype.AT_LEAST_ONE6=function(t){this.atLeastOneInternal(6,t)},e.prototype.AT_LEAST_ONE7=function(t){this.atLeastOneInternal(7,t)},e.prototype.AT_LEAST_ONE8=function(t){this.atLeastOneInternal(8,t)},e.prototype.AT_LEAST_ONE9=function(t){this.atLeastOneInternal(9,t)},e.prototype.AT_LEAST_ONE_SEP=function(t){this.atLeastOneSepFirstInternal(0,t)},e.prototype.AT_LEAST_ONE_SEP1=function(t){this.atLeastOneSepFirstInternal(1,t)},e.prototype.AT_LEAST_ONE_SEP2=function(t){this.atLeastOneSepFirstInternal(2,t)},e.prototype.AT_LEAST_ONE_SEP3=function(t){this.atLeastOneSepFirstInternal(3,t)},e.prototype.AT_LEAST_ONE_SEP4=function(t){this.atLeastOneSepFirstInternal(4,t)},e.prototype.AT_LEAST_ONE_SEP5=function(t){this.atLeastOneSepFirstInternal(5,t)},e.prototype.AT_LEAST_ONE_SEP6=function(t){this.atLeastOneSepFirstInternal(6,t)},e.prototype.AT_LEAST_ONE_SEP7=function(t){this.atLeastOneSepFirstInternal(7,t)},e.prototype.AT_LEAST_ONE_SEP8=function(t){this.atLeastOneSepFirstInternal(8,t)},e.prototype.AT_LEAST_ONE_SEP9=function(t){this.atLeastOneSepFirstInternal(9,t)},e.prototype.RULE=function(t,n,r){if(r===void 0&&(r=ii),He(this.definedRulesNames,t)){var o=Ai.buildDuplicateRuleNameError({topLevelRule:t,grammarName:this.className}),i={message:o,type:pt.DUPLICATE_RULE_NAME,ruleName:t};this.definitionErrors.push(i)}this.definedRulesNames.push(t);var c=this.defineRule(t,n,r);return this[t]=c,c},e.prototype.OVERRIDE_RULE=function(t,n,r){r===void 0&&(r=ii);var o=[];o=o.concat(U0(t,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,o);var i=this.defineRule(t,n,r);return this[t]=i,i},e.prototype.BACKTRACK=function(t,n){return function(){this.isBackTrackingStack.push(1);var r=this.saveRecogState();try{return t.apply(this,n),!0}catch(o){if(Vr(o))return!1;throw o}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}},e.prototype.getGAstProductions=function(){return this.gastProductionsCache},e.prototype.getSerializedGastProductions=function(){return ml(Et(this.gastProductionsCache))},e}(),av=function(){function e(){}return e.prototype.initRecognizerEngine=function(t,n){if(this.className=X0(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=ei,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},ne(n,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(en(t)){if(Re(t))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof t[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(en(t))this.tokensMap=tt(t,function(c,f){return c[f.name]=f,c},{});else if(ne(t,"modes")&&Ut(Ot(Et(t.modes)),Qp)){var r=Ot(Et(t.modes)),o=ja(r);this.tokensMap=tt(o,function(c,f){return c[f.name]=f,c},{})}else if(es(t))this.tokensMap=Jr(t);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=Pn;var i=Ut(Et(t),function(c){return Re(c.categoryMatches)});this.tokenMatcher=i?ei:Ri,eo(Et(this.tokensMap))},e.prototype.defineRule=function(t,n,r){if(this.selfAnalysisDone)throw Error("Grammar rule <"+t+`> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);var o=ne(r,"resyncEnabled")?r.resyncEnabled:ii.resyncEnabled,i=ne(r,"recoveryValueFunc")?r.recoveryValueFunc:ii.recoveryValueFunc,c=this.ruleShortNameIdx<<z0+Gn;this.ruleShortNameIdx++,this.shortRuleNameToFull[c]=t,this.fullRuleNameToShort[t]=c;function f(a){try{if(this.outputCst===!0){n.apply(this,a);var s=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(s),s}else return n.apply(this,a)}catch(l){return this.invokeRuleCatch(l,o,i)}finally{this.ruleFinallyStateUpdate()}}var h;h=function(a,s){return a===void 0&&(a=0),this.ruleInvocationStateUpdate(c,t,a),f.call(this,s)};var u="ruleName";return h[u]=t,h.originalGrammarAction=n,h},e.prototype.invokeRuleCatch=function(t,n,r){var o=this.RULE_STACK.length===1,i=n&&!this.isBackTracking()&&this.recoveryEnabled;if(Vr(t)){var c=t;if(i){var f=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(f))if(c.resyncedTokens=this.reSyncTo(f),this.outputCst){var h=this.CST_STACK[this.CST_STACK.length-1];return h.recoveredNode=!0,h}else return r();else{if(this.outputCst){var h=this.CST_STACK[this.CST_STACK.length-1];h.recoveredNode=!0,c.partialCstResult=h}throw c}}else{if(o)return this.moveToTerminatedState(),r();throw c}}else throw t},e.prototype.optionInternal=function(t,n){var r=this.getKeyForAutomaticLookahead($l,n);return this.optionInternalLogic(t,n,r)},e.prototype.optionInternalLogic=function(t,n,r){var o=this,i=this.getLaFuncFromCache(r),c,f;if(t.DEF!==void 0){if(c=t.DEF,f=t.GATE,f!==void 0){var h=i;i=function(){return f.call(o)&&h.call(o)}}}else c=t;if(i.call(this)===!0)return c.call(this)},e.prototype.atLeastOneInternal=function(t,n){var r=this.getKeyForAutomaticLookahead(Ma,t);return this.atLeastOneInternalLogic(t,n,r)},e.prototype.atLeastOneInternalLogic=function(t,n,r){var o=this,i=this.getLaFuncFromCache(r),c,f;if(n.DEF!==void 0){if(c=n.DEF,f=n.GATE,f!==void 0){var h=i;i=function(){return f.call(o)&&h.call(o)}}}else c=n;if(i.call(this)===!0)for(var u=this.doSingleRepetition(c);i.call(this)===!0&&u===!0;)u=this.doSingleRepetition(c);else throw this.raiseEarlyExitException(t,we.REPETITION_MANDATORY,n.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[t,n],i,Ma,t,E0)},e.prototype.atLeastOneSepFirstInternal=function(t,n){var r=this.getKeyForAutomaticLookahead(Vo,t);this.atLeastOneSepFirstInternalLogic(t,n,r)},e.prototype.atLeastOneSepFirstInternalLogic=function(t,n,r){var o=this,i=n.DEF,c=n.SEP,f=this.getLaFuncFromCache(r);if(f.call(this)===!0){i.call(this);for(var h=function(){return o.tokenMatcher(o.LA(1),c)};this.tokenMatcher(this.LA(1),c)===!0;)this.CONSUME(c),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,c,h,i,fc],h,Vo,t,fc)}else throw this.raiseEarlyExitException(t,we.REPETITION_MANDATORY_WITH_SEPARATOR,n.ERR_MSG)},e.prototype.manyInternal=function(t,n){var r=this.getKeyForAutomaticLookahead(_a,t);return this.manyInternalLogic(t,n,r)},e.prototype.manyInternalLogic=function(t,n,r){var o=this,i=this.getLaFuncFromCache(r),c,f;if(n.DEF!==void 0){if(c=n.DEF,f=n.GATE,f!==void 0){var h=i;i=function(){return f.call(o)&&h.call(o)}}}else c=n;for(var u=!0;i.call(this)===!0&&u===!0;)u=this.doSingleRepetition(c);this.attemptInRepetitionRecovery(this.manyInternal,[t,n],i,_a,t,g0,u)},e.prototype.manySepFirstInternal=function(t,n){var r=this.getKeyForAutomaticLookahead(ba,t);this.manySepFirstInternalLogic(t,n,r)},e.prototype.manySepFirstInternalLogic=function(t,n,r){var o=this,i=n.DEF,c=n.SEP,f=this.getLaFuncFromCache(r);if(f.call(this)===!0){i.call(this);for(var h=function(){return o.tokenMatcher(o.LA(1),c)};this.tokenMatcher(this.LA(1),c)===!0;)this.CONSUME(c),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,c,h,i,lc],h,ba,t,lc)}},e.prototype.repetitionSepSecondInternal=function(t,n,r,o,i){for(;r();)this.CONSUME(n),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,n,r,o,i],r,Vo,t,i)},e.prototype.doSingleRepetition=function(t){var n=this.getLexerPosition();t.call(this);var r=this.getLexerPosition();return r>n},e.prototype.orInternal=function(t,n){var r=this.getKeyForAutomaticLookahead(Dl,n),o=en(t)?t:t.DEF,i=this.getLaFuncFromCache(r),c=i.call(this,o);if(c!==void 0){var f=o[c];return f.ALT.call(this)}this.raiseNoAltException(n,t.ERR_MSG)},e.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var t=this.LA(1),n=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:t,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new Pl(n,t))}},e.prototype.subruleInternal=function(t,n,r){var o;try{var i=r!==void 0?r.ARGS:void 0;return o=t.call(this,n,i),this.cstPostNonTerminal(o,r!==void 0&&r.LABEL!==void 0?r.LABEL:t.ruleName),o}catch(c){this.subruleInternalError(c,r,t.ruleName)}},e.prototype.subruleInternalError=function(t,n,r){throw Vr(t)&&t.partialCstResult!==void 0&&(this.cstPostNonTerminal(t.partialCstResult,n!==void 0&&n.LABEL!==void 0?n.LABEL:r),delete t.partialCstResult),t},e.prototype.consumeInternal=function(t,n,r){var o;try{var i=this.LA(1);this.tokenMatcher(i,t)===!0?(this.consumeToken(),o=i):this.consumeInternalError(t,i,r)}catch(c){o=this.consumeInternalRecovery(t,n,c)}return this.cstPostTerminal(r!==void 0&&r.LABEL!==void 0?r.LABEL:t.name,o),o},e.prototype.consumeInternalError=function(t,n,r){var o,i=this.LA(0);throw r!==void 0&&r.ERR_MSG?o=r.ERR_MSG:o=this.errorMessageProvider.buildMismatchTokenMessage({expected:t,actual:n,previous:i,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new us(o,n,i))},e.prototype.consumeInternalRecovery=function(t,n,r){if(this.recoveryEnabled&&r.name==="MismatchedTokenException"&&!this.isBackTracking()){var o=this.getFollowsForInRuleRecovery(t,n);try{return this.tryInRuleRecovery(t,o)}catch(i){throw i.name===Fl?r:i}}else throw r},e.prototype.saveRecogState=function(){var t=this.errors,n=yt(this.RULE_STACK);return{errors:t,lexerState:this.exportLexerState(),RULE_STACK:n,CST_STACK:this.CST_STACK}},e.prototype.reloadRecogState=function(t){this.errors=t.errors,this.importLexerState(t.lexerState),this.RULE_STACK=t.RULE_STACK},e.prototype.ruleInvocationStateUpdate=function(t,n,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(t),this.cstInvocationStateUpdate(n,t)},e.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},e.prototype.getCurrRuleFullName=function(){var t=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[t]},e.prototype.shortRuleNameToFullName=function(t){return this.shortRuleNameToFull[t]},e.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),Pn)},e.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},e}(),sv=function(){function e(){}return e.prototype.initErrorHandler=function(t){this._errors=[],this.errorMessageProvider=ne(t,"errorMessageProvider")?t.errorMessageProvider:Tn.errorMessageProvider},e.prototype.SAVE_ERROR=function(t){if(Vr(t))return t.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:yt(this.RULE_OCCURRENCE_STACK)},this._errors.push(t),t;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(e.prototype,"errors",{get:function(){return yt(this._errors)},set:function(t){this._errors=t},enumerable:!1,configurable:!0}),e.prototype.raiseEarlyExitException=function(t,n,r){for(var o=this.getCurrRuleFullName(),i=this.getGAstProductions()[o],c=as(t,i,n,this.maxLookahead),f=c[0],h=[],u=1;u<=this.maxLookahead;u++)h.push(this.LA(u));var a=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:f,actual:h,previous:this.LA(0),customUserDescription:r,ruleName:o});throw this.SAVE_ERROR(new Sl(a,this.LA(1),this.LA(0)))},e.prototype.raiseNoAltException=function(t,n){for(var r=this.getCurrRuleFullName(),o=this.getGAstProductions()[r],i=is(t,o,this.maxLookahead),c=[],f=1;f<=this.maxLookahead;f++)c.push(this.LA(f));var h=this.LA(0),u=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:i,actual:c,previous:h,customUserDescription:n,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new kl(u,this.LA(1),h))},e}(),cv=function(){function e(){}return e.prototype.initContentAssist=function(){},e.prototype.computeContentAssist=function(t,n){var r=this.gastProductionsCache[t];if(Rn(r))throw Error("Rule ->"+t+"<- does not exist in this grammar.");return wl([r],n,this.tokenMatcher,this.maxLookahead)},e.prototype.getNextPossibleTokenTypes=function(t){var n=zt(t.ruleStack),r=this.getGAstProductions(),o=r[n],i=new m0(o,t).startWalking();return i},e}(),Ii={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(Ii);var mc=!0,gc=Math.pow(2,Gn)-1,Gl=rs({name:"RECORDING_PHASE_TOKEN",pattern:Ht.NA});eo([Gl]);var Hl=Ni(Gl,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(Hl);var uv={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}},lv=function(){function e(){}return e.prototype.initGastRecorder=function(t){this.recordingProdStack=[],this.RECORDING_PHASE=!1},e.prototype.enableRecording=function(){var t=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var n=function(o){var i=o>0?o:"";t["CONSUME"+i]=function(c,f){return this.consumeInternalRecord(c,o,f)},t["SUBRULE"+i]=function(c,f){return this.subruleInternalRecord(c,o,f)},t["OPTION"+i]=function(c){return this.optionInternalRecord(c,o)},t["OR"+i]=function(c){return this.orInternalRecord(c,o)},t["MANY"+i]=function(c){this.manyInternalRecord(o,c)},t["MANY_SEP"+i]=function(c){this.manySepFirstInternalRecord(o,c)},t["AT_LEAST_ONE"+i]=function(c){this.atLeastOneInternalRecord(o,c)},t["AT_LEAST_ONE_SEP"+i]=function(c){this.atLeastOneSepFirstInternalRecord(o,c)}},r=0;r<10;r++)n(r);t.consume=function(o,i,c){return this.consumeInternalRecord(i,o,c)},t.subrule=function(o,i,c){return this.subruleInternalRecord(i,o,c)},t.option=function(o,i){return this.optionInternalRecord(i,o)},t.or=function(o,i){return this.orInternalRecord(i,o)},t.many=function(o,i){this.manyInternalRecord(o,i)},t.atLeastOne=function(o,i){this.atLeastOneInternalRecord(o,i)},t.ACTION=t.ACTION_RECORD,t.BACKTRACK=t.BACKTRACK_RECORD,t.LA=t.LA_RECORD})},e.prototype.disableRecording=function(){var t=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var n=0;n<10;n++){var r=n>0?n:"";delete t["CONSUME"+r],delete t["SUBRULE"+r],delete t["OPTION"+r],delete t["OR"+r],delete t["MANY"+r],delete t["MANY_SEP"+r],delete t["AT_LEAST_ONE"+r],delete t["AT_LEAST_ONE_SEP"+r]}delete t.consume,delete t.subrule,delete t.option,delete t.or,delete t.many,delete t.atLeastOne,delete t.ACTION,delete t.BACKTRACK,delete t.LA})},e.prototype.ACTION_RECORD=function(t){},e.prototype.BACKTRACK_RECORD=function(t,n){return function(){return!0}},e.prototype.LA_RECORD=function(t){return oi},e.prototype.topLevelRuleRecord=function(t,n){try{var r=new nr({definition:[],name:t});return r.name=t,this.recordingProdStack.push(r),n.call(this),this.recordingProdStack.pop(),r}catch(o){if(o.KNOWN_RECORDER_ERROR!==!0)try{o.message=o.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw o}throw o}},e.prototype.optionInternalRecord=function(t,n){return Mr.call(this,ot,t,n)},e.prototype.atLeastOneInternalRecord=function(t,n){Mr.call(this,Pt,n,t)},e.prototype.atLeastOneSepFirstInternalRecord=function(t,n){Mr.call(this,St,n,t,mc)},e.prototype.manyInternalRecord=function(t,n){Mr.call(this,Fe,n,t)},e.prototype.manySepFirstInternalRecord=function(t,n){Mr.call(this,_t,n,t,mc)},e.prototype.orInternalRecord=function(t,n){return fv.call(this,t,n)},e.prototype.subruleInternalRecord=function(t,n,r){if(ri(n),!t||ne(t,"ruleName")===!1){var o=new Error("<SUBRULE"+Ec(n)+"> argument is invalid"+(" expecting a Parser method reference but got: <"+JSON.stringify(t)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw o.KNOWN_RECORDER_ERROR=!0,o}var i=Jo(this.recordingProdStack),c=t.ruleName,f=new ht({idx:n,nonTerminalName:c,referencedRule:void 0});return i.definition.push(f),this.outputCst?uv:Ii},e.prototype.consumeInternalRecord=function(t,n,r){if(ri(n),!hl(t)){var o=new Error("<CONSUME"+Ec(n)+"> argument is invalid"+(" expecting a TokenType reference but got: <"+JSON.stringify(t)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw o.KNOWN_RECORDER_ERROR=!0,o}var i=Jo(this.recordingProdStack),c=new Ce({idx:n,terminalType:t});return i.definition.push(c),Hl},e}();function Mr(e,t,n,r){r===void 0&&(r=!1),ri(n);var o=Jo(this.recordingProdStack),i=Vn(t)?t:t.DEF,c=new e({definition:[],idx:n});return r&&(c.separator=t.SEP),ne(t,"MAX_LOOKAHEAD")&&(c.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(c),i.call(this),o.definition.push(c),this.recordingProdStack.pop(),Ii}function fv(e,t){var n=this;ri(t);var r=Jo(this.recordingProdStack),o=en(e)===!1,i=o===!1?e:e.DEF,c=new Mt({definition:[],idx:t,ignoreAmbiguities:o&&e.IGNORE_AMBIGUITIES===!0});ne(e,"MAX_LOOKAHEAD")&&(c.maxLookahead=e.MAX_LOOKAHEAD);var f=tl(i,function(h){return Vn(h.GATE)});return c.hasPredicates=f,r.definition.push(c),ee(i,function(h){var u=new it({definition:[]});c.definition.push(u),ne(h,"IGNORE_AMBIGUITIES")?u.ignoreAmbiguities=h.IGNORE_AMBIGUITIES:ne(h,"GATE")&&(u.ignoreAmbiguities=!0),n.recordingProdStack.push(u),h.ALT.call(n),n.recordingProdStack.pop()}),Ii}function Ec(e){return e===0?"":""+e}function ri(e){if(e<0||e>gc){var t=new Error("Invalid DSL Method idx value: <"+e+`>
	`+("Idx value must be a none negative value smaller than "+(gc+1)));throw t.KNOWN_RECORDER_ERROR=!0,t}}var dv=function(){function e(){}return e.prototype.initPerformanceTracer=function(t){if(ne(t,"traceInitPerf")){var n=t.traceInitPerf,r=typeof n=="number";this.traceInitMaxIdent=r?n:1/0,this.traceInitPerf=r?n>0:n}else this.traceInitMaxIdent=0,this.traceInitPerf=Tn.traceInitPerf;this.traceInitIndent=-1},e.prototype.TRACE_INIT=function(t,n){if(this.traceInitPerf===!0){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+t+">");var o=ol(n),i=o.time,c=o.value,f=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&f(r+"<-- <"+t+"> time: "+i+"ms"),this.traceInitIndent--,c}else return n()},e}(),Wl=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r[i]=o[i])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),oi=Ni(Pn,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(oi);var Tn=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:os,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),ii=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),pt;(function(e){e[e.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",e[e.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",e[e.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",e[e.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",e[e.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",e[e.LEFT_RECURSION=5]="LEFT_RECURSION",e[e.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",e[e.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",e[e.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",e[e.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",e[e.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",e[e.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",e[e.TOO_MANY_ALTS=12]="TOO_MANY_ALTS"})(pt||(pt={}));function hv(e){return e===void 0&&(e=void 0),function(){return e}}var ls=function(){function e(t,n){this.definitionErrors=[],this.selfAnalysisDone=!1;var r=this;if(r.initErrorHandler(n),r.initLexerAdapter(),r.initLooksAhead(n),r.initRecognizerEngine(t,n),r.initRecoverable(n),r.initTreeBuilder(n),r.initContentAssist(),r.initGastRecorder(n),r.initPerformanceTracer(n),ne(n,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=ne(n,"skipValidations")?n.skipValidations:Tn.skipValidations}return e.performSelfAnalysis=function(t){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")},e.prototype.performSelfAnalysis=function(){var t=this;this.TRACE_INIT("performSelfAnalysis",function(){var n;t.selfAnalysisDone=!0;var r=t.className;t.TRACE_INIT("toFastProps",function(){rl(t)}),t.TRACE_INIT("Grammar Recording",function(){try{t.enableRecording(),ee(t.definedRulesNames,function(i){var c=t[i],f=c.originalGrammarAction,h=void 0;t.TRACE_INIT(i+" Rule",function(){h=t.topLevelRuleRecord(i,f)}),t.gastProductionsCache[i]=h})}finally{t.disableRecording()}});var o=[];if(t.TRACE_INIT("Grammar Resolving",function(){o=Ol({rules:Et(t.gastProductionsCache)}),t.definitionErrors.push.apply(t.definitionErrors,o)}),t.TRACE_INIT("Grammar Validations",function(){if(Re(o)&&t.skipValidations===!1){var i=Il({rules:Et(t.gastProductionsCache),maxLookahead:t.maxLookahead,tokenTypes:Et(t.tokensMap),errMsgProvider:Ai,grammarName:r});t.definitionErrors.push.apply(t.definitionErrors,i)}}),Re(t.definitionErrors)&&(t.recoveryEnabled&&t.TRACE_INIT("computeAllProdsFollows",function(){var i=l0(Et(t.gastProductionsCache));t.resyncFollows=i}),t.TRACE_INIT("ComputeLookaheadFunctions",function(){t.preComputeLookaheadFunctions(Et(t.gastProductionsCache))})),!e.DEFER_DEFINITION_ERRORS_HANDLING&&!Re(t.definitionErrors))throw n=Y(t.definitionErrors,function(i){return i.message}),new Error(`Parser Definition Errors detected:
 `+n.join(`
-------------------------------
`))})},e.DEFER_DEFINITION_ERRORS_HANDLING=!1,e}();hp(ls,[H0,q0,rv,ov,av,iv,sv,cv,lv,dv]);var pv=function(e){Wl(t,e);function t(n,r){r===void 0&&(r=Tn);var o=this,i=Jr(r);return i.outputCst=!0,o=e.call(this,n,i)||this,o}return t}(ls),vv=function(e){Wl(t,e);function t(n,r){r===void 0&&(r=Tn);var o=this,i=Jr(r);return i.outputCst=!1,o=e.call(this,n,i)||this,o}return t}(ls);function mv(e,t){var n=t===void 0?{}:t,r=n.resourceBase,o=r===void 0?"https://unpkg.com/chevrotain@"+Ta+"/diagrams/":r,i=n.css,c=i===void 0?"https://unpkg.com/chevrotain@"+Ta+"/diagrams/diagrams.css":i,f=`
<!-- This is a generated file -->
<!DOCTYPE html>
<meta charset="utf-8">
<style>
  body {
    background-color: hsl(30, 20%, 95%)
  }
</style>

`,h=`
<link rel='stylesheet' href='`+c+`'>
`,u=`
<script src='`+o+`vendor/railroad-diagrams.js'><\/script>
<script src='`+o+`src/diagrams_builder.js'><\/script>
<script src='`+o+`src/diagrams_behavior.js'><\/script>
<script src='`+o+`src/main.js'><\/script>
`,a=`
<div id="diagrams" align="center"></div>    
`,s=`
<script>
    window.serializedGrammar = `+JSON.stringify(e,null,"  ")+`;
<\/script>
`,l=`
<script>
    var diagramsDiv = document.getElementById("diagrams");
    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);
<\/script>
`;return f+h+u+a+s+l}var Ye=`
`;function gv(e){return`
(function (root, factory) {
    if (typeof define === 'function' && define.amd) {
        // AMD. Register as an anonymous module.
        define(['chevrotain'], factory);
    } else if (typeof module === 'object' && module.exports) {
        // Node. Does not work with strict CommonJS, but
        // only CommonJS-like environments that support module.exports,
        // like Node.
        module.exports = factory(require('chevrotain'));
    } else {
        // Browser globals (root is window)
        root.returnExports = factory(root.b);
    }
}(typeof self !== 'undefined' ? self : this, function (chevrotain) {

`+zl(e)+`
    
return {
    `+e.name+": "+e.name+` 
}
}));
`}function Ev(e){return`    
`+zl(e)+`
return new `+e.name+`(tokenVocabulary, config)    
`}function zl(e){var t=`
function `+e.name+`(tokenVocabulary, config) {
    // invoke super constructor
    // No support for embedded actions currently, so we can 'hardcode'
    // The use of CstParser.
    chevrotain.CstParser.call(this, tokenVocabulary, config)

    const $ = this

    `+yv(e.rules)+`

    // very important to call this after all the rules have been defined.
    // otherwise the parser may not work correctly as it will lack information
    // derived during the self analysis phase.
    this.performSelfAnalysis(this)
}

// inheritance as implemented in javascript in the previous decade... :(
`+e.name+`.prototype = Object.create(chevrotain.CstParser.prototype)
`+e.name+".prototype.constructor = "+e.name+`    
    `;return t}function yv(e){var t=Y(e,function(n){return wv(n,1)});return t.join(`
`)}function wv(e,t){var n=dt(t,'$.RULE("'+e.name+'", function() {')+Ye;return n+=_i(e.definition,t+1),n+=dt(t+1,"})")+Ye,n}function Rv(e,t){var n=e.terminalType.name;return dt(t,"$.CONSUME"+e.idx+"(this.tokensMap."+n+")"+Ye)}function Nv(e,t){return dt(t,"$.SUBRULE"+e.idx+"($."+e.nonTerminalName+")"+Ye)}function Tv(e,t){var n=dt(t,"$.OR"+e.idx+"([")+Ye,r=Y(e.definition,function(o){return Av(o,t+1)});return n+=r.join(","+Ye),n+=Ye+dt(t,"])"+Ye),n}function Av(e,t){var n=dt(t,"{")+Ye;return n+=dt(t+1,"ALT: function() {")+Ye,n+=_i(e.definition,t+1),n+=dt(t+1,"}")+Ye,n+=dt(t,"}"),n}function Cv(e,t){if(e instanceof ht)return Nv(e,t);if(e instanceof ot)return br("OPTION",e,t);if(e instanceof Pt)return br("AT_LEAST_ONE",e,t);if(e instanceof St)return br("AT_LEAST_ONE_SEP",e,t);if(e instanceof _t)return br("MANY_SEP",e,t);if(e instanceof Fe)return br("MANY",e,t);if(e instanceof Mt)return Tv(e,t);if(e instanceof Ce)return Rv(e,t);if(e instanceof it)return _i(e.definition,t);throw Error("non exhaustive match")}function br(e,t,n){var r=dt(n,"$."+(e+t.idx)+"(");return t.separator?(r+="{"+Ye,r+=dt(n+1,"SEP: this.tokensMap."+t.separator.name)+","+Ye,r+="DEF: "+yc(t.definition,n+2)+Ye,r+=dt(n,"}")+Ye):r+=yc(t.definition,n+1),r+=dt(n,")")+Ye,r}function yc(e,t){var n="function() {"+Ye;return n+=_i(e,t),n+=dt(t,"}")+Ye,n}function _i(e,t){var n="";return ee(e,function(r){n+=Cv(r,t+1)}),n}function dt(e,t){var n=Array(e*4+1).join(" ");return n+t}function xv(e){var t=Ev({name:e.name,rules:e.rules}),n=new Function("tokenVocabulary","config","chevrotain",t);return function(r){return n(e.tokenVocabulary,r,require("../api"))}}function Ov(e){return gv({name:e.name,rules:e.rules})}function Iv(){console.warn(`The clearCache function was 'soft' removed from the Chevrotain API.
	 It performs no action other than printing this message.
	 Please avoid using it as it will be completely removed in the future`)}var _v=function(){function e(){throw new Error(`The Parser class has been deprecated, use CstParser or EmbeddedActionsParser instead.	
See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_7-0-0`)}return e}();const Mv=Object.freeze(Object.defineProperty({__proto__:null,clearCache:Iv,Parser:_v,VERSION:Ta,CstParser:pv,EmbeddedActionsParser:vv,get ParserDefinitionErrorType(){return pt},EMPTY_ALT:hv,Lexer:Ht,get LexerDefinitionErrorType(){return Ue},createToken:rs,createTokenInstance:Ni,EOF:Pn,tokenLabel:er,tokenMatcher:e0,tokenName:Zp,defaultGrammarResolverErrorProvider:yl,defaultGrammarValidatorErrorProvider:Ai,defaultParserErrorProvider:os,EarlyExitException:Sl,isRecognitionException:Vr,MismatchedTokenException:us,NotAllInputParsedException:Pl,NoViableAltException:kl,defaultLexerErrorProvider:pl,Alternation:Mt,Alternative:it,NonTerminal:ht,Option:ot,Repetition:Fe,RepetitionMandatory:Pt,RepetitionMandatoryWithSeparator:St,RepetitionWithSeparator:_t,Rule:nr,Terminal:Ce,serializeGrammar:ml,serializeProduction:Fr,GAstVisitor:rr,assignOccurrenceIndices:G0,resolveGrammar:Ol,validateGrammar:Il,createSyntaxDiagramsCode:mv,generateParserFactory:xv,generateParserModule:Ov},Symbol.toStringTag,{value:"Module"})),fs=Hd(Mv),{createToken:ce,Lexer:ql}=fs,bv=We(),Kl={},Lv=ce({name:"WhiteSpace",pattern:/\s+/,group:ql.SKIPPED}),Uv=ce({name:"String",pattern:/"(""|[^"])*"/}),kv=ce({name:"SingleQuotedString",pattern:/'(''|[^'])*'/}),Pv=ce({name:"SheetQuoted",pattern:/'((?![\\\/\[\]*?:]).)+?'!/}),Sv=ce({name:"Function",pattern:/[A-Za-z_]+[A-Za-z_0-9.]*\(/}),Fv=ce({name:"FormulaErrorT",pattern:/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A/}),Bv=ce({name:"RefError",pattern:/#REF!/}),ds=ce({name:"Name",pattern:/[a-zA-Z_][a-zA-Z0-9_.?]*/}),Dv=ce({name:"Sheet",pattern:/[A-Za-z_.\d\u007F-\uFFFF]+!/}),$v=ce({name:"Cell",pattern:/[$]?[A-Za-z]{1,3}[$]?[1-9][0-9]*/,longer_alt:ds}),Vv=ce({name:"Number",pattern:/[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?/}),Gv=ce({name:"Boolean",pattern:/TRUE|FALSE/i}),Hv=ce({name:"Column",pattern:/[$]?[A-Za-z]{1,3}/,longer_alt:ds}),Wv=ce({name:"At",pattern:/@/}),zv=ce({name:"Comma",pattern:/,/}),qv=ce({name:"Colon",pattern:/:/}),Kv=ce({name:"Semicolon",pattern:/;/}),Yv=ce({name:"OpenParen",pattern:/\(/}),Xv=ce({name:"CloseParen",pattern:/\)/}),Qv=ce({name:"OpenSquareParen",pattern:/\[/}),Zv=ce({name:"CloseSquareParen",pattern:/]/});ce({name:"exclamationMark",pattern:/!/});const Jv=ce({name:"OpenCurlyParen",pattern:/{/}),jv=ce({name:"CloseCurlyParen",pattern:/}/}),em=ce({name:"QuoteS",pattern:/'/}),wc=ce({name:"MulOp",pattern:/\*/}),tm=ce({name:"PlusOp",pattern:/\+/}),nm=ce({name:"DivOp",pattern:/\//}),rm=ce({name:"MinOp",pattern:/-/}),om=ce({name:"ConcatOp",pattern:/&/}),im=ce({name:"ExOp",pattern:/\^/}),am=ce({name:"PercentOp",pattern:/%/}),sm=ce({name:"GtOp",pattern:/>/}),cm=ce({name:"EqOp",pattern:/=/}),um=ce({name:"LtOp",pattern:/</}),lm=ce({name:"NeqOp",pattern:/<>/}),fm=ce({name:"GteOp",pattern:/>=/}),dm=ce({name:"LteOp",pattern:/<=/}),Yl=[Lv,Uv,Pv,kv,Sv,Fv,Bv,Dv,$v,Gv,Hv,ds,Vv,Wv,zv,qv,Kv,Yv,Xv,Qv,Zv,Jv,jv,em,wc,tm,nm,rm,om,im,wc,am,lm,fm,dm,sm,cm,um],hm=new ql(Yl,{ensureOptimizations:!0});Yl.forEach(e=>{Kl[e.name]=e});var hs={tokenVocabulary:Kl,lex:function(e){const t=hm.tokenize(e);if(t.errors.length>0){const n=t.errors[0],r=n.line,o=n.column;let i=`
`+e.split(`
`)[r-1]+`
`;throw i+=Array(o-1).fill(" ").join("")+`^
`,n.message=i+`Error at position ${r}:${o}
`+n.message,n.errorLocation={line:r,column:o},bv.ERROR(n.message,n)}return t}};const Xl=hs,{EmbeddedActionsParser:pm}=fs,vm=Xl.tokenVocabulary,{String:Rc,SheetQuoted:mm,ExcelRefFunction:bN,ExcelConditionalRefFunction:LN,Function:gm,FormulaErrorT:Nc,RefError:Tc,Cell:Em,Sheet:ym,Name:wm,Number:Ac,Boolean:Cc,Column:Rm,Comma:Co,Colon:Nm,Semicolon:Tm,OpenParen:Am,CloseParen:xc,OpenCurlyParen:Cm,CloseCurlyParen:xm,MulOp:Om,PlusOp:ta,DivOp:Im,MinOp:na,ConcatOp:_m,ExOp:Mm,PercentOp:bm,NeqOp:Lm,GteOp:Um,LteOp:km,GtOp:Pm,EqOp:Sm,LtOp:Fm}=Xl.tokenVocabulary;class Bm extends pm{constructor(t,n){super(vm,{outputCst:!1,maxLookahead:1,skipValidations:!0}),this.utils=n,this.binaryOperatorsPrecedence=[["^"],["*","/"],["+","-"],["&"],["<",">","=","<>","<=",">="]];const r=this;r.RULE("formulaWithBinaryOp",()=>{const o=[],i=[r.SUBRULE(r.formulaWithPercentOp)];return r.MANY(()=>{o.push(r.OR(r.c1||(r.c1=[{ALT:()=>r.CONSUME(Pm).image},{ALT:()=>r.CONSUME(Sm).image},{ALT:()=>r.CONSUME(Fm).image},{ALT:()=>r.CONSUME(Lm).image},{ALT:()=>r.CONSUME(Um).image},{ALT:()=>r.CONSUME(km).image},{ALT:()=>r.CONSUME(_m).image},{ALT:()=>r.CONSUME(ta).image},{ALT:()=>r.CONSUME(na).image},{ALT:()=>r.CONSUME(Om).image},{ALT:()=>r.CONSUME(Im).image},{ALT:()=>r.CONSUME(Mm).image}]))),i.push(r.SUBRULE2(r.formulaWithPercentOp))}),r.ACTION(()=>{for(const c of this.binaryOperatorsPrecedence)for(let f=0,h=o.length;f<h;f++){const u=o[f];!c.includes(u)||(o.splice(f,1),i.splice(f,2,this.utils.applyInfix(i[f],u,i[f+1])),f--,h--)}}),i[0]}),r.RULE("plusMinusOp",()=>r.OR([{ALT:()=>r.CONSUME(ta).image},{ALT:()=>r.CONSUME(na).image}])),r.RULE("formulaWithPercentOp",()=>{let o=r.SUBRULE(r.formulaWithUnaryOp);return r.OPTION(()=>{const i=r.CONSUME(bm).image;o=r.ACTION(()=>this.utils.applyPostfix(o,i))}),o}),r.RULE("formulaWithUnaryOp",()=>{const o=[];r.MANY(()=>{const c=r.OR([{ALT:()=>r.CONSUME(ta).image},{ALT:()=>r.CONSUME(na).image}]);o.push(c)});const i=r.SUBRULE(r.formulaWithIntersect);return o.length>0?r.ACTION(()=>this.utils.applyPrefix(o,i)):i}),r.RULE("formulaWithIntersect",()=>{let o=r.SUBRULE(r.formulaWithRange);const i=[o];return r.MANY({GATE:()=>{const c=r.LA(0);return r.LA(1).startOffset>c.endOffset+1},DEF:()=>{i.push(r.SUBRULE3(r.formulaWithRange))}}),i.length>1?r.ACTION(()=>r.ACTION(()=>this.utils.applyIntersect(i))):o}),r.RULE("formulaWithRange",()=>{const o=r.SUBRULE(r.formula),i=[o];return r.MANY(()=>{r.CONSUME(Nm),i.push(r.SUBRULE2(r.formula))}),i.length>1?r.ACTION(()=>r.ACTION(()=>this.utils.applyRange(i))):o}),r.RULE("formula",()=>r.OR9([{ALT:()=>r.SUBRULE(r.referenceWithoutInfix)},{ALT:()=>r.SUBRULE(r.paren)},{ALT:()=>r.SUBRULE(r.constant)},{ALT:()=>r.SUBRULE(r.functionCall)},{ALT:()=>r.SUBRULE(r.constantArray)}])),r.RULE("paren",()=>{r.CONSUME(Am);let o;const i=[];return i.push(r.SUBRULE(r.formulaWithBinaryOp)),r.MANY(()=>{r.CONSUME(Co),i.push(r.SUBRULE2(r.formulaWithBinaryOp))}),i.length>1?o=r.ACTION(()=>this.utils.applyUnion(i)):o=i[0],r.CONSUME(xc),o}),r.RULE("constantArray",()=>{const o=[[]];let i=0;return r.CONSUME(Cm),o[i].push(r.SUBRULE(r.constantForArray)),r.MANY(()=>{const c=r.OR([{ALT:()=>r.CONSUME(Co).image},{ALT:()=>r.CONSUME(Tm).image}]),f=r.SUBRULE2(r.constantForArray);c===","||(i++,o[i]=[]),o[i].push(f)}),r.CONSUME(xm),r.ACTION(()=>this.utils.toArray(o))}),r.RULE("constantForArray",()=>r.OR([{ALT:()=>{const o=r.OPTION(()=>r.SUBRULE(r.plusMinusOp)),i=r.CONSUME(Ac).image,c=r.ACTION(()=>this.utils.toNumber(i));return o?r.ACTION(()=>this.utils.applyPrefix([o],c)):c}},{ALT:()=>{const o=r.CONSUME(Rc).image;return r.ACTION(()=>this.utils.toString(o))}},{ALT:()=>{const o=r.CONSUME(Cc).image;return r.ACTION(()=>this.utils.toBoolean(o))}},{ALT:()=>{const o=r.CONSUME(Nc).image;return r.ACTION(()=>this.utils.toError(o))}},{ALT:()=>{const o=r.CONSUME(Tc).image;return r.ACTION(()=>this.utils.toError(o))}}])),r.RULE("constant",()=>r.OR([{ALT:()=>{const o=r.CONSUME(Ac).image;return r.ACTION(()=>this.utils.toNumber(o))}},{ALT:()=>{const o=r.CONSUME(Rc).image;return r.ACTION(()=>this.utils.toString(o))}},{ALT:()=>{const o=r.CONSUME(Cc).image;return r.ACTION(()=>this.utils.toBoolean(o))}},{ALT:()=>{const o=r.CONSUME(Nc).image;return r.ACTION(()=>this.utils.toError(o))}}])),r.RULE("functionCall",()=>{const o=r.CONSUME(gm).image.slice(0,-1),i=r.SUBRULE(r.arguments);return r.CONSUME(xc),r.ACTION(()=>t.callFunction(o,i))}),r.RULE("arguments",()=>{r.MANY2(()=>{r.CONSUME2(Co)});const o=[];return r.OPTION(()=>{o.push(r.SUBRULE(r.formulaWithBinaryOp)),r.MANY(()=>{r.CONSUME1(Co),o.push(null),r.OPTION3(()=>{o.pop(),o.push(r.SUBRULE2(r.formulaWithBinaryOp))})})}),o}),r.RULE("referenceWithoutInfix",()=>r.OR([{ALT:()=>r.SUBRULE(r.referenceItem)},{ALT:()=>{const o=r.SUBRULE(r.prefixName),i=r.SUBRULE2(r.formulaWithRange);return r.ACTION(()=>{if(this.utils.isFormulaError(i))return i;i.ref.sheet=o}),i}}])),r.RULE("referenceItem",()=>r.OR([{ALT:()=>{const o=r.CONSUME(Em).image;return r.ACTION(()=>this.utils.parseCellAddress(o))}},{ALT:()=>{const o=r.CONSUME(wm).image;return r.ACTION(()=>t.getVariable(o))}},{ALT:()=>{const o=r.CONSUME(Rm).image;return r.ACTION(()=>this.utils.parseCol(o))}},{ALT:()=>{const o=r.CONSUME(Tc).image;return r.ACTION(()=>this.utils.toError(o))}}])),r.RULE("prefixName",()=>r.OR([{ALT:()=>r.CONSUME(ym).image.slice(0,-1)},{ALT:()=>r.CONSUME(mm).image.slice(1,-2).replace(/''/g,"'")}])),this.performSelfAnalysis()}}var Ql={Parser:Bm};const Lr=We(),{Address:Dm}=Xe(),{Prefix:$m,Postfix:Vm,Infix:ra,Operators:oa}=Za,Gm=Ei,Oc=1048576,Ic=16384,{NotAllInputParsedException:Hm}=fs;class Wm{constructor(t){this.context=t}columnNameToNumber(t){return Dm.columnNameToNumber(t)}parseCellAddress(t){const n=t.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{address:n[0],col:this.columnNameToNumber(n[2]),row:+n[4]}}}parseRow(t){const n=+t;if(!Number.isInteger(n))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+t}}}parseCol(t){return{ref:{col:this.columnNameToNumber(t),row:void 0}}}parseColRange(t,n){return t=this.columnNameToNumber(t),n=this.columnNameToNumber(n),{ref:{from:{col:Math.min(t,n),row:null},to:{col:Math.max(t,n),row:null}}}}parseRowRange(t,n){return{ref:{from:{col:null,row:Math.min(t,n)},to:{col:null,row:Math.max(t,n)}}}}_applyPrefix(t,n,r){return this.isFormulaError(n)?n:$m.unaryOp(t,n,r)}async applyPrefixAsync(t,n){const{val:r,isArray:o}=this.extractRefValue(await n);return this._applyPrefix(t,r,o)}applyPrefix(t,n){if(this.context.async)return this.applyPrefixAsync(t,n);{const{val:r,isArray:o}=this.extractRefValue(n);return this._applyPrefix(t,r,o)}}_applyPostfix(t,n,r){return this.isFormulaError(t)?t:Vm.percentOp(t,r,n)}async applyPostfixAsync(t,n){const{val:r,isArray:o}=this.extractRefValue(await t);return this._applyPostfix(r,o,n)}applyPostfix(t,n){if(this.context.async)return this.applyPostfixAsync(t,n);{const{val:r,isArray:o}=this.extractRefValue(t);return this._applyPostfix(r,o,n)}}_applyInfix(t,n,r){const o=t.val,i=t.isArray,c=r.val,f=r.isArray;if(this.isFormulaError(o))return o;if(this.isFormulaError(c))return c;if(oa.compareOp.includes(n))return ra.compareOp(o,n,c,i,f);if(oa.concatOp.includes(n))return ra.concatOp(o,n,c,i,f);if(oa.mathOp.includes(n))return ra.mathOp(o,n,c,i,f);throw new Error(`Unrecognized infix: ${n}`)}async applyInfixAsync(t,n,r){const o=this.extractRefValue(await t),i=this.extractRefValue(await r);return this._applyInfix(o,n,i)}applyInfix(t,n,r){if(this.context.async)return this.applyInfixAsync(t,n,r);{const o=this.extractRefValue(t),i=this.extractRefValue(r);return this._applyInfix(o,n,i)}}applyIntersect(t){if(this.isFormulaError(t[0]))return t[0];if(!t[0].ref)throw Error(`Expecting a reference, but got ${t[0]}.`);let n,r,o,i,c,f;const h=t.shift().ref;if(c=h.sheet,h.from)n=Math.max(h.from.row,h.to.row),o=Math.min(h.from.row,h.to.row),r=Math.max(h.from.col,h.to.col),i=Math.min(h.from.col,h.to.col);else{if(h.row===void 0||h.col===void 0)throw Error("Cannot intersect the whole row or column.");n=o=h.row,r=i=h.col}let u;return t.forEach(a=>{if(this.isFormulaError(a))return a;if(a=a.ref,!a)throw Error(`Expecting a reference, but got ${a}.`);if(a.from){const s=Math.max(a.from.row,a.to.row),l=Math.min(a.from.row,a.to.row),d=Math.max(a.from.col,a.to.col),v=Math.min(a.from.col,a.to.col);(l>n||s<o||v>r||d<i||c!==a.sheet)&&(u=Lr.NULL),n=Math.min(n,s),o=Math.max(o,l),r=Math.min(r,d),i=Math.max(i,v)}else{if(a.row===void 0||a.col===void 0)throw Error("Cannot intersect the whole row or column.");(a.row>n||a.row<o||a.col>r||a.col<i||c!==a.sheet)&&(u=Lr.NULL),n=o=a.row,r=i=a.col}}),u||(n===o&&r===i?f={ref:{sheet:c,row:n,col:r}}:f={ref:{sheet:c,from:{row:o,col:i},to:{row:n,col:r}}},f.ref.sheet||delete f.ref.sheet,f)}applyUnion(t){const n=new Gm;for(let r=0;r<t.length;r++){if(this.isFormulaError(t[r]))return t[r];n.add(this.extractRefValue(t[r]).val,t[r])}return n}applyRange(t){let n,r=-1,o=-1,i=Oc+1,c=Ic+1;return t.forEach(f=>{if(this.isFormulaError(f))return f;typeof f=="number"&&(f=this.parseRow(f)),f=f.ref,f.row===void 0&&(i=1,r=Oc),f.col===void 0&&(c=1,o=Ic),f.row>r&&(r=f.row),f.row<i&&(i=f.row),f.col>o&&(o=f.col),f.col<c&&(c=f.col)}),r===i&&o===c?n={ref:{row:r,col:o}}:n={ref:{from:{row:i,col:c},to:{row:r,col:o}}},n}extractRefValue(t){let n=t,r=!1;return Array.isArray(n)&&(r=!0),t.ref?{val:this.context.retrieveRef(t),isArray:r}:{val:n,isArray:r}}toArray(t){return t}toNumber(t){return Number(t)}toString(t){return t.substring(1,t.length-1).replace(/""/g,'"')}toBoolean(t){return t==="TRUE"}toError(t){return new Lr(t.toUpperCase())}isFormulaError(t){return t instanceof Lr}static formatChevrotainError(t,n){let r,o,i="";return t instanceof Hm?(r=t.token.startLine,o=t.token.startColumn):(r=t.previousToken.startLine,o=t.previousToken.startColumn+1),i+=`
`+n.split(`
`)[r-1]+`
`,i+=Array(o-1).fill(" ").join("")+`^
`,i+=`Error at position ${r}:${o}
`+t.message,t.errorLocation={line:r,column:o},Lr.ERROR(i,t)}}var Zl=Wm;const zm=Ku,_c=Qu,Mc=vh,bc=Eh,Lc=Ch,Uc=_h,kc=kh,Pc=Gh,Sc=ep,qm=ap,Rt=We(),{FormulaHelpers:Qn}=Xe(),{Parser:Km,allTokens:Ym}=Ql,Fc=hs,ia=Zl;class Xm{constructor(t,n=!1){this.logs=[],this.isTest=n,this.utils=new ia(this),t=Object.assign({functions:{},functionsNeedContext:{},onVariable:()=>null,onCell:()=>0,onRange:()=>[[0]]},t),this.onVariable=t.onVariable,this.functions=Object.assign({},Sc,Pc,kc,Uc,Lc,bc,zm,_c,Mc,qm,t.functions,t.functionsNeedContext),this.onRange=t.onRange,this.onCell=t.onCell,this.funsNullAs0=Object.keys(_c).concat(Object.keys(Mc)).concat(Object.keys(bc)).concat(Object.keys(Lc)).concat(Object.keys(Uc)).concat(Object.keys(Pc)).concat(Object.keys(Sc)),this.funsNeedContextAndNoDataRetrieve=["ROW","ROWS","COLUMN","COLUMNS","SUMIF","INDEX","AVERAGEIF","IF"],this.funsNeedContext=[...Object.keys(t.functionsNeedContext),...this.funsNeedContextAndNoDataRetrieve,"INDEX","OFFSET","INDIRECT","IF","CHOOSE","WEBSERVICE"],this.funsPreserveRef=Object.keys(kc),this.parser=new Km(this,this.utils)}static get allTokens(){return Ym}getCell(t){return t.sheet==null&&(t.sheet=this.position?this.position.sheet:void 0),this.onCell(t)}getRange(t){return t.sheet==null&&(t.sheet=this.position?this.position.sheet:void 0),this.onRange(t)}getVariable(t){const n={ref:this.onVariable(t,this.position.sheet,this.position)};return n.ref==null?Rt.NAME:n}retrieveRef(t){return Qn.isRangeRef(t)?this.getRange(t.ref):Qn.isCellRef(t)?this.getCell(t.ref):t}_callFunction(t,n){t.indexOf("_xlfn.")===0&&(t=t.slice(6)),t=t.toUpperCase();const r=this.funsNullAs0.includes(t)?0:"";if(this.funsNeedContextAndNoDataRetrieve.includes(t)||(n=n.map(o=>{if(o===null)return{value:r,isArray:!1,omitted:!0};const i=this.utils.extractRefValue(o);return this.funsPreserveRef.includes(t)?{value:i.val,isArray:i.isArray,ref:o.ref}:{value:i.val,isArray:i.isArray,isRangeRef:!!Qn.isRangeRef(o),isCellRef:!!Qn.isCellRef(o)}})),this.functions[t]){let o;try{!this.funsNeedContextAndNoDataRetrieve.includes(t)&&!this.funsNeedContext.includes(t)?o=this.functions[t](...n):o=this.functions[t](this,...n)}catch(i){if(i instanceof Rt)return i;throw i}if(o===void 0){if(this.isTest)return this.logs.includes(t)||this.logs.push(t),{value:0,ref:{}};throw Rt.NOT_IMPLEMENTED(t)}return o}else{if(this.isTest)return this.logs.includes(t)||this.logs.push(t),{value:0,ref:{}};throw Rt.NOT_IMPLEMENTED(t)}}async callFunctionAsync(t,n){const r=[];for(const i of n)r.push(await i);const o=await this._callFunction(t,r);return Qn.checkFunctionResult(o)}callFunction(t,n){if(this.async)return this.callFunctionAsync(t,n);{const r=this._callFunction(t,n);return Qn.checkFunctionResult(r)}}supportedFunctions(){const t=[];return Object.keys(this.functions).forEach(r=>{try{if(this.functions[r](0,0,0,0,0,0,0,0,0,0,0)===void 0)return;t.push(r)}catch(o){o instanceof Error&&t.push(r)}}),t.sort()}checkFormulaResult(t,n=!1){const r=typeof t;if(r==="number"){if(isNaN(t))return Rt.VALUE;if(!isFinite(t))return Rt.NUM;t+=0}else if(r==="object"){if(t instanceof Rt)return t;if(n){if(t.ref&&(t=this.retrieveRef(t)),typeof t=="object"&&!Array.isArray(t)&&t!=null)return Rt.VALUE}else if(t.ref&&t.ref.row&&!t.ref.from)t=this.retrieveRef(t);else if(t.ref&&t.ref.from&&t.ref.from.col===t.ref.to.col)t=this.retrieveRef({ref:{row:t.ref.from.row,col:t.ref.from.col}});else if(Array.isArray(t))t=t[0][0];else return Rt.VALUE}return t}parse(t,n,r=!1){if(t.length===0)throw Error("Input must not be empty.");this.position=n,this.async=!1;const o=Fc.lex(t);this.parser.input=o.tokens;let i;try{if(i=this.parser.formulaWithBinaryOp(),i=this.checkFormulaResult(i,r),i instanceof Rt)return i}catch(c){throw Rt.ERROR(c.message,c)}if(this.parser.errors.length>0){const c=this.parser.errors[0];throw ia.formatChevrotainError(c,t)}return i}async parseAsync(t,n,r=!1){if(t.length===0)throw Error("Input must not be empty.");this.position=n,this.async=!0;const o=Fc.lex(t);this.parser.input=o.tokens;let i;try{if(i=await this.parser.formulaWithBinaryOp(),i=this.checkFormulaResult(i,r),i instanceof Rt)return i}catch(c){throw Rt.ERROR(c.message,c)}if(this.parser.errors.length>0){const c=this.parser.errors[0];throw ia.formatChevrotainError(c,t)}return i}}var Qm={FormulaParser:Xm,FormulaHelpers:Qn};const xo=We(),{FormulaHelpers:UN,Types:kN,Address:Zm}=Xe(),Jm=Ei,Bc=1048576,Dc=16384;class jm{constructor(t){this.context=t}columnNameToNumber(t){return Zm.columnNameToNumber(t)}parseCellAddress(t){const n=t.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{col:this.columnNameToNumber(n[2]),row:+n[4]}}}parseRow(t){const n=+t;if(!Number.isInteger(n))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+t}}}parseCol(t){return{ref:{col:this.columnNameToNumber(t),row:void 0}}}applyPrefix(t,n){return this.extractRefValue(n),0}applyPostfix(t,n){return this.extractRefValue(t),0}applyInfix(t,n,r){return this.extractRefValue(t),this.extractRefValue(r),0}applyIntersect(t){if(this.isFormulaError(t[0]))return t[0];if(!t[0].ref)throw Error(`Expecting a reference, but got ${t[0]}.`);let n,r,o,i,c,f;const h=t.shift().ref;if(c=h.sheet,h.from)n=Math.max(h.from.row,h.to.row),o=Math.min(h.from.row,h.to.row),r=Math.max(h.from.col,h.to.col),i=Math.min(h.from.col,h.to.col);else{if(h.row===void 0||h.col===void 0)throw Error("Cannot intersect the whole row or column.");n=o=h.row,r=i=h.col}let u;return t.forEach(a=>{if(this.isFormulaError(a))return a;if(a=a.ref,!a)throw Error(`Expecting a reference, but got ${a}.`);if(a.from){const s=Math.max(a.from.row,a.to.row),l=Math.min(a.from.row,a.to.row),d=Math.max(a.from.col,a.to.col),v=Math.min(a.from.col,a.to.col);(l>n||s<o||v>r||d<i||c!==a.sheet)&&(u=xo.NULL),n=Math.min(n,s),o=Math.max(o,l),r=Math.min(r,d),i=Math.max(i,v)}else{if(a.row===void 0||a.col===void 0)throw Error("Cannot intersect the whole row or column.");(a.row>n||a.row<o||a.col>r||a.col<i||c!==a.sheet)&&(u=xo.NULL),n=o=a.row,r=i=a.col}}),u||(n===o&&r===i?f={ref:{sheet:c,row:n,col:r}}:f={ref:{sheet:c,from:{row:o,col:i},to:{row:n,col:r}}},f.ref.sheet||delete f.ref.sheet,f)}applyUnion(t){const n=new Jm;for(let r=0;r<t.length;r++){if(this.isFormulaError(t[r]))return t[r];n.add(this.extractRefValue(t[r]).val,t[r])}return n}applyRange(t){let n,r=-1,o=-1,i=Bc+1,c=Dc+1;return t.forEach(f=>{if(this.isFormulaError(f))return f;typeof f=="number"&&(f=this.parseRow(f)),f=f.ref,f.row===void 0&&(i=1,r=Bc),f.col===void 0&&(c=1,o=Dc),f.row>r&&(r=f.row),f.row<i&&(i=f.row),f.col>o&&(o=f.col),f.col<c&&(c=f.col)}),r===i&&o===c?n={ref:{row:r,col:o}}:n={ref:{from:{row:i,col:c},to:{row:r,col:o}}},n}extractRefValue(t){const n=Array.isArray(t);return t.ref?{val:this.context.retrieveRef(t),isArray:n}:{val:t,isArray:n}}toArray(t){return t}toNumber(t){return Number(t)}toString(t){return t.substring(1,t.length-1).replace(/""/g,'"')}toBoolean(t){return t==="TRUE"}toError(t){return new xo(t.toUpperCase())}isFormulaError(t){return t instanceof xo}}var eg=jm;const $c=We(),{FormulaHelpers:aa}=Xe(),{Parser:tg}=Ql,ng=hs,Vc=eg,{formatChevrotainError:rg}=Zl;class og{constructor(t){this.data=[],this.utils=new Vc(this),t=Object.assign({onVariable:()=>null},t),this.utils=new Vc(this),this.onVariable=t.onVariable,this.functions={},this.parser=new tg(this,this.utils)}getCell(t){return t.row!=null&&(t.sheet==null&&(t.sheet=this.position?this.position.sheet:void 0),this.data.findIndex(r=>r.from&&r.from.row<=t.row&&r.to.row>=t.row&&r.from.col<=t.col&&r.to.col>=t.col||r.row===t.row&&r.col===t.col&&r.sheet===t.sheet)===-1&&this.data.push(t)),0}getRange(t){return t.from.row!=null&&(t.sheet==null&&(t.sheet=this.position?this.position.sheet:void 0),this.data.findIndex(r=>r.from&&r.from.row===t.from.row&&r.from.col===t.from.col&&r.to.row===t.to.row&&r.to.col===t.to.col)===-1&&this.data.push(t)),[[0]]}getVariable(t){const n={ref:this.onVariable(t,this.position.sheet)};return n.ref==null?$c.NAME:(aa.isCellRef(n)?this.getCell(n.ref):this.getRange(n.ref),0)}retrieveRef(t){return aa.isRangeRef(t)?this.getRange(t.ref):aa.isCellRef(t)?this.getCell(t.ref):t}callFunction(t,n){return n.forEach(r=>{r!=null&&this.retrieveRef(r)}),{value:0,ref:{}}}checkFormulaResult(t){this.retrieveRef(t)}parse(t,n,r=!1){if(t.length===0)throw Error("Input must not be empty.");this.data=[],this.position=n;const o=ng.lex(t);this.parser.input=o.tokens;try{const i=this.parser.formulaWithBinaryOp();this.checkFormulaResult(i)}catch(i){if(!r)throw $c.ERROR(i.message,i)}if(this.parser.errors.length>0&&!r){const i=this.parser.errors[0];throw rg(i,t)}return this.data}}var ig={DepParser:og};const{FormulaParser:Jl}=Qm,{DepParser:ag}=ig,sg=Hu,cg=We();Object.assign(Jl,{MAX_ROW:1048576,MAX_COLUMN:16384,SSF:sg,DepParser:ag,FormulaError:cg,...Xe()});var Sn=Jl,Go={exports:{}},jl={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(_,F){var V=_.length;_.push(F);e:for(;0<V;){var z=V-1>>>1,M=_[z];if(0<o(M,F))_[z]=F,_[V]=M,V=z;else break e}}function n(_){return _.length===0?null:_[0]}function r(_){if(_.length===0)return null;var F=_[0],V=_.pop();if(V!==F){_[0]=V;e:for(var z=0,M=_.length,$=M>>>1;z<$;){var H=2*(z+1)-1,W=_[H],Q=H+1,te=_[Q];if(0>o(W,V))Q<M&&0>o(te,W)?(_[z]=te,_[Q]=V,z=Q):(_[z]=W,_[H]=V,z=H);else if(Q<M&&0>o(te,V))_[z]=te,_[Q]=V,z=Q;else break e}}return F}function o(_,F){var V=_.sortIndex-F.sortIndex;return V!==0?V:_.id-F.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var c=Date,f=c.now();e.unstable_now=function(){return c.now()-f}}var h=[],u=[],a=1,s=null,l=3,d=!1,v=!1,p=!1,m=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function y(_){for(var F=n(u);F!==null;){if(F.callback===null)r(u);else if(F.startTime<=_)r(u),F.sortIndex=F.expirationTime,t(h,F);else break;F=n(u)}}function w(_){if(p=!1,y(_),!v)if(n(h)!==null)v=!0,S();else{var F=n(u);F!==null&&b(w,F.startTime-_)}}var T=!1,R=-1,A=5,C=-1;function x(){return!(e.unstable_now()-C<A)}function O(){if(T){var _=e.unstable_now();C=_;var F=!0;try{e:{v=!1,p&&(p=!1,g(R),R=-1),d=!0;var V=l;try{t:{for(y(_),s=n(h);s!==null&&!(s.expirationTime>_&&x());){var z=s.callback;if(typeof z=="function"){s.callback=null,l=s.priorityLevel;var M=z(s.expirationTime<=_);if(_=e.unstable_now(),typeof M=="function"){s.callback=M,y(_),F=!0;break t}s===n(h)&&r(h),y(_)}else r(h);s=n(h)}if(s!==null)F=!0;else{var $=n(u);$!==null&&b(w,$.startTime-_),F=!1}}break e}finally{s=null,l=V,d=!1}F=void 0}}finally{F?I():T=!1}}}var I;if(typeof E=="function")I=function(){E(O)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,B=P.port2;P.port1.onmessage=O,I=function(){B.postMessage(null)}}else I=function(){m(O,0)};function S(){T||(T=!0,I())}function b(_,F){R=m(function(){_(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(_){_.callback=null},e.unstable_continueExecution=function(){v||d||(v=!0,S())},e.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<_?Math.floor(1e3/_):5},e.unstable_getCurrentPriorityLevel=function(){return l},e.unstable_getFirstCallbackNode=function(){return n(h)},e.unstable_next=function(_){switch(l){case 1:case 2:case 3:var F=3;break;default:F=l}var V=l;l=F;try{return _()}finally{l=V}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(_,F){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var V=l;l=_;try{return F()}finally{l=V}},e.unstable_scheduleCallback=function(_,F,V){var z=e.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?z+V:z):V=z,_){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=V+M,_={id:a++,callback:F,priorityLevel:_,startTime:V,expirationTime:M,sortIndex:-1},V>z?(_.sortIndex=V,t(u,_),n(h)===null&&_===n(u)&&(p?(g(R),R=-1):p=!0,b(w,V-z))):(_.sortIndex=M,t(h,_),v||d||(v=!0,S())),_},e.unstable_shouldYield=x,e.unstable_wrapCallback=function(_){var F=l;return function(){var V=l;l=F;try{return _.apply(this,arguments)}finally{l=V}}}})(jl);(function(e){e.exports=jl})(Go);const ai=Symbol(),ug=Symbol(),lg=typeof window>"u"||/ServerSideRendering/.test(window.navigator&&window.navigator.userAgent),ef=lg?N.exports.useEffect:N.exports.useLayoutEffect,fg=Go.exports.unstable_runWithPriority?e=>{try{Go.exports.unstable_runWithPriority(Go.exports.unstable_NormalPriority,e)}catch(t){if(t.message==="Not implemented.")e();else throw t}}:e=>e(),dg=e=>({value:n,children:r})=>{const o=N.exports.useRef(n),i=N.exports.useRef(0),[c,f]=N.exports.useState(null);c&&(c(n),f(null));const h=N.exports.useRef();if(!h.current){const u=new Set,a=(s,l)=>{gi.exports.unstable_batchedUpdates(()=>{i.current+=1;const d={n:i.current};l!=null&&l.suspense&&(d.n*=-1,d.p=new Promise(v=>{f(()=>p=>{d.v=p,delete d.p,v(p)})})),u.forEach(v=>v(d)),s()})};h.current={[ai]:{v:o,n:i,l:u,u:a}}}return ef(()=>{o.current=n,i.current+=1,fg(()=>{h.current[ai].l.forEach(u=>{u({n:i.current,v:n})})})},[n]),N.exports.createElement(e,{value:h.current},r)};function hg(e){const t=N.exports.createContext({[ai]:{v:{current:e},n:{current:-1},l:new Set,u:n=>n()}});return t[ug]=t.Provider,t.Provider=dg(t.Provider),delete t.Consumer,t}function tf(e,t){const n=N.exports.useContext(e)[ai],{v:{current:r},n:{current:o},l:i}=n,c=t(r),[f,h]=N.exports.useReducer((u,a)=>{if(!a)return[r,c];if("p"in a)throw a.p;if(a.n===o)return Object.is(u[1],c)?u:[r,c];try{if("v"in a){if(Object.is(u[0],a.v))return u;const s=t(a.v);return Object.is(u[1],s)?u:[a.v,s]}}catch{}return[...u]},[r,c]);return Object.is(f[1],c)||h(),ef(()=>(i.add(h),()=>{i.delete(h)}),[i]),f[1]}var La=function(e,t){return La=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},La(e,t)};function Hn(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");La(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var D=function(){return D=Object.assign||function(t){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},D.apply(this,arguments)};function Gr(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(u){return function(a){return h([u,a])}}function h(u){if(r)throw new TypeError("Generator is already executing.");for(;c&&(c=0,u[0]&&(n=0)),n;)try{if(r=1,o&&(i=u[0]&2?o.return:u[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,u[1])).done)return i;switch(o=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,o=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){n.label=u[1];break}if(u[0]===6&&n.label<i[1]){n.label=i[1],i=u;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(u);break}i[2]&&n.ops.pop(),n.trys.pop();continue}u=t.call(e,n)}catch(a){u=[6,a],o=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function _e(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ne(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),o,i=[],c;try{for(;(t===void 0||t-- >0)&&!(o=r.next()).done;)i.push(o.value)}catch(f){c={error:f}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(c)throw c.error}}return i}function ft(e,t,n){if(n||arguments.length===2)for(var r=0,o=t.length,i;r<o;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}var nf="SET_DATA",rf="SET_CREATE_FORMULA_PARSER",of="SELECT_ENTIRE_ROW",af="SELECT_ENTIRE_COLUMN",sf="SELECT_ENTIRE_WORKSHEET",cf="SET_SELECTION",uf="SELECT",lf="ACTIVATE",ff="SET_CELL_DATA",df="SET_CELL_DIMENSIONS",hf="COPY",Ua="CUT",pf="PASTE",vf="EDIT",mf="VIEW",pg="CLEAR",gf="BLUR",Ef="KEY_PRESS",yf="KEY_DOWN",wf="DRAG_START",Rf="DRAG_END",Nf="COMMIT";function vg(e){return{type:nf,payload:{data:e}}}function mg(e){return{type:rf,payload:{createFormulaParser:e}}}function gg(e,t){return{type:of,payload:{row:e,extend:t}}}function Eg(e,t){return{type:af,payload:{column:e,extend:t}}}function yg(){return{type:sf}}function wg(e){return{type:cf,payload:{selection:e}}}function Rg(e){return{type:uf,payload:{point:e}}}function Ng(e){return{type:lf,payload:{point:e}}}function Tf(e,t){return{type:ff,payload:{active:e,data:t}}}function Tg(e,t){return{type:df,payload:{point:e,dimensions:t}}}function Ag(e){return{type:pf,payload:{data:e}}}function Cg(e){return{type:Ef,payload:{event:e}}}function xg(e){return{type:yf,payload:{event:e}}}function Og(){return{type:wf}}function Ig(){return{type:Rf}}function _g(e){return{type:Nf,payload:{changes:e}}}function Mg(){return{type:hf}}function bg(){return{type:Ua}}function Lg(){return{type:vf}}function Ug(){return{type:mf}}function kg(){return{type:gf}}function PN(e,t){for(var n=Array(e),r=0;r<e;r++)n[r]=Array(t);return n}function xt(e,t){var n=t[e.row];if(n!==void 0)return n[e.column]}function Af(e,t,n){for(var r=[],o=t.column-e.column,i=e.row;i<=t.row;i++){var c=i-e.row;r[c]=r[c]||Array(o);for(var f=e.column;f<=t.column;f++)r[c][f-e.column]=xt({row:i,column:f},n)}return r}function mn(e,t,n){var r=ft([],Ne(n),!1),o=n[0],i=o?ft([],Ne(o),!1):[];i.length-1<e.column&&(i[e.column]=void 0,r[0]=i);var c=n[e.row]?ft([],Ne(n[e.row]),!1):[];return c[e.column]=t,r[e.row]=c,r}function Pg(e,t,n){var r=n[0];r||(r=[],n[0]=r),e.row in n||(n[e.row]=[]),e.column in r||(r[e.column]=void 0),n[e.row][e.column]=t}function Gc(e,t){if(!si(e,t))return t;var n=ft([],Ne(t),!1),r=ft([],Ne(t[e.row]),!1);return r[e.column]=void 0,n[e.row]=r,n}function Sg(e,t){var n,r,o=[];try{for(var i=_e(ps(t)),c=i.next();!c.done;c=i.next()){var f=Ne(c.value,2),h=f[0],u=f[1];Pg(h,e(u,h),o)}}catch(a){n={error:a}}finally{try{c&&!c.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o}function ps(e){var t,n,r,o,i,c,f,h,u,a,s,l,d,v,p,m,g;return Gr(this,function(E){switch(E.label){case 0:E.trys.push([0,11,12,13]),t=_e(e.entries()),n=t.next(),E.label=1;case 1:if(n.done)return[3,10];r=Ne(n.value,2),o=r[0],i=r[1],E.label=2;case 2:E.trys.push([2,7,8,9]),c=(m=void 0,_e(i.entries())),f=c.next(),E.label=3;case 3:return f.done?[3,6]:(h=Ne(f.value,2),u=h[0],a=h[1],s={row:o,column:u},[4,[s,a]]);case 4:E.sent(),E.label=5;case 5:return f=c.next(),[3,3];case 6:return[3,9];case 7:return l=E.sent(),m={error:l},[3,9];case 8:try{f&&!f.done&&(g=c.return)&&g.call(c)}finally{if(m)throw m.error}return[7];case 9:return n=t.next(),[3,1];case 10:return[3,13];case 11:return d=E.sent(),v={error:d},[3,13];case 12:try{n&&!n.done&&(p=t.return)&&p.call(t)}finally{if(v)throw v.error}return[7];case 13:return[2]}})}function Fg(e,t,n){t===void 0&&(t="	"),n===void 0&&(n=`
`);for(var r="",o=Wn(e),i=o.rows,c=o.columns,f=0;f<i;f++){f&&(r+=n);for(var h=0;h<c;h++)h&&(r+=t),e[f]&&h in e[f]&&(r+=String(e[f][h]))}return r}function Bg(e,t,n,r){n===void 0&&(n="	"),r===void 0&&(r=/\r\n|\n|\r/);var o=e.replace(/"([^"]*?)"/g,function(i,c){return c.replace(/\n/g,"\\n")});return o.split(r).map(function(i){return i.split(n).map(function(c){return c.replace(/\\n/g,`
`)}).map(t)})}function si(e,t){var n=t[0];return n&&e.row>=0&&e.column>=0&&Number.isInteger(e.row)&&Number.isInteger(e.column)&&e.column<n.length&&e.row<t.length}function Wn(e){return{columns:bi(e),rows:Mi(e)}}function Mi(e){return e.length}function bi(e){var t=e[0];return t?t.length:0}function Dg(e,t){var n=Wn(e),r=n.rows,o=n.columns;if(r>=t.rows&&o>=t.columns)return e;var i={rows:t.rows>r?t.rows:r,columns:t.columns>o?t.columns:o},c=ft([],Ne(e),!1);if(i.columns>o){var f=i.columns-o;c=c.map(function(a){return ft(ft([],Ne(a),!1),Ne(Array(f).fill(void 0)),!1)})}if(i.rows>r){var h=i.rows-r,u=Array(i.columns).fill(void 0);c=ft(ft([],Ne(c),!1),Ne(Array(h).fill(u)),!1)}return c}function $g(e,t){for(var n=[],r=0;r<e.length;r++)for(var o=0;o<e[r].length;o++){var i=e[r][o];n.push(t?t(i,{row:r,column:o}):i)}return n}function vs(e){var t=Wn(e);return{row:t.rows-1,column:t.columns-1}}var gn=function(){function e(t,n){this.start={row:Math.min(t.row,n.row),column:Math.min(t.column,n.column)},this.end={row:Math.max(t.row,n.row),column:Math.max(t.column,n.column)}}return e.prototype[Symbol.iterator]=function(){var t,n;return Gr(this,function(r){switch(r.label){case 0:t=this.start.row,r.label=1;case 1:if(!(t<=this.end.row))return[3,6];n=this.start.column,r.label=2;case 2:return n<=this.end.column?[4,{row:t,column:n}]:[3,5];case 3:r.sent(),r.label=4;case 4:return n++,[3,2];case 5:return t++,[3,1];case 6:return[2]}})},e.prototype.size=function(){var t=this.end.row+1-this.start.row,n=this.end.column+1-this.start.column;return t*n},e.prototype.has=function(t){return t.row>=this.start.row&&t.column>=this.start.column&&t.row<=this.end.row&&t.column<=this.end.column},e.prototype.mask=function(t){return new e({row:t.start.row>this.start.row?t.start.row:this.start.row,column:t.start.column>this.start.column?t.start.column:this.start.column},{row:t.end.row<this.end.row?t.end.row:this.end.row,column:t.end.column<this.end.column?t.end.column:this.end.column})},e.prototype.equals=function(t){return this.start.row===t.start.row&&this.start.column===t.start.column&&this.end.row===t.end.row&&this.end.column===t.end.column},e}();function Vg(e,t){return e.column===t.column&&e.row===t.row}var Ho={row:0,column:0},ms=function(){function e(){}return e}(),Cf=function(e){Hn(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.toRange=function(n){return null},t.prototype.normalizeTo=function(n){return this},t.prototype.hasEntireRow=function(n){return!1},t.prototype.hasEntireColumn=function(n){return!1},t.prototype.size=function(){return 0},t.prototype.has=function(){return!1},t.prototype.equals=function(n){return n instanceof t},t}(ms),pr=function(e){Hn(t,e);function t(n){var r=e.call(this)||this;return r.range=n,r}return t.prototype.toRange=function(n){return this.range},t.prototype.normalizeTo=function(n){var r=_f(n),o=new t(this.range.mask(r));return o},t.prototype.hasEntireRow=function(n){return!1},t.prototype.hasEntireColumn=function(n){return!1},t.prototype.size=function(n){var r=this.toRange(n);return r?r.size():0},t.prototype.has=function(n,r){var o=this.toRange(n);return o!==null&&o.has(r)},t.prototype.equals=function(n){return n instanceof t&&this.range.equals(n.range)},t}(ms),xf=function(e){Hn(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(ms),Of=function(e){Hn(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.toRange=function(n){return _f(n)},t.prototype.normalizeTo=function(n){return this},t.prototype.hasEntireColumn=function(n){return!0},t.prototype.hasEntireRow=function(n){return!0},t.prototype.size=function(n){return bi(n)*Mi(n)},t.prototype.has=function(n,r){return!0},t.prototype.equals=function(n){return n instanceof t},t}(xf),If=function(e){Hn(t,e);function t(n,r){var o=this;if(!Hc(n))throw new Wc("start");if(!Hc(r))throw new Wc("end");return o=e.call(this)||this,o.start=Math.min(n,r),o.end=Math.max(n,r),o}return t.prototype.equals=function(n){return n instanceof t&&this.constructor===n.constructor&&this.start===n.start&&this.end===n.end},t}(xf),ci=function(e){Hn(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.toRange=function(n){var r=vs(n);return new gn({row:this.start,column:0},{row:this.end,column:r.column})},t.prototype.normalizeTo=function(n){var r=Mi(n),o=new t(Math.max(this.start,0),Math.min(this.end,r-1));return o},t.prototype.hasEntireRow=function(n){return n>=this.start&&n<=this.end},t.prototype.hasEntireColumn=function(n){return!1},t.prototype.size=function(n){var r=this.end-this.start+1;return r*bi(n)},t.prototype.has=function(n,r){return r.row>=this.start&&r.row<=this.end},t}(If),ui=function(e){Hn(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.toRange=function(n){var r=vs(n);return new gn({row:0,column:this.start},{row:r.row,column:this.end})},t.prototype.normalizeTo=function(n){var r=bi(n),o=new t(Math.max(this.start,0),Math.min(this.end,r-1));return o},t.prototype.hasEntireRow=function(n){return!1},t.prototype.hasEntireColumn=function(n){return n>=this.start&&n<=this.end},t.prototype.size=function(n){var r=this.end-this.start+1;return r*Mi(n)},t.prototype.has=function(n,r){return r.column>=this.start&&r.column<=this.end},t}(If);function _f(e){var t=vs(e);return new gn(Ho,t)}function Hc(e){return Number.isInteger(e)&&e>=0}var Wc=function(e){Hn(t,e);function t(n){return e.call(this,"".concat(n," is not a valid index. It must be 0 or a positive integer"))||this}return t}(Error),Mf="text/plain",Gg=":focus-within";function Hg(e){e.selectionStart=e.selectionEnd=e.value.length}function Wo(e,t,n){t===void 0&&(t=0),n===void 0&&(n=1);var r=[];if(Math.sign(e-t)===-1){for(var o=t;o>e;o-=n)r.push(o);return r}for(var o=t;o<e;o+=n)r.push(o);return r}function ka(e,t){return Boolean(e&&Vg(t,e))}function sa(e){return{width:e.offsetWidth,height:e.offsetHeight,left:e.offsetLeft,top:e.offsetTop}}function Wg(e,t){var n;(n=e.clipboardData)===null||n===void 0||n.setData(Mf,t)}function zg(e){return window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData?e.clipboardData.getData(Mf):""}function Pa(e,t,n){var r=t&&t[e.row],o=n&&n[e.column];return r&&o&&D(D({},r),o)}function bf(e,t,n){var r=Pa(n.start,e,t),o=Pa(n.end,e,t);return r&&o&&{width:o.left+o.width-r.left,height:o.top+o.height-r.top,top:r.top,left:r.left}}function qg(e,t,n,r){var o=r.toRange(n);return o?bf(e,t,o):void 0}function Kg(e){var t=Sg(function(n){return(n==null?void 0:n.value)||""},e);return Fg(t)}function Yg(e,t,n){var r=Wn(e),o=r.columns,i=r.rows;return{rows:t?Math.max(i,t.length):i,columns:n?Math.max(o,n.length):o}}function ca(e,t){return e!==null&&t==="view"&&Lf(e)}function Lf(e){return e.matches(Gg)}function Xg(e){return typeof e=="string"&&e.includes(`
`)}function vn(e){return"".concat(e.row,",").concat(e.column)}function Sa(e){var t=Ne(e.split(","),2),n=t[0],r=t[1];return{row:Number(n),column:Number(r)}}var pn=function(){function e(t){this.set=t}return e.from=function(t){var n,r,o=new Set;try{for(var i=_e(t),c=i.next();!c.done;c=i.next()){var f=c.value;o.add(vn(f))}}catch(h){n={error:h}}finally{try{c&&!c.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return new e(o)},e.prototype.has=function(t){return this.set.has(vn(t))},Object.defineProperty(e.prototype,"size",{get:function(){return this.set.size},enumerable:!1,configurable:!0}),e.prototype.add=function(t){var n=new Set(this.set);return n.add(vn(t)),new e(n)},e.prototype.delete=function(t){var n=new Set(this.set);return n.delete(vn(t))?new e(n):this},e.prototype.difference=function(t){var n,r,o=this;try{for(var i=_e(t),c=i.next();!c.done;c=i.next()){var f=c.value;o=o.delete(f)}}catch(h){n={error:h}}finally{try{c&&!c.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o},e.prototype.union=function(t){var n,r,o=this;try{for(var i=_e(t),c=i.next();!c.done;c=i.next()){var f=c.value;o=o.add(f)}}catch(h){n={error:h}}finally{try{c&&!c.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o},e.prototype[Symbol.iterator]=function(){var t,n,r,o,i,c;return Gr(this,function(f){switch(f.label){case 0:f.trys.push([0,5,6,7]),t=_e(this.set),n=t.next(),f.label=1;case 1:return n.done?[3,4]:(r=n.value,[4,Sa(r)]);case 2:f.sent(),f.label=3;case 3:return n=t.next(),[3,1];case 4:return[3,7];case 5:return o=f.sent(),i={error:o},[3,7];case 6:try{n&&!n.done&&(c=t.return)&&c.call(t)}finally{if(i)throw i.error}return[7];case 7:return[2]}})},e}(),Qg="=";function Hr(e){return typeof e=="string"&&e.startsWith(Qg)&&e.length>1}function gs(e){return e.slice(1)}function Wr(e,t){return new Sn(D(D({},t),{onCell:function(n){var r={row:n.row-1,column:n.col-1},o=xt(r,e);return isNaN(o==null?void 0:o.value)?o==null?void 0:o.value:Number(o==null?void 0:o.value)},onRange:function(n){var r=Wn(e),o={row:n.from.row-1,column:n.from.col-1},i={row:Math.min(n.to.row-1,r.rows-1),column:Math.min(n.to.col-1,r.columns-1)},c=Af(o,i,e);return $g(c,function(f){return isNaN(f==null?void 0:f.value)?f==null?void 0:f.value:Number(f==null?void 0:f.value)})}}))}var Zg=new Sn.DepParser;function Uf(e,t,n){var r=Wn(n),o=r.rows,i=r.columns;try{var c=Zg.parse(e,kf(t)),f=pn.from(c.flatMap(function(h){var u="from"in h;if(u){var a=h.from,s=h.to,l={row:a.row-1,column:a.col-1},d={row:Math.min(s.row-1,o-1),column:Math.min(s.col-1,i-1)},v=new gn(l,d);return Array.from(v)}return{row:h.row-1,column:h.col-1}}));return f}catch(h){if(h instanceof Sn.FormulaError)return pn.from([]);throw h}}function Jg(e,t,n){try{var r=kf(t),o=n.parse(e,r);return o instanceof Sn.FormulaError?o.toString():o}catch(i){if(i instanceof Sn.FormulaError)return i.toString();throw i}}function kf(e){return{row:e.row+1,col:e.column+1,sheet:"Sheet1"}}var jg=function(){function e(t){t===void 0&&(t=new Map),this.forwards=t}return e.from=function(t){var n,r,o=new Map;try{for(var i=_e(t),c=i.next();!c.done;c=i.next()){var f=Ne(c.value,2),h=f[0],u=f[1];o.set(vn(h),u)}}catch(a){n={error:a}}finally{try{c&&!c.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return new e(o)},e.prototype.set=function(t,n){var r=new e(new Map(this.forwards));return n.size===0?(r.forwards.delete(vn(t)),r):(r.forwards.set(vn(t),n),r)},e.prototype.get=function(t){return this.forwards.get(vn(t))||pn.from([])},e.prototype.getBackwards=function(t){var n,r,o=pn.from([]);try{for(var i=_e(this.forwards),c=i.next();!c.done;c=i.next()){var f=Ne(c.value,2),h=f[0],u=f[1];u.has(t)&&(o=o.add(Sa(h)))}}catch(a){n={error:a}}finally{try{c&&!c.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o},e.prototype.getBackwardsRecursive=function(t,n){var r,o;n===void 0&&(n=pn.from([]));var i=this.getBackwards(t),c=n;try{for(var f=_e(i),h=f.next();!h.done;h=f.next()){var u=h.value;c.has(u)||(c=c.add(u),i=i.union(this.getBackwardsRecursive(u,c)))}}catch(a){r={error:a}}finally{try{h&&!h.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}return i},e.prototype.hasCircularDependency=function(t){for(var n,r,o=pn.from([]),i=[t];i.length>0;){var c=i.pop();if(!!c){if(o.has(c))return!0;o=o.add(c);var f=this.get(c);if(!!f)try{for(var h=(n=void 0,_e(f)),u=h.next();!u.done;u=h.next()){var a=u.value;i.push(a)}}catch(s){n={error:s}}finally{try{u&&!u.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}}}return!1},e.prototype[Symbol.iterator]=function(){var t,n,r,o,i,c,f,h,u,a,s,l,d,v,p,m,g;return Gr(this,function(E){switch(E.label){case 0:t=new Set,E.label=1;case 1:E.trys.push([1,13,14,15]),n=_e(this.forwards),r=n.next(),E.label=2;case 2:return r.done?[3,12]:(o=Ne(r.value,2),i=o[0],c=o[1],f=Sa(i),t.add(i),[4,[f,c]]);case 3:E.sent(),E.label=4;case 4:E.trys.push([4,9,10,11]),h=(m=void 0,_e(c)),u=h.next(),E.label=5;case 5:return u.done?[3,8]:(a=u.value,s=vn(a),!t.has(s)&&!this.forwards.has(s)?(t.add(s),[4,[a,pn.from([])]]):[3,7]);case 6:E.sent(),E.label=7;case 7:return u=h.next(),[3,5];case 8:return[3,11];case 9:return l=E.sent(),m={error:l},[3,11];case 10:try{u&&!u.done&&(g=h.return)&&g.call(h)}finally{if(m)throw m.error}return[7];case 11:return r=n.next(),[3,2];case 12:return[3,15];case 13:return d=E.sent(),v={error:d},[3,15];case 14:try{r&&!r.done&&(p=n.return)&&p.call(n)}finally{if(v)throw v.error}return[7];case 15:return[2]}})},e.prototype.traverseBFSBackwards=function(){var t,n,r,o,i,f,c,f,h,u,a,s,l,d,v,p;return Gr(this,function(m){switch(m.label){case 0:t=pn.from([]),n=[];try{for(r=_e(this),o=r.next();!o.done;o=r.next())i=Ne(o.value,2),f=i[0],c=i[1],c.size===0&&(t=t.add(f),n.push(f))}catch(g){l={error:g}}finally{try{o&&!o.done&&(d=r.return)&&d.call(r)}finally{if(l)throw l.error}}m.label=1;case 1:return n.length>0?(f=n.shift(),f?[4,f]:[3,1]):[3,3];case 2:if(m.sent(),h=this.getBackwards(f),h.size===0)return[3,1];try{for(u=(v=void 0,_e(h)),a=u.next();!a.done;a=u.next())s=a.value,!t.has(s)&&this.get(s).difference(t).size===0&&(n.push(s),t=t.add(s))}catch(g){v={error:g}}finally{try{a&&!a.done&&(p=u.return)&&p.call(u)}finally{if(v)throw v.error}}return[3,1];case 3:return[2]}})},e}(),bn=function(){function e(t,n,r,o){this.createFormulaParser=t,this.data=n,this.referenceGraph=r||r1(n),this.evaluatedData=o||o1(n,this.referenceGraph,this.createFormulaParser)}return e}();function e1(e,t,n){var r=mn(t,n,e.data),o=Hr(n.value)?t1(e.referenceGraph,t,n,r):e.referenceGraph,i=e.createFormulaParser(r),c=n1(e.evaluatedData,r,o,t,n,i);return new bn(e.createFormulaParser,r,o,c)}function t1(e,t,n,r){var o=Uf(gs(n.value),t,r),i=e.set(t,o);return i}function n1(e,t,n,r,o,i){var c,f,h,u;if(n.hasCircularDependency(r)){var a=pn.from([r]),s=mn(r,D(D({},o),{value:Sn.FormulaError.REF}),e);try{for(var l=_e(n.getBackwardsRecursive(r)),d=l.next();!d.done;d=l.next()){var v=d.value;if(a.has(v))break;a=a.add(v);var p=xt(v,t);!p||(s=mn(v,D(D({},p),{value:Sn.FormulaError.REF}),s))}}catch(A){c={error:A}}finally{try{d&&!d.done&&(f=l.return)&&f.call(l)}finally{if(c)throw c.error}}return s}var m=e,g=Hr(o.value)?Fa(o.value,r,i):o.value,E=D(D({},o),{value:g});m=mn(r,E,m);try{for(var y=_e(n.getBackwardsRecursive(r)),w=y.next();!w.done;w=y.next()){var v=w.value,p=xt(v,t);if(!!p){var T=Hr(p.value)?Fa(p.value,r,i):p.value,R=D(D({},p),{value:T});m=mn(v,R,m)}}}catch(A){h={error:A}}finally{try{w&&!w.done&&(u=y.return)&&u.call(y)}finally{if(h)throw h.error}}return m}function r1(e){var t,n,r=[];try{for(var o=_e(ps(e)),i=o.next();!i.done;i=o.next()){var c=Ne(i.value,2),f=c[0],h=c[1];if(h&&Hr(h.value)){var u=Uf(gs(h.value),f,e);r.push([f,u])}}}catch(a){t={error:a}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return jg.from(r)}function o1(e,t,n){var r,o,i=e,c=n(i);try{for(var f=_e(t.traverseBFSBackwards()),h=f.next();!h.done;h=f.next()){var u=h.value,a=xt(u,e);if(!!a&&Hr(a.value)){var s=Fa(a.value,u,c);i=mn(u,D(D({},a),{value:s}),i),c=n(i)}}}catch(l){r={error:l}}finally{try{h&&!h.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}return i}function Fa(e,t,n){var r=gs(e);try{return Jg(r,t,n)}catch{return Sn.FormulaError.REF}}var Ba={active:null,mode:"view",rowDimensions:{},columnDimensions:{},lastChanged:null,hasPasted:!1,cut:!1,dragging:!1,model:new bn(Wr,[]),selected:new Cf,copied:null,lastCommit:null};function i1(e,t){var n,r,o,i,c,f;switch(t.type){case nf:{var h=t.payload.data,u=e.active&&si(e.active,h)?e.active:null,a=e.selected.normalizeTo(h);return D(D({},e),{model:new bn(e.model.createFormulaParser,h),active:u,selected:a})}case rf:{var s=t.payload.createFormulaParser;return D(D({},e),{model:new bn(s,e.model.data)})}case of:{var l=t.payload,d=l.row,v=l.extend,p=e.active;return D(D({},e),{selected:v&&p?new ci(p.row,d):new ci(d,d),active:v&&p?p:D(D({},Ho),{row:d}),mode:"view"})}case af:{var m=t.payload,g=m.column,v=m.extend,p=e.active;return D(D({},e),{selected:v&&p?new ui(p.column,g):new ui(g,g),active:v&&p?p:D(D({},Ho),{column:g}),mode:"view"})}case sf:return D(D({},e),{selected:new Of,active:Ho,mode:"view"});case cf:{var E=t.payload.selection,y=E.toRange(e.model.data),p=e.active&&E.has(e.model.data,e.active)?e.active:y==null?void 0:y.start;return D(D({},e),{selected:E,active:p||null,mode:"view"})}case uf:{var w=t.payload.point;return e.active&&!ka(e.active,w)?D(D({},e),{selected:new pr(new gn(w,e.active)),mode:"view"}):e}case lf:{var w=t.payload.point;return D(D({},e),{selected:new pr(new gn(w,w)),active:w,mode:ka(e.active,w)?"edit":"view"})}case ff:{var T=t.payload,p=T.active,R=T.data;return $a(e)?e:D(D({},e),{model:e1(e.model,p,R),lastChanged:p})}case df:{var A=t.payload,w=A.point,C=A.dimensions,x=e.rowDimensions[w.row],O=e.columnDimensions[w.column];return x&&O&&x.top===C.top&&x.height===C.height&&O.left===C.left&&O.width===C.width?e:D(D({},e),{rowDimensions:D(D({},e.rowDimensions),(n={},n[w.row]={top:C.top,height:C.height},n)),columnDimensions:D(D({},e.columnDimensions),(r={},r[w.column]={left:C.left,width:C.width},r))})}case hf:case Ua:{var I=e.selected.toRange(e.model.data);return D(D({},e),{copied:I,cut:t.type===Ua,hasPasted:!1})}case pf:{var P=t.payload.data,p=e.active;if(!p)return e;var B=Bg(P,function(Ee){return{value:Ee}}),S=Wn(B),I=e.selected.toRange(e.model.data);if(I&&S.rows===1&&S.columns===1){var b=xt({row:0,column:0},B),_=e.cut&&e.copied?Gc(e.copied.start,e.model.data):e.model.data,F=[];try{for(var V=_e(I||[]),z=V.next();!z.done;z=V.next()){var w=z.value,M=xt(w,e.model.data);F.push({prevCell:M||null,nextCell:b||null}),_=mn(w,b,_)}}catch(Ee){o={error:Ee}}finally{try{z&&!z.done&&(i=V.return)&&i.call(V)}finally{if(o)throw o.error}}return D(D({},e),{model:new bn(Wr,_),copied:null,cut:!1,hasPasted:!0,mode:"view",lastCommit:F})}var $={rows:p.row+S.rows,columns:p.column+S.columns},H=Dg(e.model.data,$),W={data:H,commit:[]};try{for(var Q=_e(ps(B)),te=Q.next();!te.done;te=Q.next()){var he=Ne(te.value,2),w=he[0],b=he[1],ue=W.commit||[],Te={row:w.row+p.row,column:w.column+p.column},fe=W.data;if(e.cut){if(e.copied){var Oe={row:w.row+e.copied.start.row,column:w.column+e.copied.start.column};fe=Gc(Oe,W.data)}ue=ft(ft([],Ne(ue),!1),[{prevCell:b||null,nextCell:null}],!1)}si(Te,H)||(W={data:fe,commit:ue});var M=xt(Te,fe)||null;ue=ft(ft([],Ne(ue),!1),[{prevCell:M,nextCell:b||null}],!1),W.data=mn(Te,D(D({value:void 0},M),b),fe),W.commit=ue}}catch(Ee){c={error:Ee}}finally{try{te&&!te.done&&(f=Q.return)&&f.call(Q)}finally{if(c)throw c.error}}return D(D({},e),{model:new bn(Wr,W.data),selected:new pr(new gn(p,{row:p.row+S.rows-1,column:p.column+S.columns-1})),copied:null,cut:!1,hasPasted:!0,mode:"view",lastCommit:W.commit})}case vf:return zo(e);case mf:return Sf(e);case pg:return li(e);case gf:return Pf(e);case Ef:{var Be=t.payload.event;if($a(e)||Be.metaKey)return e;if(e.mode==="view"&&e.active){var I=e.selected.toRange(e.model.data);return(I==null?void 0:I.size())===1?zo(li(e)):zo(e)}return e}case yf:{var ze=t.payload.event,Ze=Bf(e,ze);return Ze?D(D({},e),Ze(e,ze)):e}case wf:return D(D({},e),{dragging:!0});case Rf:return D(D({},e),{dragging:!1});case Nf:{var nt=t.payload.changes;return D(D({},e),Ff(nt))}default:throw new Error("Unknown action")}}function zo(e){return $a(e)?e:D(D({},e),{mode:"edit"})}function li(e){var t,n;if(!e.active)return e;var r=function(d){return d&&!d.readOnly},o=function(d){return r(d)?Object.assign({},d,{value:void 0}):d},i=e.selected.toRange(e.model.data),c=[],f=e.model.data;try{for(var h=_e(i||[]),u=h.next();!u.done;u=h.next()){var a=u.value,s=xt(a,e.model.data),l=o(s);c.push({prevCell:s||null,nextCell:l||null}),f=mn(a,l,f)}}catch(d){t={error:d}}finally{try{u&&!u.done&&(n=h.return)&&n.call(h)}finally{if(t)throw t.error}}return D(D(D({},e),{model:new bn(Wr,f)}),Ff(c))}function Pf(e){return D(D({},e),{active:null,selected:new Cf})}function Sf(e){return D(D({},e),{mode:"view"})}function Ff(e){return{lastCommit:e}}var Zn=function(e,t){return function(n){if(!!n.active){var r=Wn(n.model.data),o=n.active.column+t,i=o>=r.columns,c={row:n.active.row+e+(i?1:0),column:(n.active.column+t)%r.columns};return si(c,n.model.data)?D(D({},n),{active:c,selected:new pr(new gn(c,c)),mode:"view"}):D(D({},n),{mode:"view"})}}},Da={ArrowUp:Zn(-1,0),ArrowDown:Zn(1,0),ArrowLeft:Zn(0,-1),ArrowRight:Zn(0,1),Tab:Zn(0,1),Enter:zo,Backspace:li,Delete:li,Escape:Pf},a1={Escape:Sf,Tab:Da.Tab,Enter:Da.ArrowDown},s1={Tab:Zn(0,-1)},Ve;(function(e){e.Left="Left",e.Right="Right",e.Top="Top",e.Bottom="Bottom"})(Ve||(Ve={}));var c1={ArrowUp:function(e){return D(D({},e),{selected:Oo(e.selected,e.active,e.model.data,Ve.Top)})},ArrowDown:function(e){return D(D({},e),{selected:Oo(e.selected,e.active,e.model.data,Ve.Bottom)})},ArrowLeft:function(e){return D(D({},e),{selected:Oo(e.selected,e.active,e.model.data,Ve.Left)})},ArrowRight:function(e){return D(D({},e),{selected:Oo(e.selected,e.active,e.model.data,Ve.Right)})},Tab:Zn(0,-1)},u1={},l1={};function Bf(e,t){var n=t.key,r;return e.mode==="edit"?t.shiftKey?r=s1:r=a1:t.shiftKey&&t.metaKey?r=u1:t.shiftKey?r=c1:t.metaKey?r=l1:r=Da,r[n]}function f1(e,t){return Bf(e,t)!==void 0}function $a(e){var t=d1(e);return Boolean(t==null?void 0:t.readOnly)}function d1(e){var t=e.active&&xt(e.active,e.model.data);return t||null}function Oo(e,t,n,r){if(!t)return e;if(e instanceof pr){var o=h1(e,t,n,r);return o}return e instanceof ui?v1(e,t,n,r):e instanceof ci?p1(e,t,n,r):e}function h1(e,t,n,r){var o,i=r===Ve.Left||r===Ve.Right?"column":"row",c=r===Ve.Left||r===Ve.Top?"start":"end",f=c==="start"?-1:1,h=e.range.has(D(D({},t),(o={},o[i]=t[i]+f*-1,o))),u=h?c==="start"?"end":"start":c,a=new gn(e.range.start,e.range.end);a[u][i]+=f;var s=new pr(a).normalizeTo(n);return s}function p1(e,t,n,r){if(r===Ve.Left||r===Ve.Right)return e;var o=r===Ve.Top?-1:1,i=r===Ve.Top?"start":"end",c=i==="start"?"end":"start",f=D({},e);(r===Ve.Top?e.end>t.row:e.start<t.row)?f[c]=e[c]+o:f[i]=e[i]+o;var h=new ci(Math.max(f.start,0),Math.max(f.end,0));return h.normalizeTo(n)}function v1(e,t,n,r){if(r===Ve.Top||r===Ve.Bottom)return e;var o=r===Ve.Left?-1:1,i=r===Ve.Left?"start":"end",c=i==="start"?"end":"start",f=D({},e);(r===Ve.Left?e.end>t.row:e.start<t.row)?f[c]=e[c]+o:f[i]=e[i]+o;var h=new ui(Math.max(f.start,0),Math.max(f.end,0));return h.normalizeTo(n)}var Es=hg([Ba,function(){}]),m1=function(e){var t=e.children,n=e.columns,r=e.hideColumnIndicators,o=n+(r?0:1),i=Wo(o).map(function(c){return k("col",{},c)});return Se("table",{className:"Spreadsheet__table",children:[k("colgroup",{children:i}),k("tbody",{children:t})]})},g1=function(e){return k("tr",{...D({},e)})},E1=function(e){return k("tr",{...D({},e)})};function ro(){return tf(Es,function(e){var t=Ne(e,2);t[0];var n=t[1];return n})}function $e(e){return tf(Es,function(t){var n=Ne(t,1),r=n[0];return e(r)})}var y1=function(e){var t=e.selected,n=e.onSelect,r=N.exports.useCallback(function(){n()},[n]);return k("th",{className:$n("Spreadsheet__header",{"Spreadsheet__header--selected":t}),onClick:r,tabIndex:0})},w1=function(e){return function(n){var r=ro(),o=N.exports.useCallback(function(){return r(yg())},[r]),i=$e(function(c){return c.selected instanceof Of});return k(e,{...D({},n,{selected:i,onSelect:o})})}},R1=function(e){var t=e.column,n=e.label,r=e.selected,o=e.onSelect,i=N.exports.useCallback(function(c){o(t,c.shiftKey)},[o,t]);return k("th",{className:$n("Spreadsheet__header",{"Spreadsheet__header--selected":r}),onClick:i,tabIndex:0,children:n!==void 0?n:T1(t)})},N1=function(e){return function(n){var r=ro(),o=N.exports.useCallback(function(c,f){return r(Eg(c,f))},[r]),i=$e(function(c){return c.selected.hasEntireColumn(n.column)});return k(e,{...D({},n,{selected:i,onSelect:o})})}};function T1(e){for(var t="",n=e;n>=0;)t=String.fromCharCode(65+n%26)+t,n=Math.floor(n/26)-1;return t}var A1=function(e){var t=e.row,n=e.label,r=e.selected,o=e.onSelect,i=N.exports.useCallback(function(c){o(t,c.shiftKey)},[o,t]);return k("th",{className:$n("Spreadsheet__header",{"Spreadsheet__header--selected":r}),onClick:i,tabIndex:0,children:n!==void 0?n:t+1})},C1=function(e){return function(n){var r=ro(),o=$e(function(c){return c.selected.hasEntireRow(n.row)}),i=N.exports.useCallback(function(c,f){return r(gg(c,f))},[r]);return k(e,{...D({},n,{selected:o,onSelect:i})})}},x1=function(e){var t=e.row,n=e.column,r=e.DataViewer,o=e.selected,i=e.active,c=e.dragging,f=e.mode,h=e.data,u=e.evaluatedData,a=e.select,s=e.activate,l=e.setCellDimensions,d=e.setCellData,v=N.exports.useRef(null),p=N.exports.useMemo(function(){return{row:t,column:n}},[t,n]),m=N.exports.useCallback(function(E){f==="view"&&(l(p,sa(E.currentTarget)),E.shiftKey?a(p):s(p))},[f,l,p,a,s]),g=N.exports.useCallback(function(E){c&&(l(p,sa(E.currentTarget)),a(p))},[l,a,c,p]);return N.exports.useEffect(function(){var E=v.current;o&&E&&l(p,sa(E)),E&&i&&f==="view"&&E.focus()},[l,o,i,f,p,h]),h&&h.DataViewer&&(r=h.DataViewer),k("td",{ref:v,className:$n("Spreadsheet__cell",h==null?void 0:h.className,{"Spreadsheet__cell--readonly":h==null?void 0:h.readOnly}),onMouseOver:g,onMouseDown:m,tabIndex:0,children:k(r,{row:t,column:n,cell:h,evaluatedCell:u,setCellData:d})})},O1=function(e){return function(n){var r=n.row,o=n.column,i=ro(),c=N.exports.useMemo(function(){return{row:r,column:o}},[r,o]),f=N.exports.useCallback(function(E){return i(Tf(c,E))},[i,c]),h=N.exports.useCallback(function(E){return i(Rg(E))},[i]),u=N.exports.useCallback(function(E){return i(Ng(E))},[i]),a=N.exports.useCallback(function(E,y){return i(Tg(E,y))},[i]),s=$e(function(E){return ka(E.active,c)}),l=$e(function(E){return s?E.mode:"view"}),d=$e(function(E){return xt(c,E.model.data)}),v=$e(function(E){return xt(c,E.model.evaluatedData)}),p=$e(function(E){return E.selected.has(E.model.data,c)}),m=$e(function(E){return E.dragging}),g=$e(function(E){var y;return((y=E.copied)===null||y===void 0?void 0:y.has(c))||!1});return k(e,{...D({},n,{selected:p,active:s,copied:g,dragging:m,mode:l,evaluatedData:v,data:d,select:h,activate:u,setCellDimensions:a,setCellData:f})})}},I1="TRUE",_1="FALSE",M1=function(e){var t=e.cell,n=e.evaluatedCell,r=b1(t,n);return typeof r=="boolean"?k("span",{className:"Spreadsheet__data-viewer Spreadsheet__data-viewer--boolean",children:L1(r)}):k("span",{className:$n("Spreadsheet__data-viewer",{"Spreadsheet__data-viewer--preserve-breaks":Xg(r)}),children:r})};function b1(e,t){var n,r=(n=t==null?void 0:t.value)!==null&&n!==void 0?n:e==null?void 0:e.value;return r&&typeof r=="object"?r.toString():r}function L1(e){return e?I1:_1}var U1=function(e){var t,n=e.onChange,r=e.cell,o=N.exports.useRef(null),i=N.exports.useCallback(function(f){n(D(D({},r),{value:f.target.value}))},[n,r]);N.exports.useEffect(function(){o.current&&Hg(o.current)},[o]);var c=(t=r==null?void 0:r.value)!==null&&t!==void 0?t:"";return k("div",{className:"Spreadsheet__data-editor",children:k("input",{ref:o,type:"text",onChange:i,value:c,autoFocus:!0})})},k1=function(e){var t=N.exports.useRef(null),n=ro(),r=N.exports.useCallback(function(E,y){return n(Tf(E,y))},[n]),o=N.exports.useCallback(function(){return n(Lg())},[n]),i=N.exports.useCallback(function(E){return n(_g(E))},[n]),c=N.exports.useCallback(function(){n(Ug())},[n]),f=$e(function(E){return E.active}),h=$e(function(E){return E.mode}),u=$e(function(E){return E.active?xt(E.active,E.model.data):void 0}),a=$e(function(E){return f?Pa(f,E.rowDimensions,E.columnDimensions):void 0}),s=N.exports.useMemo(function(){return!f||!a},[f,a]),l=N.exports.useRef(void 0),d=N.exports.useRef(null),v=N.exports.useRef(void 0),p=N.exports.useCallback(function(E){!f||r(f,E)},[r,f]);N.exports.useEffect(function(){var E=t.current;!s&&E&&E.focus()},[t,s]),N.exports.useEffect(function(){var E=d.current,y=v.current;if(d.current=f,v.current=u,!(!E||!y)){var w=(f==null?void 0:f.row)!==E.row||(f==null?void 0:f.column)!==E.column,T=h!=="edit";if(w||T){var R=l.current;y!==R?i([{prevCell:R||null,nextCell:y}]):!w&&u!==y&&i([{prevCell:y,nextCell:u||null}]),l.current=u}}});var m=u&&u.DataEditor||e.DataEditor,g=u&&u.readOnly;return s?null:k("div",{ref:t,className:$n("Spreadsheet__active-cell","Spreadsheet__active-cell--".concat(h)),style:a,onClick:h==="view"&&!g?o:void 0,tabIndex:0,children:h==="edit"&&f&&k(m,{row:f.row,column:f.column,cell:u,onChange:p,exitEditMode:c})})},Df=function(e){var t,n=e.dimensions,r=e.dragging,o=e.hidden,i=e.variant,c=n||{},f=c.width,h=c.height,u=c.top,a=c.left;return k("div",{className:$n("Spreadsheet__floating-rect",(t={},t["Spreadsheet__floating-rect--".concat(i)]=i,t["Spreadsheet__floating-rect--dragging"]=r,t["Spreadsheet__floating-rect--hidden"]=o,t)),style:{width:f,height:h,top:u,left:a}})},P1=function(){var e=$e(function(o){return o.selected}),t=$e(function(o){return e&&qg(o.rowDimensions,o.columnDimensions,o.model.data,o.selected)}),n=$e(function(o){return o.dragging}),r=$e(function(o){return o.selected.size(o.model.data)<2});return k(Df,{variant:"selected",dimensions:t,dragging:n,hidden:r})},S1=function(){var e=$e(function(r){return r.copied}),t=$e(function(r){return e&&bf(r.rowDimensions,r.columnDimensions,e)}),n=e===null;return k(Df,{variant:"copied",dimensions:t,hidden:n,dragging:!1})};function F1(e,t){t===void 0&&(t={});var n=t.insertAt;if(!(!e||typeof document>"u")){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",n==="top"&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}var B1=`.Spreadsheet {
  --background-color: white;
  --text-color: black;
  --readonly-text-color: rgba(0, 0, 0, 0.4);
  --outline-color: #4285f4;
  --outline-background-color: rgba(160, 195, 255, 0.2);
  --border-color: hsl(2deg, 0%, 91%);
  --header-background-color: rgba(0, 0, 0, 0.04);
  --elevation: 0 2px 5px rgba(0, 0, 0, 0.4);

  position: relative;
  overflow: visible;
  background: var(--background-color);
  color: var(--text-color);
  display: inline-block;
}

.Spreadsheet--dark-mode {
  --background-color: black;
  --text-color: white;
  --readonly-text-color: rgba(255, 255, 255, 0.4);
  --header-background-color: rgba(255, 255, 255, 0.04);
  --border-color: hsl(2deg, 0%, 19%);
}

.Spreadsheet__active-cell {
  position: absolute;
  border: 2px solid var(--outline-color);
  box-sizing: border-box;
}

.Spreadsheet__active-cell--edit {
  background: var(--background-color);
  box-shadow: var(--elevation);
}

.Spreadsheet__table {
  border-collapse: collapse;
  table-layout: fixed;
}

.Spreadsheet__cell,
.Spreadsheet__active-cell {
  cursor: cell;
}

.Spreadsheet__cell {
  outline: none;
}

.Spreadsheet__cell--readonly {
  color: var(--readonly-text-color);
}

.Spreadsheet__cell,
.Spreadsheet__header {
  min-width: 6em;
  min-height: 1.9em;
  height: 1.9em;
  max-height: 1.9em;
  border: 1px solid var(--border-color);
  overflow: hidden;
  word-break: keep-all;
  white-space: nowrap;
  text-align: left;
  box-sizing: border-box;
  user-select: none;
}

.Spreadsheet__header {
  background: var(--header-background-color);
  color: var(--readonly-text-color);
  text-align: center;
  font: inherit;
}

.Spreadsheet__header--selected {
  background: #5f6268;
  color: #fff;
}

.Spreadsheet__header,
.Spreadsheet__data-viewer,
.Spreadsheet__data-editor input {
  padding: 4px;
  box-sizing: border-box;
}

.Spreadsheet__data-viewer--preserve-breaks {
  white-space: pre-wrap;
}

.Spreadsheet__data-editor,
.Spreadsheet__data-editor input {
  width: 100%;
  height: 100%;
}

.Spreadsheet__data-editor input {
  font: inherit;
  color: inherit;
  background: none;
  border: none;
  outline: none;
  margin: 0;
}

.Spreadsheet__data-viewer--boolean {
  text-align: center;
}

.Spreadsheet__floating-rect {
  position: absolute;
  pointer-events: none;
  box-sizing: border-box;
}

.Spreadsheet__floating-rect--hidden {
  display: none;
}

.Spreadsheet__floating-rect--selected {
  background: var(--outline-background-color);
  border: 2px var(--outline-color) solid;
}

.Spreadsheet__floating-rect--dragging {
  border: none;
}

.Spreadsheet__floating-rect--copied {
  border: 2px var(--outline-color) dashed;
}
`;F1(B1);var D1=function(e){var t,n=e.className,r=e.darkMode,o=e.columnLabels,i=e.rowLabels,c=e.hideColumnIndicators,f=e.hideRowIndicators,h=e.onKeyDown,u=e.Table,a=u===void 0?m1:u,s=e.Row,l=s===void 0?g1:s,d=e.HeaderRow,v=d===void 0?E1:d,p=e.DataEditor,m=p===void 0?U1:p,g=e.DataViewer,E=g===void 0?M1:g,y=e.onChange,w=y===void 0?function(){}:y,T=e.onModeChange,R=T===void 0?function(){}:T,A=e.onSelect,C=A===void 0?function(){}:A,x=e.onActivate,O=x===void 0?function(){}:x,I=e.onBlur,P=I===void 0?function(){}:I,B=e.onCellCommit,S=B===void 0?function(){}:B,b=e.onEvaluatedDataChange,_=b===void 0?function(){}:b,F=N.exports.useMemo(function(){var X=e.createFormulaParser||Wr,Me=new bn(X,e.data);return D(D({},Ba),{model:Me,selected:e.selected||Ba.selected})},[e.createFormulaParser,e.data,e.selected]),V=N.exports.useReducer(i1,F),z=Ne(V,2),M=z[0],$=z[1],H=N.exports.useMemo(function(){return Yg(M.model.data,i,o)},[M.model.data,i,o]),W=M.mode,Q=N.exports.useRef(null),te=function(X){return N.exports.useCallback(function(){for(var Me=[],Je=0;Je<arguments.length;Je++)Me[Je]=arguments[Je];return $(X.apply(void 0,ft([],Ne(Me),!1)))},[X])},he=te(bg),ue=te(Mg),Te=te(Ag),fe=te(xg),Oe=te(Cg),Be=te(Og),ze=te(Ig),Ze=te(vg),nt=te(mg),pe=te(kg),ke=te(wg),Ee=N.exports.useRef(M.active);N.exports.useEffect(function(){if(M.active!==Ee.current)if(M.active)O(M.active);else{var X=Q.current;X&&Lf(X)&&document.activeElement&&document.activeElement.blur(),P()}Ee.current=M.active},[O,P,M.active]);var De=N.exports.useRef(M.model.data);N.exports.useEffect(function(){M.model.data!==De.current&&M.model.data!==e.data&&w(M.model.data),De.current=M.model.data},[M.model.data,w,e.data]);var Ie=N.exports.useRef(M.model.evaluatedData);N.exports.useEffect(function(){var X,Me;((X=M==null?void 0:M.model)===null||X===void 0?void 0:X.evaluatedData)!==(Ie==null?void 0:Ie.current)&&_((Me=M==null?void 0:M.model)===null||Me===void 0?void 0:Me.evaluatedData),Ie.current=M.model.evaluatedData},[(t=M==null?void 0:M.model)===null||t===void 0?void 0:t.evaluatedData,_]);var ye=N.exports.useRef(M.selected);N.exports.useEffect(function(){M.selected.equals(ye.current)||(!e.selected||!M.selected.equals(e.selected))&&C(M.selected),ye.current=M.selected},[M.selected,C,e.selected]);var Ge=N.exports.useRef(M.mode);N.exports.useEffect(function(){M.mode!==Ge.current&&R(M.mode),Ge.current=M.mode},[M.mode,R]);var at=N.exports.useRef(M.lastCommit);N.exports.useEffect(function(){var X,Me;if(M.lastCommit&&M.lastCommit!==at.current)try{for(var Je=_e(M.lastCommit),Lt=Je.next();!Lt.done;Lt=Je.next()){var un=Lt.value;S(un.prevCell,un.nextCell,M.lastChanged)}}catch(Dt){X={error:Dt}}finally{try{Lt&&!Lt.done&&(Me=Je.return)&&Me.call(Je)}finally{if(X)throw X.error}}},[S,M.lastChanged,M.lastCommit]);var bt=N.exports.useRef(e.selected);N.exports.useEffect(function(){e.selected&&bt.current&&!e.selected.equals(bt.current)&&ke(e.selected),bt.current=e.selected},[e.selected,ke]);var xn=N.exports.useRef(e.data);N.exports.useEffect(function(){e.data!==xn.current&&Ze(e.data),xn.current=e.data},[e.data,Ze]);var Xt=N.exports.useRef(e.createFormulaParser);N.exports.useEffect(function(){e.createFormulaParser!==Xt.current&&e.createFormulaParser&&nt(e.createFormulaParser),Xt.current=e.createFormulaParser},[e.createFormulaParser,nt]);var zn=N.exports.useCallback(function(X){var Me=M.model,Je=M.selected,Lt=Me.data,un=Je.toRange(Lt);if(un){var Dt=Af(un.start,un.end,Lt),fo=Kg(Dt);Wg(X,fo)}},[M]),qn=N.exports.useCallback(function(X){ca(Q.current,W)&&(X.preventDefault(),X.stopPropagation(),zn(X),he())},[W,zn,he]),Cr=N.exports.useCallback(function(X){ca(Q.current,W)&&(X.preventDefault(),X.stopPropagation(),zn(X),ue())},[W,zn,ue]),xr=N.exports.useCallback(function(X){if(ca(Q.current,W)&&(X.preventDefault(),X.stopPropagation(),X.clipboardData)){var Me=zg(X);Te(Me)}},[W,Te]),uo=N.exports.useCallback(function(X){X.persist(),h&&h(X),X.defaultPrevented||(f1(M,X)&&X.nativeEvent.preventDefault(),fe(X))},[M,h,fe]),Or=N.exports.useCallback(function(){ze(),document.removeEventListener("mouseup",Or)},[ze]),lo=N.exports.useCallback(function(X){!M.dragging&&X.buttons===1&&(Be(),document.addEventListener("mouseup",Or))},[M,Be,Or]),Ir=N.exports.useCallback(function(X){X.currentTarget.contains(X.relatedTarget)||pe()},[pe]),_r=N.exports.useMemo(function(){return O1(e.Cell||x1)},[e.Cell]),Qt=N.exports.useMemo(function(){return w1(e.CornerIndicator||y1)},[e.CornerIndicator]),Bt=N.exports.useMemo(function(){return C1(e.RowIndicator||A1)},[e.RowIndicator]),Zt=N.exports.useMemo(function(){return N1(e.ColumnIndicator||R1)},[e.ColumnIndicator]);N.exports.useEffect(function(){return document.addEventListener("cut",qn),document.addEventListener("copy",Cr),document.addEventListener("paste",xr),function(){document.removeEventListener("cut",qn),document.removeEventListener("copy",Cr),document.removeEventListener("paste",xr)}},[qn,Cr,xr]);var cn=N.exports.useMemo(function(){return Se(a,{columns:H.columns,hideColumnIndicators:c,children:[Se(v,{children:[!f&&!c&&k(Qt,{}),!c&&Wo(H.columns).map(function(X){return o?k(Zt,{column:X,label:X in o?o[X]:null},X):k(Zt,{column:X},X)})]}),Wo(H.rows).map(function(X){return Se(l,{row:X,children:[!f&&(i?k(Bt,{row:X,label:X in i?i[X]:null},X):k(Bt,{row:X},X)),Wo(H.columns).map(function(Me){return k(_r,{row:X,column:Me,DataViewer:E},Me)})]},X)})]})},[a,H.rows,H.columns,c,l,v,f,Qt,o,Zt,i,Bt,_r,E]),Kn=N.exports.useMemo(function(){return k(k1,{DataEditor:m})},[m]),Di=N.exports.useMemo(function(){return Se("div",{ref:Q,className:$n("Spreadsheet",n,{"Spreadsheet--dark-mode":r}),onKeyPress:Oe,onKeyDown:uo,onMouseMove:lo,onBlur:Ir,children:[cn,Kn,k(P1,{}),k(S1,{})]})},[n,r,Oe,uo,lo,Ir,cn,Kn]);return N.exports.createElement(Es.Provider,{value:V},Di)};const $f=N.exports.createContext(null),SN=({children:e})=>{const[t,n]=N.exports.useState({});return k($f.Provider,{value:{message:t,setMessage:n},children:e})};function Qe(e,t){t===void 0&&(t={});var n=t.insertAt;if(e&&typeof document<"u"){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",n==="top"&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}function se(){return se=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},se.apply(this,arguments)}function de(e,t,{checkForDefaultPrevented:n=!0}={}){return function(r){if(e==null||e(r),n===!1||!r.defaultPrevented)return t==null?void 0:t(r)}}function ys(...e){return t=>e.forEach(n=>function(r,o){typeof r=="function"?r(o):r!=null&&(r.current=o)}(n,t))}function wt(...e){return N.exports.useCallback(ys(...e),e)}function Tr(e,t=[]){let n=[];const r=()=>{const o=n.map(i=>N.exports.createContext(i));return function(i){const c=(i==null?void 0:i[e])||o;return N.exports.useMemo(()=>({[`__scope${e}`]:{...i,[e]:c}}),[i,c])}};return r.scopeName=e,[function(o,i){const c=N.exports.createContext(i),f=n.length;function h(u){const{scope:a,children:s,...l}=u,d=(a==null?void 0:a[e][f])||c,v=N.exports.useMemo(()=>l,Object.values(l));return N.exports.createElement(d.Provider,{value:v},s)}return n=[...n,i],h.displayName=o+"Provider",[h,function(u,a){const s=(a==null?void 0:a[e][f])||c,l=N.exports.useContext(s);if(l)return l;if(i!==void 0)return i;throw new Error(`\`${u}\` must be used within \`${o}\``)}]},$1(r,...t)]}function $1(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(o){const i=r.reduce((c,{useScope:f,scopeName:h})=>({...c,...f(o)[`__scope${h}`]}),{});return N.exports.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return n.scopeName=t.scopeName,n}function tn(e){const t=N.exports.useRef(e);return N.exports.useEffect(()=>{t.current=e}),N.exports.useMemo(()=>(...n)=>{var r;return(r=t.current)===null||r===void 0?void 0:r.call(t,...n)},[])}function ws({prop:e,defaultProp:t,onChange:n=()=>{}}){const[r,o]=function({defaultProp:h,onChange:u}){const a=N.exports.useState(h),[s]=a,l=N.exports.useRef(s),d=tn(u);return N.exports.useEffect(()=>{l.current!==s&&(d(s),l.current=s)},[s,l,d]),a}({defaultProp:t,onChange:n}),i=e!==void 0,c=i?e:r,f=tn(n);return[c,N.exports.useCallback(h=>{if(i){const u=typeof h=="function"?h(e):h;u!==e&&f(u)}else o(h)},[i,e,o,f])]}Qe(`@import url('https://unpkg.com/mirotone@5.3.0/dist/styles.css');
`);const zr=N.exports.forwardRef((e,t)=>{const{children:n,...r}=e,o=N.exports.Children.toArray(n),i=o.find(V1);if(i){const c=i.props.children,f=o.map(h=>h===i?N.exports.Children.count(c)>1?N.exports.Children.only(null):N.exports.isValidElement(c)?c.props.children:null:h);return N.exports.createElement(Va,se({},r,{ref:t}),N.exports.isValidElement(c)?N.exports.cloneElement(c,void 0,f):null)}return N.exports.createElement(Va,se({},r,{ref:t}),n)});zr.displayName="Slot";const Va=N.exports.forwardRef((e,t)=>{const{children:n,...r}=e;return N.exports.isValidElement(n)?N.exports.cloneElement(n,{...G1(r,n.props),ref:t?ys(t,n.ref):n.ref}):N.exports.Children.count(n)>1?N.exports.Children.only(null):null});Va.displayName="SlotClone";const Vf=({children:e})=>N.exports.createElement(N.exports.Fragment,null,e);function V1(e){return N.exports.isValidElement(e)&&e.type===Vf}function G1(e,t){const n={...t};for(const r in t){const o=e[r],i=t[r];/^on[A-Z]/.test(r)?o&&i?n[r]=(...c)=>{i(...c),o(...c)}:o&&(n[r]=o):r==="style"?n[r]={...o,...i}:r==="className"&&(n[r]=[o,i].filter(Boolean).join(" "))}return{...e,...n}}const Ft=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,t)=>{const n=N.exports.forwardRef((r,o)=>{const{asChild:i,...c}=r,f=i?zr:t;return N.exports.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),N.exports.createElement(f,se({},c,{ref:o}))});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function Gf(e,t){e&&gi.exports.flushSync(()=>e.dispatchEvent(t))}function Hf(e){const t=e+"CollectionProvider",[n,r]=Tr(t),[o,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),c=e+"CollectionSlot",f=e+"CollectionItemSlot",h="data-radix-collection-item";return[{Provider:u=>{const{scope:a,children:s}=u,l=rt.useRef(null),d=rt.useRef(new Map).current;return rt.createElement(o,{scope:a,itemMap:d,collectionRef:l},s)},Slot:rt.forwardRef((u,a)=>{const{scope:s,children:l}=u,d=wt(a,i(c,s).collectionRef);return rt.createElement(zr,{ref:d},l)}),ItemSlot:rt.forwardRef((u,a)=>{const{scope:s,children:l,...d}=u,v=rt.useRef(null),p=wt(a,v),m=i(f,s);return rt.useEffect(()=>(m.itemMap.set(v,{ref:v,...d}),()=>{m.itemMap.delete(v)})),rt.createElement(zr,{[h]:"",ref:p},l)})},function(u){const a=i(e+"CollectionConsumer",u);return rt.useCallback(()=>{const s=a.collectionRef.current;if(!s)return[];const l=Array.from(s.querySelectorAll(`[${h}]`));return Array.from(a.itemMap.values()).sort((d,v)=>l.indexOf(d.ref.current)-l.indexOf(v.ref.current))},[a.collectionRef,a.itemMap])},r]}const H1=N.exports.createContext(void 0);function Wf(e){const t=N.exports.useContext(H1);return e||t||"ltr"}const Ga="dismissableLayer.update",W1="dismissableLayer.pointerDownOutside",z1="dismissableLayer.focusOutside";let zc;const q1=N.exports.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),zf=N.exports.forwardRef((e,t)=>{var n;const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:c,onInteractOutside:f,onDismiss:h,...u}=e,a=N.exports.useContext(q1),[s,l]=N.exports.useState(null),d=(n=s==null?void 0:s.ownerDocument)!==null&&n!==void 0?n:globalThis==null?void 0:globalThis.document,[,v]=N.exports.useState({}),p=wt(t,C=>l(C)),m=Array.from(a.layers),[g]=[...a.layersWithOutsidePointerEventsDisabled].slice(-1),E=m.indexOf(g),y=s?m.indexOf(s):-1,w=a.layersWithOutsidePointerEventsDisabled.size>0,T=y>=E,R=function(C,x=globalThis==null?void 0:globalThis.document){const O=tn(C),I=N.exports.useRef(!1),P=N.exports.useRef(()=>{});return N.exports.useEffect(()=>{const B=b=>{if(b.target&&!I.current){let F=function(){Kc(W1,O,_,{discrete:!0})};const _={originalEvent:b};b.pointerType==="touch"?(x.removeEventListener("click",P.current),P.current=F,x.addEventListener("click",P.current,{once:!0})):F()}else x.removeEventListener("click",P.current);I.current=!1},S=window.setTimeout(()=>{x.addEventListener("pointerdown",B)},0);return()=>{window.clearTimeout(S),x.removeEventListener("pointerdown",B),x.removeEventListener("click",P.current)}},[x,O]),{onPointerDownCapture:()=>I.current=!0}}(C=>{const x=C.target,O=[...a.branches].some(I=>I.contains(x));T&&!O&&(i==null||i(C),f==null||f(C),C.defaultPrevented||h==null||h())},d),A=function(C,x=globalThis==null?void 0:globalThis.document){const O=tn(C),I=N.exports.useRef(!1);return N.exports.useEffect(()=>{const P=B=>{B.target&&!I.current&&Kc(z1,O,{originalEvent:B},{discrete:!1})};return x.addEventListener("focusin",P),()=>x.removeEventListener("focusin",P)},[x,O]),{onFocusCapture:()=>I.current=!0,onBlurCapture:()=>I.current=!1}}(C=>{const x=C.target;[...a.branches].some(O=>O.contains(x))||(c==null||c(C),f==null||f(C),C.defaultPrevented||h==null||h())},d);return function(C,x=globalThis==null?void 0:globalThis.document){const O=tn(C);N.exports.useEffect(()=>{const I=P=>{P.key==="Escape"&&O(P)};return x.addEventListener("keydown",I),()=>x.removeEventListener("keydown",I)},[O,x])}(C=>{y===a.layers.size-1&&(o==null||o(C),!C.defaultPrevented&&h&&(C.preventDefault(),h()))},d),N.exports.useEffect(()=>{if(s)return r&&(a.layersWithOutsidePointerEventsDisabled.size===0&&(zc=d.body.style.pointerEvents,d.body.style.pointerEvents="none"),a.layersWithOutsidePointerEventsDisabled.add(s)),a.layers.add(s),qc(),()=>{r&&a.layersWithOutsidePointerEventsDisabled.size===1&&(d.body.style.pointerEvents=zc)}},[s,d,r,a]),N.exports.useEffect(()=>()=>{s&&(a.layers.delete(s),a.layersWithOutsidePointerEventsDisabled.delete(s),qc())},[s,a]),N.exports.useEffect(()=>{const C=()=>v({});return document.addEventListener(Ga,C),()=>document.removeEventListener(Ga,C)},[]),N.exports.createElement(Ft.div,se({},u,{ref:p,style:{pointerEvents:w?T?"auto":"none":void 0,...e.style},onFocusCapture:de(e.onFocusCapture,A.onFocusCapture),onBlurCapture:de(e.onBlurCapture,A.onBlurCapture),onPointerDownCapture:de(e.onPointerDownCapture,R.onPointerDownCapture)}))});function qc(){const e=new CustomEvent(Ga);document.dispatchEvent(e)}function Kc(e,t,n,{discrete:r}){const o=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),r?Gf(o,i):o.dispatchEvent(i)}let ua=0;function Yc(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}const la="focusScope.autoFocusOnMount",fa="focusScope.autoFocusOnUnmount",Xc={bubbles:!1,cancelable:!0},K1=N.exports.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:o,onUnmountAutoFocus:i,...c}=e,[f,h]=N.exports.useState(null),u=tn(o),a=tn(i),s=N.exports.useRef(null),l=wt(t,p=>h(p)),d=N.exports.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;N.exports.useEffect(()=>{if(r){let p=function(y){if(d.paused||!f)return;const w=y.target;f.contains(w)?s.current=w:Mn(s.current,{select:!0})},m=function(y){if(d.paused||!f)return;const w=y.relatedTarget;w!==null&&(f.contains(w)||Mn(s.current,{select:!0}))},g=function(y){if(document.activeElement===document.body)for(const w of y)w.removedNodes.length>0&&Mn(f)};document.addEventListener("focusin",p),document.addEventListener("focusout",m);const E=new MutationObserver(g);return f&&E.observe(f,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",p),document.removeEventListener("focusout",m),E.disconnect()}}},[r,f,d.paused]),N.exports.useEffect(()=>{if(f){Jc.add(d);const m=document.activeElement;if(!f.contains(m)){const g=new CustomEvent(la,Xc);f.addEventListener(la,u),f.dispatchEvent(g),g.defaultPrevented||(function(E,{select:y=!1}={}){const w=document.activeElement;for(const T of E)if(Mn(T,{select:y}),document.activeElement!==w)return}((p=Qc(f),p.filter(E=>E.tagName!=="A")),{select:!0}),document.activeElement===m&&Mn(f))}return()=>{f.removeEventListener(la,u),setTimeout(()=>{const g=new CustomEvent(fa,Xc);f.addEventListener(fa,a),f.dispatchEvent(g),g.defaultPrevented||Mn(m!=null?m:document.body,{select:!0}),f.removeEventListener(fa,a),Jc.remove(d)},0)}}var p},[f,u,a,d]);const v=N.exports.useCallback(p=>{if(!n&&!r||d.paused)return;const m=p.key==="Tab"&&!p.altKey&&!p.ctrlKey&&!p.metaKey,g=document.activeElement;if(m&&g){const E=p.currentTarget,[y,w]=function(T){const R=Qc(T),A=Zc(R,T),C=Zc(R.reverse(),T);return[A,C]}(E);y&&w?p.shiftKey||g!==w?p.shiftKey&&g===y&&(p.preventDefault(),n&&Mn(w,{select:!0})):(p.preventDefault(),n&&Mn(y,{select:!0})):g===E&&p.preventDefault()}},[n,r,d.paused]);return N.exports.createElement(Ft.div,se({tabIndex:-1},c,{ref:l,onKeyDown:v}))});function Qc(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function Zc(e,t){for(const n of e)if(!Y1(n,{upTo:t}))return n}function Y1(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Mn(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&function(r){return r instanceof HTMLInputElement&&"select"in r}(e)&&t&&e.select()}}const Jc=function(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=jc(e,t),e.unshift(t)},remove(t){var n;e=jc(e,t),(n=e[0])===null||n===void 0||n.resume()}}}();function jc(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}const vr=Boolean(globalThis==null?void 0:globalThis.document)?N.exports.useLayoutEffect:()=>{},X1=Wd["useId".toString()]||(()=>{});let Q1=0;function fi(e){const[t,n]=N.exports.useState(X1());return vr(()=>{e||n(r=>r!=null?r:String(Q1++))},[e]),e||(t?`radix-${t}`:"")}const Z1=["top","right","bottom","left"],Fn=Math.min,At=Math.max,di=Math.round,Io=Math.floor,Bn=e=>({x:e,y:e}),J1={left:"right",right:"left",bottom:"top",top:"bottom"},j1={start:"end",end:"start"};function Ha(e,t,n){return At(e,Fn(t,n))}function An(e,t){return typeof e=="function"?e(t):e}function En(e){return e.split("-")[0]}function yr(e){return e.split("-")[1]}function Rs(e){return e==="x"?"y":"x"}function Ns(e){return e==="y"?"height":"width"}function Ar(e){return["top","bottom"].includes(En(e))?"y":"x"}function Ts(e){return Rs(Ar(e))}function da(e){return e.replace(/start|end/g,t=>j1[t])}function _o(e){return e.replace(/left|right|bottom|top/g,t=>J1[t])}function qf(e){return typeof e!="number"?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(e):{top:e,right:e,bottom:e,left:e}}function hi(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function eu(e,t,n){let{reference:r,floating:o}=e;const i=Ar(t),c=Ts(t),f=Ns(c),h=En(t),u=i==="y",a=r.x+r.width/2-o.width/2,s=r.y+r.height/2-o.height/2,l=r[f]/2-o[f]/2;let d;switch(h){case"top":d={x:a,y:r.y-o.height};break;case"bottom":d={x:a,y:r.y+r.height};break;case"right":d={x:r.x+r.width,y:s};break;case"left":d={x:r.x-o.width,y:s};break;default:d={x:r.x,y:r.y}}switch(yr(t)){case"start":d[c]-=l*(n&&u?-1:1);break;case"end":d[c]+=l*(n&&u?-1:1)}return d}async function qr(e,t){var n;t===void 0&&(t={});const{x:r,y:o,platform:i,rects:c,elements:f,strategy:h}=e,{boundary:u="clippingAncestors",rootBoundary:a="viewport",elementContext:s="floating",altBoundary:l=!1,padding:d=0}=An(t,e),v=qf(d),p=f[l?s==="floating"?"reference":"floating":s],m=hi(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(p)))==null||n?p:p.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(f.floating)),boundary:u,rootBoundary:a,strategy:h})),g=s==="floating"?{...c.floating,x:r,y:o}:c.reference,E=await(i.getOffsetParent==null?void 0:i.getOffsetParent(f.floating)),y=await(i.isElement==null?void 0:i.isElement(E))&&await(i.getScale==null?void 0:i.getScale(E))||{x:1,y:1},w=hi(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:f,rect:g,offsetParent:E,strategy:h}):g);return{top:(m.top-w.top+v.top)/y.y,bottom:(w.bottom-m.bottom+v.bottom)/y.y,left:(m.left-w.left+v.left)/y.x,right:(w.right-m.right+v.right)/y.x}}function tu(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function nu(e){return Z1.some(t=>e[t]>=0)}const eE=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:o,y:i,placement:c,middlewareData:f}=t,h=await async function(u,a){const{placement:s,platform:l,elements:d}=u,v=await(l.isRTL==null?void 0:l.isRTL(d.floating)),p=En(s),m=yr(s),g=Ar(s)==="y",E=["left","top"].includes(p)?-1:1,y=v&&g?-1:1,w=An(a,u);let{mainAxis:T,crossAxis:R,alignmentAxis:A}=typeof w=="number"?{mainAxis:w,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...w};return m&&typeof A=="number"&&(R=m==="end"?-1*A:A),g?{x:R*y,y:T*E}:{x:T*E,y:R*y}}(t,e);return c===((n=f.offset)==null?void 0:n.placement)&&(r=f.arrow)!=null&&r.alignmentOffset?{}:{x:o+h.x,y:i+h.y,data:{...h,placement:c}}}}};function Dn(e){return Kf(e)?(e.nodeName||"").toLowerCase():"#document"}function Ct(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function yn(e){var t;return(t=(Kf(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function Kf(e){return e instanceof Node||e instanceof Ct(e).Node}function wn(e){return e instanceof Element||e instanceof Ct(e).Element}function on(e){return e instanceof HTMLElement||e instanceof Ct(e).HTMLElement}function ru(e){return typeof ShadowRoot<"u"&&(e instanceof ShadowRoot||e instanceof Ct(e).ShadowRoot)}function Kr(e){const{overflow:t,overflowX:n,overflowY:r,display:o}=kt(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(o)}function tE(e){return["table","td","th"].includes(Dn(e))}function Wa(e){const t=As(),n=kt(e);return n.transform!=="none"||n.perspective!=="none"||!!n.containerType&&n.containerType!=="normal"||!t&&!!n.backdropFilter&&n.backdropFilter!=="none"||!t&&!!n.filter&&n.filter!=="none"||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function As(){return!(typeof CSS>"u"||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function Li(e){return["html","body","#document"].includes(Dn(e))}function kt(e){return Ct(e).getComputedStyle(e)}function Ui(e){return wn(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function wr(e){if(Dn(e)==="html")return e;const t=e.assignedSlot||e.parentNode||ru(e)&&e.host||yn(e);return ru(t)?t.host:t}function Yf(e){const t=wr(e);return Li(t)?e.ownerDocument?e.ownerDocument.body:e.body:on(t)&&Kr(t)?t:Yf(t)}function Yr(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const o=Yf(e),i=o===((r=e.ownerDocument)==null?void 0:r.body),c=Ct(o);return i?t.concat(c,c.visualViewport||[],Kr(o)?o:[],c.frameElement&&n?Yr(c.frameElement):[]):t.concat(o,Yr(o,[],n))}function Xf(e){const t=kt(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const o=on(e),i=o?e.offsetWidth:n,c=o?e.offsetHeight:r,f=di(n)!==i||di(r)!==c;return f&&(n=i,r=c),{width:n,height:r,$:f}}function Cs(e){return wn(e)?e:e.contextElement}function mr(e){const t=Cs(e);if(!on(t))return Bn(1);const n=t.getBoundingClientRect(),{width:r,height:o,$:i}=Xf(t);let c=(i?di(n.width):n.width)/r,f=(i?di(n.height):n.height)/o;return c&&Number.isFinite(c)||(c=1),f&&Number.isFinite(f)||(f=1),{x:c,y:f}}const nE=Bn(0);function Qf(e){const t=Ct(e);return As()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:nE}function tr(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const o=e.getBoundingClientRect(),i=Cs(e);let c=Bn(1);t&&(r?wn(r)&&(c=mr(r)):c=mr(e));const f=function(l,d,v){return d===void 0&&(d=!1),!(!v||d&&v!==Ct(l))&&d}(i,n,r)?Qf(i):Bn(0);let h=(o.left+f.x)/c.x,u=(o.top+f.y)/c.y,a=o.width/c.x,s=o.height/c.y;if(i){const l=Ct(i),d=r&&wn(r)?Ct(r):r;let v=l,p=v.frameElement;for(;p&&r&&d!==v;){const m=mr(p),g=p.getBoundingClientRect(),E=kt(p),y=g.left+(p.clientLeft+parseFloat(E.paddingLeft))*m.x,w=g.top+(p.clientTop+parseFloat(E.paddingTop))*m.y;h*=m.x,u*=m.y,a*=m.x,s*=m.y,h+=y,u+=w,v=Ct(p),p=v.frameElement}}return hi({width:a,height:s,x:h,y:u})}const rE=[":popover-open",":modal"];function Zf(e){return rE.some(t=>{try{return e.matches(t)}catch{return!1}})}function Jf(e){return tr(yn(e)).left+Ui(e).scrollLeft}function ou(e,t,n){let r;if(t==="viewport")r=function(o,i){const c=Ct(o),f=yn(o),h=c.visualViewport;let u=f.clientWidth,a=f.clientHeight,s=0,l=0;if(h){u=h.width,a=h.height;const d=As();(!d||d&&i==="fixed")&&(s=h.offsetLeft,l=h.offsetTop)}return{width:u,height:a,x:s,y:l}}(e,n);else if(t==="document")r=function(o){const i=yn(o),c=Ui(o),f=o.ownerDocument.body,h=At(i.scrollWidth,i.clientWidth,f.scrollWidth,f.clientWidth),u=At(i.scrollHeight,i.clientHeight,f.scrollHeight,f.clientHeight);let a=-c.scrollLeft+Jf(o);const s=-c.scrollTop;return kt(f).direction==="rtl"&&(a+=At(i.clientWidth,f.clientWidth)-h),{width:h,height:u,x:a,y:s}}(yn(e));else if(wn(t))r=function(o,i){const c=tr(o,!0,i==="fixed"),f=c.top+o.clientTop,h=c.left+o.clientLeft,u=on(o)?mr(o):Bn(1);return{width:o.clientWidth*u.x,height:o.clientHeight*u.y,x:h*u.x,y:f*u.y}}(t,n);else{const o=Qf(e);r={...t,x:t.x-o.x,y:t.y-o.y}}return hi(r)}function jf(e,t){const n=wr(e);return!(n===t||!wn(n)||Li(n))&&(kt(n).position==="fixed"||jf(n,t))}function oE(e,t,n){const r=on(t),o=yn(t),i=n==="fixed",c=tr(e,!0,i,t);let f={scrollLeft:0,scrollTop:0};const h=Bn(0);if(r||!r&&!i)if((Dn(t)!=="body"||Kr(o))&&(f=Ui(t)),r){const u=tr(t,!0,i,t);h.x=u.x+t.clientLeft,h.y=u.y+t.clientTop}else o&&(h.x=Jf(o));return{x:c.left+f.scrollLeft-h.x,y:c.top+f.scrollTop-h.y,width:c.width,height:c.height}}function iu(e,t){return on(e)&&kt(e).position!=="fixed"?t?t(e):e.offsetParent:null}function au(e,t){const n=Ct(e);if(!on(e)||Zf(e))return n;let r=iu(e,t);for(;r&&tE(r)&&kt(r).position==="static";)r=iu(r,t);return r&&(Dn(r)==="html"||Dn(r)==="body"&&kt(r).position==="static"&&!Wa(r))?n:r||function(o){let i=wr(o);for(;on(i)&&!Li(i);){if(Wa(i))return i;i=wr(i)}return null}(e)||n}const iE={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:r,strategy:o}=e;const i=o==="fixed",c=yn(r),f=!!t&&Zf(t.floating);if(r===c||f&&i)return n;let h={scrollLeft:0,scrollTop:0},u=Bn(1);const a=Bn(0),s=on(r);if((s||!s&&!i)&&((Dn(r)!=="body"||Kr(c))&&(h=Ui(r)),on(r))){const l=tr(r);u=mr(r),a.x=l.x+r.clientLeft,a.y=l.y+r.clientTop}return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-h.scrollLeft*u.x+a.x,y:n.y*u.y-h.scrollTop*u.y+a.y}},getDocumentElement:yn,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:r,strategy:o}=e;const i=[...n==="clippingAncestors"?function(h,u){const a=u.get(h);if(a)return a;let s=Yr(h,[],!1).filter(p=>wn(p)&&Dn(p)!=="body"),l=null;const d=kt(h).position==="fixed";let v=d?wr(h):h;for(;wn(v)&&!Li(v);){const p=kt(v),m=Wa(v);m||p.position!=="fixed"||(l=null),(d?!m&&!l:!m&&p.position==="static"&&l&&["absolute","fixed"].includes(l.position)||Kr(v)&&!m&&jf(h,v))?s=s.filter(g=>g!==v):l=p,v=wr(v)}return u.set(h,s),s}(t,this._c):[].concat(n),r],c=i[0],f=i.reduce((h,u)=>{const a=ou(t,u,o);return h.top=At(a.top,h.top),h.right=Fn(a.right,h.right),h.bottom=Fn(a.bottom,h.bottom),h.left=At(a.left,h.left),h},ou(t,c,o));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}},getOffsetParent:au,getElementRects:async function(e){const t=this.getOffsetParent||au,n=this.getDimensions;return{reference:oE(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,...await n(e.floating)}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=Xf(e);return{width:t,height:n}},getScale:mr,isElement:wn,isRTL:function(e){return kt(e).direction==="rtl"}};function aE(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:i=!0,elementResize:c=typeof ResizeObserver=="function",layoutShift:f=typeof IntersectionObserver=="function",animationFrame:h=!1}=r,u=Cs(e),a=o||i?[...u?Yr(u):[],...Yr(t)]:[];a.forEach(m=>{o&&m.addEventListener("scroll",n,{passive:!0}),i&&m.addEventListener("resize",n)});const s=u&&f?function(m,g){let E,y=null;const w=yn(m);function T(){var R;clearTimeout(E),(R=y)==null||R.disconnect(),y=null}return function R(A,C){A===void 0&&(A=!1),C===void 0&&(C=1),T();const{left:x,top:O,width:I,height:P}=m.getBoundingClientRect();if(A||g(),!I||!P)return;const B={rootMargin:-Io(O)+"px "+-Io(w.clientWidth-(x+I))+"px "+-Io(w.clientHeight-(O+P))+"px "+-Io(x)+"px",threshold:At(0,Fn(1,C))||1};let S=!0;function b(_){const F=_[0].intersectionRatio;if(F!==C){if(!S)return R();F?R(!1,F):E=setTimeout(()=>{R(!1,1e-7)},100)}S=!1}try{y=new IntersectionObserver(b,{...B,root:w.ownerDocument})}catch{y=new IntersectionObserver(b,B)}y.observe(m)}(!0),T}(u,n):null;let l,d=-1,v=null;c&&(v=new ResizeObserver(m=>{let[g]=m;g&&g.target===u&&v&&(v.unobserve(t),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var E;(E=v)==null||E.observe(t)})),n()}),u&&!h&&v.observe(u),v.observe(t));let p=h?tr(e):null;return h&&function m(){const g=tr(e);!p||g.x===p.x&&g.y===p.y&&g.width===p.width&&g.height===p.height||n(),p=g,l=requestAnimationFrame(m)}(),n(),()=>{var m;a.forEach(g=>{o&&g.removeEventListener("scroll",n),i&&g.removeEventListener("resize",n)}),s==null||s(),(m=v)==null||m.disconnect(),v=null,h&&cancelAnimationFrame(l)}}const sE=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:o}=t,{mainAxis:i=!0,crossAxis:c=!1,limiter:f={fn:m=>{let{x:g,y:E}=m;return{x:g,y:E}}},...h}=An(e,t),u={x:n,y:r},a=await qr(t,h),s=Ar(En(o)),l=Rs(s);let d=u[l],v=u[s];if(i){const m=l==="y"?"bottom":"right";d=Ha(d+a[l==="y"?"top":"left"],d,d-a[m])}if(c){const m=s==="y"?"bottom":"right";v=Ha(v+a[s==="y"?"top":"left"],v,v-a[m])}const p=f.fn({...t,[l]:d,[s]:v});return{...p,data:{x:p.x-n,y:p.y-r}}}}},cE=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:o,middlewareData:i,rects:c,initialPlacement:f,platform:h,elements:u}=t,{mainAxis:a=!0,crossAxis:s=!0,fallbackPlacements:l,fallbackStrategy:d="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:p=!0,...m}=An(e,t);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const g=En(o),E=En(f)===f,y=await(h.isRTL==null?void 0:h.isRTL(u.floating)),w=l||(E||!p?[_o(f)]:function(P){const B=_o(P);return[da(P),B,da(B)]}(f));l||v==="none"||w.push(...function(P,B,S,b){const _=yr(P);let F=function(V,z,M){const $=["left","right"],H=["right","left"],W=["top","bottom"],Q=["bottom","top"];switch(V){case"top":case"bottom":return M?z?H:$:z?$:H;case"left":case"right":return z?W:Q;default:return[]}}(En(P),S==="start",b);return _&&(F=F.map(V=>V+"-"+_),B&&(F=F.concat(F.map(da)))),F}(f,p,v,y));const T=[f,...w],R=await qr(t,m),A=[];let C=((r=i.flip)==null?void 0:r.overflows)||[];if(a&&A.push(R[g]),s){const P=function(B,S,b){b===void 0&&(b=!1);const _=yr(B),F=Ts(B),V=Ns(F);let z=F==="x"?_===(b?"end":"start")?"right":"left":_==="start"?"bottom":"top";return S.reference[V]>S.floating[V]&&(z=_o(z)),[z,_o(z)]}(o,c,y);A.push(R[P[0]],R[P[1]])}if(C=[...C,{placement:o,overflows:A}],!A.every(P=>P<=0)){var x,O;const P=(((x=i.flip)==null?void 0:x.index)||0)+1,B=T[P];if(B)return{data:{index:P,overflows:C},reset:{placement:B}};let S=(O=C.filter(b=>b.overflows[0]<=0).sort((b,_)=>b.overflows[1]-_.overflows[1])[0])==null?void 0:O.placement;if(!S)switch(d){case"bestFit":{var I;const b=(I=C.map(_=>[_.placement,_.overflows.filter(F=>F>0).reduce((F,V)=>F+V,0)]).sort((_,F)=>_[1]-F[1])[0])==null?void 0:I[0];b&&(S=b);break}case"initialPlacement":S=f}if(o!==S)return{reset:{placement:S}}}return{}}}},uE=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:r,platform:o,elements:i}=t,{apply:c=()=>{},...f}=An(e,t),h=await qr(t,f),u=En(n),a=yr(n),s=Ar(n)==="y",{width:l,height:d}=r.floating;let v,p;u==="top"||u==="bottom"?(v=u,p=a===(await(o.isRTL==null?void 0:o.isRTL(i.floating))?"start":"end")?"left":"right"):(p=u,v=a==="end"?"top":"bottom");const m=d-h[v],g=l-h[p],E=!t.middlewareData.shift;let y=m,w=g;if(s){const R=l-h.left-h.right;w=a||E?Fn(g,R):R}else{const R=d-h.top-h.bottom;y=a||E?Fn(m,R):R}if(E&&!a){const R=At(h.left,0),A=At(h.right,0),C=At(h.top,0),x=At(h.bottom,0);s?w=l-2*(R!==0||A!==0?R+A:At(h.left,h.right)):y=d-2*(C!==0||x!==0?C+x:At(h.top,h.bottom))}await c({...t,availableWidth:w,availableHeight:y});const T=await o.getDimensions(i.floating);return l!==T.width||d!==T.height?{reset:{rects:!0}}:{}}}},lE=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...o}=An(e,t);switch(r){case"referenceHidden":{const i=tu(await qr(t,{...o,elementContext:"reference"}),n.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:nu(i)}}}case"escaped":{const i=tu(await qr(t,{...o,altBoundary:!0}),n.floating);return{data:{escapedOffsets:i,escaped:nu(i)}}}default:return{}}}}},su=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:o,rects:i,platform:c,elements:f,middlewareData:h}=t,{element:u,padding:a=0}=An(e,t)||{};if(u==null)return{};const s=qf(a),l={x:n,y:r},d=Ts(o),v=Ns(d),p=await c.getDimensions(u),m=d==="y",g=m?"top":"left",E=m?"bottom":"right",y=m?"clientHeight":"clientWidth",w=i.reference[v]+i.reference[d]-l[d]-i.floating[v],T=l[d]-i.reference[d],R=await(c.getOffsetParent==null?void 0:c.getOffsetParent(u));let A=R?R[y]:0;A&&await(c.isElement==null?void 0:c.isElement(R))||(A=f.floating[y]||i.floating[v]);const C=w/2-T/2,x=A/2-p[v]/2-1,O=Fn(s[g],x),I=Fn(s[E],x),P=O,B=A-p[v]-I,S=A/2-p[v]/2+C,b=Ha(P,S,B),_=!h.arrow&&yr(o)!=null&&S!==b&&i.reference[v]/2-(S<P?O:I)-p[v]/2<0,F=_?S<P?S-P:S-B:0;return{[d]:l[d]+F,data:{[d]:b,centerOffset:S-b-F,..._&&{alignmentOffset:F}},reset:_}}}),fE=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:o,rects:i,middlewareData:c}=t,{offset:f=0,mainAxis:h=!0,crossAxis:u=!0}=An(e,t),a={x:n,y:r},s=Ar(o),l=Rs(s);let d=a[l],v=a[s];const p=An(f,t),m=typeof p=="number"?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(h){const y=l==="y"?"height":"width",w=i.reference[l]-i.floating[y]+m.mainAxis,T=i.reference[l]+i.reference[y]-m.mainAxis;d<w?d=w:d>T&&(d=T)}if(u){var g,E;const y=l==="y"?"width":"height",w=["top","left"].includes(En(o)),T=i.reference[s]-i.floating[y]+(w&&((g=c.offset)==null?void 0:g[s])||0)+(w?0:m.crossAxis),R=i.reference[s]+i.reference[y]+(w?0:((E=c.offset)==null?void 0:E[s])||0)-(w?m.crossAxis:0);v<T?v=T:v>R&&(v=R)}return{[l]:d,[s]:v}}}},dE=(e,t,n)=>{const r=new Map,o={platform:iE,...n},i={...o.platform,_c:r};return(async(c,f,h)=>{const{placement:u="bottom",strategy:a="absolute",middleware:s=[],platform:l}=h,d=s.filter(Boolean),v=await(l.isRTL==null?void 0:l.isRTL(f));let p=await l.getElementRects({reference:c,floating:f,strategy:a}),{x:m,y:g}=eu(p,u,v),E=u,y={},w=0;for(let T=0;T<d.length;T++){const{name:R,fn:A}=d[T],{x:C,y:x,data:O,reset:I}=await A({x:m,y:g,initialPlacement:u,placement:E,strategy:a,middlewareData:y,rects:p,platform:l,elements:{reference:c,floating:f}});m=C!=null?C:m,g=x!=null?x:g,y={...y,[R]:{...y[R],...O}},I&&w<=50&&(w++,typeof I=="object"&&(I.placement&&(E=I.placement),I.rects&&(p=I.rects===!0?await l.getElementRects({reference:c,floating:f,strategy:a}):I.rects),{x:m,y:g}=eu(p,E,v)),T=-1)}return{x:m,y:g,placement:E,strategy:a,middlewareData:y}})(e,t,{...o,platform:i})},hE=e=>({name:"arrow",options:e,fn(t){const{element:n,padding:r}=typeof e=="function"?e(t):e;return n&&(o=n,{}.hasOwnProperty.call(o,"current"))?n.current!=null?su({element:n.current,padding:r}).fn(t):{}:n?su({element:n,padding:r}).fn(t):{};var o}});var qo=typeof document<"u"?N.exports.useLayoutEffect:N.exports.useEffect;function pi(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,o;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!=0;)if(!pi(e[r],t[r]))return!1;return!0}if(o=Object.keys(e),n=o.length,n!==Object.keys(t).length)return!1;for(r=n;r--!=0;)if(!{}.hasOwnProperty.call(t,o[r]))return!1;for(r=n;r--!=0;){const i=o[r];if((i!=="_owner"||!e.$$typeof)&&!pi(e[i],t[i]))return!1}return!0}return e!=e&&t!=t}function ed(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function cu(e,t){const n=ed(e);return Math.round(t*n)/n}function uu(e){const t=N.exports.useRef(e);return qo(()=>{t.current=e}),t}const pE=N.exports.forwardRef((e,t)=>{const{children:n,width:r=10,height:o=5,...i}=e;return N.exports.createElement(Ft.svg,se({},i,{ref:t,width:r,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),e.asChild?n:N.exports.createElement("polygon",{points:"0,0 30,0 15,10"}))}),td="Popper",[nd,ki]=Tr(td),[vE,rd]=nd(td),mE=N.exports.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...o}=e,i=rd("PopperAnchor",n),c=N.exports.useRef(null),f=wt(t,c);return N.exports.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||c.current)}),r?null:N.exports.createElement(Ft.div,se({},o,{ref:f}))}),od="PopperContent",[gE,EE]=nd(od),yE=N.exports.forwardRef((e,t)=>{var n,r,o,i,c,f,h,u;const{__scopePopper:a,side:s="bottom",sideOffset:l=0,align:d="center",alignOffset:v=0,arrowPadding:p=0,avoidCollisions:m=!0,collisionBoundary:g=[],collisionPadding:E=0,sticky:y="partial",hideWhenDetached:w=!1,updatePositionStrategy:T="optimized",onPlaced:R,...A}=e,C=rd(od,a),[x,O]=N.exports.useState(null),I=wt(t,pe=>O(pe)),[P,B]=N.exports.useState(null),S=function(pe){const[ke,Ee]=N.exports.useState(void 0);return vr(()=>{if(pe){Ee({width:pe.offsetWidth,height:pe.offsetHeight});const De=new ResizeObserver(Ie=>{if(!Array.isArray(Ie)||!Ie.length)return;const ye=Ie[0];let Ge,at;if("borderBoxSize"in ye){const bt=ye.borderBoxSize,xn=Array.isArray(bt)?bt[0]:bt;Ge=xn.inlineSize,at=xn.blockSize}else Ge=pe.offsetWidth,at=pe.offsetHeight;Ee({width:Ge,height:at})});return De.observe(pe,{box:"border-box"}),()=>De.unobserve(pe)}Ee(void 0)},[pe]),ke}(P),b=(n=S==null?void 0:S.width)!==null&&n!==void 0?n:0,_=(r=S==null?void 0:S.height)!==null&&r!==void 0?r:0,F=s+(d!=="center"?"-"+d:""),V=typeof E=="number"?E:{top:0,right:0,bottom:0,left:0,...E},z=Array.isArray(g)?g:[g],M=z.length>0,$={padding:V,boundary:z.filter(TE),altBoundary:M},{refs:H,floatingStyles:W,placement:Q,isPositioned:te,middlewareData:he}=function(pe){pe===void 0&&(pe={});const{placement:ke="bottom",strategy:Ee="absolute",middleware:De=[],platform:Ie,elements:{reference:ye,floating:Ge}={},transform:at=!0,whileElementsMounted:bt,open:xn}=pe,[Xt,zn]=N.exports.useState({x:0,y:0,strategy:Ee,placement:ke,middlewareData:{},isPositioned:!1}),[qn,Cr]=N.exports.useState(De);pi(qn,De)||Cr(De);const[xr,uo]=N.exports.useState(null),[Or,lo]=N.exports.useState(null),Ir=N.exports.useCallback(st=>{st!==Zt.current&&(Zt.current=st,uo(st))},[]),_r=N.exports.useCallback(st=>{st!==cn.current&&(cn.current=st,lo(st))},[]),Qt=ye||xr,Bt=Ge||Or,Zt=N.exports.useRef(null),cn=N.exports.useRef(null),Kn=N.exports.useRef(Xt),Di=bt!=null,X=uu(bt),Me=uu(Ie),Je=N.exports.useCallback(()=>{if(!Zt.current||!cn.current)return;const st={placement:ke,strategy:Ee,middleware:qn};Me.current&&(st.platform=Me.current),dE(Zt.current,cn.current,st).then(ho=>{const ar={...ho,isPositioned:!0};Lt.current&&!pi(Kn.current,ar)&&(Kn.current=ar,gi.exports.flushSync(()=>{zn(ar)}))})},[qn,ke,Ee,Me]);qo(()=>{xn===!1&&Kn.current.isPositioned&&(Kn.current.isPositioned=!1,zn(st=>({...st,isPositioned:!1})))},[xn]);const Lt=N.exports.useRef(!1);qo(()=>(Lt.current=!0,()=>{Lt.current=!1}),[]),qo(()=>{if(Qt&&(Zt.current=Qt),Bt&&(cn.current=Bt),Qt&&Bt){if(X.current)return X.current(Qt,Bt,Je);Je()}},[Qt,Bt,Je,X,Di]);const un=N.exports.useMemo(()=>({reference:Zt,floating:cn,setReference:Ir,setFloating:_r}),[Ir,_r]),Dt=N.exports.useMemo(()=>({reference:Qt,floating:Bt}),[Qt,Bt]),fo=N.exports.useMemo(()=>{const st={position:Ee,left:0,top:0};if(!Dt.floating)return st;const ho=cu(Dt.floating,Xt.x),ar=cu(Dt.floating,Xt.y);return at?{...st,transform:"translate("+ho+"px, "+ar+"px)",...ed(Dt.floating)>=1.5&&{willChange:"transform"}}:{position:Ee,left:ho,top:ar}},[Ee,at,Dt.floating,Xt.x,Xt.y]);return N.exports.useMemo(()=>({...Xt,update:Je,refs:un,elements:Dt,floatingStyles:fo}),[Xt,Je,un,Dt,fo])}({strategy:"fixed",placement:F,whileElementsMounted:(...pe)=>aE(...pe,{animationFrame:T==="always"}),elements:{reference:C.anchor},middleware:[eE({mainAxis:l+_,alignmentAxis:v}),m&&sE({mainAxis:!0,crossAxis:!1,limiter:y==="partial"?fE():void 0,...$}),m&&cE({...$}),uE({...$,apply:({elements:pe,rects:ke,availableWidth:Ee,availableHeight:De})=>{const{width:Ie,height:ye}=ke.reference,Ge=pe.floating.style;Ge.setProperty("--radix-popper-available-width",`${Ee}px`),Ge.setProperty("--radix-popper-available-height",`${De}px`),Ge.setProperty("--radix-popper-anchor-width",`${Ie}px`),Ge.setProperty("--radix-popper-anchor-height",`${ye}px`)}}),P&&hE({element:P,padding:p}),AE({arrowWidth:b,arrowHeight:_}),w&&lE({strategy:"referenceHidden",...$})]}),[ue,Te]=id(Q),fe=tn(R);vr(()=>{te&&(fe==null||fe())},[te,fe]);const Oe=(o=he.arrow)===null||o===void 0?void 0:o.x,Be=(i=he.arrow)===null||i===void 0?void 0:i.y,ze=((c=he.arrow)===null||c===void 0?void 0:c.centerOffset)!==0,[Ze,nt]=N.exports.useState();return vr(()=>{x&&nt(window.getComputedStyle(x).zIndex)},[x]),N.exports.createElement("div",{ref:H.setFloating,"data-radix-popper-content-wrapper":"",style:{...W,transform:te?W.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Ze,"--radix-popper-transform-origin":[(f=he.transformOrigin)===null||f===void 0?void 0:f.x,(h=he.transformOrigin)===null||h===void 0?void 0:h.y].join(" ")},dir:e.dir},N.exports.createElement(gE,{scope:a,placedSide:ue,onArrowChange:B,arrowX:Oe,arrowY:Be,shouldHideArrow:ze},N.exports.createElement(Ft.div,se({"data-side":ue,"data-align":Te},A,{ref:I,style:{...A.style,animation:te?void 0:"none",opacity:(u=he.hide)!==null&&u!==void 0&&u.referenceHidden?0:void 0}}))))}),wE="PopperArrow",RE={top:"bottom",right:"left",bottom:"top",left:"right"},NE=N.exports.forwardRef(function(e,t){const{__scopePopper:n,...r}=e,o=EE(wE,n),i=RE[o.placedSide];return N.exports.createElement("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0}},N.exports.createElement(pE,se({},r,{ref:t,style:{...r.style,display:"block"}})))});function TE(e){return e!==null}const AE=e=>({name:"transformOrigin",options:e,fn(t){var n,r,o,i,c;const{placement:f,rects:h,middlewareData:u}=t,a=((n=u.arrow)===null||n===void 0?void 0:n.centerOffset)!==0,s=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[d,v]=id(f),p={start:"0%",center:"50%",end:"100%"}[v],m=((r=(o=u.arrow)===null||o===void 0?void 0:o.x)!==null&&r!==void 0?r:0)+s/2,g=((i=(c=u.arrow)===null||c===void 0?void 0:c.y)!==null&&i!==void 0?i:0)+l/2;let E="",y="";return d==="bottom"?(E=a?p:`${m}px`,y=-l+"px"):d==="top"?(E=a?p:`${m}px`,y=`${h.floating.height+l}px`):d==="right"?(E=-l+"px",y=a?p:`${g}px`):d==="left"&&(E=`${h.floating.width+l}px`,y=a?p:`${g}px`),{data:{x:E,y}}}});function id(e){const[t,n="center"]=e.split("-");return[t,n]}const ad=e=>{const{__scopePopper:t,children:n}=e,[r,o]=N.exports.useState(null);return N.exports.createElement(vE,{scope:t,anchor:r,onAnchorChange:o},n)},sd=mE,cd=yE,CE=NE,ud=N.exports.forwardRef((e,t)=>{var n;const{container:r=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...o}=e;return r?zd.createPortal(N.exports.createElement(Ft.div,se({},o,{ref:t})),r):null}),oo=e=>{const{present:t,children:n}=e,r=function(c){const[f,h]=N.exports.useState(),u=N.exports.useRef({}),a=N.exports.useRef(c),s=N.exports.useRef("none"),l=c?"mounted":"unmounted",[d,v]=function(p,m){return N.exports.useReducer((g,E)=>{const y=m[g][E];return y!=null?y:g},p)}(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return N.exports.useEffect(()=>{const p=Mo(u.current);s.current=d==="mounted"?p:"none"},[d]),vr(()=>{const p=u.current,m=a.current;if(m!==c){const g=s.current,E=Mo(p);c?v("MOUNT"):E==="none"||(p==null?void 0:p.display)==="none"?v("UNMOUNT"):v(m&&g!==E?"ANIMATION_OUT":"UNMOUNT"),a.current=c}},[c,v]),vr(()=>{if(f){const p=g=>{const E=Mo(u.current).includes(g.animationName);g.target===f&&E&&gi.exports.flushSync(()=>v("ANIMATION_END"))},m=g=>{g.target===f&&(s.current=Mo(u.current))};return f.addEventListener("animationstart",m),f.addEventListener("animationcancel",p),f.addEventListener("animationend",p),()=>{f.removeEventListener("animationstart",m),f.removeEventListener("animationcancel",p),f.removeEventListener("animationend",p)}}v("ANIMATION_END")},[f,v]),{isPresent:["mounted","unmountSuspended"].includes(d),ref:N.exports.useCallback(p=>{p&&(u.current=getComputedStyle(p)),h(p)},[])}}(t),o=typeof n=="function"?n({present:r.isPresent}):N.exports.Children.only(n),i=wt(r.ref,o.ref);return typeof n=="function"||r.isPresent?N.exports.cloneElement(o,{ref:i}):null};function Mo(e){return(e==null?void 0:e.animationName)||"none"}oo.displayName="Presence";const ha="rovingFocusGroup.onEntryFocus",xE={bubbles:!1,cancelable:!0},xs="RovingFocusGroup",[za,ld,OE]=Hf(xs),[IE,fd]=Tr(xs,[OE]),[_E,ME]=IE(xs),bE=N.exports.forwardRef((e,t)=>N.exports.createElement(za.Provider,{scope:e.__scopeRovingFocusGroup},N.exports.createElement(za.Slot,{scope:e.__scopeRovingFocusGroup},N.exports.createElement(LE,se({},e,{ref:t}))))),LE=N.exports.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:o=!1,dir:i,currentTabStopId:c,defaultCurrentTabStopId:f,onCurrentTabStopIdChange:h,onEntryFocus:u,...a}=e,s=N.exports.useRef(null),l=wt(t,s),d=Wf(i),[v=null,p]=ws({prop:c,defaultProp:f,onChange:h}),[m,g]=N.exports.useState(!1),E=tn(u),y=ld(n),w=N.exports.useRef(!1),[T,R]=N.exports.useState(0);return N.exports.useEffect(()=>{const A=s.current;if(A)return A.addEventListener(ha,E),()=>A.removeEventListener(ha,E)},[E]),N.exports.createElement(_E,{scope:n,orientation:r,dir:d,loop:o,currentTabStopId:v,onItemFocus:N.exports.useCallback(A=>p(A),[p]),onItemShiftTab:N.exports.useCallback(()=>g(!0),[]),onFocusableItemAdd:N.exports.useCallback(()=>R(A=>A+1),[]),onFocusableItemRemove:N.exports.useCallback(()=>R(A=>A-1),[])},N.exports.createElement(Ft.div,se({tabIndex:m||T===0?-1:0,"data-orientation":r},a,{ref:l,style:{outline:"none",...e.style},onMouseDown:de(e.onMouseDown,()=>{w.current=!0}),onFocus:de(e.onFocus,A=>{const C=!w.current;if(A.target===A.currentTarget&&C&&!m){const x=new CustomEvent(ha,xE);if(A.currentTarget.dispatchEvent(x),!x.defaultPrevented){const O=y().filter(I=>I.focusable);dd([O.find(I=>I.active),O.find(I=>I.id===v),...O].filter(Boolean).map(I=>I.ref.current))}}w.current=!1}),onBlur:de(e.onBlur,()=>g(!1))})))}),UE=N.exports.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:o=!1,tabStopId:i,...c}=e,f=fi(),h=i||f,u=ME("RovingFocusGroupItem",n),a=u.currentTabStopId===h,s=ld(n),{onFocusableItemAdd:l,onFocusableItemRemove:d}=u;return N.exports.useEffect(()=>{if(r)return l(),()=>d()},[r,l,d]),N.exports.createElement(za.ItemSlot,{scope:n,id:h,focusable:r,active:o},N.exports.createElement(Ft.span,se({tabIndex:a?0:-1,"data-orientation":u.orientation},c,{ref:t,onMouseDown:de(e.onMouseDown,v=>{r?u.onItemFocus(h):v.preventDefault()}),onFocus:de(e.onFocus,()=>u.onItemFocus(h)),onKeyDown:de(e.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey)return void u.onItemShiftTab();if(v.target!==v.currentTarget)return;const p=function(E,y,w){const T=function(R,A){return A!=="rtl"?R:R==="ArrowLeft"?"ArrowRight":R==="ArrowRight"?"ArrowLeft":R}(E.key,w);return y==="vertical"&&["ArrowLeft","ArrowRight"].includes(T)||y==="horizontal"&&["ArrowUp","ArrowDown"].includes(T)?void 0:kE[T]}(v,u.orientation,u.dir);if(p!==void 0){v.preventDefault();let E=s().filter(y=>y.focusable).map(y=>y.ref.current);if(p==="last")E.reverse();else if(p==="prev"||p==="next"){p==="prev"&&E.reverse();const y=E.indexOf(v.currentTarget);E=u.loop?(g=y+1,(m=E).map((w,T)=>m[(g+T)%m.length])):E.slice(y+1)}setTimeout(()=>dd(E))}var m,g})})))}),kE={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function dd(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}const PE=bE,SE=UE;var lr=new WeakMap,bo=new WeakMap,Lo={},lu=0,hd=function(e){return e&&(e.host||hd(e.parentNode))},FE=function(e,t,n,r){var o=function(s,l){return l.map(function(d){if(s.contains(d))return d;var v=hd(d);return v&&s.contains(v)?v:(console.error("aria-hidden",d,"in not contained inside",s,". Doing nothing"),null)}).filter(function(d){return Boolean(d)})}(t,Array.isArray(e)?e:[e]);Lo[n]||(Lo[n]=new WeakMap);var i=Lo[n],c=[],f=new Set,h=new Set(o),u=function(s){s&&!f.has(s)&&(f.add(s),u(s.parentNode))};o.forEach(u);var a=function(s){s&&!h.has(s)&&Array.prototype.forEach.call(s.children,function(l){if(f.has(l))a(l);else{var d=l.getAttribute(r),v=d!==null&&d!=="false",p=(lr.get(l)||0)+1,m=(i.get(l)||0)+1;lr.set(l,p),i.set(l,m),c.push(l),p===1&&v&&bo.set(l,!0),m===1&&l.setAttribute(n,"true"),v||l.setAttribute(r,"true")}})};return a(t),f.clear(),lu++,function(){c.forEach(function(s){var l=lr.get(s)-1,d=i.get(s)-1;lr.set(s,l),i.set(s,d),l||(bo.has(s)||s.removeAttribute(r),bo.delete(s)),d||s.removeAttribute(n)}),--lu||(lr=new WeakMap,lr=new WeakMap,bo=new WeakMap,Lo={})}},BE=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),o=function(i){return typeof document>"u"?null:(Array.isArray(i)?i[0]:i).ownerDocument.body}(e);return o?(r.push.apply(r,Array.from(o.querySelectorAll("[aria-live]"))),FE(r,o,n,"aria-hidden")):function(){return null}},jt=function(){return jt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},jt.apply(this,arguments)};function pd(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}var Ko="right-scroll-bar-position",Yo="width-before-scroll-bar";function pa(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}var fu=new WeakMap;function DE(e,t){var n,r,o,i=(n=null,r=function(c){return e.forEach(function(f){return pa(f,c)})},(o=N.exports.useState(function(){return{value:n,callback:r,facade:{get current(){return o.value},set current(c){var f=o.value;f!==c&&(o.value=c,o.callback(c,f))}}}})[0]).callback=r,o.facade);return N.exports.useLayoutEffect(function(){var c=fu.get(i);if(c){var f=new Set(c),h=new Set(e),u=i.current;f.forEach(function(a){h.has(a)||pa(a,null)}),h.forEach(function(a){f.has(a)||pa(a,u)})}fu.set(i,e)},[e]),i}function $E(e){return e}var vd=function(e){var t=e.sideCar,n=pd(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return N.exports.createElement(r,jt({},n))};vd.isSideCarExport=!0;var md=function(e){e===void 0&&(e={});var t=function(n,r){r===void 0&&(r=$E);var o=[],i=!1;return{read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return o.length?o[o.length-1]:n},useMedium:function(c){var f=r(c,i);return o.push(f),function(){o=o.filter(function(h){return h!==f})}},assignSyncMedium:function(c){for(i=!0;o.length;){var f=o;o=[],f.forEach(c)}o={push:function(h){return c(h)},filter:function(){return o}}},assignMedium:function(c){i=!0;var f=[];if(o.length){var h=o;o=[],h.forEach(c),f=o}var u=function(){var s=f;f=[],s.forEach(c)},a=function(){return Promise.resolve().then(u)};a(),o={push:function(s){f.push(s),a()},filter:function(s){return f=f.filter(s),o}}}}}(null);return t.options=jt({async:!0,ssr:!1},e),t}(),va=function(){},vi=N.exports.forwardRef(function(e,t){var n=N.exports.useRef(null),r=N.exports.useState({onScrollCapture:va,onWheelCapture:va,onTouchMoveCapture:va}),o=r[0],i=r[1],c=e.forwardProps,f=e.children,h=e.className,u=e.removeScrollBar,a=e.enabled,s=e.shards,l=e.sideCar,d=e.noIsolation,v=e.inert,p=e.allowPinchZoom,m=e.as,g=m===void 0?"div":m,E=pd(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),y=l,w=DE([n,t]),T=jt(jt({},E),o);return N.exports.createElement(N.exports.Fragment,null,a&&N.exports.createElement(y,{sideCar:md,removeScrollBar:u,shards:s,noIsolation:d,inert:v,setCallbacks:i,allowPinchZoom:!!p,lockRef:n}),c?N.exports.cloneElement(N.exports.Children.only(f),jt(jt({},T),{ref:w})):N.exports.createElement(g,jt({},T,{className:h,ref:w}),f))});vi.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},vi.classNames={fullWidth:Yo,zeroRight:Ko};function VE(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__}();return t&&e.setAttribute("nonce",t),e}var GE=function(){var e=0,t=null;return{add:function(n){var r,o;e==0&&(t=VE())&&(o=n,(r=t).styleSheet?r.styleSheet.cssText=o:r.appendChild(document.createTextNode(o)),function(i){(document.head||document.getElementsByTagName("head")[0]).appendChild(i)}(t)),e++},remove:function(){!--e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},gd=function(){var e,t=(e=GE(),function(n,r){N.exports.useEffect(function(){return e.add(n),function(){e.remove()}},[n&&r])});return function(n){var r=n.styles,o=n.dynamic;return t(r,o),null}},HE={left:0,top:0,right:0,gap:0},ma=function(e){return parseInt(e||"",10)||0},WE=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return HE;var t=function(o){var i=window.getComputedStyle(document.body),c=i[o==="padding"?"paddingLeft":"marginLeft"],f=i[o==="padding"?"paddingTop":"marginTop"],h=i[o==="padding"?"paddingRight":"marginRight"];return[ma(c),ma(f),ma(h)]}(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},zE=gd(),gr="data-scroll-locked",qE=function(e,t,n,r){var o=e.left,i=e.top,c=e.right,f=e.gap;return n===void 0&&(n="margin"),`
  .`.concat("with-scroll-bars-hidden",` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(f,"px ").concat(r,`;
  }
  body[`).concat(gr,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(c,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(f,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(f,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Ko,` {
    right: `).concat(f,"px ").concat(r,`;
  }
  
  .`).concat(Yo,` {
    margin-right: `).concat(f,"px ").concat(r,`;
  }
  
  .`).concat(Ko," .").concat(Ko,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Yo," .").concat(Yo,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(gr,`] {
    `).concat("--removed-body-scroll-bar-size",": ").concat(f,`px;
  }
`)},du=function(){var e=parseInt(document.body.getAttribute(gr)||"0",10);return isFinite(e)?e:0},KE=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,o=r===void 0?"margin":r;N.exports.useEffect(function(){return document.body.setAttribute(gr,(du()+1).toString()),function(){var c=du()-1;c<=0?document.body.removeAttribute(gr):document.body.setAttribute(gr,c.toString())}},[]);var i=N.exports.useMemo(function(){return WE(o)},[o]);return N.exports.createElement(zE,{styles:qE(i,!t,o,n?"":"!important")})},qa=!1;if(typeof window<"u")try{var Uo=Object.defineProperty({},"passive",{get:function(){return qa=!0,!0}});window.addEventListener("test",Uo,Uo),window.removeEventListener("test",Uo,Uo)}catch{qa=!1}var fr=!!qa&&{passive:!1},hu=function(e,t){var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!function(r){return r.tagName==="TEXTAREA"}(e)&&n[t]==="visible")},pu=function(e,t){var n=t;do{if(typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host),Ed(e,n)){var r=yd(e,n);if(r[1]>r[2])return!0}n=n.parentNode}while(n&&n!==document.body);return!1},Ed=function(e,t){return e==="v"?function(n){return hu(n,"overflowY")}(t):function(n){return hu(n,"overflowX")}(t)},yd=function(e,t){return e==="v"?[(n=t).scrollTop,n.scrollHeight,n.clientHeight]:function(r){return[r.scrollLeft,r.scrollWidth,r.clientWidth]}(t);var n},ko=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},vu=function(e){return[e.deltaX,e.deltaY]},mu=function(e){return e&&"current"in e?e.current:e},YE=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},XE=0,dr=[],gu,QE=(gu=function(e){var t=N.exports.useRef([]),n=N.exports.useRef([0,0]),r=N.exports.useRef(),o=N.exports.useState(XE++)[0],i=N.exports.useState(function(){return gd()})[0],c=N.exports.useRef(e);N.exports.useEffect(function(){c.current=e},[e]),N.exports.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(o));var p=function(m,g,E){if(E||arguments.length===2)for(var y,w=0,T=g.length;w<T;w++)!y&&w in g||(y||(y=Array.prototype.slice.call(g,0,w)),y[w]=g[w]);return m.concat(y||Array.prototype.slice.call(g))}([e.lockRef.current],(e.shards||[]).map(mu),!0).filter(Boolean);return p.forEach(function(m){return m.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),p.forEach(function(m){return m.classList.remove("allow-interactivity-".concat(o))})}}},[e.inert,e.lockRef.current,e.shards]);var f=N.exports.useCallback(function(p,m){if("touches"in p&&p.touches.length===2)return!c.current.allowPinchZoom;var g,E=ko(p),y=n.current,w="deltaX"in p?p.deltaX:y[0]-E[0],T="deltaY"in p?p.deltaY:y[1]-E[1],R=p.target,A=Math.abs(w)>Math.abs(T)?"h":"v";if("touches"in p&&A==="h"&&R.type==="range")return!1;var C=pu(A,R);if(!C)return!0;if(C?g=A:(g=A==="v"?"h":"v",C=pu(A,R)),!C)return!1;if(!r.current&&"changedTouches"in p&&(w||T)&&(r.current=g),!g)return!0;var x=r.current||g;return function(O,I,P,B,S){var b=function(he,ue){return he==="h"&&ue==="rtl"?-1:1}(O,window.getComputedStyle(I).direction),_=b*B,F=P.target,V=I.contains(F),z=!1,M=_>0,$=0,H=0;do{var W=yd(O,F),Q=W[0],te=W[1]-W[2]-b*Q;(Q||te)&&Ed(O,F)&&($+=te,H+=Q),F=F.parentNode}while(!V&&F!==document.body||V&&(I.contains(F)||I===F));return(!M||$!==0&&S)&&(M||H!==0&&S)||(z=!0),z}(x,m,p,x==="h"?w:T,!0)},[]),h=N.exports.useCallback(function(p){var m=p;if(dr.length&&dr[dr.length-1]===i){var g="deltaY"in m?vu(m):ko(m),E=t.current.filter(function(w){return w.name===m.type&&w.target===m.target&&(T=w.delta,R=g,T[0]===R[0]&&T[1]===R[1]);var T,R})[0];if(E&&E.should)m.cancelable&&m.preventDefault();else if(!E){var y=(c.current.shards||[]).map(mu).filter(Boolean).filter(function(w){return w.contains(m.target)});(y.length>0?f(m,y[0]):!c.current.noIsolation)&&m.cancelable&&m.preventDefault()}}},[]),u=N.exports.useCallback(function(p,m,g,E){var y={name:p,delta:m,target:g,should:E};t.current.push(y),setTimeout(function(){t.current=t.current.filter(function(w){return w!==y})},1)},[]),a=N.exports.useCallback(function(p){n.current=ko(p),r.current=void 0},[]),s=N.exports.useCallback(function(p){u(p.type,vu(p),p.target,f(p,e.lockRef.current))},[]),l=N.exports.useCallback(function(p){u(p.type,ko(p),p.target,f(p,e.lockRef.current))},[]);N.exports.useEffect(function(){return dr.push(i),e.setCallbacks({onScrollCapture:s,onWheelCapture:s,onTouchMoveCapture:l}),document.addEventListener("wheel",h,fr),document.addEventListener("touchmove",h,fr),document.addEventListener("touchstart",a,fr),function(){dr=dr.filter(function(p){return p!==i}),document.removeEventListener("wheel",h,fr),document.removeEventListener("touchmove",h,fr),document.removeEventListener("touchstart",a,fr)}},[]);var d=e.removeScrollBar,v=e.inert;return N.exports.createElement(N.exports.Fragment,null,v?N.exports.createElement(i,{styles:YE(o)}):null,d?N.exports.createElement(KE,{gapMode:"margin"}):null)},md.useMedium(gu),vd),wd=N.exports.forwardRef(function(e,t){return N.exports.createElement(vi,jt({},e,{ref:t,sideCar:QE}))});wd.classNames=vi.classNames;const ZE=["Enter"," "],Rd=["ArrowUp","PageDown","End"],JE=["ArrowDown","PageUp","Home",...Rd],Pi="Menu",[Ka,jE,ey]=Hf(Pi),[ir,Nd]=Tr(Pi,[ey,ki,fd]),Os=ki(),Td=fd(),[ty,io]=ir(Pi),[ny,Is]=ir(Pi),ry=N.exports.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,o=Os(n);return N.exports.createElement(sd,se({},o,r,{ref:t}))}),Ad="MenuPortal",[oy,iy]=ir(Ad,{forceMount:void 0}),Ln="MenuContent",[ay,Cd]=ir(Ln),sy=N.exports.forwardRef((e,t)=>{const n=iy(Ln,e.__scopeMenu),{forceMount:r=n.forceMount,...o}=e,i=io(Ln,e.__scopeMenu),c=Is(Ln,e.__scopeMenu);return N.exports.createElement(Ka.Provider,{scope:e.__scopeMenu},N.exports.createElement(oo,{present:r||i.open},N.exports.createElement(Ka.Slot,{scope:e.__scopeMenu},c.modal?N.exports.createElement(cy,se({},o,{ref:t})):N.exports.createElement(uy,se({},o,{ref:t})))))}),cy=N.exports.forwardRef((e,t)=>{const n=io(Ln,e.__scopeMenu),r=N.exports.useRef(null),o=wt(t,r);return N.exports.useEffect(()=>{const i=r.current;if(i)return BE(i)},[]),N.exports.createElement(xd,se({},e,{ref:o,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:de(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)}))}),uy=N.exports.forwardRef((e,t)=>{const n=io(Ln,e.__scopeMenu);return N.exports.createElement(xd,se({},e,{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)}))}),xd=N.exports.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:o,onOpenAutoFocus:i,onCloseAutoFocus:c,disableOutsidePointerEvents:f,onEntryFocus:h,onEscapeKeyDown:u,onPointerDownOutside:a,onFocusOutside:s,onInteractOutside:l,onDismiss:d,disableOutsideScroll:v,...p}=e,m=io(Ln,n),g=Is(Ln,n),E=Os(n),y=Td(n),w=jE(n),[T,R]=N.exports.useState(null),A=N.exports.useRef(null),C=wt(t,A,m.onContentChange),x=N.exports.useRef(0),O=N.exports.useRef(""),I=N.exports.useRef(0),P=N.exports.useRef(null),B=N.exports.useRef("right"),S=N.exports.useRef(0),b=v?wd:N.exports.Fragment,_=v?{as:zr,allowPinchZoom:!0}:void 0,F=M=>{var $,H;const W=O.current+M,Q=w().filter(fe=>!fe.disabled),te=document.activeElement,he=($=Q.find(fe=>fe.ref.current===te))===null||$===void 0?void 0:$.textValue,ue=function(fe,Oe,Be){const ze=Oe.length>1&&Array.from(Oe).every(Ie=>Ie===Oe[0]),Ze=ze?Oe[0]:Oe,nt=Be?fe.indexOf(Be):-1;let pe=(ke=fe,Ee=Math.max(nt,0),ke.map((Ie,ye)=>ke[(Ee+ye)%ke.length]));var ke,Ee;Ze.length===1&&(pe=pe.filter(Ie=>Ie!==Be));const De=pe.find(Ie=>Ie.toLowerCase().startsWith(Ze.toLowerCase()));return De!==Be?De:void 0}(Q.map(fe=>fe.textValue),W,he),Te=(H=Q.find(fe=>fe.textValue===ue))===null||H===void 0?void 0:H.ref.current;(function fe(Oe){O.current=Oe,window.clearTimeout(x.current),Oe!==""&&(x.current=window.setTimeout(()=>fe(""),1e3))})(W),Te&&setTimeout(()=>Te.focus())};N.exports.useEffect(()=>()=>window.clearTimeout(x.current),[]),N.exports.useEffect(()=>{var M,$;const H=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(M=H[0])!==null&&M!==void 0?M:Yc()),document.body.insertAdjacentElement("beforeend",($=H[1])!==null&&$!==void 0?$:Yc()),ua++,()=>{ua===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(W=>W.remove()),ua--}},[]);const V=N.exports.useCallback(M=>{var $,H;return B.current===(($=P.current)===null||$===void 0?void 0:$.side)&&function(W,Q){if(!Q)return!1;const te={x:W.clientX,y:W.clientY};return function(he,ue){const{x:Te,y:fe}=he;let Oe=!1;for(let Be=0,ze=ue.length-1;Be<ue.length;ze=Be++){const Ze=ue[Be].x,nt=ue[Be].y,pe=ue[ze].x,ke=ue[ze].y;nt>fe!=ke>fe&&Te<(pe-Ze)*(fe-nt)/(ke-nt)+Ze&&(Oe=!Oe)}return Oe}(te,Q)}(M,(H=P.current)===null||H===void 0?void 0:H.area)},[]);return N.exports.createElement(ay,{scope:n,searchRef:O,onItemEnter:N.exports.useCallback(M=>{V(M)&&M.preventDefault()},[V]),onItemLeave:N.exports.useCallback(M=>{var $;V(M)||(($=A.current)===null||$===void 0||$.focus(),R(null))},[V]),onTriggerLeave:N.exports.useCallback(M=>{V(M)&&M.preventDefault()},[V]),pointerGraceTimerRef:I,onPointerGraceIntentChange:N.exports.useCallback(M=>{P.current=M},[])},N.exports.createElement(b,_,N.exports.createElement(K1,{asChild:!0,trapped:o,onMountAutoFocus:de(i,M=>{var $;M.preventDefault(),($=A.current)===null||$===void 0||$.focus()}),onUnmountAutoFocus:c},N.exports.createElement(zf,{asChild:!0,disableOutsidePointerEvents:f,onEscapeKeyDown:u,onPointerDownOutside:a,onFocusOutside:s,onInteractOutside:l,onDismiss:d},N.exports.createElement(PE,se({asChild:!0},y,{dir:g.dir,orientation:"vertical",loop:r,currentTabStopId:T,onCurrentTabStopIdChange:R,onEntryFocus:de(h,M=>{g.isUsingKeyboardRef.current||M.preventDefault()})}),N.exports.createElement(cd,se({role:"menu","aria-orientation":"vertical","data-state":(z=m.open,z?"open":"closed"),"data-radix-menu-content":"",dir:g.dir},E,p,{ref:C,style:{outline:"none",...p.style},onKeyDown:de(p.onKeyDown,M=>{const $=M.target.closest("[data-radix-menu-content]")===M.currentTarget,H=M.ctrlKey||M.altKey||M.metaKey,W=M.key.length===1;$&&(M.key==="Tab"&&M.preventDefault(),!H&&W&&F(M.key));const Q=A.current;if(M.target!==Q||!JE.includes(M.key))return;M.preventDefault();const te=w().filter(he=>!he.disabled).map(he=>he.ref.current);Rd.includes(M.key)&&te.reverse(),function(he){const ue=document.activeElement;for(const Te of he)if(Te===ue||(Te.focus(),document.activeElement!==ue))return}(te)}),onBlur:de(e.onBlur,M=>{M.currentTarget.contains(M.target)||(window.clearTimeout(x.current),O.current="")}),onPointerMove:de(e.onPointerMove,Xa(M=>{const $=M.target,H=S.current!==M.clientX;if(M.currentTarget.contains($)&&H){const W=M.clientX>S.current?"right":"left";B.current=W,S.current=M.clientX}}))})))))));var z}),Ya="MenuItem",Eu="menu.itemSelect",ly=N.exports.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...o}=e,i=N.exports.useRef(null),c=Is(Ya,e.__scopeMenu),f=Cd(Ya,e.__scopeMenu),h=wt(t,i),u=N.exports.useRef(!1);return N.exports.createElement(fy,se({},o,{ref:h,disabled:n,onClick:de(e.onClick,()=>{const a=i.current;if(!n&&a){const s=new CustomEvent(Eu,{bubbles:!0,cancelable:!0});a.addEventListener(Eu,l=>r==null?void 0:r(l),{once:!0}),Gf(a,s),s.defaultPrevented?u.current=!1:c.onClose()}}),onPointerDown:a=>{var s;(s=e.onPointerDown)===null||s===void 0||s.call(e,a),u.current=!0},onPointerUp:de(e.onPointerUp,a=>{var s;u.current||(s=a.currentTarget)===null||s===void 0||s.click()}),onKeyDown:de(e.onKeyDown,a=>{const s=f.searchRef.current!=="";n||s&&a.key===" "||ZE.includes(a.key)&&(a.currentTarget.click(),a.preventDefault())})}))}),fy=N.exports.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:o,...i}=e,c=Cd(Ya,n),f=Td(n),h=N.exports.useRef(null),u=wt(t,h),[a,s]=N.exports.useState(!1),[l,d]=N.exports.useState("");return N.exports.useEffect(()=>{const v=h.current;var p;v&&d(((p=v.textContent)!==null&&p!==void 0?p:"").trim())},[i.children]),N.exports.createElement(Ka.ItemSlot,{scope:n,disabled:r,textValue:o!=null?o:l},N.exports.createElement(SE,se({asChild:!0},f,{focusable:!r}),N.exports.createElement(Ft.div,se({role:"menuitem","data-highlighted":a?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0},i,{ref:u,onPointerMove:de(e.onPointerMove,Xa(v=>{r?c.onItemLeave(v):(c.onItemEnter(v),!v.defaultPrevented&&v.currentTarget.focus())})),onPointerLeave:de(e.onPointerLeave,Xa(v=>c.onItemLeave(v))),onFocus:de(e.onFocus,()=>s(!0)),onBlur:de(e.onBlur,()=>s(!1))}))))});ir("MenuRadioGroup",{value:void 0,onValueChange:()=>{}});ir("MenuItemIndicator",{checked:!1});function Xa(e){return t=>t.pointerType==="mouse"?e(t):void 0}ir("MenuSub");const dy=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:o,onOpenChange:i,modal:c=!0}=e,f=Os(t),[h,u]=N.exports.useState(null),a=N.exports.useRef(!1),s=tn(i),l=Wf(o);return N.exports.useEffect(()=>{const d=()=>{a.current=!0,document.addEventListener("pointerdown",v,{capture:!0,once:!0}),document.addEventListener("pointermove",v,{capture:!0,once:!0})},v=()=>a.current=!1;return document.addEventListener("keydown",d,{capture:!0}),()=>{document.removeEventListener("keydown",d,{capture:!0}),document.removeEventListener("pointerdown",v,{capture:!0}),document.removeEventListener("pointermove",v,{capture:!0})}},[]),N.exports.createElement(ad,f,N.exports.createElement(ty,{scope:t,open:n,onOpenChange:s,content:h,onContentChange:u},N.exports.createElement(ny,{scope:t,onClose:N.exports.useCallback(()=>s(!1),[s]),isUsingKeyboardRef:a,dir:l,modal:c},r)))},hy=ry,py=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:o}=e,i=io(Ad,t);return N.exports.createElement(oy,{scope:t,forceMount:n},N.exports.createElement(oo,{present:n||i.open},N.exports.createElement(ud,{asChild:!0,container:o},r)))},vy=sy,my=ly,Od="DropdownMenu",[gy,FN]=Tr(Od,[Nd]),ao=Nd(),[Ey,Id]=gy(Od),yy=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:o,defaultOpen:i,onOpenChange:c,modal:f=!0}=e,h=ao(t),u=N.exports.useRef(null),[a=!1,s]=ws({prop:o,defaultProp:i,onChange:c});return N.exports.createElement(Ey,{scope:t,triggerId:fi(),triggerRef:u,contentId:fi(),open:a,onOpenChange:s,onOpenToggle:N.exports.useCallback(()=>s(l=>!l),[s]),modal:f},N.exports.createElement(dy,se({},h,{open:a,onOpenChange:s,dir:r,modal:f}),n))},wy=N.exports.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...o}=e,i=Id("DropdownMenuTrigger",n),c=ao(n);return N.exports.createElement(hy,se({asChild:!0},c),N.exports.createElement(Ft.button,se({type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r},o,{ref:ys(t,i.triggerRef),onPointerDown:de(e.onPointerDown,f=>{r||f.button!==0||f.ctrlKey!==!1||(i.onOpenToggle(),i.open||f.preventDefault())}),onKeyDown:de(e.onKeyDown,f=>{r||(["Enter"," "].includes(f.key)&&i.onOpenToggle(),f.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(f.key)&&f.preventDefault())})})))}),Ry=e=>{const{__scopeDropdownMenu:t,...n}=e,r=ao(t);return N.exports.createElement(py,se({},r,n))},Ny=N.exports.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Id("DropdownMenuContent",n),i=ao(n),c=N.exports.useRef(!1);return N.exports.createElement(vy,se({id:o.contentId,"aria-labelledby":o.triggerId},i,r,{ref:t,onCloseAutoFocus:de(e.onCloseAutoFocus,f=>{var h;c.current||(h=o.triggerRef.current)===null||h===void 0||h.focus(),c.current=!1,f.preventDefault()}),onInteractOutside:de(e.onInteractOutside,f=>{const h=f.detail.originalEvent,u=h.button===0&&h.ctrlKey===!0,a=h.button===2||u;o.modal&&!a||(c.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),Ty=N.exports.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=ao(n);return N.exports.createElement(my,se({},o,r,{ref:t}))});function le(e){return typeof e=="string"&&e.length>0}var Ay={panel:"Dropdown-module_panel__6PJ1F"};Qe(`.Dropdown-module_panel__6PJ1F {
  background-color: var(--white);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
  border-radius: var(--border-radius-medium);
}
`);const Cy=N.exports.forwardRef((e,t)=>{const{size:n="medium",trigger:r,open:o,onOpenChange:i,children:c,className:f,...h}=e,u=[Ay.panel,`p-${n}`,f].filter(le);return Se(yy,{open:o,onOpenChange:i,children:[k(wy,{asChild:!0,children:r}),k(Ry,{children:k(Ny,{className:u.join(" "),...h,ref:t,children:c})})]})});Cy.displayName="Dropdown";const xy=N.exports.forwardRef((e,t)=>{const{className:n,children:r,...o}=e,i=["app-card--title",n].filter(le);return k("h1",{...o,ref:t,className:i.join(" "),children:r})});xy.displayName="AppCardTitle";var Oy={tags:"AppCardTags-module_tags__ep-F0"};Qe(`.AppCardTags-module_tags__ep-F0 span.tag:not(:last-child) {
  margin-right: var(--space-xsmall);
}
`);const Iy=N.exports.forwardRef((e,t)=>{const{className:n,children:r,...o}=e,i=["app-card--tags",Oy.tags,n].filter(le);return k("div",{...o,ref:t,className:i.join(" "),children:r})});Iy.displayName="AppCardTags";const _y=N.exports.forwardRef((e,t)=>{const{className:n,children:r,...o}=e,i=["app-card--description","p-medium",n].filter(le);return k("h1",{...o,ref:t,className:i.join(" "),children:r})});_y.displayName="AppCardDescription";const My=N.exports.forwardRef((e,t)=>{const{className:n,children:r,...o}=e,i=["app-card--body",n].filter(le);return k("div",{...o,ref:t,className:i.join(" "),children:r})});My.displayName="AppCardBody";const by=N.exports.forwardRef((e,t)=>{const{accentColor:n="var(--blue700)",className:r,children:o,style:i={},...c}=e,f=["app-card",r].filter(le);return k("div",{...c,ref:t,className:f.join(" "),style:{...i,"--accent-color":n},children:o})});by.displayName="AppCard";var _s={button:"Button-module_button__2ZuB7","button-loading":"Button-module_button-loading__UQNwF",gap:"Button-module_gap__kCOx4"};function Ly(e){switch(e){case"small":return"button-small";case"medium":return"button-medium";case"large":return""}}function Uy(e){switch(e){case"primary":return"button-primary";case"secondary":return"button-secondary";case"tertiary":return"button-tertiary";case"danger":return"button-danger"}}function ky(e){return e?`button-loading ${_s["button-loading"]}`:""}function Py(e){return e?_s.gap:""}Qe(`.Button-module_button__2ZuB7 {
  place-content: center;
}

.Button-module_button__2ZuB7:nth-child(n) {
    margin: 0;
  }

.Button-module_button__2ZuB7 span.icon {
    pointer-events: none;
  }

.Button-module_button__2ZuB7 [class*='p-'] {
    font-size: inherit;
  }

.Button-module_button-loading__UQNwF.Button-module_button-loading__UQNwF.Button-module_button-loading__UQNwF > span.icon {
    filter: opacity(0);
  }

.Button-module_gap__kCOx4.Button-module_gap__kCOx4 {
    gap: var(--gap);
  }
`);const _d=N.exports.forwardRef((e,t)=>{const{size:n="medium",variant:r="primary",isDisabled:o=!1,isLoading:i=!1,gap:c,children:f,className:h,style:u={},...a}=e,s=["button",_s.button,Ly(n),Uy(r),ky(i),Py(c),h].filter(le);let l={...u};return c!==void 0&&(l={...l,"--gap":c}),k("button",{...a,ref:t,className:s.join(" "),disabled:o,style:l,children:f})});_d.displayName="Button";var yu={container:"Checkbox-module_container__aV9qz","empty-label":"Checkbox-module_empty-label__OKclI"};Qe(`.Checkbox-module_container__aV9qz {
  margin-bottom: 0;
}

.checkbox span.Checkbox-module_empty-label__OKclI {
  margin: 0;
}
`);const Sy=N.exports.forwardRef((e,t)=>{const{label:n,value:r,onChange:o,className:i,...c}=e;return Se("label",{className:["checkbox",yu.container].join(" "),children:[k("input",{...c,ref:t,className:i,type:"checkbox",checked:r,onChange:f=>o==null?void 0:o(f.target.checked)}),k("span",n?{children:n}:{className:yu["empty-label"]})]})});Sy.displayName="Checkbox";const Fy=N.exports.forwardRef((e,t)=>{const{className:n,...r}=e;return k("hr",{...r,ref:t,className:n})});function By(e){switch(e){case"small":return"form-group-small";case"medium":return"form-group"}}function Dy(e){return e?"form-group__disabled":""}Fy.displayName="Divider";const $y=N.exports.forwardRef((e,t)=>{const{size:n="medium",status:r,isDisabled:o,className:i,children:c,...f}=e,h=[By(n),Dy(o),r,i].filter(le);return k("div",{...f,ref:t,className:h.join(" "),children:c})});$y.displayName="FormGroup";var Vy={xxsmall:"Icon-module_xxsmall__pOzU3",xsmall:"Icon-module_xsmall__tQp11",small:"Icon-module_small__mDMog",medium:"Icon-module_medium__P78uD",large:"Icon-module_large__95dqp",xlarge:"Icon-module_xlarge__w4sTG",xxlarge:"Icon-module_xxlarge__aiAIs"};Qe(`.Icon-module_xxsmall__pOzU3 {
  background-size: calc(var(--icon-size) / 3);
  height: calc(var(--icon-size) / 3);
  width: calc(var(--icon-size) / 3);
}

.Icon-module_xsmall__tQp11 {
  background-size: calc(var(--icon-size) / 2);
  height: calc(var(--icon-size) / 2);
  width: calc(var(--icon-size) / 2);
}

.Icon-module_small__mDMog {
  background-size: calc(var(--icon-size) / 1.5);
  height: calc(var(--icon-size) / 1.5);
  width: calc(var(--icon-size) / 1.5);
}

.Icon-module_medium__P78uD {
  background-size: var(--icon-size);
  height: var(--icon-size);
  width: var(--icon-size);
}

.Icon-module_large__95dqp {
  background-size: calc(var(--icon-size) * 1.5);
  height: calc(var(--icon-size) * 1.5);
  width: calc(var(--icon-size) * 1.5);
}

.Icon-module_xlarge__w4sTG {
  background-size: calc(var(--icon-size) * 2);
  height: calc(var(--icon-size) * 2);
  width: calc(var(--icon-size) * 2);
}

.Icon-module_xxlarge__aiAIs {
  background-size: calc(var(--icon-size) * 3);
  height: calc(var(--icon-size) * 3);
  width: calc(var(--icon-size) * 3);
}
`);const Ms=N.exports.forwardRef((e,t)=>{const{size:n="medium",name:r,className:o,...i}=e,c=["icon",`icon-${r}`,Vy[n],o].filter(le);return k("span",{...i,ref:t,className:c.join(" ")})});Ms.displayName="Icon";function Gy(e){switch(e){case"small":return"input-small";case"medium":return""}}function Hy(e){return e?"border-left":""}function Wy(e){return e?"border-right":""}function Md(e){switch(e){case"1/4":return"one-fourth";case"2/4":return"two-fourth";case"3/4":return"three-fourth";case"4/4":return""}}const zy=N.exports.forwardRef((e,t)=>{const{value:n,onChange:r,size:o="medium",isDisabled:i=!1,isReadOnly:c=!1,flexModifier:f="4/4",className:h,...u}=e,a=["input",h,Gy(o),Md(f)].filter(le);return k("input",{ref:t,...u,className:a.join(" "),value:n,onChange:s=>r==null?void 0:r(s.target.value),disabled:i,readOnly:c})});zy.displayName="Input";const qy=N.exports.forwardRef((e,t)=>{const{className:n,children:r,borderLeft:o=!1,borderRight:i=!1,flexModifier:c="4/4",...f}=e,h=["input-decoration",Hy(o),Wy(i),Md(c),n].filter(le);return k("span",{ref:t,...f,className:h.join(" "),children:r})});qy.displayName="InputDecoration";const Ky=N.exports.forwardRef((e,t)=>{const{className:n,children:r,...o}=e,i=["input-group",n].filter(le);return k("div",{ref:t,...o,className:i.join(" "),children:r})});Ky.displayName="InputGroup";const Yy=N.exports.forwardRef((e,t)=>{const{className:n,children:r,...o}=e;return k("label",{...o,ref:t,className:n,children:r})});Yy.displayName="InputLabel";const Xy=N.exports.forwardRef((e,t)=>{const{className:n,children:r,...o}=e,i=["status-text",n].filter(le);return k("div",{ref:t,...o,className:i.join(" "),children:r})});Xy.displayName="InputStatusText";const Qy=N.exports.forwardRef((e,t)=>{const{className:n,children:r,variant:o="info",...i}=e,c=["label",`label-${o}`,n].filter(le);return k("span",{...i,ref:t,className:c.join(" "),children:r})});Qy.displayName="Label";const Zy=N.exports.forwardRef((e,t)=>{const{className:n,children:r,variant:o="info",...i}=e,c=["link",`link-${o}`,n].filter(le);return k("a",{...i,ref:t,className:c.join(" "),children:r})});Zy.displayName="Link";var wu={container:"RadioButton-module_container__6QkHV","empty-label":"RadioButton-module_empty-label__ykvRF"};Qe(`.RadioButton-module_container__6QkHV {
  margin-bottom: 0;
}

.radiobutton span.RadioButton-module_empty-label__ykvRF {
  margin: 0;
}
`);const Jy=N.exports.forwardRef((e,t)=>{const{label:n,value:r,onChange:o,className:i,...c}=e;return Se("label",{className:["radiobutton",wu.container].join(" "),children:[k("input",{...c,ref:t,className:i,type:"radio",checked:r,onChange:f=>o==null?void 0:o(f.target.checked)}),k("span",n?{children:n}:{className:wu["empty-label"]})]})});function jy(e){switch(e){case"small":return"select-small";case"medium":return""}}Jy.displayName="RadioButton";const ew=N.exports.forwardRef((e,t)=>{const{value:n,onChange:r,size:o="medium",isDisabled:i=!1,className:c,...f}=e,h=["select",jy(o),c].filter(le);return k("select",{...f,ref:t,className:h.join(" "),value:n,onChange:u=>r==null?void 0:r(u.target.value),disabled:i,children:e.children})});ew.displayName="Select";const tw=N.exports.forwardRef((e,t)=>{const{className:n,...r}=e;return k("option",{...r,ref:t,className:n,children:e.children})});tw.displayName="SelectOption";var ga={spinner:"Spinner-module_spinner__GpFZS",spin:"Spinner-module_spin__LFfLH","spinner-small":"Spinner-module_spinner-small__Zfd0D","spinner-medium":"Spinner-module_spinner-medium__sX5Is","spinner-large":"Spinner-module_spinner-large__DIjyj",circle:"Spinner-module_circle__zdwi7",animate:"Spinner-module_animate__FmeJ9",circleAnimation:"Spinner-module_circleAnimation__6o-Ny"};function nw(e){switch(e){case"small":return"spinner-small";case"medium":return"spinner-medium";case"large":return"spinner-large"}}Qe(`.Spinner-module_spinner__GpFZS {
  display: block;
  animation: 2s linear 0s infinite normal none running Spinner-module_spin__LFfLH;
  transform-origin: center center;
  stroke: currentcolor;
  color: var(--spinner-color);
}

.Spinner-module_spinner-small__Zfd0D {
  width: calc(var(--icon-size) / 1.5);
  height: calc(var(--icon-size) / 1.5);
}

.Spinner-module_spinner-medium__sX5Is {
  width: var(--icon-size);
  height: var(--icon-size);
}

.Spinner-module_spinner-large__DIjyj {
  width: calc(var(--icon-size) * 1.5);
  height: calc(var(--icon-size) * 1.5);
}

@keyframes Spinner-module_spin__LFfLH {
  100% {
    transform: rotate(360deg);
  }
}

.Spinner-module_circle__zdwi7 {
  stroke-width: 4;
  fill: none;
  stroke-miterlimit: 10;
  stroke-dasharray: 89, 200;
  stroke-dashoffset: 0;
  animation: 1.5s ease-in-out 0s infinite normal none running Spinner-module_animate__FmeJ9;
  stroke-linecap: round;
}

@media (prefers-reduced-motion: no-preference) {

.Spinner-module_circle__zdwi7 {
    animation-name: Spinner-module_circleAnimation__6o-Ny;
}
  }

@keyframes Spinner-module_circleAnimation__6o-Ny {
  0% {
    stroke-dasharray: 1, 200;
    stroke-dashoffset: 0;
  }
  50% {
    stroke-dasharray: 89, 200;
    stroke-dashoffset: -35px;
  }
  100% {
    stroke-dasharray: 89, 200;
    stroke-dashoffset: -124px;
  }
}
`);const bd=N.exports.forwardRef((e,t)=>{const{className:n,spinnerColor:r="var(--indigo700)",size:o="medium",style:i={}}=e,c=[ga.spinner,ga[nw(o)],n];return k("svg",{ref:t,role:"progressbar",className:c.join(" "),viewBox:"25 25 50 50",style:{...i,"--spinner-color":r},children:k("circle",{className:ga.circle,cx:"50",cy:"50",r:"20"})})});function rw(e){return e?"":"table__no-sticky-headers"}bd.displayName="Spinner";const ow=N.exports.forwardRef((e,t)=>{const{className:n,children:r,headIsSticky:o=!0,...i}=e,c=["table",rw(o),n];return k("table",{...i,ref:t,className:c.join(" "),children:r})});ow.displayName="Table";const iw=N.exports.forwardRef((e,t)=>{const{className:n,children:r,...o}=e;return k("thead",{...o,ref:t,className:n,children:r})});iw.displayName="TableHead";const aw=N.exports.forwardRef((e,t)=>{const{className:n,children:r,...o}=e;return k("th",{...o,ref:t,className:n,children:r})});aw.displayName="TableHeadCell";const sw=N.exports.forwardRef((e,t)=>{const{className:n,children:r,...o}=e;return k("tbody",{...o,ref:t,className:n,children:r})});sw.displayName="TableBody";const cw=N.exports.forwardRef((e,t)=>{const{className:n,children:r,...o}=e;return k("td",{...o,ref:t,className:n,children:r})});cw.displayName="TableCell";const uw=N.exports.forwardRef((e,t)=>{const{className:n,children:r,...o}=e;return k("tr",{...o,ref:t,className:n,children:r})});uw.displayName="TableRow";const lw=N.exports.forwardRef((e,t)=>{const{className:n,tabs:r,activeIndex:o,onClick:i,...c}=e,f=["tabs",n].filter(le);return k("div",{...c,ref:t,className:f.join(" "),children:k("div",{className:"tabs-header-list",children:r.map((h,u)=>{const a=["tab",(s=o===u,s?"tab-active":""),n].filter(le);var s;const l=["tab-text",h.badge?"tab-badge":void 0].filter(le);return k("div",{className:a.join(" "),tabIndex:0,onClick:()=>i==null?void 0:i(u),children:k("div",{className:l.join(" "),"data-badge":h.badge,children:h.children})},h.id)})})})});function Ld(e){return e?`icon icon-${e}`:""}lw.displayName="Tabs";const fw=N.exports.forwardRef((e,t)=>{const{icon:n,textColor:r="var(--black)",backgroundColor:o="var(--indigo50)",className:i,children:c,style:f={},...h}=e,u=["tag",Ld(n),i].filter(le);return k("a",{...h,ref:t,className:u.join(" "),style:{...f,"--color":r,"--background":o},children:c})});fw.displayName="LinkTag";const dw=N.exports.forwardRef((e,t)=>{const{icon:n,textColor:r="var(--black)",backgroundColor:o="var(--indigo50)",className:i,children:c,...f}=e,h=["tag",Ld(n),i].filter(le);return k("span",{...f,ref:t,className:h.join(" "),style:{"--color":r,"--background":o},children:c})});dw.displayName="Tag";const hw=N.exports.forwardRef((e,t)=>{const{icon:n,className:r,...o}=e,i=["icon",`icon-${n}`,r].filter(le);return k("button",{...o,type:"button",ref:t,className:i.join(" ")})});hw.displayName="TagButton";const pw=N.exports.forwardRef((e,t)=>{const{className:n,...r}=e,o=["tag-image",n].filter(le);return k("img",{...r,ref:t,className:o.join(" ")})});function vw(e){switch(e){case"small":return"textarea-small";case"medium":return""}}pw.displayName="TagImage";const mw=N.exports.forwardRef((e,t)=>{const{value:n,onChange:r,size:o="medium",isDisabled:i=!1,isReadOnly:c=!1,className:f,...h}=e,u=["textarea",f,vw(o)].filter(le);return k("textarea",{ref:t,...h,className:u.join(" "),onChange:a=>r==null?void 0:r(a.target.value),disabled:i,readOnly:c})});mw.displayName="TextArea";var Ru={container:"Toggle-module_container__ftUHq","empty-label":"Toggle-module_empty-label__4ncg-"};Qe(`.Toggle-module_container__ftUHq {
  margin-bottom: 0;
}

.toggle span.Toggle-module_empty-label__4ncg- {
  padding: 0;
}
`);const gw=N.exports.forwardRef((e,t)=>{const{label:n,value:r,onChange:o,className:i,...c}=e;return Se("label",{className:["toggle",Ru.container].join(" "),children:[k("input",{...c,ref:t,className:i,type:"checkbox",checked:r,onChange:f=>o==null?void 0:o(f.target.checked)}),k("span",n?{children:n}:{className:Ru["empty-label"]})]})});gw.displayName="Toggle";var Ew="DropdownButton-module_icon__Z24l-";Qe(`.DropdownButton-module_icon__Z24l- {
  pointer-events: none;
}
`);const yw=N.exports.forwardRef((e,t)=>{const{children:n,...r}=e;return Se(_d,{ref:t,...r,children:[n,k(Ms,{name:"arrow-down",className:Ew})]})});yw.displayName="DropdownButton";var ww={divider:"DropdownDivider-module_divider__utvAL"};Qe(`.DropdownDivider-module_divider__utvAL {
  margin: var(--space-xxsmall) 0;
}
`);const Rw=N.exports.forwardRef((e,t)=>{const{className:n,...r}=e,o=[ww.divider,n].filter(le);return k("hr",{...r,ref:t,className:o.join(" ")})});Rw.displayName="DropdownDivider";var Nw={"menu-item":"DropdownItem-module_menu-item__HkFBl"};Qe(`.DropdownItem-module_menu-item__HkFBl {
  padding: var(--space-xsmall) var(--space-small);
}

.DropdownItem-module_menu-item__HkFBl:hover {
  background-color: var(--blue100);
  cursor: pointer;
}

.DropdownItem-module_menu-item__HkFBl:focus-visible {
  outline: none;
}
`);const Tw=N.exports.forwardRef((e,t)=>{const{className:n,disableCloseOnSelect:r=!1,onSelect:o,...i}=e,c=[Nw["menu-item"],n].filter(le);return k(Ty,{className:c.join(" "),...i,ref:t,onSelect:f=>{r&&f.preventDefault(),o==null||o()}})});Tw.displayName="DropdownItem";var Nu={badge:"DismissableBadge-module_badge__NiWYc","close-button":"DismissableBadge-module_close-button__-TAbm"};Qe(`.DismissableBadge-module_badge__NiWYc {
  display: flex;
  align-items: center;
  gap: var(--space-xsmall);
  padding: var(--space-xsmall) var(--space-xsmall) var(--space-xsmall) calc(var(--space-xsmall) * 1.5);
  border: var(--border);
  border-radius: var(--border-radius);
  background-color: var(--background-color);
  color: var(--color);
}

.DismissableBadge-module_close-button__-TAbm {
  border-radius: var(--border-radius);
  height: unset;
  padding: var(--space-xxsmall);
  background-color: unset;
  border: none;
}

.DismissableBadge-module_close-button__-TAbm:hover {
    background-color: var(--hover-background-color);
    cursor: pointer;
  }

.DismissableBadge-module_close-button__-TAbm span.icon-close {
    background-size: calc(var(--icon-size) / 1.25);
    height: calc(var(--icon-size) / 1.25);
    width: calc(var(--icon-size) / 1.25);
    pointer-events: none;
    filter: var(--icon-filter);
  }
`);const It={color:{primaryText:"var(--primary-text-color)",secondaryText:"var(--secondary-text-color)",primaryActionColor:"var(--primary-action-color)",blue:{100:"var(--blue100)",200:"var(--blue200)",300:"var(--blue300)",400:"var(--blue400)",500:"var(--blue500)",600:"var(--blue600)",700:"var(--blue700)",800:"var(--blue800)",900:"var(--blue900)"},indigo:{50:"var(--indigo50)",100:"var(--indigo100)",200:"var(--indigo200)",300:"var(--indigo300)",400:"var(--indigo400)",500:"var(--indigo500)",600:"var(--indigo600)",700:"var(--indigo700)"},indigoAlpha:{4:"var(--indigoAlpha4)",6:"var(--indigoAlpha6)",8:"var(--indigoAlpha8)",12:"var(--indigoAlpha12)",20:"var(--indigoAlpha20)",40:"var(--indigoAlpha40)",80:"var(--indigoAlpha80)"},green:{100:"var(--green100)",400:"var(--green400)",700:"var(--green700)",800:"var(--green800)"},black:"var(--black)",blackAlpha:{20:"var(--blackAlpha20)",40:"var(--blackAlpha40)",60:"var(--blackAlpha60)",80:"var(--blackAlpha80)"},red:{50:"var(--red50)",100:"var(--red100)",400:"var(--red400)",600:"var(--red600)",700:"var(--red700)",800:"var(--red800)",900:"var(--red900)"},yellow:{100:"var(--yellow100)",400:"var(--yellow400)",700:"var(--yellow700)"},white:"var(--white)",whiteAlpha:{20:"var(--whiteAlpha20)",40:"var(--whiteAlpha40)",80:"var(--whiteAlpha80)"}},typography:{fontWeight:{normal:"var(--font-weight-normal)",medium:"var(--font-weight-medium)",bold:"var(--font-weight-bold)",black:"var(--font-weight-black)"},fontSize:{small:"var(--font-size-small)",medium:"var(--font-size-medium)",large:"var(--font-size-large)",xlarge:"var(--font-size-xlarge)",xxlarge:"var(--font-size-xxlarge)",xxxlarge:"var(--font-size-xxxlarge)"},font:{header:"var(--header-font)",body:"var(--body-font)"}},space:{xxxsmall:"var(--space-xxxsmall)",xxsmall:"var(--space-xxsmall)",xsmall:"var(--space-xsmall)",small:"var(--space-small)",medium:"var(--space-medium)",large:"var(--space-large)",xlarge:"var(--space-xlarge)",xxlarge:"var(--space-xxlarge)",xxxlarge:"var(--space-xxxlarge)"},borderRadius:{small:"var(--border-radius-small)",medium:"var(--border-radius-medium)",large:"var(--border-radius-large)",xlarge:"var(--border-radius-xlarge)",xxlarge:"var(--border-radius-xxlarge)",circle:"var(--border-radius-circle)"}};function Aw(e){return e?It.borderRadius.xxlarge:It.borderRadius.medium}function Cw(e){switch(e){case"primary":return It.color.white;case"secondary":return It.color.indigo[50]}}function xw(e){switch(e){case"primary":return`1.5px solid ${It.color.blue[600]}`;case"secondary":return"none"}}function Ow(e){switch(e){case"primary":return It.color.primaryActionColor;case"secondary":return It.color.primaryText}}function Iw(e){return e?It.borderRadius.xxlarge:It.borderRadius.medium}function _w(e){switch(e){case"primary":return It.color.blue[300];case"secondary":return It.color.indigo[300]}}function Mw(e){switch(e){case"primary":return"brightness(0) saturate(100%) invert(47%) sepia(74%) saturate(5653%) hue-rotate(221deg) brightness(98%) contrast(106%)";case"secondary":return"brightness(0) saturate(100%) invert(38%) sepia(8%) saturate(1583%) hue-rotate(206deg) brightness(92%) contrast(88%)"}}const bw=N.exports.forwardRef((e,t)=>{const{className:n,children:r,rounded:o=!1,variant:i="primary",onClose:c,style:f,...h}=e,u=[Nu.badge,"p-medium",n].filter(le);return Se("div",{...h,ref:t,className:u.join(" "),style:{...f,"--border-radius":Aw(o),"--background-color":Cw(i),"--border":xw(i),"--color":Ow(i)},children:[r,k("button",{className:Nu["close-button"],style:{"--border-radius":Iw(o),"--hover-background-color":_w(i),"--icon-filter":Mw(i)},onClick:c,children:k(Ms,{name:"close"})})]})});bw.displayName="DismissableBadge";const Lw=N.exports.forwardRef((e,t)=>N.exports.createElement(Ft.span,se({},e,{ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}))),[Si,BN]=Tr("Tooltip",[ki]),Fi=ki(),Uw=700,Qa="tooltip.open",[kw,bs]=Si("TooltipProvider"),Pw=e=>{const{__scopeTooltip:t,delayDuration:n=Uw,skipDelayDuration:r=300,disableHoverableContent:o=!1,children:i}=e,[c,f]=N.exports.useState(!0),h=N.exports.useRef(!1),u=N.exports.useRef(0);return N.exports.useEffect(()=>{const a=u.current;return()=>window.clearTimeout(a)},[]),N.exports.createElement(kw,{scope:t,isOpenDelayed:c,delayDuration:n,onOpen:N.exports.useCallback(()=>{window.clearTimeout(u.current),f(!1)},[]),onClose:N.exports.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>f(!0),r)},[r]),isPointerInTransitRef:h,onPointerInTransitChange:N.exports.useCallback(a=>{h.current=a},[]),disableHoverableContent:o},i)},Ls="Tooltip",[Sw,so]=Si(Ls),Tu="TooltipTrigger",Fw=N.exports.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,o=so(Tu,n),i=bs(Tu,n),c=Fi(n),f=wt(t,N.exports.useRef(null),o.onTriggerChange),h=N.exports.useRef(!1),u=N.exports.useRef(!1),a=N.exports.useCallback(()=>h.current=!1,[]);return N.exports.useEffect(()=>()=>document.removeEventListener("pointerup",a),[a]),N.exports.createElement(sd,se({asChild:!0},c),N.exports.createElement(Ft.button,se({"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute},r,{ref:f,onPointerMove:de(e.onPointerMove,s=>{s.pointerType!=="touch"&&(u.current||i.isPointerInTransitRef.current||(o.onTriggerEnter(),u.current=!0))}),onPointerLeave:de(e.onPointerLeave,()=>{o.onTriggerLeave(),u.current=!1}),onPointerDown:de(e.onPointerDown,()=>{h.current=!0,document.addEventListener("pointerup",a,{once:!0})}),onFocus:de(e.onFocus,()=>{h.current||o.onOpen()}),onBlur:de(e.onBlur,o.onClose),onClick:de(e.onClick,o.onClose)})))}),Ud="TooltipPortal",[Bw,Dw]=Si(Ud,{forceMount:void 0}),Xr="TooltipContent",$w=N.exports.forwardRef((e,t)=>{const n=Dw(Xr,e.__scopeTooltip),{forceMount:r=n.forceMount,side:o="top",...i}=e,c=so(Xr,e.__scopeTooltip);return N.exports.createElement(oo,{present:r||c.open},c.disableHoverableContent?N.exports.createElement(kd,se({side:o},i,{ref:t})):N.exports.createElement(Vw,se({side:o},i,{ref:t})))}),Vw=N.exports.forwardRef((e,t)=>{const n=so(Xr,e.__scopeTooltip),r=bs(Xr,e.__scopeTooltip),o=N.exports.useRef(null),i=wt(t,o),[c,f]=N.exports.useState(null),{trigger:h,onClose:u}=n,a=o.current,{onPointerInTransitChange:s}=r,l=N.exports.useCallback(()=>{f(null),s(!1)},[s]),d=N.exports.useCallback((v,p)=>{const m=v.currentTarget,g={x:v.clientX,y:v.clientY},E=function(w,T,R=5){const A=[];switch(T){case"top":A.push({x:w.x-R,y:w.y+R},{x:w.x+R,y:w.y+R});break;case"bottom":A.push({x:w.x-R,y:w.y-R},{x:w.x+R,y:w.y-R});break;case"left":A.push({x:w.x+R,y:w.y-R},{x:w.x+R,y:w.y+R});break;case"right":A.push({x:w.x-R,y:w.y-R},{x:w.x-R,y:w.y+R})}return A}(g,function(w,T){const R=Math.abs(T.top-w.y),A=Math.abs(T.bottom-w.y),C=Math.abs(T.right-w.x),x=Math.abs(T.left-w.x);switch(Math.min(R,A,C,x)){case x:return"left";case C:return"right";case R:return"top";case A:return"bottom";default:throw new Error("unreachable")}}(g,m.getBoundingClientRect())),y=function(w){const T=w.slice();return T.sort((R,A)=>R.x<A.x?-1:R.x>A.x?1:R.y<A.y?-1:R.y>A.y?1:0),function(R){if(R.length<=1)return R.slice();const A=[];for(let x=0;x<R.length;x++){const O=R[x];for(;A.length>=2;){const I=A[A.length-1],P=A[A.length-2];if(!((I.x-P.x)*(O.y-P.y)>=(I.y-P.y)*(O.x-P.x)))break;A.pop()}A.push(O)}A.pop();const C=[];for(let x=R.length-1;x>=0;x--){const O=R[x];for(;C.length>=2;){const I=C[C.length-1],P=C[C.length-2];if(!((I.x-P.x)*(O.y-P.y)>=(I.y-P.y)*(O.x-P.x)))break;C.pop()}C.push(O)}return C.pop(),A.length===1&&C.length===1&&A[0].x===C[0].x&&A[0].y===C[0].y?A:A.concat(C)}(T)}([...E,...function(w){const{top:T,right:R,bottom:A,left:C}=w;return[{x:C,y:T},{x:R,y:T},{x:R,y:A},{x:C,y:A}]}(p.getBoundingClientRect())]);f(y),s(!0)},[s]);return N.exports.useEffect(()=>()=>l(),[l]),N.exports.useEffect(()=>{if(h&&a){const v=m=>d(m,a),p=m=>d(m,h);return h.addEventListener("pointerleave",v),a.addEventListener("pointerleave",p),()=>{h.removeEventListener("pointerleave",v),a.removeEventListener("pointerleave",p)}}},[h,a,d,l]),N.exports.useEffect(()=>{if(c){const v=p=>{const m=p.target,g={x:p.clientX,y:p.clientY},E=(h==null?void 0:h.contains(m))||(a==null?void 0:a.contains(m)),y=!function(w,T){const{x:R,y:A}=w;let C=!1;for(let x=0,O=T.length-1;x<T.length;O=x++){const I=T[x].x,P=T[x].y,B=T[O].x,S=T[O].y;P>A!=S>A&&R<(B-I)*(A-P)/(S-P)+I&&(C=!C)}return C}(g,c);E?l():y&&(l(),u())};return document.addEventListener("pointermove",v),()=>document.removeEventListener("pointermove",v)}},[h,a,c,u,l]),N.exports.createElement(kd,se({},e,{ref:i}))}),[Gw,Hw]=Si(Ls,{isInside:!1}),kd=N.exports.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":o,onEscapeKeyDown:i,onPointerDownOutside:c,...f}=e,h=so(Xr,n),u=Fi(n),{onClose:a}=h;return N.exports.useEffect(()=>(document.addEventListener(Qa,a),()=>document.removeEventListener(Qa,a)),[a]),N.exports.useEffect(()=>{if(h.trigger){const s=l=>{const d=l.target;d!=null&&d.contains(h.trigger)&&a()};return window.addEventListener("scroll",s,{capture:!0}),()=>window.removeEventListener("scroll",s,{capture:!0})}},[h.trigger,a]),N.exports.createElement(zf,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:c,onFocusOutside:s=>s.preventDefault(),onDismiss:a},N.exports.createElement(cd,se({"data-state":h.stateAttribute},u,f,{ref:t,style:{...f.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"}}),N.exports.createElement(Vf,null,r),N.exports.createElement(Gw,{scope:n,isInside:!0},N.exports.createElement(Lw,{id:h.contentId,role:"tooltip"},o||r))))}),Ww=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:o=!1,onOpenChange:i,disableHoverableContent:c,delayDuration:f}=e,h=bs(Ls,e.__scopeTooltip),u=Fi(t),[a,s]=N.exports.useState(null),l=fi(),d=N.exports.useRef(0),v=c!=null?c:h.disableHoverableContent,p=f!=null?f:h.delayDuration,m=N.exports.useRef(!1),[g=!1,E]=ws({prop:r,defaultProp:o,onChange:A=>{A?(h.onOpen(),document.dispatchEvent(new CustomEvent(Qa))):h.onClose(),i==null||i(A)}}),y=N.exports.useMemo(()=>g?m.current?"delayed-open":"instant-open":"closed",[g]),w=N.exports.useCallback(()=>{window.clearTimeout(d.current),m.current=!1,E(!0)},[E]),T=N.exports.useCallback(()=>{window.clearTimeout(d.current),E(!1)},[E]),R=N.exports.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(()=>{m.current=!0,E(!0)},p)},[p,E]);return N.exports.useEffect(()=>()=>window.clearTimeout(d.current),[]),N.exports.createElement(ad,u,N.exports.createElement(Sw,{scope:t,contentId:l,open:g,stateAttribute:y,trigger:a,onTriggerChange:s,onTriggerEnter:N.exports.useCallback(()=>{h.isOpenDelayed?R():w()},[h.isOpenDelayed,R,w]),onTriggerLeave:N.exports.useCallback(()=>{v?T():window.clearTimeout(d.current)},[T,v]),onOpen:w,onClose:T,disableHoverableContent:v},n))},zw=Fw,qw=e=>{const{__scopeTooltip:t,forceMount:n,children:r,container:o}=e,i=so(Ud,t);return N.exports.createElement(Bw,{scope:t,forceMount:n},N.exports.createElement(oo,{present:n||i.open},N.exports.createElement(ud,{asChild:!0,container:o},r)))},Kw=$w,Yw=N.exports.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,o=Fi(n);return Hw("TooltipArrow",n).isInside?null:N.exports.createElement(CE,se({},o,r,{ref:t}))});var Xw={content:"Tooltip-module_content__puu8c"};Qe(`.Tooltip-module_content__puu8c {
  color: var(--white);
  background-color: var(--black);
  padding: 10px;
  border-radius: var(--space-xxsmall);
}
`);const Qw=N.exports.forwardRef((e,t)=>{const{delayDuration:n=500,disableCloseOnOutside:r=!1,trigger:o,open:i,onOpenChange:c,size:f="medium",children:h,className:u,...a}=e,s=[Xw.content,`p-${f}`,u].filter(le);return k(Pw,{delayDuration:n,children:Se(Ww,{onOpenChange:c,open:i,children:[k(zw,{asChild:!0,children:o}),k(qw,{children:Se(Kw,{...a,className:s.join(" "),ref:t,onPointerDownOutside:l=>{r&&l.preventDefault()},children:[h,k(Yw,{})]})})]})})});Qw.displayName="Tooltip";const Zw=N.exports.forwardRef((e,t)=>{const{className:n,children:r,...o}=e,i=["centered",n].filter(le);return k("div",{...o,ref:t,className:i.join(" "),children:r})});Zw.displayName="Centered";var sn={flex:"Flex-module_flex__2ZbG8","align-content":"Flex-module_align-content__kSz6F","align-items":"Flex-module_align-items__mWuQZ","column-gap":"Flex-module_column-gap__61s52","flex-direction":"Flex-module_flex-direction__zt-FE","flex-flow":"Flex-module_flex-flow__eOs9U","flex-wrap":"Flex-module_flex-wrap__N3vns",gap:"Flex-module_gap__IxNhW","justify-content":"Flex-module_justify-content__syvR6","row-gap":"Flex-module_row-gap__0EHtg"};function Jw(e){return e?sn["align-content"]:""}function jw(e){return e?sn["align-items"]:""}function eR(e){return e?sn["column-gap"]:""}function tR(e){return e?sn["flex-direction"]:""}function nR(e){return e?sn["flex-flow"]:""}function rR(e){return e?sn["flex-wrap"]:""}function oR(e){return e?sn.gap:""}function iR(e){return e?sn["justify-content"]:""}function aR(e){return e?sn["row-gap"]:""}Qe(`.Flex-module_flex__2ZbG8 {
  display: flex;
}

.Flex-module_align-content__kSz6F {
  align-content: var(--align-content);
}

.Flex-module_align-items__mWuQZ {
  align-items: var(--align-items);
}

.Flex-module_column-gap__61s52 {
  -moz-column-gap: var(--column-gap);
       column-gap: var(--column-gap);
}

.Flex-module_flex-direction__zt-FE {
  flex-direction: var(--flex-direction);
}

.Flex-module_flex-flow__eOs9U {
  flex-flow: var(--flex-flow);
}

.Flex-module_flex-wrap__N3vns {
  flex-wrap: var(--flex-wrap);
}

.Flex-module_gap__IxNhW {
  gap: var(--gap);
}

.Flex-module_justify-content__syvR6 {
  justify-content: var(--justify-content);
}

.Flex-module_row-gap__0EHtg {
  row-gap: var(--row-gap);
}
`);const sR=N.exports.forwardRef((e,t)=>{const{className:n,alignContent:r,alignItems:o,columnGap:i,flexDirection:c,flexFlow:f,flexWrap:h,gap:u,justifyContent:a,rowGap:s,style:l={},...d}=e,v=[sn.flex,Jw(r),jw(o),eR(i),tR(c),nR(f),rR(h),oR(u),iR(a),aR(s),n].filter(le);let p={...l};return r!==void 0&&(p={...p,"--align-content":r}),o!==void 0&&(p={...p,"--align-items":o}),i!==void 0&&(p={...p,"--column-gap":i}),c!==void 0&&(p={...p,"--flex-direction":c}),f!==void 0&&(p={...p,"--flex-flow":f}),h!==void 0&&(p={...p,"--flex-wrap":h}),u!==void 0&&(p={...p,"--gap":u}),a!==void 0&&(p={...p,"--justify-content":a}),s!==void 0&&(p={...p,"--row-gap":s}),k("div",{...d,ref:t,className:v.join(" "),style:p})});sR.displayName="Flex";const cR=N.exports.forwardRef((e,t)=>{const{className:n,children:r,...o}=e,i=["grid",n].filter(le);return k("div",{...o,ref:t,className:i.join(" "),children:r})});cR.displayName="Grid";const uR=N.exports.forwardRef((e,t)=>{const{className:n,children:r,colStart:o,colEnd:i,...c}=e,f=[`cs${o}`,`ce${i}`,n].filter(le);return k("div",{...c,ref:t,className:f.join(" "),children:r})});uR.displayName="GridItem";var lR={heading:"Heading-module_heading__MEFIt"};Qe(`.Heading-module_heading__MEFIt {
  color: var(--font-color);
}
`);const fR=N.exports.forwardRef((e,t)=>{const{className:n,children:r,level:o=1,fontColor:i,style:c={},...f}=e,h=[`h${o}`,lR.heading,n].filter(le);let u={...c};switch(i!==void 0&&(u={...u,"--font-color":i}),o){case 1:return k("h1",{...f,ref:t,className:h.join(" "),style:u,children:r});case 2:return k("h2",{...f,ref:t,className:h.join(" "),style:u,children:r});case 3:return k("h3",{...f,ref:t,className:h.join(" "),style:u,children:r});case 4:return k("h4",{...f,ref:t,className:h.join(" "),style:u,children:r})}});fR.displayName="Heading";var dR={paragraph:"Paragraph-module_paragraph__EOOM8"};Qe(`.Paragraph-module_paragraph__EOOM8 {
  font-size: var(--font-size);
  font-weight: var(--font-weight);
  color: var(--font-color);
}
`);const hR=N.exports.forwardRef((e,t)=>{const{className:n,children:r,size:o="medium",fontWeight:i,fontColor:c,style:f={},...h}=e,u=[dR.paragraph,n].filter(le);let a={...f};return a={...a,"--font-size":It.typography.fontSize[o]},i!==void 0&&(a={...a,"--font-weight":i}),c!==void 0&&(a={...a,"--font-color":c}),console.log("paragraphStyle",a),k("p",{...h,ref:t,className:u.join(" "),style:a,children:r})});hR.displayName="Paragraph";var pR={text:"Text-module_text__7yIVD"};Qe(`.Text-module_text__7yIVD {
  font-size: var(--font-size);
  font-weight: var(--font-weight);
  color: var(--font-color);
}
`);const vR=N.exports.forwardRef((e,t)=>{const{className:n,children:r,size:o="medium",fontWeight:i,fontColor:c,style:f={},...h}=e,u=[pR.text,n].filter(le);let a={...f};return a={...a,"--font-size":It.typography.fontSize[o]},i!==void 0&&(a={...a,"--font-weight":i}),c!==void 0&&(a={...a,"--font-color":c}),k("span",{...h,ref:t,className:u.join(" "),style:a,children:r})});vR.displayName="Text";function DN(){return k("div",{style:{position:"fixed",width:"100%",height:"100%",top:0,left:0,zIndex:1e3,background:"rgba(0, 0, 0, .5)"},children:k(bd,{size:"large",spinnerColor:"var(--whiteAlpha80)",style:{position:"absolute",top:"50%",left:"50%"}})})}const mR=e=>e.message?e.message:e.error?e.error.message:"Unexpected error.";function $N(){const e=N.exports.useContext($f);if(!e)throw new Error("MessageContext is not provided");const{message:t,setMessage:n}=e;N.exports.useEffect(()=>{var c;((t==null?void 0:t.message)||(t==null?void 0:t.error))&&((c=r.current)==null||c.showModal())},[t]);const r=N.exports.useRef(null),o=N.exports.useRef(null),i=c=>{var f,h;(f=o.current)!=null&&f.contains(c.target)||(n({}),(h=r.current)==null||h.close())};return k(Ra,{children:((t==null?void 0:t.message)||(t==null?void 0:t.error))&&k("div",{children:k("dialog",{ref:r,onClick:i,children:k("div",{ref:o,children:mR(t)})})})})}function gR({column:e,label:t,updateLabel:n}){const[r,o]=N.exports.useState((t==null?void 0:t.toString())||String.fromCharCode(e+65)),[i,c]=N.exports.useState(!1),[f,h]=N.exports.useState(!1),u=N.exports.useRef(null),a=()=>{h(!0)},s=()=>{h(!1)},l=()=>{c(!0)};N.exports.useEffect(()=>{i&&u.current&&u.current.focus()},[i]);const d=m=>{o(m.currentTarget.value)},v=()=>{n(e,r),c(!1)};return i?k("th",{className:"Spreadsheet__data-editor",children:k("input",{ref:u,type:"text",value:r,onKeyDown:m=>{!f&&m.key==="Enter"?v():m.key==="Backspace"&&(m.preventDefault(),o(r.slice(0,-1)))},onChange:d,onBlur:v,onCompositionStart:a,onCompositionEnd:s,size:5})}):k("th",{onClick:l,className:"Spreadsheet__header",children:k("span",{children:r})})}function ER(){const e=N.exports.useContext(Zr);if(!e)throw new Error("ChartDataContext is not provided");const{data:t,columns:n,setData:r,setColumns:o}=e,i=u=>k(Ra,{children:k(gR,{...u,updateLabel:h})}),c=()=>{const u=[...n];u.push(String(u.length+1)),o(u)},f=()=>{const u=[...n];u.pop(),o(u);const a=u.length;r(t.map(s=>Array.isArray(s)?s.slice(0,a):s))},h=(u,a)=>{const s=[...n];s.length>u?s[u]=a:s.push(a),o(s)};return k(Ra,{children:k("div",{children:t&&n&&Se("div",{className:"",style:{display:"flex",alignContent:"start"},children:[k(D1,{data:t,onChange:r,columnLabels:n,ColumnIndicator:i}),k("div",{children:Se("div",{className:"",style:{display:"flex"},children:[k("button",{className:"button button-secondary button-small",style:{height:30,marginTop:2,marginLeft:4,marginRight:1},onClick:c,children:k("span",{className:"icon icon-plus"})}),k("button",{className:"button button-secondary button-small",style:{height:30,marginTop:2,marginLeft:1,marginRight:15},onClick:f,children:k("span",{className:"icon icon-minus"})})]})})]})})})}function yR(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Au(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Cu(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Au(Object(n),!0).forEach(function(r){yR(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Au(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function wR(e,t){if(e==null)return{};var n={},r=Object.keys(e),o,i;for(i=0;i<r.length;i++)o=r[i],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function RR(e,t){if(e==null)return{};var n=wR(e,t),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)r=i[o],!(t.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(n[r]=e[r]))}return n}function NR(e,t){return TR(e)||AR(e,t)||CR(e,t)||xR()}function TR(e){if(Array.isArray(e))return e}function AR(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],r=!0,o=!1,i=void 0;try{for(var c=e[Symbol.iterator](),f;!(r=(f=c.next()).done)&&(n.push(f.value),!(t&&n.length===t));r=!0);}catch(h){o=!0,i=h}finally{try{!r&&c.return!=null&&c.return()}finally{if(o)throw i}}return n}}function CR(e,t){if(!!e){if(typeof e=="string")return xu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xu(e,t)}}function xu(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xR(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OR(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ou(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Iu(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ou(Object(n),!0).forEach(function(r){OR(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ou(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function IR(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(r){return t.reduceRight(function(o,i){return i(o)},r)}}function Sr(e){return function t(){for(var n=this,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return o.length>=e.length?e.apply(this,o):function(){for(var c=arguments.length,f=new Array(c),h=0;h<c;h++)f[h]=arguments[h];return t.apply(n,[].concat(o,f))}}}function mi(e){return{}.toString.call(e).includes("Object")}function _R(e){return!Object.keys(e).length}function Qr(e){return typeof e=="function"}function MR(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function bR(e,t){return mi(t)||Un("changeType"),Object.keys(t).some(function(n){return!MR(e,n)})&&Un("changeField"),t}function LR(e){Qr(e)||Un("selectorType")}function UR(e){Qr(e)||mi(e)||Un("handlerType"),mi(e)&&Object.values(e).some(function(t){return!Qr(t)})&&Un("handlersType")}function kR(e){e||Un("initialIsRequired"),mi(e)||Un("initialType"),_R(e)&&Un("initialContent")}function PR(e,t){throw new Error(e[t]||e.default)}var SR={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},Un=Sr(PR)(SR),Po={changes:bR,selector:LR,handler:UR,initial:kR};function FR(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Po.initial(e),Po.handler(t);var n={current:e},r=Sr($R)(n,t),o=Sr(DR)(n),i=Sr(Po.changes)(e),c=Sr(BR)(n);function f(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(a){return a};return Po.selector(u),u(n.current)}function h(u){IR(r,o,i,c)(u)}return[f,h]}function BR(e,t){return Qr(t)?t(e.current):t}function DR(e,t){return e.current=Iu(Iu({},e.current),t),t}function $R(e,t,n){return Qr(t)?t(e.current):Object.keys(n).forEach(function(r){var o;return(o=t[r])===null||o===void 0?void 0:o.call(t,e.current[r])}),n}var VR={create:FR},GR={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs"}};function HR(e){return function t(){for(var n=this,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return o.length>=e.length?e.apply(this,o):function(){for(var c=arguments.length,f=new Array(c),h=0;h<c;h++)f[h]=arguments[h];return t.apply(n,[].concat(o,f))}}}function WR(e){return{}.toString.call(e).includes("Object")}function zR(e){return e||_u("configIsRequired"),WR(e)||_u("configType"),e.urls?(qR(),{paths:{vs:e.urls.monacoBase}}):e}function qR(){console.warn(Pd.deprecation)}function KR(e,t){throw new Error(e[t]||e.default)}var Pd={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},_u=HR(KR)(Pd),YR={config:zR},XR=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(o){return n.reduceRight(function(i,c){return c(i)},o)}};function Sd(e,t){return Object.keys(t).forEach(function(n){t[n]instanceof Object&&e[n]&&Object.assign(t[n],Sd(e[n],t[n]))}),Cu(Cu({},e),t)}var QR={type:"cancelation",msg:"operation is manually canceled"};function Ea(e){var t=!1,n=new Promise(function(r,o){e.then(function(i){return t?o(QR):r(i)}),e.catch(o)});return n.cancel=function(){return t=!0},n}var ZR=VR.create({config:GR,isInitialized:!1,resolve:null,reject:null,monaco:null}),Fd=NR(ZR,2),co=Fd[0],Bi=Fd[1];function JR(e){var t=YR.config(e),n=t.monaco,r=RR(t,["monaco"]);Bi(function(o){return{config:Sd(o.config,r),monaco:n}})}function jR(){var e=co(function(t){var n=t.monaco,r=t.isInitialized,o=t.resolve;return{monaco:n,isInitialized:r,resolve:o}});if(!e.isInitialized){if(Bi({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),Ea(ya);if(window.monaco&&window.monaco.editor)return Bd(window.monaco),e.resolve(window.monaco),Ea(ya);XR(eN,nN)(rN)}return Ea(ya)}function eN(e){return document.body.appendChild(e)}function tN(e){var t=document.createElement("script");return e&&(t.src=e),t}function nN(e){var t=co(function(r){var o=r.config,i=r.reject;return{config:o,reject:i}}),n=tN("".concat(t.config.paths.vs,"/loader.js"));return n.onload=function(){return e()},n.onerror=t.reject,n}function rN(){var e=co(function(n){var r=n.config,o=n.resolve,i=n.reject;return{config:r,resolve:o,reject:i}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(n){Bd(n),e.resolve(n)},function(n){e.reject(n)})}function Bd(e){co().monaco||Bi({monaco:e})}function oN(){return co(function(e){var t=e.monaco;return t})}var ya=new Promise(function(e,t){return Bi({resolve:e,reject:t})}),Dd={config:JR,init:jR,__getMonacoInstance:oN},iN={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},wa=iN,aN={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},sN=aN;function cN({children:e}){return rt.createElement("div",{style:sN.container},e)}var uN=cN,lN=uN;function fN({width:e,height:t,isEditorReady:n,loading:r,_ref:o,className:i,wrapperProps:c}){return rt.createElement("section",{style:{...wa.wrapper,width:e,height:t},...c},!n&&rt.createElement(lN,null,r),rt.createElement("div",{ref:o,style:{...wa.fullWidth,...!n&&wa.hide},className:i}))}var dN=fN,$d=N.exports.memo(dN);function hN(e){N.exports.useEffect(e,[])}var Vd=hN;function pN(e,t,n=!0){let r=N.exports.useRef(!0);N.exports.useEffect(r.current||!n?()=>{r.current=!1}:e,t)}var Tt=pN;function Br(){}function hr(e,t,n,r){return vN(e,r)||mN(e,t,n,r)}function vN(e,t){return e.editor.getModel(Gd(e,t))}function mN(e,t,n,r){return e.editor.createModel(t,n,r?Gd(e,r):void 0)}function Gd(e,t){return e.Uri.parse(t)}function gN({original:e,modified:t,language:n,originalLanguage:r,modifiedLanguage:o,originalModelPath:i,modifiedModelPath:c,keepCurrentOriginalModel:f=!1,keepCurrentModifiedModel:h=!1,theme:u="light",loading:a="Loading...",options:s={},height:l="100%",width:d="100%",className:v,wrapperProps:p={},beforeMount:m=Br,onMount:g=Br}){let[E,y]=N.exports.useState(!1),[w,T]=N.exports.useState(!0),R=N.exports.useRef(null),A=N.exports.useRef(null),C=N.exports.useRef(null),x=N.exports.useRef(g),O=N.exports.useRef(m),I=N.exports.useRef(!1);Vd(()=>{let b=Dd.init();return b.then(_=>(A.current=_)&&T(!1)).catch(_=>(_==null?void 0:_.type)!=="cancelation"&&console.error("Monaco initialization: error:",_)),()=>R.current?S():b.cancel()}),Tt(()=>{if(R.current&&A.current){let b=R.current.getOriginalEditor(),_=hr(A.current,e||"",r||n||"text",i||"");_!==b.getModel()&&b.setModel(_)}},[i],E),Tt(()=>{if(R.current&&A.current){let b=R.current.getModifiedEditor(),_=hr(A.current,t||"",o||n||"text",c||"");_!==b.getModel()&&b.setModel(_)}},[c],E),Tt(()=>{let b=R.current.getModifiedEditor();b.getOption(A.current.editor.EditorOption.readOnly)?b.setValue(t||""):t!==b.getValue()&&(b.executeEdits("",[{range:b.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),b.pushUndoStop())},[t],E),Tt(()=>{var b,_;(_=(b=R.current)==null?void 0:b.getModel())==null||_.original.setValue(e||"")},[e],E),Tt(()=>{let{original:b,modified:_}=R.current.getModel();A.current.editor.setModelLanguage(b,r||n||"text"),A.current.editor.setModelLanguage(_,o||n||"text")},[n,r,o],E),Tt(()=>{var b;(b=A.current)==null||b.editor.setTheme(u)},[u],E),Tt(()=>{var b;(b=R.current)==null||b.updateOptions(s)},[s],E);let P=N.exports.useCallback(()=>{var F;if(!A.current)return;O.current(A.current);let b=hr(A.current,e||"",r||n||"text",i||""),_=hr(A.current,t||"",o||n||"text",c||"");(F=R.current)==null||F.setModel({original:b,modified:_})},[n,t,o,e,r,i,c]),B=N.exports.useCallback(()=>{var b;!I.current&&C.current&&(R.current=A.current.editor.createDiffEditor(C.current,{automaticLayout:!0,...s}),P(),(b=A.current)==null||b.editor.setTheme(u),y(!0),I.current=!0)},[s,u,P]);N.exports.useEffect(()=>{E&&x.current(R.current,A.current)},[E]),N.exports.useEffect(()=>{!w&&!E&&B()},[w,E,B]);function S(){var _,F,V,z;let b=(_=R.current)==null?void 0:_.getModel();f||((F=b==null?void 0:b.original)==null||F.dispose()),h||((V=b==null?void 0:b.modified)==null||V.dispose()),(z=R.current)==null||z.dispose()}return rt.createElement($d,{width:d,height:l,isEditorReady:E,loading:a,_ref:C,className:v,wrapperProps:p})}var EN=gN;N.exports.memo(EN);function yN(e){let t=N.exports.useRef();return N.exports.useEffect(()=>{t.current=e},[e]),t.current}var wN=yN,So=new Map;function RN({defaultValue:e,defaultLanguage:t,defaultPath:n,value:r,language:o,path:i,theme:c="light",line:f,loading:h="Loading...",options:u={},overrideServices:a={},saveViewState:s=!0,keepCurrentModel:l=!1,width:d="100%",height:v="100%",className:p,wrapperProps:m={},beforeMount:g=Br,onMount:E=Br,onChange:y,onValidate:w=Br}){let[T,R]=N.exports.useState(!1),[A,C]=N.exports.useState(!0),x=N.exports.useRef(null),O=N.exports.useRef(null),I=N.exports.useRef(null),P=N.exports.useRef(E),B=N.exports.useRef(g),S=N.exports.useRef(),b=N.exports.useRef(r),_=wN(i),F=N.exports.useRef(!1),V=N.exports.useRef(!1);Vd(()=>{let $=Dd.init();return $.then(H=>(x.current=H)&&C(!1)).catch(H=>(H==null?void 0:H.type)!=="cancelation"&&console.error("Monaco initialization: error:",H)),()=>O.current?M():$.cancel()}),Tt(()=>{var H,W,Q,te;let $=hr(x.current,e||r||"",t||o||"",i||n||"");$!==((H=O.current)==null?void 0:H.getModel())&&(s&&So.set(_,(W=O.current)==null?void 0:W.saveViewState()),(Q=O.current)==null||Q.setModel($),s&&((te=O.current)==null||te.restoreViewState(So.get(i))))},[i],T),Tt(()=>{var $;($=O.current)==null||$.updateOptions(u)},[u],T),Tt(()=>{!O.current||r===void 0||(O.current.getOption(x.current.editor.EditorOption.readOnly)?O.current.setValue(r):r!==O.current.getValue()&&(V.current=!0,O.current.executeEdits("",[{range:O.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),O.current.pushUndoStop(),V.current=!1))},[r],T),Tt(()=>{var H,W;let $=(H=O.current)==null?void 0:H.getModel();$&&o&&((W=x.current)==null||W.editor.setModelLanguage($,o))},[o],T),Tt(()=>{var $;f!==void 0&&(($=O.current)==null||$.revealLine(f))},[f],T),Tt(()=>{var $;($=x.current)==null||$.editor.setTheme(c)},[c],T);let z=N.exports.useCallback(()=>{var $;if(!(!I.current||!x.current)&&!F.current){B.current(x.current);let H=i||n,W=hr(x.current,r||e||"",t||o||"",H||"");O.current=($=x.current)==null?void 0:$.editor.create(I.current,{model:W,automaticLayout:!0,...u},a),s&&O.current.restoreViewState(So.get(H)),x.current.editor.setTheme(c),f!==void 0&&O.current.revealLine(f),R(!0),F.current=!0}},[e,t,n,r,o,i,u,a,s,c,f]);N.exports.useEffect(()=>{T&&P.current(O.current,x.current)},[T]),N.exports.useEffect(()=>{!A&&!T&&z()},[A,T,z]),b.current=r,N.exports.useEffect(()=>{var $,H;T&&y&&(($=S.current)==null||$.dispose(),S.current=(H=O.current)==null?void 0:H.onDidChangeModelContent(W=>{V.current||y(O.current.getValue(),W)}))},[T,y]),N.exports.useEffect(()=>{if(T){let $=x.current.editor.onDidChangeMarkers(H=>{var Q;let W=(Q=O.current.getModel())==null?void 0:Q.uri;if(W&&H.find(te=>te.path===W.path)){let te=x.current.editor.getModelMarkers({resource:W});w==null||w(te)}});return()=>{$==null||$.dispose()}}return()=>{}},[T,w]);function M(){var $,H;($=S.current)==null||$.dispose(),l?s&&So.set(i,O.current.saveViewState()):(H=O.current.getModel())==null||H.dispose(),O.current.dispose()}return rt.createElement($d,{width:d,height:v,isEditorReady:T,loading:h,_ref:I,className:p,wrapperProps:m})}var NN=RN,TN=N.exports.memo(NN),AN=TN;function CN(){const e=N.exports.useContext(Zr);if(!e)throw new Error("ChartDataContext is not provided");const{spec:t,setSpec:n}=e;return k("div",{children:k("div",{style:{padding:0},children:k(AN,{height:"90vh",defaultLanguage:"json",defaultValue:"{}",value:t,options:{minimap:{enabled:!1}},onChange:r=>n(r||""),beforeMount:r=>{r.languages.json.jsonDefaults.setDiagnosticsOptions({allowComments:!1,enableSchemaRequest:!0,validate:!0})}})})})}function xN(){const e=N.exports.useId(),t=N.exports.useContext(Zr);if(!t)throw new Error("ChartDataContext is not provided");const{data:n,columns:r,spec:o}=t,[i,c]=N.exports.useState();return N.exports.useEffect(()=>{e&&r&&n&&o&&(async()=>{try{await new qd().showChart(CSS.escape(`vega_${e}`),r,n,o)}catch{c("Vega-Lite specification is invalid.")}})()},[r,n,o]),k("div",{id:`vega_${e}`,children:i})}function VN(){if(!N.exports.useContext(Zr))throw new Error("ChartDataContext is not provided");const[t,n]=N.exports.useState("data"),r=o=>t===o?"tab tab-active":"tab";return Se("div",{className:"grid",children:[Se("div",{className:"cs1 ce6",children:[Se("div",{className:"tabs",children:[Se("div",{className:"tabs-header-list",style:{paddingBottom:2},children:[k("div",{className:r("data"),style:{fontWeight:"bold"},onClick:()=>n("data"),children:k("div",{className:"tab-text tab-badge",children:"Data"})}),k("div",{className:r("chart"),style:{fontWeight:"bold"},onClick:()=>n("chart"),children:k("div",{className:"tab-text tab-badge",children:"Vega-Lite"})})]}),Se("div",{style:{height:"80vh",overflow:"scroll"},children:[t==="data"&&k("div",{children:k(ER,{})}),t==="chart"&&k("div",{children:k(CN,{})})]})]}),Se("div",{style:{display:"flex",padding:2},children:[k("span",{className:"icon icon-help-question"}),k("div",{style:{paddingLeft:3},children:k("a",{href:"https://vega.github.io/vega-lite/",target:"_blank",children:"Vega-Lite Docs"})})]})]}),k("div",{className:"cs7 ce12",style:{height:"80vh",overflow:"scroll"},children:k(xN,{})})]})}export{Zr as C,$f as M,DN as O,SN as a,$N as b,PN as c,_N as d,VN as e};
