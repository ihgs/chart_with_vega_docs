import"./style.a87c9e06.js";import{r as s,j as n,F as A,a as e,c as E}from"./jsx-runtime.9f138595.js";import{c as S,C as v,M as D,O as I,a as b,b as y,d as L,e as N}from"./common.d6780a8e.js";import{C as T,a as r,G as _,M as G}from"./miro.39761233.js";const O=100,P=4,V=S(O,P);function j(){const[m,C]=s.exports.useState(""),[u,i]=s.exports.useState(!1),c=s.exports.useContext(v);if(!c)throw new Error("ChartDataContext is not provided");const{data:g,columns:h,setData:d,setColumns:x,spec:M,setSpec:f}=c,l=s.exports.useContext(D);if(!l)throw new Error("MessageContext is not provided");const{setMessage:p}=l;s.exports.useEffect(()=>{(async()=>{const a=(await miro.board.getSelection())[0];if(a){C(a.id);const o=await T.fromMetaData({data:await a.getMetadata(r.VEGA_DATA),columns:await a.getMetadata(r.COL_NAMES),spec:await a.getMetadata(r.VEGA_SPEC)});x(o.columns),d(o.data),f(o.prettierSpec())}else d(V)})()},[]);async function w(){try{const t=new _;i(!0),await t.updateGraph(m,h,g,M),await miro.board.ui.closeModal()}catch(t){console.warn(t),t instanceof G?p({error:t,detail:t}):p({message:"Vega-Lite specification is invalid.",detail:t}),i(!1)}}return n(A,{children:[u&&e(I,{}),e("div",{style:{textAlign:"right"},children:e("button",{className:"button button-primary button-small",style:{marginBottom:3},onClick:w,children:"Update Chart"})})]})}const R=()=>e("div",{className:"",children:n(b,{children:[e(y,{}),n(L,{children:[e(j,{}),e(N,{})]})]})}),B=document.getElementById("root"),F=E(B);F.render(e(R,{}));
