import{r as N,j as G,g as Zi,a as uf,b as lf,W as qe,t as ff}from"./index-rQnCqdvM.js";import{G as df}from"./miro-BztXybb3.js";const er=N.createContext(null),_E=({children:e})=>{const[r,n]=N.useState(""),[t,o]=N.useState([]),[f,l]=N.useState([]);return G.jsx(er.Provider,{value:{spec:r,setSpec:n,data:t,setData:o,columns:f,setColumns:l},children:e})};var xo={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var ba;function hf(){return ba||(ba=1,function(e){(function(){var r={}.hasOwnProperty;function n(){for(var f="",l=0;l<arguments.length;l++){var g=arguments[l];g&&(f=o(f,t(g)))}return f}function t(f){if(typeof f=="string"||typeof f=="number")return f;if(typeof f!="object")return"";if(Array.isArray(f))return n.apply(null,f);if(f.toString!==Object.prototype.toString&&!f.toString.toString().includes("[native code]"))return f.toString();var l="";for(var g in f)r.call(f,g)&&f[g]&&(l=o(l,g));return l}function o(f,l){return l?f?f+" "+l:f+l:f}e.exports?(n.default=n,e.exports=n):window.classNames=n})()}(xo)),xo.exports}var pf=hf();const sn=Zi(pf);var bo,La;function ao(){if(La)return bo;La=1;class e{constructor(n,t){if(n==null&&t==null)this._data=[],this._refs=[];else{if(n.length!==t.length)throw Error("Collection: data length should match references length.");this._data=n,this._refs=t}}get data(){return this._data}get refs(){return this._refs}get length(){return this._data.length}add(n,t){this._data.push(n),this._refs.push(t)}}return bo=e,bo}var Lo,Ua;function Ve(){if(Ua)return Lo;Ua=1;const e=Fe(),r=ao(),n={NUMBER:0,ARRAY:1,BOOLEAN:2,STRING:3,RANGE_REF:4,CELL_REF:5,COLLECTIONS:6,NUMBER_NO_BOOLEAN:10},t=[1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,6227020800,87178291200,1307674368e3,20922789888e3,355687428096e3,6402373705728e3,121645100408832e3,243290200817664e4,5109094217170944e4,11240007277776077e5,2585201673888498e7,6204484017332394e8,15511210043330986e9,40329146112660565e10,10888869450418352e12,30488834461171387e13,8841761993739702e15,26525285981219107e16,8222838654177922e18,2631308369336935e20,8683317618811886e21,29523279903960416e22,10333147966386145e24,37199332678990125e25,13763753091226346e27,5230226174666011e29,20397882081197444e30,8159152832478977e32,3345252661316381e34,140500611775288e37,6041526306337383e37,2658271574788449e39,11962222086548019e40,5502622159812089e42,25862324151116818e43,12413915592536073e45,6082818640342675e47,30414093201713376e48,15511187532873822e50,8065817517094388e52,42748832840600255e53,2308436973392414e56,12696403353658276e57,7109985878048635e59,40526919504877214e60,23505613312828785e62,13868311854568984e64,832098711274139e67,5075802138772248e68,3146997326038794e70,198260831540444e73,12688693218588417e73,8247650592082472e75,5443449390774431e77,3647111091818868e79,24800355424368305e80,1711224524281413e83,11978571669969892e84,8504785885678623e86,61234458376886085e87,44701154615126844e89,3307885441519386e92,248091408113954e95,18854947016660504e95,14518309202828587e97,11324281178206297e99,8946182130782976e101,7156945704626381e103,5797126020747368e105,4753643337012842e107,3945523969720659e109,3314240134565353e111,281710411438055e114,24227095383672734e114,2107757298379528e117,18548264225739844e118,1650795516090846e121,14857159644817615e122,1352001527678403e125,12438414054641308e126,11567725070816416e128,1087366156656743e131,1032997848823906e133,9916779348709496e134,9619275968248212e136,9426890448883248e138,9332621544394415e140,9332621544394415e142],o={};Object.keys(n).forEach(i=>{o[n[i]]=i});class f{constructor(){this.Types=n,this.type2Number={number:n.NUMBER,boolean:n.BOOLEAN,string:n.STRING,object:-1}}checkFunctionResult(a){if(typeof a==="number"){if(isNaN(a))return e.VALUE;if(!isFinite(a))return e.NUM}return a??e.NULL}flattenDeep(a){return a.reduce((s,u)=>Array.isArray(u)?s.concat(this.flattenDeep(u)):s.concat(u),[])}acceptNumber(a,s=!0,u=!0){if(a instanceof e)return a;let v;if(typeof a=="number")v=a;else if(typeof a=="boolean")if(u)v=Number(a);else throw e.VALUE;else if(typeof a=="string"){if(a.length===0||(v=Number(a),v!==v))throw e.VALUE}else if(Array.isArray(a))if(s)v=this.acceptNumber(a[0][0]);else if(a[0].length===1)v=this.acceptNumber(a[0][0]);else throw e.VALUE;else throw Error("Unknown type in FormulaHelpers.acceptNumber");return v}flattenParams(a,s,u,v,h=null,p=1){if(a.length<p)throw e.ARG_MISSING([s]);h==null&&(h=s===n.NUMBER?0:s==null?null:""),a.forEach(m=>{const{isCellRef:E,isRangeRef:y,isArray:w}=m,T=m.value instanceof r,R=!E&&!y&&!w&&!T,A={isLiteral:R,isCellRef:E,isRangeRef:y,isArray:w,isUnion:T};if(R)m.omitted?m=h:m=this.accept(m,s,h),v(m,A);else if(E)v(m.value,A);else if(T){if(!u)throw e.VALUE;m=m.value.data,m=this.flattenDeep(m),m.forEach(O=>{v(O,A)})}else(y||w)&&(m=this.flattenDeep(m.value),m.forEach(O=>{v(O,A)}))})}accept(a,s=null,u,v=!0,h=!1){if(Array.isArray(s)&&(s=s[0]),a==null&&u===void 0)throw e.ARG_MISSING([s]);if(a==null)return u;if(typeof a!="object"||Array.isArray(a))return a;const p=a.isArray;if(a.value!=null&&(a=a.value),s==null)return a;if(a instanceof e)throw a;if(s===n.ARRAY){if(Array.isArray(a))return v?this.flattenDeep(a):a;if(a instanceof r)throw e.VALUE;if(h)return v?[a]:[[a]];throw e.VALUE}else if(s===n.COLLECTIONS)return a;p&&(a=a[0][0]);const m=this.type(a);if(s===n.STRING)m===n.BOOLEAN?a=a?"TRUE":"FALSE":a=`${a}`;else if(s===n.BOOLEAN){if(m===n.STRING)throw e.VALUE;m===n.NUMBER&&(a=!!a)}else if(s===n.NUMBER)a=this.acceptNumber(a,!1);else if(s===n.NUMBER_NO_BOOLEAN)a=this.acceptNumber(a,!1,!1);else throw e.VALUE;return a}type(a){let s=this.type2Number[typeof a];return s===-1&&(Array.isArray(a)?s=n.ARRAY:a.ref?a.ref.from?s=n.RANGE_REF:s=n.CELL_REF:a instanceof r&&(s=n.COLLECTIONS)),s}isRangeRef(a){return a.ref&&a.ref.from}isCellRef(a){return a.ref&&!a.ref.from}retrieveRanges(a,s,u){return u=c.extend(s,u),s=this.retrieveArg(a,s),s=l.accept(s,n.ARRAY,void 0,!1,!0),u!==s?(u=this.retrieveArg(a,u),u=l.accept(u,n.ARRAY,void 0,!1,!0)):u=s,[s,u]}retrieveArg(a,s){if(s===null)return{value:0,isArray:!1,omitted:!0};const u=a.utils.extractRefValue(s);return{value:u.val,isArray:u.isArray,ref:s.ref}}}const l=new f,g={isWildCard:i=>typeof i=="string"?/[*?]/.test(i):!1,toRegex:(i,a)=>RegExp(i.replace(/[.+^${}()|[\]\\]/g,"\\$&").replace(/([^~]??)[?]/g,"$1.").replace(/([^~]??)[*]/g,"$1.*").replace(/~([?*])/g,"$1"),a)},d={parse:i=>{const a=typeof i;if(a==="string"){const s=i.toUpperCase();if(s==="TRUE"||s==="FALSE")return{op:"=",value:s==="TRUE"};const u=i.match(/(<>|>=|<=|>|<|=)(.*)/);if(u){let v=u[1],h;if(isNaN(u[2])){const p=u[2].toUpperCase();if(p==="TRUE"||p==="FALSE")h=p==="TRUE";else if(/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A|#REF!/.test(u[2]))h=new e(u[2]);else if(h=u[2],g.isWildCard(h))return{op:"wc",value:g.toRegex(h),match:v==="="}}else h=Number(u[2]);return{op:v,value:h}}else return g.isWildCard(i)?{op:"wc",value:g.toRegex(i),match:!0}:{op:"=",value:i}}else{if(a==="boolean"||a==="number"||Array.isArray(i)||i instanceof e)return{op:"=",value:i};throw Error(`Criteria.parse: type ${typeof i} not support`)}}},c={columnNumberToName:i=>{let a=i,s="",u=0;for(;a>0;)u=(a-1)%26,s=String.fromCharCode(65+u)+s,a=Math.floor((a-u)/26);return s},columnNameToNumber:i=>{i=i.toUpperCase();const a=i.length;let s=0;for(let u=0;u<a;u++){const v=i.charCodeAt(u);isNaN(v)||(s+=(v-64)*26**(a-u-1))}return s},extend:(i,a)=>{if(a==null)return i;let s,u;if(l.isCellRef(i))s=0,u=0;else if(l.isRangeRef(i))s=i.ref.to.row-i.ref.from.row,u=i.ref.to.col-i.ref.from.col;else throw Error("Address.extend should not reach here.");return l.isCellRef(a)?(s>0||u>0)&&(a={ref:{from:{col:a.ref.col,row:a.ref.row},to:{row:a.ref.row+s,col:a.ref.col+u}}}):(a.ref.to.row=a.ref.from.row+s,a.ref.to.col=a.ref.from.col+u),a}};return Lo={FormulaHelpers:l,Types:n,ReversedTypes:o,Factorials:t,WildCard:g,Criteria:d,Address:c},Lo}var Uo,ka;function Fe(){if(ka)return Uo;ka=1;class e extends Error{constructor(n,t,o){if(super(t),t==null&&o==null&&e.errorMap.has(n))return e.errorMap.get(n);t==null&&o==null?(this._error=n,e.errorMap.set(n,this)):this._error=n,this.details=o}get error(){return this._error}get name(){return this._error}equals(n){return n instanceof e&&n._error===this._error}toString(){return this._error}}return e.errorMap=new Map,e.DIV0=new e("#DIV/0!"),e.NA=new e("#N/A"),e.NAME=new e("#NAME?"),e.NULL=new e("#NULL!"),e.NUM=new e("#NUM!"),e.REF=new e("#REF!"),e.VALUE=new e("#VALUE!"),e.NOT_IMPLEMENTED=r=>new e("#NAME?",`Function ${r} is not implemented.`),e.TOO_MANY_ARGS=r=>new e("#N/A",`Function ${r} has too many arguments.`),e.ARG_MISSING=r=>{const{Types:n}=Ve();return new e("#N/A",`Argument type ${r.map(t=>n[t]).join(", ")} is missing.`)},e.ERROR=(r,n)=>new e("#ERROR!",r,n),Uo=e,Uo}var ko,Pa;function Nc(){if(Pa)return ko;Pa=1;class e{}e.version="0.10.3";function r(I){let _="",C=I.length-1;for(;C>=0;)_+=I.charAt(C--);return _}function n(I,_){let C="";for(;C.length<_;)C+=I;return C}function t(I,_){let C=""+I;return C.length>=_?C:n("0",_-C.length)+C}function o(I,_){let C=""+I;return C.length>=_?C:n(" ",_-C.length)+C}function f(I,_){let C=""+I;return C.length>=_?C:C+n(" ",_-C.length)}function l(I,_){let C=""+Math.round(I);return C.length>=_?C:n("0",_-C.length)+C}function g(I,_){let C=""+I;return C.length>=_?C:n("0",_-C.length)+C}const d=Math.pow(2,32);function c(I,_){if(I>d||I<-d)return l(I,_);const C=Math.round(I);return g(C,_)}function i(I,_){return _=_||0,I.length>=7+_&&(I.charCodeAt(_)|32)===103&&(I.charCodeAt(_+1)|32)===101&&(I.charCodeAt(_+2)|32)===110&&(I.charCodeAt(_+3)|32)===101&&(I.charCodeAt(_+4)|32)===114&&(I.charCodeAt(_+5)|32)===97&&(I.charCodeAt(_+6)|32)===108}const a=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],s=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function u(I){I[0]="General",I[1]="0",I[2]="0.00",I[3]="#,##0",I[4]="#,##0.00",I[9]="0%",I[10]="0.00%",I[11]="0.00E+00",I[12]="# ?/?",I[13]="# ??/??",I[14]="m/d/yy",I[15]="d-mmm-yy",I[16]="d-mmm",I[17]="mmm-yy",I[18]="h:mm AM/PM",I[19]="h:mm:ss AM/PM",I[20]="h:mm",I[21]="h:mm:ss",I[22]="m/d/yy h:mm",I[37]="#,##0 ;(#,##0)",I[38]="#,##0 ;[Red](#,##0)",I[39]="#,##0.00;(#,##0.00)",I[40]="#,##0.00;[Red](#,##0.00)",I[45]="mm:ss",I[46]="[h]:mm:ss",I[47]="mmss.0",I[48]="##0.0E+0",I[49]="@",I[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',I[65535]="General"}const v={};u(v);function h(I,_,C){const P=I<0?-1:1;let x=I*P,z=0,L=1,V=0,te=1,j=0,ne=0,ie=Math.floor(x);for(;j<_&&(ie=Math.floor(x),V=ie*L+z,ne=ie*j+te,!(x-ie<5e-8));)x=1/(x-ie),z=L,L=V,te=j,j=ne;if(ne>_&&(j>_?(ne=te,V=z):(ne=j,V=L)),!C)return[0,P*V,ne];const he=Math.floor(P*V/ne);return[he,P*V-he*ne,ne]}function p(I,_,C){if(I>2958465||I<0)return null;let P=I|0,x=Math.floor(86400*(I-P)),z=0,L=[];const V={D:P,T:x,u:86400*(I-P)-x,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(V.u)<1e-6&&(V.u=0),_&&_.date1904&&(P+=1462),V.u>.9999&&(V.u=0,++x===86400&&(V.T=x=0,++P,++V.D)),P===60)L=C?[1317,10,29]:[1900,2,29],z=3;else if(P===0)L=C?[1317,8,29]:[1900,1,0],z=6;else{P>60&&--P;const te=new Date(1900,0,1);te.setDate(te.getDate()+P-1),L=[te.getFullYear(),te.getMonth()+1,te.getDate()],z=te.getDay(),P<60&&(z=(z+6)%7),C&&(z=O())}return V.y=L[0],V.m=L[1],V.d=L[2],V.S=x%60,x=Math.floor(x/60),V.M=x%60,x=Math.floor(x/60),V.H=x,V.q=z,V}e.parse_date_code=p;const m=new Date(1899,11,31,0,0,0),E=m.getTime(),y=new Date(1900,2,1,0,0,0);function w(I,_){let C=I.getTime();return _?C-=1461*24*60*60*1e3:I>=y&&(C+=24*60*60*1e3),(C-(E+(I.getTimezoneOffset()-m.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function T(I){return I.toString(10)}e._general_int=T;const R=function(){const _=/\.(\d*[1-9])0+$/,C=/\.0*$/,P=/\.(\d*[1-9])0+/,x=/\.0*[Ee]/,z=/(E[+-])(\d)$/;function L(ne){const ie=ne<0?12:11;let he=j(ne.toFixed(12));return he.length<=ie||(he=ne.toPrecision(10),he.length<=ie)?he:ne.toExponential(5)}function V(ne){let ie=ne.toFixed(11).replace(_,".$1");return ie.length>(ne<0?12:11)&&(ie=ne.toPrecision(6)),ie}function te(ne){for(let ie=0;ie!==ne.length;++ie)if((ne.charCodeAt(ie)|32)===101)return ne.replace(P,".$1").replace(x,"E").replace("e","E").replace(z,"$10$2");return ne}function j(ne){return ne.indexOf(".")>-1?ne.replace(C,"").replace(_,".$1"):ne}return function(ie){let he=Math.floor(Math.log(Math.abs(ie))*Math.LOG10E),ce;return he>=-4&&he<=-1?ce=ie.toPrecision(10+he):Math.abs(he)<=9?ce=L(ie):he===10?ce=ie.toFixed(10).substr(0,12):ce=V(ie),j(te(ce))}}();e._general_num=R;function A(I,_){switch(typeof I){case"string":return I;case"boolean":return I?"TRUE":"FALSE";case"number":return(I|0)===I?T(I):R(I);case"undefined":return"";case"object":if(I==null)return"";if(I instanceof Date)return D(14,w(I,_&&_.date1904),_)}throw new Error("unsupported value in General format: "+I)}e._general=A;function O(){return 0}function M(I,_,C,P){let x="",z=0,L=0,V=C.y,te,j=0;switch(I){case 98:V=C.y+543;case 121:switch(_.length){case 1:case 2:te=V%100,j=2;break;default:te=V%1e4,j=4;break}break;case 109:switch(_.length){case 1:case 2:te=C.m,j=_.length;break;case 3:return s[C.m-1][1];case 5:return s[C.m-1][0];default:return s[C.m-1][2]}break;case 100:switch(_.length){case 1:case 2:te=C.d,j=_.length;break;case 3:return a[C.q][0];default:return a[C.q][1]}break;case 104:switch(_.length){case 1:case 2:te=1+(C.H+11)%12,j=_.length;break;default:throw"bad hour format: "+_}break;case 72:switch(_.length){case 1:case 2:te=C.H,j=_.length;break;default:throw"bad hour format: "+_}break;case 77:switch(_.length){case 1:case 2:te=C.M,j=_.length;break;default:throw"bad minute format: "+_}break;case 115:if(_!=="s"&&_!=="ss"&&_!==".0"&&_!==".00"&&_!==".000")throw"bad second format: "+_;return C.u===0&&(_==="s"||_==="ss")?t(C.S,_.length):(P>=2?L=P===3?1e3:100:L=P===1?10:1,z=Math.round(L*(C.S+C.u)),z>=60*L&&(z=0),_==="s"?z===0?"0":""+z/L:(x=t(z,2+P),_==="ss"?x.substr(0,2):"."+x.substr(2,_.length-1)));case 90:switch(_){case"[h]":case"[hh]":te=C.D*24+C.H;break;case"[m]":case"[mm]":te=(C.D*24+C.H)*60+C.M;break;case"[s]":case"[ss]":te=((C.D*24+C.H)*60+C.M)*60+Math.round(C.S+C.u);break;default:throw"bad abstime format: "+_}j=_.length===3?1:2;break;case 101:te=V,j=1}return j>0?t(te,j):""}function b(I){if(I.length<=3)return I;let C=I.length%3,P=I.substr(0,C);for(;C!==I.length;C+=3)P+=(P.length>0?",":"")+I.substr(C,3);return P}const k=function(){const _=/%/g;function C(X,U,B){const q=U.replace(_,""),K=U.length-q.length;return k(X,q,B*Math.pow(10,2*K))+n("%",K)}function P(X,U,B){let q=U.length-1;for(;U.charCodeAt(q-1)===44;)--q;return k(X,U.substr(0,q),B/Math.pow(10,3*(U.length-q)))}function x(X,U){let B,q=X.indexOf("E")-X.indexOf(".")-1;if(X.match(/^#+0.0E\+0$/)){if(U===0)return"0.0E+0";if(U<0)return"-"+x(X,-U);let K=X.indexOf(".");K===-1&&(K=X.indexOf("E"));let se=Math.floor(Math.log(U)*Math.LOG10E)%K;if(se<0&&(se+=K),B=(U/Math.pow(10,se)).toPrecision(q+1+(K+se)%K),B.indexOf("e")===-1){const Ee=Math.floor(Math.log(U)*Math.LOG10E);for(B.indexOf(".")===-1?B=B.charAt(0)+"."+B.substr(1)+"E+"+(Ee-B.length+se):B+="E+"+(Ee-se);B.substr(0,2)==="0.";)B=B.charAt(0)+B.substr(2,K)+"."+B.substr(2+K),B=B.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");B=B.replace(/\+-/,"-")}B=B.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(Ee,Te,Ce,ve){return Te+Ce+ve.substr(0,(K+se)%K)+"."+ve.substr(se)+"E"})}else B=U.toExponential(q);return X.match(/E\+00$/)&&B.match(/e[+-]\d$/)&&(B=B.substr(0,B.length-1)+"0"+B.charAt(B.length-1)),X.match(/E\-/)&&B.match(/e\+/)&&(B=B.replace(/e\+/,"e")),B.replace("e","E")}const z=/# (\?+)( ?)\/( ?)(\d+)/;function L(X,U,B){const q=parseInt(X[4],10),K=Math.round(U*q),se=Math.floor(K/q);let Ee=K-se*q,Te=q;return B+(se===0?"":""+se)+" "+(Ee===0?n(" ",X[1].length+1+X[4].length):o(Ee,X[1].length)+X[2]+"/"+X[3]+t(Te,X[4].length))}function V(X,U,B){return B+(U===0?"":""+U)+n(" ",X[1].length+2+X[4].length)}const te=/^#*0*\.([0#]+)/,j=/\).*[0#]/,ne=/\(###\) ###\\?-####/;function ie(X){let U="",B;for(let q=0;q!==X.length;++q)switch(B=X.charCodeAt(q)){case 35:break;case 63:U+=" ";break;case 48:U+="0";break;default:U+=String.fromCharCode(B)}return U}function he(X,U){const B=Math.pow(10,U);return""+Math.round(X*B)/B}function ce(X,U){return U<(""+Math.round((X-Math.floor(X))*Math.pow(10,U))).length?0:Math.round((X-Math.floor(X))*Math.pow(10,U))}function Ae(X,U){return U<(""+Math.round((X-Math.floor(X))*Math.pow(10,U))).length?1:0}function we(X){return X<2147483647&&X>-2147483648?""+(X>=0?X|0:X-1|0):""+Math.floor(X)}function de(X,U,B){if(X.charCodeAt(0)===40&&!U.match(j)){const ge=U.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return B>=0?de("n",ge,B):"("+de("n",ge,-B)+")"}if(U.charCodeAt(U.length-1)===44)return P(X,U,B);if(U.indexOf("%")!==-1)return C(X,U,B);if(U.indexOf("E")!==-1)return x(U,B);if(U.charCodeAt(0)===36)return"$"+de(X,U.substr(U.charAt(1)==" "?2:1),B);let q,K,se,Ee,Te=Math.abs(B),Ce=B<0?"-":"";if(U.match(/^00+$/))return Ce+c(Te,U.length);if(U.match(/^[#?]+$/))return q=c(B,0),q==="0"&&(q=""),q.length>U.length?q:ie(U.substr(0,U.length-q.length))+q;if(K=U.match(z))return L(K,Te,Ce);if(U.match(/^#+0+$/))return Ce+c(Te,U.length-U.indexOf("0"));if(K=U.match(te))return q=he(B,K[1].length).replace(/^([^\.]+)$/,"$1."+ie(K[1])).replace(/\.$/,"."+ie(K[1])).replace(/\.(\d*)$/,function(ge,Ye){return"."+Ye+n("0",ie(K[1]).length-Ye.length)}),U.indexOf("0.")!==-1?q:q.replace(/^0\./,".");if(U=U.replace(/^#+([0.])/,"$1"),K=U.match(/^(0*)\.(#*)$/))return Ce+he(Te,K[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,K[1].length?"0.":".");if(K=U.match(/^#{1,3},##0(\.?)$/))return Ce+b(c(Te,0));if(K=U.match(/^#,##0\.([#0]*0)$/))return B<0?"-"+de(X,U,-B):b(""+(Math.floor(B)+Ae(B,K[1].length)))+"."+t(ce(B,K[1].length),K[1].length);if(K=U.match(/^#,#*,#0/))return de(X,U.replace(/^#,#*,/,""),B);if(K=U.match(/^([0#]+)(\\?-([0#]+))+$/))return q=r(de(X,U.replace(/[\\-]/g,""),B)),se=0,r(r(U.replace(/\\/g,"")).replace(/[0#]/g,function(ge){return se<q.length?q.charAt(se++):ge==="0"?"0":""}));if(U.match(ne))return q=de(X,"##########",B),"("+q.substr(0,3)+") "+q.substr(3,3)+"-"+q.substr(6);let ve="";if(K=U.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return se=Math.min(K[4].length,7),Ee=h(Te,Math.pow(10,se)-1,!1),q=""+Ce,ve=k("n",K[1],Ee[1]),ve.charAt(ve.length-1)===" "&&(ve=ve.substr(0,ve.length-1)+"0"),q+=ve+K[2]+"/"+K[3],ve=f(Ee[2],se),ve.length<K[4].length&&(ve=ie(K[4].substr(K[4].length-ve.length))+ve),q+=ve,q;if(K=U.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return se=Math.min(Math.max(K[1].length,K[4].length),7),Ee=h(Te,Math.pow(10,se)-1,!0),Ce+(Ee[0]||(Ee[1]?"":"0"))+" "+(Ee[1]?o(Ee[1],se)+K[2]+"/"+K[3]+f(Ee[2],se):n(" ",2*se+1+K[2].length+K[3].length));if(K=U.match(/^[#0?]+$/))return q=c(B,0),U.length<=q.length?q:ie(U.substr(0,U.length-q.length))+q;if(K=U.match(/^([#0?]+)\.([#0]+)$/)){q=""+B.toFixed(Math.min(K[2].length,10)).replace(/([^0])0+$/,"$1"),se=q.indexOf(".");const ge=U.indexOf(".")-se,Ye=U.length-q.length-ge;return ie(U.substr(0,ge)+q+U.substr(U.length-Ye))}if(K=U.match(/^00,000\.([#0]*0)$/))return se=ce(B,K[1].length),B<0?"-"+de(X,U,-B):b(we(B)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(ge){return"00,"+(ge.length<3?t(0,3-ge.length):"")+ge})+"."+t(se,K[1].length);switch(U){case"###,##0.00":return de(X,"#,##0.00",B);case"###,###":case"##,###":case"#,###":const ge=b(c(Te,0));return ge!=="0"?Ce+ge:"";case"###,###.00":return de(X,"###,##0.00",B).replace(/^0\./,".");case"#,###.00":return de(X,"#,##0.00",B).replace(/^0\./,".")}throw new Error("unsupported format |"+U+"|")}function ae(X,U,B){let q=U.length-1;for(;U.charCodeAt(q-1)===44;)--q;return k(X,U.substr(0,q),B/Math.pow(10,3*(U.length-q)))}function me(X,U,B){const q=U.replace(_,""),K=U.length-q.length;return k(X,q,B*Math.pow(10,2*K))+n("%",K)}function Ne(X,U){let B,q=X.indexOf("E")-X.indexOf(".")-1;if(X.match(/^#+0.0E\+0$/)){if(U===0)return"0.0E+0";if(U<0)return"-"+Ne(X,-U);let K=X.indexOf(".");K===-1&&(K=X.indexOf("E"));let se=Math.floor(Math.log(U)*Math.LOG10E)%K;if(se<0&&(se+=K),B=(U/Math.pow(10,se)).toPrecision(q+1+(K+se)%K),!B.match(/[Ee]/)){const Ee=Math.floor(Math.log(U)*Math.LOG10E);B.indexOf(".")===-1?B=B.charAt(0)+"."+B.substr(1)+"E+"+(Ee-B.length+se):B+="E+"+(Ee-se),B=B.replace(/\+-/,"-")}B=B.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(Ee,Te,Ce,ve){return Te+Ce+ve.substr(0,(K+se)%K)+"."+ve.substr(se)+"E"})}else B=U.toExponential(q);return X.match(/E\+00$/)&&B.match(/e[+-]\d$/)&&(B=B.substr(0,B.length-1)+"0"+B.charAt(B.length-1)),X.match(/E\-/)&&B.match(/e\+/)&&(B=B.replace(/e\+/,"e")),B.replace("e","E")}function fe(X,U,B){if(X.charCodeAt(0)===40&&!U.match(j)){const ge=U.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return B>=0?fe("n",ge,B):"("+fe("n",ge,-B)+")"}if(U.charCodeAt(U.length-1)===44)return ae(X,U,B);if(U.indexOf("%")!==-1)return me(X,U,B);if(U.indexOf("E")!==-1)return Ne(U,B);if(U.charCodeAt(0)===36)return"$"+fe(X,U.substr(U.charAt(1)==" "?2:1),B);let q,K,se,Ee,Te=Math.abs(B),Ce=B<0?"-":"";if(U.match(/^00+$/))return Ce+t(Te,U.length);if(U.match(/^[#?]+$/))return q=""+B,B===0&&(q=""),q.length>U.length?q:ie(U.substr(0,U.length-q.length))+q;if(K=U.match(z))return V(K,Te,Ce);if(U.match(/^#+0+$/))return Ce+t(Te,U.length-U.indexOf("0"));if(K=U.match(te))return q=(""+B).replace(/^([^\.]+)$/,"$1."+ie(K[1])).replace(/\.$/,"."+ie(K[1])),q=q.replace(/\.(\d*)$/,function(ge,Ye){return"."+Ye+n("0",ie(K[1]).length-Ye.length)}),U.indexOf("0.")!==-1?q:q.replace(/^0\./,".");if(U=U.replace(/^#+([0.])/,"$1"),K=U.match(/^(0*)\.(#*)$/))return Ce+(""+Te).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,K[1].length?"0.":".");if(K=U.match(/^#{1,3},##0(\.?)$/))return Ce+b(""+Te);if(K=U.match(/^#,##0\.([#0]*0)$/))return B<0?"-"+fe(X,U,-B):b(""+B)+"."+n("0",K[1].length);if(K=U.match(/^#,#*,#0/))return fe(X,U.replace(/^#,#*,/,""),B);if(K=U.match(/^([0#]+)(\\?-([0#]+))+$/))return q=r(fe(X,U.replace(/[\\-]/g,""),B)),se=0,r(r(U.replace(/\\/g,"")).replace(/[0#]/g,function(ge){return se<q.length?q.charAt(se++):ge==="0"?"0":""}));if(U.match(ne))return q=fe(X,"##########",B),"("+q.substr(0,3)+") "+q.substr(3,3)+"-"+q.substr(6);let ve="";if(K=U.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return se=Math.min(K[4].length,7),Ee=h(Te,Math.pow(10,se)-1,!1),q=""+Ce,ve=k("n",K[1],Ee[1]),ve.charAt(ve.length-1)==" "&&(ve=ve.substr(0,ve.length-1)+"0"),q+=ve+K[2]+"/"+K[3],ve=f(Ee[2],se),ve.length<K[4].length&&(ve=ie(K[4].substr(K[4].length-ve.length))+ve),q+=ve,q;if(K=U.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return se=Math.min(Math.max(K[1].length,K[4].length),7),Ee=h(Te,Math.pow(10,se)-1,!0),Ce+(Ee[0]||(Ee[1]?"":"0"))+" "+(Ee[1]?o(Ee[1],se)+K[2]+"/"+K[3]+f(Ee[2],se):n(" ",2*se+1+K[2].length+K[3].length));if(K=U.match(/^[#0?]+$/))return q=""+B,U.length<=q.length?q:ie(U.substr(0,U.length-q.length))+q;if(K=U.match(/^([#0]+)\.([#0]+)$/)){q=""+B.toFixed(Math.min(K[2].length,10)).replace(/([^0])0+$/,"$1"),se=q.indexOf(".");let ge=U.indexOf(".")-se,Ye=U.length-q.length-ge;return ie(U.substr(0,ge)+q+U.substr(U.length-Ye))}if(K=U.match(/^00,000\.([#0]*0)$/))return B<0?"-"+fe(X,U,-B):b(""+B).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(ge){return"00,"+(ge.length<3?t(0,3-ge.length):"")+ge})+"."+t(0,K[1].length);switch(U){case"###,###":case"##,###":case"#,###":const ge=b(""+Te);return ge!=="0"?Ce+ge:"";default:if(U.match(/\.[0#?]*$/))return fe(X,U.slice(0,U.lastIndexOf(".")),B)+ie(U.slice(U.lastIndexOf(".")))}throw new Error("unsupported format |"+U+"|")}return function(U,B,q){return(q|0)===q?fe(U,B,q):de(U,B,q)}}();function F(I){const _=[];let C=!1,P=0;for(let x=0;x<I.length;++x)switch(I.charCodeAt(x)){case 34:C=!C;break;case 95:case 42:case 92:++x;break;case 59:_[_.length]=I.substr(P,x-P),P=x+1}if(_[_.length]=I.substr(P),C===!0)throw new Error("Format |"+I+"| unterminated string ");return _}e._split=F;const $=/\[[HhMmSs]*\]/;function Y(I){let _=0,C="",P="";for(;_<I.length;)switch(C=I.charAt(_)){case"G":i(I,_)&&(_+=6),_++;break;case'"':for(;I.charCodeAt(++_)!==34&&_<I.length;)++_;++_;break;case"\\":_+=2;break;case"_":_+=2;break;case"@":++_;break;case"B":case"b":if(I.charAt(_+1)==="1"||I.charAt(_+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":if(I.substr(_,3).toUpperCase()==="A/P"||I.substr(_,5).toUpperCase()==="AM/PM")return!0;++_;break;case"[":for(P=C;I.charAt(_++)!=="]"&&_<I.length;)P+=I.charAt(_);if(P.match($))return!0;break;case".":case"0":case"#":for(;_<I.length&&("0#?.,E+-%".indexOf(C=I.charAt(++_))>-1||C=="\\"&&I.charAt(_+1)=="-"&&"0#".indexOf(I.charAt(_+2))>-1););break;case"?":for(;I.charAt(++_)===C;);break;case"*":++_,(I.charAt(_)===" "||I.charAt(_)==="*")&&++_;break;case"(":case")":++_;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;_<I.length&&"0123456789".indexOf(I.charAt(++_))>-1;);break;case" ":++_;break;default:++_;break}return!1}e.is_date=Y;function W(I,_,C,P){let x=[],z="",L=0,V="",te="t",j,ne,ie,he="H";for(;L<I.length;)switch(V=I.charAt(L)){case"G":if(!i(I,L))throw new Error("unrecognized character "+V+" in "+I);x[x.length]={t:"G",v:"General"},L+=7;break;case'"':for(z="";(ie=I.charCodeAt(++L))!==34&&L<I.length;)z+=String.fromCharCode(ie);x[x.length]={t:"t",v:z},++L;break;case"\\":const U=I.charAt(++L),B=U==="("||U===")"?U:"t";x[x.length]={t:B,v:U},++L;break;case"_":x[x.length]={t:"t",v:" "},L+=2;break;case"@":x[x.length]={t:"T",v:_},++L;break;case"B":case"b":if(I.charAt(L+1)==="1"||I.charAt(L+1)==="2"){if(j==null&&(j=p(_,C,I.charAt(L+1)==="2"),j==null))return"";x[x.length]={t:"X",v:I.substr(L,2)},te=V,L+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":V=V.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(_<0||j==null&&(j=p(_,C),j==null))return"";for(z=V;++L<I.length&&I.charAt(L).toLowerCase()===V;)z+=V;V==="m"&&te.toLowerCase()==="h"&&(V="M"),V==="h"&&(V=he),x[x.length]={t:V,v:z},te=V;break;case"A":case"a":const q={t:V,v:V};if(j==null&&(j=p(_,C)),I.substr(L,3).toUpperCase()==="A/P"?(j!=null&&(q.v=j.H>=12?"P":"A"),q.t="T",he="h",L+=3):I.substr(L,5).toUpperCase()==="AM/PM"?(j!=null&&(q.v=j.H>=12?"PM":"AM"),q.t="T",L+=5,he="h"):(q.t="t",++L),j==null&&q.t==="T")return"";x[x.length]=q,te=V;break;case"[":for(z=V;I.charAt(L++)!=="]"&&L<I.length;)z+=I.charAt(L);if(z.slice(-1)!=="]")throw'unterminated "[" block: |'+z+"|";if(z.match($)){if(j==null&&(j=p(_,C),j==null))return"";x[x.length]={t:"Z",v:z.toLowerCase()},te=z.charAt(1)}else z.indexOf("$")>-1&&(z=(z.match(/\$([^-\[\]]*)/)||[])[1]||"$",Y(I)||(x[x.length]={t:"t",v:z}));break;case".":if(j!=null){for(z=V;++L<I.length&&(V=I.charAt(L))==="0";)z+=V;x[x.length]={t:"s",v:z};break}case"0":case"#":for(z=V;++L<I.length&&"0#?.,E+-%".indexOf(V=I.charAt(L))>-1||V=="\\"&&I.charAt(L+1)=="-"&&L<I.length-2&&"0#".indexOf(I.charAt(L+2))>-1;)z+=V;x[x.length]={t:"n",v:z};break;case"?":for(z=V;I.charAt(++L)===V;)z+=V;x[x.length]={t:V,v:z},te=V;break;case"*":++L,(I.charAt(L)===" "||I.charAt(L)==="*")&&++L;break;case"(":case")":x[x.length]={t:P===1||typeof _=="number"&&_<0?"t":V,v:V},++L;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(z=V;L<I.length&&"0123456789".indexOf(I.charAt(++L))>-1;)z+=I.charAt(L);x[x.length]={t:"D",v:z};break;case" ":x[x.length]={t:V,v:V},++L;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(V)===-1)throw new Error("unrecognized character "+V+" in "+I);x[x.length]={t:"t",v:V},++L;break}let ce=0,Ae=0,we;for(L=x.length-1,te="t";L>=0;--L)switch(x[L].t){case"h":case"H":x[L].t=he,te="h",ce<1&&(ce=1);break;case"s":(we=x[L].v.match(/\.0+$/))&&(Ae=Math.max(Ae,we[0].length-1)),ce<3&&(ce=3);case"d":case"y":case"M":case"e":te=x[L].t;break;case"m":te==="s"&&(x[L].t="M",ce<2&&(ce=2));break;case"X":break;case"Z":ce<1&&x[L].v.match(/[Hh]/)&&(ce=1),ce<2&&x[L].v.match(/[Mm]/)&&(ce=2),ce<3&&x[L].v.match(/[Ss]/)&&(ce=3)}switch(ce){case 0:break;case 1:j.u>=.5&&(j.u=0,++j.S),j.S>=60&&(j.S=0,++j.M),j.M>=60&&(j.M=0,++j.H);break;case 2:j.u>=.5&&(j.u=0,++j.S),j.S>=60&&(j.S=0,++j.M);break}let de="",ae;for(L=0;L<x.length;++L)switch(x[L].t){case"t":case"T":case" ":case"D":break;case"X":x[L].v="",x[L].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":x[L].v=M(x[L].t.charCodeAt(0),x[L].v,j,Ae),x[L].t="t";break;case"n":case"(":case"?":for(ae=L+1;x[ae]!=null&&((V=x[ae].t)==="?"||V==="D"||(V===" "||V==="t")&&x[ae+1]!=null&&(x[ae+1].t==="?"||x[ae+1].t==="t"&&x[ae+1].v==="/")||x[L].t==="("&&(V===" "||V==="n"||V===")")||V==="t"&&(x[ae].v==="/"||x[ae].v===" "&&x[ae+1]!=null&&x[ae+1].t==="?"));)x[L].v+=x[ae].v,x[ae]={v:"",t:";"},++ae;de+=x[L].v,L=ae-1;break;case"G":x[L].t="t",x[L].v=A(_,C);break}let me="",Ne,fe;if(de.length>0){de.charCodeAt(0)===40?(Ne=_<0&&de.charCodeAt(0)===45?-_:_,fe=k("(",de,Ne)):(Ne=_<0&&P>1?-_:_,fe=k("n",de,Ne),Ne<0&&x[0]&&x[0].t==="t"&&(fe=fe.substr(1),x[0].v="-"+x[0].v)),ae=fe.length-1;let U=x.length;for(L=0;L<x.length;++L)if(x[L]!=null&&x[L].t!=="t"&&x[L].v.indexOf(".")>-1){U=L;break}let B=x.length;if(U===x.length&&fe.indexOf("E")===-1){for(L=x.length-1;L>=0;--L)x[L]==null||"n?(".indexOf(x[L].t)===-1||(ae>=x[L].v.length-1?(ae-=x[L].v.length,x[L].v=fe.substr(ae+1,x[L].v.length)):ae<0?x[L].v="":(x[L].v=fe.substr(0,ae+1),ae=-1),x[L].t="t",B=L);ae>=0&&B<x.length&&(x[B].v=fe.substr(0,ae+1)+x[B].v)}else if(U!==x.length&&fe.indexOf("E")===-1){for(ae=fe.indexOf(".")-1,L=U;L>=0;--L)if(!(x[L]==null||"n?(".indexOf(x[L].t)===-1)){for(ne=x[L].v.indexOf(".")>-1&&L===U?x[L].v.indexOf(".")-1:x[L].v.length-1,me=x[L].v.substr(ne+1);ne>=0;--ne)ae>=0&&(x[L].v.charAt(ne)==="0"||x[L].v.charAt(ne)==="#")&&(me=fe.charAt(ae--)+me);x[L].v=me,x[L].t="t",B=L}for(ae>=0&&B<x.length&&(x[B].v=fe.substr(0,ae+1)+x[B].v),ae=fe.indexOf(".")+1,L=U;L<x.length;++L)if(!(x[L]==null||"n?(".indexOf(x[L].t)===-1&&L!==U)){for(ne=x[L].v.indexOf(".")>-1&&L===U?x[L].v.indexOf(".")+1:0,me=x[L].v.substr(0,ne);ne<x[L].v.length;++ne)ae<fe.length&&(me+=fe.charAt(ae++));x[L].v=me,x[L].t="t",B=L}}}for(L=0;L<x.length;++L)x[L]!=null&&"n(?".indexOf(x[L].t)>-1&&(Ne=P>1&&_<0&&L>0&&x[L-1].v==="-"?-_:_,x[L].v=k(x[L].t,x[L].v,Ne),x[L].t="t");let X="";for(L=0;L!==x.length;++L)x[L]!=null&&(X+=x[L].v);return X}e._eval=W;const S=/\[[=<>]/,H=/\[([=<>]*)(-?\d+\.?\d*)\]/;function J(I,_){if(_==null)return!1;const C=parseFloat(_[2]);switch(_[1]){case"=":if(I===C)return!0;break;case">":if(I>C)return!0;break;case"<":if(I<C)return!0;break;case"<>":if(I!==C)return!0;break;case">=":if(I>=C)return!0;break;case"<=":if(I<=C)return!0;break}return!1}function ee(I,_){let C=F(I),P=C.length,x=C[P-1].indexOf("@");if(P<4&&x>-1&&--P,C.length>4)throw new Error("cannot find right format for |"+C.join("|")+"|");if(typeof _!="number")return[4,C.length===4||x>-1?C[C.length-1]:"@"];switch(C.length){case 1:C=x>-1?["General","General","General",C[0]]:[C[0],C[0],C[0],"@"];break;case 2:C=x>-1?[C[0],C[0],C[0],C[1]]:[C[0],C[1],C[0],"@"];break;case 3:C=x>-1?[C[0],C[1],C[0],C[2]]:[C[0],C[1],C[2],"@"];break}const z=_>0?C[0]:_<0?C[1]:C[2];if(C[0].indexOf("[")===-1&&C[1].indexOf("[")===-1)return[P,z];if(C[0].match(S)!=null||C[1].match(S)!=null){const L=C[0].match(H),V=C[1].match(H);return J(_,L)?[P,C[0]]:J(_,V)?[P,C[1]]:[P,C[L!=null&&V!=null?2:1]]}return[P,z]}function D(I,_,C){C==null&&(C={});let P="";switch(typeof I){case"string":I==="m/d/yy"&&C.dateNF?P=C.dateNF:P=I;break;case"number":I===14&&C.dateNF?P=C.dateNF:P=(C.table!=null?C.table:v)[I];break}if(i(P,0))return A(_,C);_ instanceof Date&&(_=w(_,C.date1904));const x=ee(P,_);if(i(x[1]))return A(_,C);if(_===!0)_="TRUE";else if(_===!1)_="FALSE";else if(_===""||_==null)return"";return W(x[1],_,C,x[0])}function Z(I,_){if(typeof _!="number"){_=+_||-1;for(let C=0;C<392;++C){if(v[C]===void 0){_<0&&(_=C);continue}if(v[C]===I){_=C;break}}_<0&&(_=391)}return v[_]=I,_}return e.load=Z,e._table=v,e.get_table=function(){return v},e.load_table=function(_){for(let C=0;C!==392;++C)_[C]!==void 0&&Z(_[C],C)},e.init_table=u,e.format=D,ko=e,ko}var Po={exports:{}},Sa;function vf(){return Sa||(Sa=1,function(e){const r="ศูนย์บาทถ้วน",n=["","หนึ่ง","สอง","สาม","สี่","ห้า","หก","เจ็ด","แปด","เก้า"],t=["","สิบ","ร้อย","พัน","หมื่น","แสน","ล้าน"];function o(d){let c="";const i=d.length,a=7;if(i>a){const s=i-a+1,u=d.slice(0,s),v=d.slice(s);return o(u)+"ล้าน"+o(v)}else for(let s=0;s<i;s++){const u=d[s];u>0&&(c+=n[u]+t[i-s-1])}return c}function f(d){let c=d;c=c.replace("หนึ่งสิบ","สิบ"),c=c.replace("สองสิบ","ยี่สิบ");const i=5;return c.length>i&&c.length-c.lastIndexOf("หนึ่ง")===i&&(c=c.substr(0,c.length-i)+"เอ็ด"),c}function l(d,c){let i="";return d===""&&c===""?i=r:d!==""&&c===""?i=d+"บาทถ้วน":d===""&&c!==""?i=c+"สตางค์":i=d+"บาท"+c+"สตางค์",i}function g(d){let c=r;if(isNaN(d)||d>=Number.MAX_SAFE_INTEGER)return c;const i=Math.floor(d).toString(),a=Math.round(d%1*100).toString(),s=Array.from(i).map(Number),u=Array.from(a).map(Number);let v=o(s),h=o(u);return v=f(v),h=f(h),c=l(v,h),c}e.exports!=null&&(e.exports=g)}(Po)),Po.exports}var So,Fa;function Tc(){if(Fa)return So;Fa=1;const e=Fe(),{FormulaHelpers:r,Types:n,WildCard:t}=Ve(),o=r,f=Nc(),l=vf(),g={latin:{halfRE:/[!-~]/g,fullRE:/[！-～]/g,delta:65248},hangul1:{halfRE:/[ﾡ-ﾾ]/g,fullRE:/[ᆨ-ᇂ]/g,delta:-60921},hangul2:{halfRE:/[ￂ-ￜ]/g,fullRE:/[ᅡ-ᅵ]/g,delta:-61025},kana:{delta:0,half:"｡｢｣､･ｦｧｨｩｪｫｬｭｮｯｰｱｲｳｴｵｶｷｸｹｺｻｼｽｾｿﾀﾁﾂﾃﾄﾅﾆﾇﾈﾉﾊﾋﾌﾍﾎﾏﾐﾑﾒﾓﾔﾕﾖﾗﾘﾙﾚﾛﾜﾝﾞﾟ",full:"。「」、・ヲァィゥェォャュョッーアイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワン゛゜"},extras:{delta:0,half:"¢£¬¯¦¥₩ |←↑→↓■°",full:"￠￡￢￣￤￥￦　￨￩￪￫￬￭￮"}},d=h=>p=>h.delta?String.fromCharCode(p.charCodeAt(0)+h.delta):[...h.full][[...h.half].indexOf(p)],c=h=>p=>h.delta?String.fromCharCode(p.charCodeAt(0)-h.delta):[...h.half][[...h.full].indexOf(p)],i=(h,p)=>h[p+"RE"]||new RegExp("["+h[p]+"]","g"),a=Object.keys(g).map(h=>g[h]),s=h=>a.reduce((p,m)=>p.replace(i(m,"half"),d(m)),h),u=h=>a.reduce((p,m)=>p.replace(i(m,"full"),c(m)),h),v={ASC:h=>(h=o.accept(h,n.STRING),u(h)),BAHTTEXT:h=>{h=o.accept(h,n.NUMBER);try{return l(h)}catch(p){throw Error(`Error in https://github.com/jojoee/bahttext 
${p.toString()}`)}},CHAR:h=>{if(h=o.accept(h,n.NUMBER),h>255||h<1)throw e.VALUE;return String.fromCharCode(h)},CLEAN:h=>(h=o.accept(h,n.STRING),h.replace(/[\x00-\x1F]/g,"")),CODE:h=>{if(h=o.accept(h,n.STRING),h.length===0)throw e.VALUE;return h.charCodeAt(0)},CONCAT:(...h)=>{let p="";return o.flattenParams(h,n.STRING,!1,m=>{m=o.accept(m,n.STRING),p+=m}),p},CONCATENATE:(...h)=>{let p="";if(h.length===0)throw Error("CONCATENATE need at least one argument.");return h.forEach(m=>{m=o.accept(m,n.STRING),p+=m}),p},DBCS:h=>(h=o.accept(h,n.STRING),s(h)),DOLLAR:(h,p)=>{h=o.accept(h,n.NUMBER),p=o.accept(p,n.NUMBER,2);const m=Array(p).fill("0").join("");return f.format(`$#,##0.${m}_);($#,##0.${m})`,h).trim()},EXACT:(h,p)=>(h=o.accept(h,[n.STRING]),p=o.accept(p,[n.STRING]),h===p),FIND:(h,p,m)=>{if(h=o.accept(h,n.STRING),p=o.accept(p,n.STRING),m=o.accept(m,n.NUMBER,1),m<1||m>p.length)throw e.VALUE;const E=p.indexOf(h,m-1);if(E===-1)throw e.VALUE;return E+1},FINDB:(...h)=>v.FIND(...h),FIXED:(h,p,m)=>{h=o.accept(h,n.NUMBER),p=o.accept(p,n.NUMBER,2),m=o.accept(m,n.BOOLEAN,!1);const E=Array(p).fill("0").join(""),y=m?"":"#,";return f.format(`${y}##0.${E}_);(${y}##0.${E})`,h).trim()},LEFT:(h,p)=>{if(h=o.accept(h,n.STRING),p=o.accept(p,n.NUMBER,1),p<0)throw e.VALUE;return p>h.length?h:h.slice(0,p)},LEFTB:(...h)=>v.LEFT(...h),LEN:h=>(h=o.accept(h,n.STRING),h.length),LENB:(...h)=>v.LEN(...h),LOWER:h=>(h=o.accept(h,n.STRING),h.toLowerCase()),MID:(h,p,m)=>{if(h=o.accept(h,n.STRING),p=o.accept(p,n.NUMBER),m=o.accept(m,n.NUMBER),p>h.length)return"";if(p<1||m<1)throw e.VALUE;return h.slice(p-1,p+m-1)},MIDB:(...h)=>v.MID(...h),NUMBERVALUE:(h,p,m)=>{if(h=o.accept(h,n.STRING),p=o.accept(p,n.STRING,"."),m=o.accept(m,n.STRING,","),h.length===0)return 0;if(p.length===0||m.length===0||(p=p[0],m=m[0],p===m||h.indexOf(p)<h.lastIndexOf(m)))throw e.VALUE;const E=h.replace(m,"").replace(p,".").replace(/[^\-0-9.%()]/g,"").match(/([(-]*)([0-9]*[.]*[0-9]+)([)]?)([%]*)/);if(!E)throw e.VALUE;const y=E[1].length,w=E[3].length,T=E[4].length;let R=Number(E[2]);if(y>1||y&&!w||!y&&w||isNaN(R))throw e.VALUE;return R=R/100**T,y?-R:R},PHONETIC:()=>{},PROPER:h=>(h=o.accept(h,[n.STRING]),h=h.toLowerCase(),h=h.charAt(0).toUpperCase()+h.slice(1),h.replace(/(?:[^a-zA-Z])([a-zA-Z])/g,p=>p.toUpperCase())),REPLACE:(h,p,m,E)=>{h=o.accept(h,[n.STRING]),p=o.accept(p,[n.NUMBER]),m=o.accept(m,[n.NUMBER]),E=o.accept(E,[n.STRING]);let y=h.split("");return y.splice(p-1,m,E),y.join("")},REPLACEB:(...h)=>v.REPLACE(...h),REPT:(h,p)=>{h=o.accept(h,n.STRING),p=o.accept(p,n.NUMBER);let m="";for(let E=0;E<p;E++)m+=h;return m},RIGHT:(h,p)=>{if(h=o.accept(h,n.STRING),p=o.accept(p,n.NUMBER,1),p<0)throw e.VALUE;const m=h.length;return p>m?h:h.slice(m-p)},RIGHTB:(...h)=>v.RIGHT(...h),SEARCH:(h,p,m)=>{if(h=o.accept(h,n.STRING),p=o.accept(p,n.STRING),m=o.accept(m,n.NUMBER,1),m<1||m>p.length)throw e.VALUE;let E=t.isWildCard(h)?t.toRegex(h,"i"):h;const y=p.slice(m-1).search(E);if(y===-1)throw e.VALUE;return y+m},SEARCHB:(...h)=>v.SEARCH(...h),SUBSTITUTE:(...h)=>{},T:h=>(h=o.accept(h),typeof h=="string"?h:""),TEXT:(h,p)=>{h=o.accept(h,n.NUMBER),p=o.accept(p,n.STRING);try{return f.format(p,h)}catch(m){throw console.error(m),e.VALUE}},TEXTJOIN:(...h)=>{},TRIM:h=>(h=o.accept(h,[n.STRING]),h.replace(/^\s+|\s+$/g,"")),UNICHAR:h=>{if(h=o.accept(h,[n.NUMBER]),h<=0)throw e.VALUE;return String.fromCharCode(h)},UNICODE:h=>v.CODE(h)};return So=v,So}var Fo,Ba;function so(){if(Ba)return Fo;Ba=1;const e=Fe(),{FormulaHelpers:r}=Ve(),n={unaryOp:(l,g,d)=>{let c=1;if(l.forEach(i=>{if(i!=="+")if(i==="-")c=-c;else throw new Error(`Unrecognized prefix: ${i}`)}),g==null&&(g=0),c===1)return g;try{g=r.acceptNumber(g,d)}catch(i){if(i instanceof e)Array.isArray(g)&&(g=g[0][0]);else throw i}return typeof g=="number"&&isNaN(g)?e.VALUE:-g}},t={percentOp:(l,g,d)=>{try{l=r.acceptNumber(l,d)}catch(c){if(c instanceof e)return c;throw c}if(g==="%")return l/100;throw new Error(`Unrecognized postfix: ${g}`)}},o={boolean:3,string:2,number:1};return Fo={Prefix:n,Postfix:t,Infix:{compareOp:(l,g,d,c,i)=>{l==null&&(l=0),d==null&&(d=0),c&&(l=l[0][0]),i&&(d=d[0][0]);const a=typeof l,s=typeof d;if(a===s)switch(g){case"=":return l===d;case">":return l>d;case"<":return l<d;case"<>":return l!==d;case"<=":return l<=d;case">=":return l>=d}else switch(g){case"=":return!1;case">":return o[a]>o[s];case"<":return o[a]<o[s];case"<>":return!0;case"<=":return o[a]<=o[s];case">=":return o[a]>=o[s]}throw Error("Infix.compareOp: Should not reach here.")},concatOp:(l,g,d,c,i)=>{l==null&&(l=""),d==null&&(d=""),c&&(l=l[0][0]),i&&(d=d[0][0]);const a=typeof l,s=typeof d;return a==="boolean"&&(l=l?"TRUE":"FALSE"),s==="boolean"&&(d=d?"TRUE":"FALSE"),""+l+d},mathOp:(l,g,d,c,i)=>{l==null&&(l=0),d==null&&(d=0);try{l=r.acceptNumber(l,c),d=r.acceptNumber(d,i)}catch(a){if(a instanceof e)return a;throw a}switch(g){case"+":return l+d;case"-":return l-d;case"*":return l*d;case"/":return d===0?e.DIV0:l/d;case"^":return l**d}throw Error("Infix.mathOp: Should not reach here.")}},Operators:{compareOp:["<",">","=","<>","<=",">="],concatOp:["&"],mathOp:["+","-","*","/","^"]}},Fo}var Bo,Da;function Ac(){if(Da)return Bo;Da=1;const e=Fe(),{FormulaHelpers:r,Types:n,Factorials:t,Criteria:o}=Ve(),{Infix:f}=so(),l=r,g=[],d=[];function c(s){return s<=100?t[s]:g[s]>0?g[s]:g[s]=c(s-1)*s}function i(s){return s===1||s===0?1:s===2?2:d[s]>0?d[s]:d[s]=i(s-2)*s}const a={ABS:s=>(s=l.accept(s,n.NUMBER),Math.abs(s)),AGGREGATE:(s,u,v,...h)=>{},ARABIC:s=>{if(s=l.accept(s,n.STRING).toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(s))throw new e("#VALUE!","Invalid roman numeral in ARABIC evaluation.");let u=0;return s.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(v){u+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[v]}),u},BASE:(s,u,v)=>{if(s=l.accept(s,n.NUMBER),s<0||s>=2**53||(u=l.accept(u,n.NUMBER),u<2||u>36)||(v=l.accept(v,n.NUMBER,0),v<0))throw e.NUM;const h=s.toString(u).toUpperCase();return new Array(Math.max(v+1-h.length,0)).join("0")+h},CEILING:(s,u)=>{if(s=l.accept(s,n.NUMBER),u=l.accept(u,n.NUMBER),u===0)return 0;if(s/u%1===0)return s;const v=Math.abs(u),h=Math.floor(Math.abs(s)/v);return s<0?u<0?-v*(h+1):-v*h:(h+1)*v},"CEILING.MATH":(s,u,v)=>{if(s=l.accept(s,n.NUMBER),u=l.accept(u,n.NUMBER,s>0?1:-1),v=l.accept(v,n.NUMBER,0),s>=0)return a.CEILING(s,u);const h=v?u:0;return a.CEILING(s,u)-h},"CEILING.PRECISE":(s,u)=>(s=l.accept(s,n.NUMBER),u=l.accept(u,n.NUMBER,1),a.CEILING(s,Math.abs(u))),COMBIN:(s,u)=>{if(s=l.accept(s,n.NUMBER),u=l.accept(u,n.NUMBER),s<0||u<0||s<u)throw e.NUM;const v=a.FACT(s),h=a.FACT(u);return v/h/a.FACT(s-u)},COMBINA:(s,u)=>{if(s=l.accept(s,n.NUMBER),u=l.accept(u,n.NUMBER),(s===0||s===1)&&u===0)return 1;if(s<0||u<0)throw e.NUM;return a.COMBIN(s+u-1,s-1)},DECIMAL:(s,u)=>{if(s=l.accept(s,n.STRING),u=l.accept(u,n.NUMBER),u=Math.trunc(u),u<2||u>36)throw e.NUM;const v=parseInt(s,u);if(isNaN(v))throw e.NUM;return v},DEGREES:s=>(s=l.accept(s,n.NUMBER),s*(180/Math.PI)),EVEN:s=>a.CEILING(s,-2),EXP:s=>(s=l.accept(s,n.NUMBER),Math.exp(s)),FACT:s=>{if(s=l.accept(s,n.NUMBER),s=Math.trunc(s),s>170||s<0)throw e.NUM;return s<=100?t[s]:c(s)},FACTDOUBLE:s=>{if(s=l.accept(s,n.NUMBER),s=Math.trunc(s),s<-1)throw e.NUM;return s===-1?1:i(s)},FLOOR:(s,u)=>{if(s=l.accept(s,n.NUMBER),u=l.accept(u,n.NUMBER),u===0)return 0;if(s>0&&u<0)throw e.NUM;if(s/u%1===0)return s;const v=Math.abs(u),h=Math.floor(Math.abs(s)/v);return s<0?u<0?-v*h:-v*(h+1):h*v},"FLOOR.MATH":(s,u,v)=>(s=l.accept(s,n.NUMBER),u=l.accept(u,n.NUMBER,s>0?1:-1),v=l.accept(v,n.NUMBER,0),v===0||s>=0?a.FLOOR(s,Math.abs(u)):a.FLOOR(s,u)+u),"FLOOR.PRECISE":(s,u)=>(s=l.accept(s,n.NUMBER),u=l.accept(u,n.NUMBER,1),a.FLOOR(s,Math.abs(u))),GCD:(...s)=>{const u=[];l.flattenParams(s,null,!1,E=>{if(E=typeof E=="boolean"?NaN:Number(E),isNaN(E))throw e.VALUE;if(E<0||E>9007199254740990)throw e.NUM;u.push(Math.trunc(E))},0);let v,h,p=s.length,m=Math.abs(u[0]);for(v=1;v<p;v++){for(h=Math.abs(u[v]);m&&h;)m>h?m%=h:h%=m;m+=h}return m},INT:s=>(s=l.accept(s,n.NUMBER),Math.floor(s)),"ISO.CEILING":(...s)=>a["CEILING.PRECISE"](...s),LCM:(...s)=>{const u=[];l.flattenParams(s,null,!1,p=>{if(p=typeof p=="boolean"?NaN:Number(p),isNaN(p))throw e.VALUE;if(p<0||p>9007199254740990)throw e.NUM;u.push(Math.trunc(p))},1);let v=u.length,h=Math.abs(u[0]);for(let p=1;p<v;p++){let m=Math.abs(u[p]),E=h;for(;h&&m;)h>m?h%=m:m%=h;h=Math.abs(E*u[p])/(h+m)}return h},LN:s=>(s=l.accept(s,n.NUMBER),Math.log(s)),LOG:(s,u)=>(s=l.accept(s,n.NUMBER),u=l.accept(u,n.NUMBER,10),Math.log(s)/Math.log(u)),LOG10:s=>(s=l.accept(s,n.NUMBER),Math.log10(s)),MDETERM:s=>{if(s=l.accept(s,n.ARRAY,void 0,!1,!0),s[0].length!==s.length)throw e.VALUE;const u=s.length,v=s[0].length;let h=0,p,m;if(u===1)return s[0][0];if(u===2)return s[0][0]*s[1][1]-s[0][1]*s[1][0];for(let E=0;E<v;E++){p=s[0][E],m=s[0][E];for(let y=1;y<u;y++)m*=s[y][((E+y)%v+v)%v],p*=s[y][((E-y)%v+v)%v];h+=m-p}return h},MINVERSE:s=>{},MMULT:(s,u)=>{s=l.accept(s,n.ARRAY,void 0,!1,!0),u=l.accept(u,n.ARRAY,void 0,!1,!0);const v=s.length,h=s[0].length,p=u.length,m=u[0].length,E=new Array(v);if(h!==p)throw e.VALUE;for(let y=0;y<v;y++){E[y]=new Array(m);for(let w=0;w<m;w++){E[y][w]=0;for(let T=0;T<h;T++){const R=s[y][T],A=u[T][w];if(typeof R!="number"||typeof A!="number")throw e.VALUE;E[y][w]+=s[y][T]*u[T][w]}}}return E},MOD:(s,u)=>{if(s=l.accept(s,n.NUMBER),u=l.accept(u,n.NUMBER),u===0)throw e.DIV0;return s-u*a.INT(s/u)},MROUND:(s,u)=>{if(s=l.accept(s,n.NUMBER),u=l.accept(u,n.NUMBER),u===0)return 0;if(s>0&&u<0||s<0&&u>0)throw e.NUM;return s/u%1===0?s:Math.round(s/u)*u},MULTINOMIAL:(...s)=>{let u=0,v=1;return l.flattenParams(s,n.NUMBER,!1,h=>{if(h<0)throw e.NUM;u+=h,v*=c(h)}),c(u)/v},MUNIT:s=>{s=l.accept(s,n.NUMBER);const u=[];for(let v=0;v<s;v++){const h=[];for(let p=0;p<s;p++)v===p?h.push(1):h.push(0);u.push(h)}return u},ODD:s=>{if(s=l.accept(s,n.NUMBER),s===0)return 1;let u=Math.ceil(Math.abs(s));return u=u&1?u:u+1,s>0?u:-u},PI:()=>Math.PI,POWER:(s,u)=>(s=l.accept(s,n.NUMBER),u=l.accept(u,n.NUMBER),s**u),PRODUCT:(...s)=>{let u=1;return l.flattenParams(s,null,!0,(v,h)=>{const p=Number(v);h.isLiteral&&!isNaN(p)?u*=p:typeof v=="number"&&(u*=v)},1),u},QUOTIENT:(s,u)=>(s=l.accept(s,n.NUMBER),u=l.accept(u,n.NUMBER),Math.trunc(s/u)),RADIANS:s=>(s=l.accept(s,n.NUMBER),s/180*Math.PI),RAND:()=>Math.random(),RANDBETWEEN:(s,u)=>(s=l.accept(s,n.NUMBER),u=l.accept(u,n.NUMBER),Math.floor(Math.random()*(u-s+1)+s)),ROMAN:(s,u)=>{if(s=l.accept(s,n.NUMBER),u=l.accept(u,n.NUMBER,0),u!==0)throw Error("ROMAN: only allows form=0 (classic form).");const v=String(s).split(""),h=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let p="",m=3;for(;m--;)p=(h[+v.pop()+m*10]||"")+p;return new Array(+v.join("")+1).join("M")+p},ROUND:(s,u)=>{s=l.accept(s,n.NUMBER),u=l.accept(u,n.NUMBER);const v=Math.pow(10,Math.abs(u)),h=s>0?1:-1;return u>0?h*Math.round(Math.abs(s)*v)/v:u===0?h*Math.round(Math.abs(s)):h*Math.round(Math.abs(s)/v)*v},ROUNDDOWN:(s,u)=>{s=l.accept(s,n.NUMBER),u=l.accept(u,n.NUMBER);const v=Math.pow(10,Math.abs(u)),h=s>0?1:-1;if(u>0){const p=1/v*.5;return h*Math.round((Math.abs(s)-p)*v)/v}else{if(u===0)return h*Math.round(Math.abs(s)-.5);{const p=v*.5;return h*Math.round((Math.abs(s)-p)/v)*v}}},ROUNDUP:(s,u)=>{s=l.accept(s,n.NUMBER),u=l.accept(u,n.NUMBER);const v=Math.pow(10,Math.abs(u)),h=s>0?1:-1;if(u>0){const p=1/v*.5;return h*Math.round((Math.abs(s)+p)*v)/v}else{if(u===0)return h*Math.round(Math.abs(s)+.5);{const p=v*.5;return h*Math.round((Math.abs(s)+p)/v)*v}}},SERIESSUM:(s,u,v,h)=>{s=l.accept(s,n.NUMBER),u=l.accept(u,n.NUMBER),v=l.accept(v,n.NUMBER);let p=0,m;return l.flattenParams([h],n.NUMBER,!1,E=>{if(typeof E!="number")throw e.VALUE;p===0?m=E*Math.pow(s,u):m+=E*Math.pow(s,u+p*v),p++}),m},SIGN:s=>(s=l.accept(s,n.NUMBER),s>0?1:s===0?0:-1),SQRT:s=>{if(s=l.accept(s,n.NUMBER),s<0)throw e.NUM;return Math.sqrt(s)},SQRTPI:s=>{if(s=l.accept(s,n.NUMBER),s<0)throw e.NUM;return Math.sqrt(s*Math.PI)},SUBTOTAL:()=>{},SUM:(...s)=>{let u=0;return l.flattenParams(s,n.NUMBER,!0,(v,h)=>{(h.isLiteral||typeof v=="number")&&(u+=v)}),u},SUMIF:(s,u,v,h)=>{const p=l.retrieveRanges(s,u,h);u=p[0],h=p[1],v=l.retrieveArg(s,v);const m=v.isArray;v=o.parse(l.accept(v));let E=0;return u.forEach((y,w)=>{y.forEach((T,R)=>{const A=h[w][R];typeof A=="number"&&(v.op==="wc"?v.match===v.value.test(T)&&(E+=A):f.compareOp(T,v.op,v.value,Array.isArray(T),m)&&(E+=A))})}),E},SUMIFS:()=>{},SUMPRODUCT:(s,...u)=>{s=l.accept(s,n.ARRAY,void 0,!1,!0),u.forEach(h=>{if(h=l.accept(h,n.ARRAY,void 0,!1,!0),s[0].length!==h[0].length||s.length!==h.length)throw e.VALUE;for(let p=0;p<s.length;p++)for(let m=0;m<s[0].length;m++)typeof s[p][m]!="number"&&(s[p][m]=0),typeof h[p][m]!="number"&&(h[p][m]=0),s[p][m]*=h[p][m]});let v=0;return s.forEach(h=>{h.forEach(p=>{v+=p})}),v},SUMSQ:(...s)=>{let u=0;return l.flattenParams(s,n.NUMBER,!0,(v,h)=>{(h.isLiteral||typeof v=="number")&&(u+=v**2)}),u},SUMX2MY2:(s,u)=>{const v=[],h=[];let p=0;if(l.flattenParams([s],null,!1,(m,E)=>{v.push(m)}),l.flattenParams([u],null,!1,(m,E)=>{h.push(m)}),v.length!==h.length)throw e.NA;for(let m=0;m<v.length;m++)typeof v[m]=="number"&&typeof h[m]=="number"&&(p+=v[m]**2-h[m]**2);return p},SUMX2PY2:(s,u)=>{const v=[],h=[];let p=0;if(l.flattenParams([s],null,!1,(m,E)=>{v.push(m)}),l.flattenParams([u],null,!1,(m,E)=>{h.push(m)}),v.length!==h.length)throw e.NA;for(let m=0;m<v.length;m++)typeof v[m]=="number"&&typeof h[m]=="number"&&(p+=v[m]**2+h[m]**2);return p},SUMXMY2:(s,u)=>{const v=[],h=[];let p=0;if(l.flattenParams([s],null,!1,(m,E)=>{v.push(m)}),l.flattenParams([u],null,!1,(m,E)=>{h.push(m)}),v.length!==h.length)throw e.NA;for(let m=0;m<v.length;m++)typeof v[m]=="number"&&typeof h[m]=="number"&&(p+=(v[m]-h[m])**2);return p},TRUNC:s=>(s=l.accept(s,n.NUMBER),Math.trunc(s))};return Bo=a,Bo}var Do,Va;function mf(){if(Va)return Do;Va=1;const e=Fe(),{FormulaHelpers:r,Types:n}=Ve(),t=r,o=2**27-1;return Do={ACOS:l=>{if(l=t.accept(l,n.NUMBER),l>1||l<-1)throw e.NUM;return Math.acos(l)},ACOSH:l=>{if(l=t.accept(l,n.NUMBER),l<1)throw e.NUM;return Math.acosh(l)},ACOT:l=>(l=t.accept(l,n.NUMBER),Math.PI/2-Math.atan(l)),ACOTH:l=>{if(l=t.accept(l,n.NUMBER),Math.abs(l)<=1)throw e.NUM;return Math.atanh(1/l)},ASIN:l=>{if(l=t.accept(l,n.NUMBER),l>1||l<-1)throw e.NUM;return Math.asin(l)},ASINH:l=>(l=t.accept(l,n.NUMBER),Math.asinh(l)),ATAN:l=>(l=t.accept(l,n.NUMBER),Math.atan(l)),ATAN2:(l,g)=>{if(l=t.accept(l,n.NUMBER),g=t.accept(g,n.NUMBER),g===0&&l===0)throw e.DIV0;return Math.atan2(g,l)},ATANH:l=>{if(l=t.accept(l,n.NUMBER),Math.abs(l)>1)throw e.NUM;return Math.atanh(l)},COS:l=>{if(l=t.accept(l,n.NUMBER),Math.abs(l)>o)throw e.NUM;return Math.cos(l)},COSH:l=>(l=t.accept(l,n.NUMBER),Math.cosh(l)),COT:l=>{if(l=t.accept(l,n.NUMBER),Math.abs(l)>o)throw e.NUM;if(l===0)throw e.DIV0;return 1/Math.tan(l)},COTH:l=>{if(l=t.accept(l,n.NUMBER),l===0)throw e.DIV0;return 1/Math.tanh(l)},CSC:l=>{if(l=t.accept(l,n.NUMBER),Math.abs(l)>o)throw e.NUM;return 1/Math.sin(l)},CSCH:l=>{if(l=t.accept(l,n.NUMBER),l===0)throw e.DIV0;return 1/Math.sinh(l)},SEC:l=>{if(l=t.accept(l,n.NUMBER),Math.abs(l)>o)throw e.NUM;return 1/Math.cos(l)},SECH:l=>(l=t.accept(l,n.NUMBER),1/Math.cosh(l)),SIN:l=>{if(l=t.accept(l,n.NUMBER),Math.abs(l)>o)throw e.NUM;return Math.sin(l)},SINH:l=>(l=t.accept(l,n.NUMBER),Math.sinh(l)),TAN:l=>{if(l=t.accept(l,n.NUMBER),Math.abs(l)>o)throw e.NUM;return Math.tan(l)},TANH:l=>(l=t.accept(l,n.NUMBER),Math.tanh(l))},Do}var Vo,Ga;function gf(){if(Ga)return Vo;Ga=1;const e=Fe(),{FormulaHelpers:r,Types:n}=Ve(),t=r;function o(l){let g=0,d=0;return t.flattenParams(l,null,!0,c=>{const i=typeof c;i==="string"?c==="TRUE"?c=!0:c==="FALSE"&&(c=!1):i==="number"&&(c=!!c),typeof c=="boolean"&&(c===!0?g++:d++)}),[g,d]}return Vo={AND:(...l)=>{const[g,d]=o(l);return g===0&&d===0?e.VALUE:g>0&&d===0},FALSE:()=>!1,IF:(l,g,d,c)=>(g=t.accept(g,n.BOOLEAN),d=t.accept(d),c=t.accept(c,null,!1),g?d:c),IFERROR:(l,g)=>l.value instanceof e?t.accept(g):t.accept(l),IFNA:function(l,g){if(arguments.length>2)throw e.TOO_MANY_ARGS("IFNA");return e.NA.equals(l.value)?t.accept(g):t.accept(l)},IFS:(...l)=>{if(l.length%2!==0)return new e("#N/A","IFS expects all arguments after position 0 to be in pairs.");for(let g=0;g<l.length/2;g++){const d=t.accept(l[g*2],n.BOOLEAN),c=t.accept(l[g*2+1]);if(d)return c}return e.NA},NOT:l=>(l=t.accept(l,n.BOOLEAN),!l),OR:(...l)=>{const[g,d]=o(l);return g===0&&d===0?e.VALUE:g>0},SWITCH:(...l)=>{},TRUE:()=>!0,XOR:(...l)=>{const[g,d]=o(l);return g===0&&d===0?e.VALUE:g%2===1}},Vo}var Go={},Wa;function Ef(){return Wa||(Wa=1,function(e){(function(r){r(typeof DO_NOT_EXPORT_BESSEL>"u"?e:{})})(function(r){r.version="1.0.2";var n=Math;function t(i,a){for(var s=0,u=0;s<i.length;++s)u=a*u+i[s];return u}function o(i,a,s,u,v){if(a===0)return s;if(a===1)return u;for(var h=2/i,p=u,m=1;m<a;++m)p=u*m*h+v*s,s=u,u=p;return p}function f(i,a,s,u,v){return function(p,m){if(u){if(p===0)return u==1?-1/0:1/0;if(p<0)return NaN}if(m===0)return i(p);if(m===1)return a(p);if(m<0)return NaN;m|=0;var E=i(p),y=a(p);return o(p,m,E,y,v)}}var l=function(){var i=.636619772,a=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),s=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),u=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),v=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function h(T){var R=0,A=0,O=0,M=T*T;if(T<8)A=t(a,M),O=t(s,M),R=A/O;else{var b=T-.785398164;M=64/M,A=t(u,M),O=t(v,M),R=n.sqrt(i/T)*(n.cos(b)*A-n.sin(b)*O*8/T)}return R}var p=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),m=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),E=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),y=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function w(T){var R=0,A=0,O=0,M=T*T,b=n.abs(T)-2.356194491;return Math.abs(T)<8?(A=T*t(p,M),O=t(m,M),R=A/O):(M=64/M,A=t(E,M),O=t(y,M),R=n.sqrt(i/n.abs(T))*(n.cos(b)*A-n.sin(b)*O*8/n.abs(T)),T<0&&(R=-R)),R}return function T(R,A){if(A=Math.round(A),!isFinite(R))return isNaN(R)?R:0;if(A<0)return(A%2?-1:1)*T(R,-A);if(R<0)return(A%2?-1:1)*T(-R,A);if(A===0)return h(R);if(A===1)return w(R);if(R===0)return 0;var O=0;if(R>A)O=o(R,A,h(R),w(R),-1);else{for(var M=2*n.floor((A+n.floor(n.sqrt(40*A)))/2),b=!1,k=0,F=0,$=1,Y=0,W=2/R,S=M;S>0;S--)Y=S*W*$-k,k=$,$=Y,n.abs($)>1e10&&($*=1e-10,k*=1e-10,O*=1e-10,F*=1e-10),b&&(F+=$),b=!b,S==A&&(O=k);F=2*F-$,O/=F}return O}}(),g=function(){var i=.636619772,a=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),s=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),u=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),v=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function h(T){var R=0,A=0,O=0,M=T*T,b=T-.785398164;return T<8?(A=t(a,M),O=t(s,M),R=A/O+i*l(T,0)*n.log(T)):(M=64/M,A=t(u,M),O=t(v,M),R=n.sqrt(i/T)*(n.sin(b)*A+n.cos(b)*O*8/T)),R}var p=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),m=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),E=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),y=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function w(T){var R=0,A=0,O=0,M=T*T,b=T-2.356194491;return T<8?(A=T*t(p,M),O=t(m,M),R=A/O+i*(l(T,1)*n.log(T)-1/T)):(M=64/M,A=t(E,M),O=t(y,M),R=n.sqrt(i/T)*(n.sin(b)*A+n.cos(b)*O*8/T)),R}return f(h,w,"BESSELY",1,-1)}(),d=function(){var i=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),a=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function s(p){return p<=3.75?t(i,p*p/(3.75*3.75)):n.exp(n.abs(p))/n.sqrt(n.abs(p))*t(a,3.75/n.abs(p))}var u=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),v=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function h(p){return p<3.75?p*t(u,p*p/(3.75*3.75)):(p<0?-1:1)*n.exp(n.abs(p))/n.sqrt(n.abs(p))*t(v,3.75/n.abs(p))}return function p(m,E){if(E=Math.round(E),E===0)return s(m);if(E===1)return h(m);if(E<0)return NaN;if(n.abs(m)===0)return 0;if(m==1/0)return 1/0;var y=0,w,T=2/n.abs(m),R=0,A=1,O=0,M=2*n.round((E+n.round(n.sqrt(40*E)))/2);for(w=M;w>0;w--)O=w*T*A+R,R=A,A=O,n.abs(A)>1e10&&(A*=1e-10,R*=1e-10,y*=1e-10),w==E&&(y=R);return y*=p(m,0)/A,m<0&&E%2?-y:y}}(),c=function(){var i=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),a=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function s(p){return p<=2?-n.log(p/2)*d(p,0)+t(i,p*p/4):n.exp(-p)/n.sqrt(p)*t(a,2/p)}var u=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),v=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function h(p){return p<=2?n.log(p/2)*d(p,1)+1/p*t(u,p*p/4):n.exp(-p)/n.sqrt(p)*t(v,2/p)}return f(s,h,"BESSELK",2,1)}();r.besselj=l,r.bessely=g,r.besseli=d,r.besselk=c})}(Go)),Go}var Mr={exports:{}},yf=Mr.exports,Ha;function Cc(){return Ha||(Ha=1,function(e,r){(function(n,t){e.exports=t()})(yf,function(){var n=function(t,o){var f=Array.prototype.concat,l=Array.prototype.slice,g=Object.prototype.toString;function d(E,y){var w=E>y?E:y;return t.pow(10,17-~~(t.log(w>0?w:-w)*t.LOG10E))}var c=Array.isArray||function(y){return g.call(y)==="[object Array]"};function i(E){return g.call(E)==="[object Function]"}function a(E){return typeof E=="number"?E-E===0:!1}function s(E){return f.apply([],E)}function u(){return new u._init(arguments)}u.fn=u.prototype,u._init=function(y){if(c(y[0]))if(c(y[0][0])){i(y[1])&&(y[0]=u.map(y[0],y[1]));for(var w=0;w<y[0].length;w++)this[w]=y[0][w];this.length=y[0].length}else this[0]=i(y[1])?u.map(y[0],y[1]):y[0],this.length=1;else if(a(y[0]))this[0]=u.seq.apply(null,y),this.length=1;else{if(y[0]instanceof u)return u(y[0].toArray());this[0]=[],this.length=1}return this},u._init.prototype=u.prototype,u._init.constructor=u,u.utils={calcRdx:d,isArray:c,isFunction:i,isNumber:a,toVector:s},u._random_fn=t.random,u.setRandom=function(y){if(typeof y!="function")throw new TypeError("fn is not a function");u._random_fn=y},u.extend=function(y){var w,T;if(arguments.length===1){for(T in y)u[T]=y[T];return this}for(w=1;w<arguments.length;w++)for(T in arguments[w])y[T]=arguments[w][T];return y},u.rows=function(y){return y.length||1},u.cols=function(y){return y[0].length||1},u.dimensions=function(y){return{rows:u.rows(y),cols:u.cols(y)}},u.row=function(y,w){return c(w)?w.map(function(T){return u.row(y,T)}):y[w]},u.rowa=function(y,w){return u.row(y,w)},u.col=function(y,w){if(c(w)){var T=u.arange(y.length).map(function(){return new Array(w.length)});return w.forEach(function(O,M){u.arange(y.length).forEach(function(b){T[b][M]=y[b][O]})}),T}for(var R=new Array(y.length),A=0;A<y.length;A++)R[A]=[y[A][w]];return R},u.cola=function(y,w){return u.col(y,w).map(function(T){return T[0]})},u.diag=function(y){for(var w=u.rows(y),T=new Array(w),R=0;R<w;R++)T[R]=[y[R][R]];return T},u.antidiag=function(y){for(var w=u.rows(y)-1,T=new Array(w),R=0;w>=0;w--,R++)T[R]=[y[R][w]];return T},u.transpose=function(y){var w=[],T,R,A,O,M;for(c(y[0])||(y=[y]),R=y.length,A=y[0].length,M=0;M<A;M++){for(T=new Array(R),O=0;O<R;O++)T[O]=y[O][M];w.push(T)}return w.length===1?w[0]:w},u.map=function(y,w,T){var R,A,O,M,b;for(c(y[0])||(y=[y]),A=y.length,O=y[0].length,M=T?y:new Array(A),R=0;R<A;R++)for(M[R]||(M[R]=new Array(O)),b=0;b<O;b++)M[R][b]=w(y[R][b],R,b);return M.length===1?M[0]:M},u.cumreduce=function(y,w,T){var R,A,O,M,b;for(c(y[0])||(y=[y]),A=y.length,O=y[0].length,M=T?y:new Array(A),R=0;R<A;R++)for(M[R]||(M[R]=new Array(O)),O>0&&(M[R][0]=y[R][0]),b=1;b<O;b++)M[R][b]=w(M[R][b-1],y[R][b]);return M.length===1?M[0]:M},u.alter=function(y,w){return u.map(y,w,!0)},u.create=function(y,w,T){var R=new Array(y),A,O;for(i(w)&&(T=w,w=y),A=0;A<y;A++)for(R[A]=new Array(w),O=0;O<w;O++)R[A][O]=T(A,O);return R};function v(){return 0}u.zeros=function(y,w){return a(w)||(w=y),u.create(y,w,v)};function h(){return 1}u.ones=function(y,w){return a(w)||(w=y),u.create(y,w,h)},u.rand=function(y,w){return a(w)||(w=y),u.create(y,w,u._random_fn)};function p(E,y){return E===y?1:0}u.identity=function(y,w){return a(w)||(w=y),u.create(y,w,p)},u.symmetric=function(y){var w=y.length,T,R;if(y.length!==y[0].length)return!1;for(T=0;T<w;T++)for(R=0;R<w;R++)if(y[R][T]!==y[T][R])return!1;return!0},u.clear=function(y){return u.alter(y,v)},u.seq=function(y,w,T,R){i(R)||(R=!1);var A=[],O=d(y,w),M=(w*O-y*O)/((T-1)*O),b=y,k;for(k=0;b<=w&&k<T;k++,b=(y*O+M*O*k)/O)A.push(R?R(b,k):b);return A},u.arange=function(y,w,T){var R=[],A;if(T=T||1,w===o&&(w=y,y=0),y===w||T===0)return[];if(y<w&&T<0)return[];if(y>w&&T>0)return[];if(T>0)for(A=y;A<w;A+=T)R.push(A);else for(A=y;A>w;A+=T)R.push(A);return R},u.slice=function(){function E(w,T,R,A){var O,M=[],b=w.length;if(T===o&&R===o&&A===o)return u.copy(w);if(T=T||0,R=R||w.length,T=T>=0?T:b+T,R=R>=0?R:b+R,A=A||1,T===R||A===0)return[];if(T<R&&A<0)return[];if(T>R&&A>0)return[];if(A>0)for(O=T;O<R;O+=A)M.push(w[O]);else for(O=T;O>R;O+=A)M.push(w[O]);return M}function y(w,T){var R,A;if(T=T||{},a(T.row)){if(a(T.col))return w[T.row][T.col];var O=u.rowa(w,T.row);return R=T.col||{},E(O,R.start,R.end,R.step)}if(a(T.col)){var M=u.cola(w,T.col);return A=T.row||{},E(M,A.start,A.end,A.step)}A=T.row||{},R=T.col||{};var b=E(w,A.start,A.end,A.step);return b.map(function(k){return E(k,R.start,R.end,R.step)})}return y}(),u.sliceAssign=function(y,w,T){var R,A;if(a(w.row)){if(a(w.col))return y[w.row][w.col]=T;w.col=w.col||{},w.col.start=w.col.start||0,w.col.end=w.col.end||y[0].length,w.col.step=w.col.step||1,R=u.arange(w.col.start,t.min(y.length,w.col.end),w.col.step);var O=w.row;return R.forEach(function(b,k){y[O][b]=T[k]}),y}if(a(w.col)){w.row=w.row||{},w.row.start=w.row.start||0,w.row.end=w.row.end||y.length,w.row.step=w.row.step||1,A=u.arange(w.row.start,t.min(y[0].length,w.row.end),w.row.step);var M=w.col;return A.forEach(function(b,k){y[b][M]=T[k]}),y}return T[0].length===o&&(T=[T]),w.row.start=w.row.start||0,w.row.end=w.row.end||y.length,w.row.step=w.row.step||1,w.col.start=w.col.start||0,w.col.end=w.col.end||y[0].length,w.col.step=w.col.step||1,A=u.arange(w.row.start,t.min(y.length,w.row.end),w.row.step),R=u.arange(w.col.start,t.min(y[0].length,w.col.end),w.col.step),A.forEach(function(b,k){R.forEach(function(F,$){y[b][F]=T[k][$]})}),y},u.diagonal=function(y){var w=u.zeros(y.length,y.length);return y.forEach(function(T,R){w[R][R]=T}),w},u.copy=function(y){return y.map(function(w){return a(w)?w:w.map(function(T){return T})})};var m=u.prototype;return m.length=0,m.push=Array.prototype.push,m.sort=Array.prototype.sort,m.splice=Array.prototype.splice,m.slice=Array.prototype.slice,m.toArray=function(){return this.length>1?l.call(this):l.call(this)[0]},m.map=function(y,w){return u(u.map(this,y,w))},m.cumreduce=function(y,w){return u(u.cumreduce(this,y,w))},m.alter=function(y){return u.alter(this,y),this},function(E){for(var y=0;y<E.length;y++)(function(w){m[w]=function(T){var R=this,A;return T?(setTimeout(function(){T.call(R,m[w].call(R))}),this):(A=u[w](this),c(A)?u(A):A)}})(E[y])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(E){for(var y=0;y<E.length;y++)(function(w){m[w]=function(T,R){var A=this;return R?(setTimeout(function(){R.call(A,m[w].call(A,T))}),this):u(u[w](this,T))}})(E[y])}("row col".split(" ")),function(E){for(var y=0;y<E.length;y++)(function(w){m[w]=function(){return u(u[w].apply(null,arguments))}})(E[y])}("create zeros ones rand identity".split(" ")),u}(Math);return function(t,o){var f=t.utils.isFunction;function l(c,i){return c-i}function g(c,i,a){return o.max(i,o.min(c,a))}t.sum=function(i){for(var a=0,s=i.length;--s>=0;)a+=i[s];return a},t.sumsqrd=function(i){for(var a=0,s=i.length;--s>=0;)a+=i[s]*i[s];return a},t.sumsqerr=function(i){for(var a=t.mean(i),s=0,u=i.length,v;--u>=0;)v=i[u]-a,s+=v*v;return s},t.sumrow=function(i){for(var a=0,s=i.length;--s>=0;)a+=i[s];return a},t.product=function(i){for(var a=1,s=i.length;--s>=0;)a*=i[s];return a},t.min=function(i){for(var a=i[0],s=0;++s<i.length;)i[s]<a&&(a=i[s]);return a},t.max=function(i){for(var a=i[0],s=0;++s<i.length;)i[s]>a&&(a=i[s]);return a},t.unique=function(i){for(var a={},s=[],u=0;u<i.length;u++)a[i[u]]||(a[i[u]]=!0,s.push(i[u]));return s},t.mean=function(i){return t.sum(i)/i.length},t.meansqerr=function(i){return t.sumsqerr(i)/i.length},t.geomean=function(i){var a=i.map(o.log),s=t.mean(a);return o.exp(s)},t.median=function(i){var a=i.length,s=i.slice().sort(l);return a&1?s[a/2|0]:(s[a/2-1]+s[a/2])/2},t.cumsum=function(i){return t.cumreduce(i,function(a,s){return a+s})},t.cumprod=function(i){return t.cumreduce(i,function(a,s){return a*s})},t.diff=function(i){var a=[],s=i.length,u;for(u=1;u<s;u++)a.push(i[u]-i[u-1]);return a},t.rank=function(c){var i,a=[],s={};for(i=0;i<c.length;i++){var u=c[i];s[u]?s[u]++:(s[u]=1,a.push(u))}var v=a.sort(l),h={},p=1;for(i=0;i<v.length;i++){var u=v[i],m=s[u],E=p,y=p+m-1,w=(E+y)/2;h[u]=w,p+=m}return c.map(function(T){return h[T]})},t.mode=function(i){var a=i.length,s=i.slice().sort(l),u=1,v=0,h=0,p=[],m;for(m=0;m<a;m++)s[m]===s[m+1]?u++:(u>v?(p=[s[m]],v=u,h=0):u===v&&(p.push(s[m]),h++),u=1);return h===0?p[0]:p},t.range=function(i){return t.max(i)-t.min(i)},t.variance=function(i,a){return t.sumsqerr(i)/(i.length-(a?1:0))},t.pooledvariance=function(i){var a=i.reduce(function(u,v){return u+t.sumsqerr(v)},0),s=i.reduce(function(u,v){return u+v.length},0);return a/(s-i.length)},t.deviation=function(c){for(var i=t.mean(c),a=c.length,s=new Array(a),u=0;u<a;u++)s[u]=c[u]-i;return s},t.stdev=function(i,a){return o.sqrt(t.variance(i,a))},t.pooledstdev=function(i){return o.sqrt(t.pooledvariance(i))},t.meandev=function(i){for(var a=t.mean(i),s=[],u=i.length-1;u>=0;u--)s.push(o.abs(i[u]-a));return t.mean(s)},t.meddev=function(i){for(var a=t.median(i),s=[],u=i.length-1;u>=0;u--)s.push(o.abs(i[u]-a));return t.median(s)},t.coeffvar=function(i){return t.stdev(i)/t.mean(i)},t.quartiles=function(i){var a=i.length,s=i.slice().sort(l);return[s[o.round(a/4)-1],s[o.round(a/2)-1],s[o.round(a*3/4)-1]]},t.quantiles=function(i,a,s,u){var v=i.slice().sort(l),h=[a.length],p=i.length,m,E,y,w,T,R;for(typeof s>"u"&&(s=3/8),typeof u>"u"&&(u=3/8),m=0;m<a.length;m++)E=a[m],y=s+E*(1-s-u),w=p*E+y,T=o.floor(g(w,1,p-1)),R=g(w-T,0,1),h[m]=(1-R)*v[T-1]+R*v[T];return h},t.percentile=function(i,a,s){var u=i.slice().sort(l),v=a*(u.length+(s?1:-1))+(s?0:1),h=parseInt(v),p=v-h;return h+1<u.length?u[h-1]+p*(u[h]-u[h-1]):u[h-1]},t.percentileOfScore=function(i,a,s){var u=0,v=i.length,h=!1,p,m;for(s==="strict"&&(h=!0),m=0;m<v;m++)p=i[m],(h&&p<a||!h&&p<=a)&&u++;return u/v},t.histogram=function(i,a){a=a||4;var s=t.min(i),u=(t.max(i)-s)/a,v=i.length,h=[],p;for(p=0;p<a;p++)h[p]=0;for(p=0;p<v;p++)h[o.min(o.floor((i[p]-s)/u),a-1)]+=1;return h},t.covariance=function(i,a){var s=t.mean(i),u=t.mean(a),v=i.length,h=new Array(v),p;for(p=0;p<v;p++)h[p]=(i[p]-s)*(a[p]-u);return t.sum(h)/(v-1)},t.corrcoeff=function(i,a){return t.covariance(i,a)/t.stdev(i,1)/t.stdev(a,1)},t.spearmancoeff=function(c,i){return c=t.rank(c),i=t.rank(i),t.corrcoeff(c,i)},t.stanMoment=function(i,a){for(var s=t.mean(i),u=t.stdev(i),v=i.length,h=0,p=0;p<v;p++)h+=o.pow((i[p]-s)/u,a);return h/i.length},t.skewness=function(i){return t.stanMoment(i,3)},t.kurtosis=function(i){return t.stanMoment(i,4)-3};var d=t.prototype;(function(c){for(var i=0;i<c.length;i++)(function(a){d[a]=function(s,u){var v=[],h=0,p=this;if(f(s)&&(u=s,s=!1),u)return setTimeout(function(){u.call(p,d[a].call(p,s))}),this;if(this.length>1){for(p=s===!0?this:this.transpose();h<p.length;h++)v[h]=t[a](p[h]);return v}return t[a](this[0],s)}})(c[i])})("cumsum cumprod".split(" ")),function(c){for(var i=0;i<c.length;i++)(function(a){d[a]=function(s,u){var v=[],h=0,p=this;if(f(s)&&(u=s,s=!1),u)return setTimeout(function(){u.call(p,d[a].call(p,s))}),this;if(this.length>1){for(a!=="sumrow"&&(p=s===!0?this:this.transpose());h<p.length;h++)v[h]=t[a](p[h]);return s===!0?t[a](t.utils.toVector(v)):v}return t[a](this[0],s)}})(c[i])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(c){for(var i=0;i<c.length;i++)(function(a){d[a]=function(){var s=[],u=0,v=this,h=Array.prototype.slice.call(arguments),p;if(f(h[h.length-1])){p=h[h.length-1];var m=h.slice(0,h.length-1);return setTimeout(function(){p.call(v,d[a].apply(v,m))}),this}else{p=void 0;var E=function(w){return t[a].apply(v,[w].concat(h))}}if(this.length>1){for(v=v.transpose();u<v.length;u++)s[u]=E(v[u]);return s}return E(this[0])}})(c[i])}("quantiles percentileOfScore".split(" "))}(n,Math),function(t,o){t.gammaln=function(l){var g=0,d=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],c=1.000000000190015,i,a,s;for(s=(a=i=l)+5.5,s-=(i+.5)*o.log(s);g<6;g++)c+=d[g]/++a;return o.log(2.5066282746310007*c/i)-s},t.loggam=function(l){var g,d,c,i,a,s,u,v=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(g=l,u=0,l==1||l==2)return 0;for(l<=7&&(u=o.floor(7-l),g=l+u),d=1/(g*g),c=2*o.PI,a=v[9],s=8;s>=0;s--)a*=d,a+=v[s];if(i=a/g+.5*o.log(c)+(g-.5)*o.log(g)-g,l<=7)for(s=1;s<=u;s++)i-=o.log(g-1),g-=1;return i},t.gammafn=function(l){var g=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],d=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],c=!1,i=0,a=0,s=0,u=l,v,h,p,m;if(l>171.6243769536076)return 1/0;if(u<=0)if(m=u%1+36e-17,m)c=(u&1?-1:1)*o.PI/o.sin(o.PI*m),u=1-u;else return 1/0;for(p=u,u<1?h=u++:h=(u-=i=(u|0)-1)-1,v=0;v<8;++v)s=(s+g[v])*h,a=a*h+d[v];if(m=s/a+1,p<u)m/=p;else if(p>u)for(v=0;v<i;++v)m*=u,u++;return c&&(m=c/m),m},t.gammap=function(l,g){return t.lowRegGamma(l,g)*t.gammafn(l)},t.lowRegGamma=function(l,g){var d=t.gammaln(l),c=l,i=1/l,a=i,s=g+1-l,u=1/1e-30,v=1/s,h=v,p=1,m=-~(o.log(l>=1?l:1/l)*8.5+l*.4+17),E;if(g<0||l<=0)return NaN;if(g<l+1){for(;p<=m;p++)i+=a*=g/++c;return i*o.exp(-g+l*o.log(g)-d)}for(;p<=m;p++)E=-p*(p-l),s+=2,v=E*v+s,u=s+E/u,v=1/v,h*=v*u;return 1-h*o.exp(-g+l*o.log(g)-d)},t.factorialln=function(l){return l<0?NaN:t.gammaln(l+1)},t.factorial=function(l){return l<0?NaN:t.gammafn(l+1)},t.combination=function(l,g){return l>170||g>170?o.exp(t.combinationln(l,g)):t.factorial(l)/t.factorial(g)/t.factorial(l-g)},t.combinationln=function(l,g){return t.factorialln(l)-t.factorialln(g)-t.factorialln(l-g)},t.permutation=function(l,g){return t.factorial(l)/t.factorial(l-g)},t.betafn=function(l,g){if(!(l<=0||g<=0))return l+g>170?o.exp(t.betaln(l,g)):t.gammafn(l)*t.gammafn(g)/t.gammafn(l+g)},t.betaln=function(l,g){return t.gammaln(l)+t.gammaln(g)-t.gammaln(l+g)},t.betacf=function(l,g,d){var c=1e-30,i=1,a=g+d,s=g+1,u=g-1,v=1,h=1-a*l/s,p,m,E,y;for(o.abs(h)<c&&(h=c),h=1/h,y=h;i<=100&&(p=2*i,m=i*(d-i)*l/((u+p)*(g+p)),h=1+m*h,o.abs(h)<c&&(h=c),v=1+m/v,o.abs(v)<c&&(v=c),h=1/h,y*=h*v,m=-(g+i)*(a+i)*l/((g+p)*(s+p)),h=1+m*h,o.abs(h)<c&&(h=c),v=1+m/v,o.abs(v)<c&&(v=c),h=1/h,E=h*v,y*=E,!(o.abs(E-1)<3e-7));i++);return y},t.gammapinv=function(l,g){var d=0,c=g-1,i=1e-8,a=t.gammaln(g),s,u,v,h,p,m,E;if(l>=1)return o.max(100,g+100*o.sqrt(g));if(l<=0)return 0;for(g>1?(m=o.log(c),E=o.exp(c*(m-1)-a),p=l<.5?l:1-l,v=o.sqrt(-2*o.log(p)),s=(2.30753+v*.27061)/(1+v*(.99229+v*.04481))-v,l<.5&&(s=-s),s=o.max(.001,g*o.pow(1-1/(9*g)-s/(3*o.sqrt(g)),3))):(v=1-g*(.253+g*.12),l<v?s=o.pow(l/v,1/g):s=1-o.log(1-(l-v)/(1-v)));d<12;d++){if(s<=0)return 0;if(u=t.lowRegGamma(g,s)-l,g>1?v=E*o.exp(-(s-c)+c*(o.log(s)-m)):v=o.exp(-s+c*o.log(s)-a),h=u/v,s-=v=h/(1-.5*o.min(1,h*((g-1)/s-1))),s<=0&&(s=.5*(s+v)),o.abs(v)<i*s)break}return s},t.erf=function(l){var g=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],d=g.length-1,c=!1,i=0,a=0,s,u,v,h;for(l<0&&(l=-l,c=!0),s=2/(2+l),u=4*s-2;d>0;d--)v=i,i=u*i-a+g[d],a=v;return h=s*o.exp(-l*l+.5*(g[0]+u*i)-a),c?h-1:1-h},t.erfc=function(l){return 1-t.erf(l)},t.erfcinv=function(l){var g=0,d,c,i,a;if(l>=2)return-100;if(l<=0)return 100;for(a=l<1?l:2-l,i=o.sqrt(-2*o.log(a/2)),d=-.70711*((2.30753+i*.27061)/(1+i*(.99229+i*.04481))-i);g<2;g++)c=t.erfc(d)-a,d+=c/(1.1283791670955126*o.exp(-d*d)-d*c);return l<1?d:-d},t.ibetainv=function(l,g,d){var c=1e-8,i=g-1,a=d-1,s=0,u,v,h,p,m,E,y,w,T,R,A;if(l<=0)return 0;if(l>=1)return 1;for(g>=1&&d>=1?(h=l<.5?l:1-l,p=o.sqrt(-2*o.log(h)),y=(2.30753+p*.27061)/(1+p*(.99229+p*.04481))-p,l<.5&&(y=-y),w=(y*y-3)/6,T=2/(1/(2*g-1)+1/(2*d-1)),R=y*o.sqrt(w+T)/T-(1/(2*d-1)-1/(2*g-1))*(w+5/6-2/(3*T)),y=g/(g+d*o.exp(2*R))):(u=o.log(g/(g+d)),v=o.log(d/(g+d)),p=o.exp(g*u)/g,m=o.exp(d*v)/d,R=p+m,l<p/R?y=o.pow(g*R*l,1/g):y=1-o.pow(d*R*(1-l),1/d)),A=-t.gammaln(g)-t.gammaln(d)+t.gammaln(g+d);s<10;s++){if(y===0||y===1)return y;if(E=t.ibeta(y,g,d)-l,p=o.exp(i*o.log(y)+a*o.log(1-y)+A),m=E/p,y-=p=m/(1-.5*o.min(1,m*(i/y-a/(1-y)))),y<=0&&(y=.5*(y+p)),y>=1&&(y=.5*(y+p+1)),o.abs(p)<c*y&&s>0)break}return y},t.ibeta=function(l,g,d){var c=l===0||l===1?0:o.exp(t.gammaln(g+d)-t.gammaln(g)-t.gammaln(d)+g*o.log(l)+d*o.log(1-l));return l<0||l>1?!1:l<(g+1)/(g+d+2)?c*t.betacf(l,g,d)/g:1-c*t.betacf(1-l,d,g)/d},t.randn=function(l,g){var d,c,i,a,s;if(g||(g=l),l)return t.create(l,g,function(){return t.randn()});do d=t._random_fn(),c=1.7156*(t._random_fn()-.5),i=d-.449871,a=o.abs(c)+.386595,s=i*i+a*(.196*a-.25472*i);while(s>.27597&&(s>.27846||c*c>-4*o.log(d)*d*d));return c/d},t.randg=function(l,g,d){var c=l,i,a,s,u,v,h;if(d||(d=g),l||(l=1),g)return h=t.zeros(g,d),h.alter(function(){return t.randg(l)}),h;l<1&&(l+=1),i=l-1/3,a=1/o.sqrt(9*i);do{do v=t.randn(),u=1+a*v;while(u<=0);u=u*u*u,s=t._random_fn()}while(s>1-.331*o.pow(v,4)&&o.log(s)>.5*v*v+i*(1-u+o.log(u)));if(l==c)return i*u;do s=t._random_fn();while(s===0);return o.pow(s,1/c)*i*u},function(f){for(var l=0;l<f.length;l++)(function(g){t.fn[g]=function(){return t(t.map(this,function(d){return t[g](d)}))}})(f[l])}("gammaln gammafn factorial factorialln".split(" ")),function(f){for(var l=0;l<f.length;l++)(function(g){t.fn[g]=function(){return t(t[g].apply(null,arguments))}})(f[l])}("randn".split(" "))}(n,Math),function(t,o){(function(c){for(var i=0;i<c.length;i++)(function(a){t[a]=function s(u,v,h){return this instanceof s?(this._a=u,this._b=v,this._c=h,this):new s(u,v,h)},t.fn[a]=function(s,u,v){var h=t[a](s,u,v);return h.data=this,h},t[a].prototype.sample=function(s){var u=this._a,v=this._b,h=this._c;return s?t.alter(s,function(){return t[a].sample(u,v,h)}):t[a].sample(u,v,h)},function(s){for(var u=0;u<s.length;u++)(function(v){t[a].prototype[v]=function(h){var p=this._a,m=this._b,E=this._c;return!h&&h!==0&&(h=this.data),typeof h!="number"?t.fn.map.call(h,function(y){return t[a][v](y,p,m,E)}):t[a][v](h,p,m,E)}})(s[u])}("pdf cdf inv".split(" ")),function(s){for(var u=0;u<s.length;u++)(function(v){t[a].prototype[v]=function(){return t[a][v](this._a,this._b,this._c)}})(s[u])}("mean median mode variance".split(" "))})(c[i])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),t.extend(t.beta,{pdf:function(i,a,s){return i>1||i<0?0:a==1&&s==1?1:a<512&&s<512?o.pow(i,a-1)*o.pow(1-i,s-1)/t.betafn(a,s):o.exp((a-1)*o.log(i)+(s-1)*o.log(1-i)-t.betaln(a,s))},cdf:function(i,a,s){return i>1||i<0?(i>1)*1:t.ibeta(i,a,s)},inv:function(i,a,s){return t.ibetainv(i,a,s)},mean:function(i,a){return i/(i+a)},median:function(i,a){return t.ibetainv(.5,i,a)},mode:function(i,a){return(i-1)/(i+a-2)},sample:function(i,a){var s=t.randg(i);return s/(s+t.randg(a))},variance:function(i,a){return i*a/(o.pow(i+a,2)*(i+a+1))}}),t.extend(t.centralF,{pdf:function(i,a,s){var u,v,h;return i<0?0:a<=2?i===0&&a<2?1/0:i===0&&a===2?1:1/t.betafn(a/2,s/2)*o.pow(a/s,a/2)*o.pow(i,a/2-1)*o.pow(1+a/s*i,-(a+s)/2):(u=a*i/(s+i*a),v=s/(s+i*a),h=a*v/2,h*t.binomial.pdf((a-2)/2,(a+s-2)/2,u))},cdf:function(i,a,s){return i<0?0:t.ibeta(a*i/(a*i+s),a/2,s/2)},inv:function(i,a,s){return s/(a*(1/t.ibetainv(i,a/2,s/2)-1))},mean:function(i,a){return a>2?a/(a-2):void 0},mode:function(i,a){return i>2?a*(i-2)/(i*(a+2)):void 0},sample:function(i,a){var s=t.randg(i/2)*2,u=t.randg(a/2)*2;return s/i/(u/a)},variance:function(i,a){if(!(a<=4))return 2*a*a*(i+a-2)/(i*(a-2)*(a-2)*(a-4))}}),t.extend(t.cauchy,{pdf:function(i,a,s){return s<0?0:s/(o.pow(i-a,2)+o.pow(s,2))/o.PI},cdf:function(i,a,s){return o.atan((i-a)/s)/o.PI+.5},inv:function(c,i,a){return i+a*o.tan(o.PI*(c-.5))},median:function(i){return i},mode:function(i){return i},sample:function(i,a){return t.randn()*o.sqrt(1/(2*t.randg(.5)))*a+i}}),t.extend(t.chisquare,{pdf:function(i,a){return i<0?0:i===0&&a===2?.5:o.exp((a/2-1)*o.log(i)-i/2-a/2*o.log(2)-t.gammaln(a/2))},cdf:function(i,a){return i<0?0:t.lowRegGamma(a/2,i/2)},inv:function(c,i){return 2*t.gammapinv(c,.5*i)},mean:function(c){return c},median:function(i){return i*o.pow(1-2/(9*i),3)},mode:function(i){return i-2>0?i-2:0},sample:function(i){return t.randg(i/2)*2},variance:function(i){return 2*i}}),t.extend(t.exponential,{pdf:function(i,a){return i<0?0:a*o.exp(-a*i)},cdf:function(i,a){return i<0?0:1-o.exp(-a*i)},inv:function(c,i){return-o.log(1-c)/i},mean:function(c){return 1/c},median:function(c){return 1/c*o.log(2)},mode:function(){return 0},sample:function(i){return-1/i*o.log(t._random_fn())},variance:function(c){return o.pow(c,-2)}}),t.extend(t.gamma,{pdf:function(i,a,s){return i<0?0:i===0&&a===1?1/s:o.exp((a-1)*o.log(i)-i/s-t.gammaln(a)-a*o.log(s))},cdf:function(i,a,s){return i<0?0:t.lowRegGamma(a,i/s)},inv:function(c,i,a){return t.gammapinv(c,i)*a},mean:function(c,i){return c*i},mode:function(i,a){if(i>1)return(i-1)*a},sample:function(i,a){return t.randg(i)*a},variance:function(i,a){return i*a*a}}),t.extend(t.invgamma,{pdf:function(i,a,s){return i<=0?0:o.exp(-(a+1)*o.log(i)-s/i-t.gammaln(a)+a*o.log(s))},cdf:function(i,a,s){return i<=0?0:1-t.lowRegGamma(a,s/i)},inv:function(c,i,a){return a/t.gammapinv(1-c,i)},mean:function(c,i){return c>1?i/(c-1):void 0},mode:function(i,a){return a/(i+1)},sample:function(i,a){return a/t.randg(i)},variance:function(i,a){if(!(i<=2))return a*a/((i-1)*(i-1)*(i-2))}}),t.extend(t.kumaraswamy,{pdf:function(i,a,s){return i===0&&a===1?s:i===1&&s===1?a:o.exp(o.log(a)+o.log(s)+(a-1)*o.log(i)+(s-1)*o.log(1-o.pow(i,a)))},cdf:function(i,a,s){return i<0?0:i>1?1:1-o.pow(1-o.pow(i,a),s)},inv:function(i,a,s){return o.pow(1-o.pow(1-i,1/s),1/a)},mean:function(c,i){return i*t.gammafn(1+1/c)*t.gammafn(i)/t.gammafn(1+1/c+i)},median:function(i,a){return o.pow(1-o.pow(2,-1/a),1/i)},mode:function(i,a){if(i>=1&&a>=1&&i!==1&&a!==1)return o.pow((i-1)/(i*a-1),1/i)},variance:function(){throw new Error("variance not yet implemented")}}),t.extend(t.lognormal,{pdf:function(i,a,s){return i<=0?0:o.exp(-o.log(i)-.5*o.log(2*o.PI)-o.log(s)-o.pow(o.log(i)-a,2)/(2*s*s))},cdf:function(i,a,s){return i<0?0:.5+.5*t.erf((o.log(i)-a)/o.sqrt(2*s*s))},inv:function(c,i,a){return o.exp(-1.4142135623730951*a*t.erfcinv(2*c)+i)},mean:function(i,a){return o.exp(i+a*a/2)},median:function(i){return o.exp(i)},mode:function(i,a){return o.exp(i-a*a)},sample:function(i,a){return o.exp(t.randn()*a+i)},variance:function(i,a){return(o.exp(a*a)-1)*o.exp(2*i+a*a)}}),t.extend(t.noncentralt,{pdf:function(i,a,s){var u=1e-14;return o.abs(s)<u?t.studentt.pdf(i,a):o.abs(i)<u?o.exp(t.gammaln((a+1)/2)-s*s/2-.5*o.log(o.PI*a)-t.gammaln(a/2)):a/i*(t.noncentralt.cdf(i*o.sqrt(1+2/a),a+2,s)-t.noncentralt.cdf(i,a,s))},cdf:function(i,a,s){var u=1e-14,v=200;if(o.abs(s)<u)return t.studentt.cdf(i,a);var h=!1;i<0&&(h=!0,s=-s);for(var p=t.normal.cdf(-s,0,1),m=u+1,E=m,y=i*i/(i*i+a),w=0,T=o.exp(-s*s/2),R=o.exp(-s*s/2-.5*o.log(2)-t.gammaln(3/2))*s;w<v||E>u||m>u;)E=m,w>0&&(T*=s*s/(2*w),R*=s*s/(2*(w+1/2))),m=T*t.beta.cdf(y,w+.5,a/2)+R*t.beta.cdf(y,w+1,a/2),p+=.5*m,w++;return h?1-p:p}}),t.extend(t.normal,{pdf:function(i,a,s){return o.exp(-.5*o.log(2*o.PI)-o.log(s)-o.pow(i-a,2)/(2*s*s))},cdf:function(i,a,s){return .5*(1+t.erf((i-a)/o.sqrt(2*s*s)))},inv:function(c,i,a){return-1.4142135623730951*a*t.erfcinv(2*c)+i},mean:function(c){return c},median:function(i){return i},mode:function(c){return c},sample:function(i,a){return t.randn()*a+i},variance:function(c,i){return i*i}}),t.extend(t.pareto,{pdf:function(i,a,s){return i<a?0:s*o.pow(a,s)/o.pow(i,s+1)},cdf:function(i,a,s){return i<a?0:1-o.pow(a/i,s)},inv:function(i,a,s){return a/o.pow(1-i,1/s)},mean:function(i,a){if(!(a<=1))return a*o.pow(i,a)/(a-1)},median:function(i,a){return i*(a*o.SQRT2)},mode:function(i){return i},variance:function(c,i){if(!(i<=2))return c*c*i/(o.pow(i-1,2)*(i-2))}}),t.extend(t.studentt,{pdf:function(i,a){return a=a>1e100?1e100:a,1/(o.sqrt(a)*t.betafn(.5,a/2))*o.pow(1+i*i/a,-((a+1)/2))},cdf:function(i,a){var s=a/2;return t.ibeta((i+o.sqrt(i*i+a))/(2*o.sqrt(i*i+a)),s,s)},inv:function(c,i){var a=t.ibetainv(2*o.min(c,1-c),.5*i,.5);return a=o.sqrt(i*(1-a)/a),c>.5?a:-a},mean:function(i){return i>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(i){return t.randn()*o.sqrt(i/(2*t.randg(i/2)))},variance:function(i){return i>2?i/(i-2):i>1?1/0:void 0}}),t.extend(t.weibull,{pdf:function(i,a,s){return i<0||a<0||s<0?0:s/a*o.pow(i/a,s-1)*o.exp(-o.pow(i/a,s))},cdf:function(i,a,s){return i<0?0:1-o.exp(-o.pow(i/a,s))},inv:function(c,i,a){return i*o.pow(-o.log(1-c),1/a)},mean:function(c,i){return c*t.gammafn(1+1/i)},median:function(i,a){return i*o.pow(o.log(2),1/a)},mode:function(i,a){return a<=1?0:i*o.pow((a-1)/a,1/a)},sample:function(i,a){return i*o.pow(-o.log(t._random_fn()),1/a)},variance:function(i,a){return i*i*t.gammafn(1+2/a)-o.pow(t.weibull.mean(i,a),2)}}),t.extend(t.uniform,{pdf:function(i,a,s){return i<a||i>s?0:1/(s-a)},cdf:function(i,a,s){return i<a?0:i<s?(i-a)/(s-a):1},inv:function(c,i,a){return i+c*(a-i)},mean:function(i,a){return .5*(i+a)},median:function(i,a){return t.mean(i,a)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(i,a){return i/2+a/2+(a/2-i/2)*(2*t._random_fn()-1)},variance:function(i,a){return o.pow(a-i,2)/12}});function f(c,i,a,s){for(var u=0,v=1,h=1,p=1,m=0,E=0,y;o.abs((h-E)/h)>s;)E=h,y=-(i+m)*(i+a+m)*c/(i+2*m)/(i+2*m+1),u=h+y*u,v=p+y*v,m=m+1,y=m*(a-m)*c/(i+2*m-1)/(i+2*m),h=u+y*h,p=v+y*p,u=u/p,v=v/p,h=h/p,p=1;return h/i}t.extend(t.binomial,{pdf:function(i,a,s){return s===0||s===1?a*s===i?1:0:t.combination(a,i)*o.pow(s,i)*o.pow(1-s,a-i)},cdf:function(i,a,s){var u,v=1e-10;if(i<0)return 0;if(i>=a)return 1;if(s<0||s>1||a<=0)return NaN;i=o.floor(i);var h=s,p=i+1,m=a-i,E=p+m,y=o.exp(t.gammaln(E)-t.gammaln(m)-t.gammaln(p)+p*o.log(h)+m*o.log(1-h));return h<(p+1)/(E+2)?u=y*f(h,p,m,v):u=1-y*f(1-h,m,p,v),o.round((1-u)*(1/v))/(1/v)}}),t.extend(t.negbin,{pdf:function(i,a,s){return i!==i>>>0?!1:i<0?0:t.combination(i+a-1,a-1)*o.pow(1-s,i)*o.pow(s,a)},cdf:function(i,a,s){var u=0,v=0;if(i<0)return 0;for(;v<=i;v++)u+=t.negbin.pdf(v,a,s);return u}}),t.extend(t.hypgeom,{pdf:function(i,a,s,u){if(i!==i|0)return!1;if(i<0||i<s-(a-u))return 0;if(i>u||i>s)return 0;if(s*2>a)return u*2>a?t.hypgeom.pdf(a-s-u+i,a,a-s,a-u):t.hypgeom.pdf(u-i,a,a-s,u);if(u*2>a)return t.hypgeom.pdf(s-i,a,s,a-u);if(s<u)return t.hypgeom.pdf(i,a,u,s);for(var v=1,h=0,p=0;p<i;p++){for(;v>1&&h<u;)v*=1-s/(a-h),h++;v*=(u-p)*(s-p)/((p+1)*(a-s-u+p+1))}for(;h<u;h++)v*=1-s/(a-h);return o.min(1,o.max(0,v))},cdf:function(i,a,s,u){if(i<0||i<s-(a-u))return 0;if(i>=u||i>=s)return 1;if(s*2>a)return u*2>a?t.hypgeom.cdf(a-s-u+i,a,a-s,a-u):1-t.hypgeom.cdf(u-i-1,a,a-s,u);if(u*2>a)return 1-t.hypgeom.cdf(s-i-1,a,s,a-u);if(s<u)return t.hypgeom.cdf(i,a,u,s);for(var v=1,h=1,p=0,m=0;m<i;m++){for(;v>1&&p<u;){var E=1-s/(a-p);h*=E,v*=E,p++}h*=(u-m)*(s-m)/((m+1)*(a-s-u+m+1)),v+=h}for(;p<u;p++)v*=1-s/(a-p);return o.min(1,o.max(0,v))}}),t.extend(t.poisson,{pdf:function(i,a){return a<0||i%1!==0||i<0?0:o.pow(a,i)*o.exp(-a)/t.factorial(i)},cdf:function(i,a){var s=[],u=0;if(i<0)return 0;for(;u<=i;u++)s.push(t.poisson.pdf(u,a));return t.sum(s)},mean:function(c){return c},variance:function(c){return c},sampleSmall:function(i){var a=1,s=0,u=o.exp(-i);do s++,a*=t._random_fn();while(a>u);return s-1},sampleLarge:function(i){var a=i,s,u,v,h,p,m,E,y,w,T;for(h=o.sqrt(a),p=o.log(a),E=.931+2.53*h,m=-.059+.02483*E,y=1.1239+1.1328/(E-3.4),w=.9277-3.6224/(E-2);;){if(u=o.random()-.5,v=o.random(),T=.5-o.abs(u),s=o.floor((2*m/T+E)*u+a+.43),T>=.07&&v<=w)return s;if(!(s<0||T<.013&&v>T)&&o.log(v)+o.log(y)-o.log(m/(T*T)+E)<=-a+s*p-t.loggam(s+1))return s}},sample:function(i){return i<10?this.sampleSmall(i):this.sampleLarge(i)}}),t.extend(t.triangular,{pdf:function(i,a,s,u){return s<=a||u<a||u>s?NaN:i<a||i>s?0:i<u?2*(i-a)/((s-a)*(u-a)):i===u?2/(s-a):2*(s-i)/((s-a)*(s-u))},cdf:function(i,a,s,u){return s<=a||u<a||u>s?NaN:i<=a?0:i>=s?1:i<=u?o.pow(i-a,2)/((s-a)*(u-a)):1-o.pow(s-i,2)/((s-a)*(s-u))},inv:function(i,a,s,u){return s<=a||u<a||u>s?NaN:i<=(u-a)/(s-a)?a+(s-a)*o.sqrt(i*((u-a)/(s-a))):a+(s-a)*(1-o.sqrt((1-i)*(1-(u-a)/(s-a))))},mean:function(i,a,s){return(i+a+s)/3},median:function(i,a,s){if(s<=(i+a)/2)return a-o.sqrt((a-i)*(a-s))/o.sqrt(2);if(s>(i+a)/2)return i+o.sqrt((a-i)*(s-i))/o.sqrt(2)},mode:function(i,a,s){return s},sample:function(i,a,s){var u=t._random_fn();return u<(s-i)/(a-i)?i+o.sqrt(u*(a-i)*(s-i)):a-o.sqrt((1-u)*(a-i)*(a-s))},variance:function(i,a,s){return(i*i+a*a+s*s-i*a-i*s-a*s)/18}}),t.extend(t.arcsine,{pdf:function(i,a,s){return s<=a?NaN:i<=a||i>=s?0:2/o.PI*o.pow(o.pow(s-a,2)-o.pow(2*i-a-s,2),-.5)},cdf:function(i,a,s){return i<a?0:i<s?2/o.PI*o.asin(o.sqrt((i-a)/(s-a))):1},inv:function(c,i,a){return i+(.5-.5*o.cos(o.PI*c))*(a-i)},mean:function(i,a){return a<=i?NaN:(i+a)/2},median:function(i,a){return a<=i?NaN:(i+a)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(i,a){return(i+a)/2+(a-i)/2*o.sin(2*o.PI*t.uniform.sample(0,1))},variance:function(i,a){return a<=i?NaN:o.pow(a-i,2)/8}});function l(c){return c/o.abs(c)}t.extend(t.laplace,{pdf:function(i,a,s){return s<=0?0:o.exp(-o.abs(i-a)/s)/(2*s)},cdf:function(i,a,s){return s<=0?0:i<a?.5*o.exp((i-a)/s):1-.5*o.exp(-(i-a)/s)},mean:function(c){return c},median:function(c){return c},mode:function(c){return c},variance:function(c,i){return 2*i*i},sample:function(i,a){var s=t._random_fn()-.5;return i-a*l(s)*o.log(1-2*o.abs(s))}});function g(c,i,a){var s=12,u=6,v=-30,h=-50,p=60,m=8,E=3,y=2,w=3,T=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],R=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],A=c*.5;if(A>=m)return 1;var O=2*t.normal.cdf(A,0,1,1,0)-1;O>=o.exp(h/a)?O=o.pow(O,a):O=0;var M;c>E?M=y:M=w;for(var b=A,k=(m-A)/M,F=b+k,$=0,Y=a-1,W=1;W<=M;W++){for(var S=0,H=.5*(F+b),J=.5*(F-b),ee=1;ee<=s;ee++){var D,Z;u<ee?(D=s-ee+1,Z=T[D-1]):(D=ee,Z=-T[D-1]);var I=J*Z,_=H+I,C=_*_;if(C>p)break;var P=2*t.normal.cdf(_,0,1,1,0),x=2*t.normal.cdf(_,c,1,1,0),z=P*.5-x*.5;z>=o.exp(v/Y)&&(z=R[D-1]*o.exp(-(.5*C))*o.pow(z,Y),S+=z)}S*=2*J*a/o.sqrt(2*o.PI),$+=S,b=F,F+=k}return O+=$,O<=o.exp(v/i)?0:(O=o.pow(O,i),O>=1?1:O)}function d(c,i,a){var s=.322232421088,u=.099348462606,v=-1,h=.588581570495,p=-.342242088547,m=.531103462366,E=-.204231210125,y=.10353775285,w=-453642210148e-16,T=.0038560700634,R=.8832,A=.2368,O=1.208,M=1.4142,b=120,k=.5-.5*c,F=o.sqrt(o.log(1/(k*k))),$=F+((((F*w+E)*F+p)*F+v)*F+s)/((((F*T+y)*F+m)*F+h)*F+u);a<b&&($+=($*$*$+$)/a/4);var Y=R-A*$;return a<b&&(Y+=-1.214/a+O*$/a),$*(Y*o.log(i-1)+M)}t.extend(t.tukey,{cdf:function(i,a,s){var u=1,v=a,h=16,p=8,m=-30,E=1e-14,y=100,w=800,T=5e3,R=25e3,A=1,O=.5,M=.25,b=.125,k=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],F=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(i<=0)return 0;if(s<2||u<1||v<2)return NaN;if(!Number.isFinite(i))return 1;if(s>R)return g(i,u,v);var $=s*.5,Y=$*o.log(s)-s*o.log(2)-t.gammaln($),W=$-1,S=s*.25,H;s<=y?H=A:s<=w?H=O:s<=T?H=M:H=b,Y+=o.log(H);for(var J=0,ee=1;ee<=50;ee++){for(var D=0,Z=(2*ee-1)*H,I=1;I<=h;I++){var _,C;p<I?(_=I-p-1,C=Y+W*o.log(Z+k[_]*H)-(k[_]*H+Z)*S):(_=I-1,C=Y+W*o.log(Z-k[_]*H)+(k[_]*H-Z)*S);var P;if(C>=m){p<I?P=i*o.sqrt((k[_]*H+Z)*.5):P=i*o.sqrt((-(k[_]*H)+Z)*.5);var x=g(P,u,v),z=x*F[_]*o.exp(C);D+=z}}if(ee*H>=1&&D<=E)break;J+=D}if(D>E)throw new Error("tukey.cdf failed to converge");return J>1&&(J=1),J},inv:function(c,i,a){var s=1,u=i,v=1e-4,h=50;if(a<2||s<1||u<2)return NaN;if(c<0||c>1)return NaN;if(c===0)return 0;if(c===1)return 1/0;var p=d(c,u,a),m=t.tukey.cdf(p,i,a)-c,E;m>0?E=o.max(0,p-1):E=p+1;for(var y=t.tukey.cdf(E,i,a)-c,w,T=1;T<h;T++){w=E-y*(E-p)/(y-m),m=y,p=E,w<0&&(w=0,y=-c),y=t.tukey.cdf(w,i,a)-c,E=w;var R=o.abs(E-p);if(R<v)return w}throw new Error("tukey.inv failed to converge")}})}(n,Math),function(t,o){var f=Array.prototype.push,l=t.utils.isArray;function g(d){return l(d)||d instanceof t}t.extend({add:function(c,i){return g(i)?(g(i[0])||(i=[i]),t.map(c,function(a,s,u){return a+i[s][u]})):t.map(c,function(a){return a+i})},subtract:function(c,i){return g(i)?(g(i[0])||(i=[i]),t.map(c,function(a,s,u){return a-i[s][u]||0})):t.map(c,function(a){return a-i})},divide:function(c,i){return g(i)?(g(i[0])||(i=[i]),t.multiply(c,t.inv(i))):t.map(c,function(a){return a/i})},multiply:function(c,i){var a,s,u,v,h,p,m,E;if(c.length===void 0&&i.length===void 0)return c*i;if(h=c.length,p=c[0].length,m=t.zeros(h,u=g(i)?i[0].length:p),E=0,g(i)){for(;E<u;E++)for(a=0;a<h;a++){for(v=0,s=0;s<p;s++)v+=c[a][s]*i[s][E];m[a][E]=v}return h===1&&E===1?m[0][0]:m}return t.map(c,function(y){return y*i})},outer:function(c,i){return t.multiply(c.map(function(a){return[a]}),[i])},dot:function(c,i){g(c[0])||(c=[c]),g(i[0])||(i=[i]);for(var a=c[0].length===1&&c.length!==1?t.transpose(c):c,s=i[0].length===1&&i.length!==1?t.transpose(i):i,u=[],v=0,h=a.length,p=a[0].length,m,E;v<h;v++){for(u[v]=[],m=0,E=0;E<p;E++)m+=a[v][E]*s[v][E];u[v]=m}return u.length===1?u[0]:u},pow:function(c,i){return t.map(c,function(a){return o.pow(a,i)})},exp:function(c){return t.map(c,function(i){return o.exp(i)})},log:function(c){return t.map(c,function(i){return o.log(i)})},abs:function(c){return t.map(c,function(i){return o.abs(i)})},norm:function(c,i){var a=0,s=0;for(isNaN(i)&&(i=2),g(c[0])&&(c=c[0]);s<c.length;s++)a+=o.pow(o.abs(c[s]),i);return o.pow(a,1/i)},angle:function(c,i){return o.acos(t.dot(c,i)/(t.norm(c)*t.norm(i)))},aug:function(c,i){var a=[],s;for(s=0;s<c.length;s++)a.push(c[s].slice());for(s=0;s<a.length;s++)f.apply(a[s],i[s]);return a},inv:function(c){for(var i=c.length,a=c[0].length,s=t.identity(i,a),u=t.gauss_jordan(c,s),v=[],h=0,p;h<i;h++)for(v[h]=[],p=a;p<u[0].length;p++)v[h][p-a]=u[h][p];return v},det:function d(c){if(c.length===2)return c[0][0]*c[1][1]-c[0][1]*c[1][0];for(var i=0,a=0;a<c.length;a++){for(var s=[],u=1;u<c.length;u++){s[u-1]=[];for(var v=0;v<c.length;v++)v<a?s[u-1][v]=c[u][v]:v>a&&(s[u-1][v-1]=c[u][v])}var h=a%2?-1:1;i+=d(s)*c[0][a]*h}return i},gauss_elimination:function(c,i){var a=0,s=0,u=c.length,v=c[0].length,h=1,p=0,m=[],E,y,w,T;for(c=t.aug(c,i),E=c[0].length,a=0;a<u;a++){for(y=c[a][a],s=a,T=a+1;T<v;T++)y<o.abs(c[T][a])&&(y=c[T][a],s=T);if(s!=a)for(T=0;T<E;T++)w=c[a][T],c[a][T]=c[s][T],c[s][T]=w;for(s=a+1;s<u;s++)for(h=c[s][a]/c[a][a],T=a;T<E;T++)c[s][T]=c[s][T]-h*c[a][T]}for(a=u-1;a>=0;a--){for(p=0,s=a+1;s<=u-1;s++)p=p+m[s]*c[a][s];m[a]=(c[a][E-1]-p)/c[a][a]}return m},gauss_jordan:function(c,i){var a=t.aug(c,i),s=a.length,u=a[0].length,v=0,h,p,m;for(p=0;p<s;p++){var E=p;for(m=p+1;m<s;m++)o.abs(a[m][p])>o.abs(a[E][p])&&(E=m);var y=a[p];for(a[p]=a[E],a[E]=y,m=p+1;m<s;m++)for(v=a[m][p]/a[p][p],h=p;h<u;h++)a[m][h]-=a[p][h]*v}for(p=s-1;p>=0;p--){for(v=a[p][p],m=0;m<p;m++)for(h=u-1;h>p-1;h--)a[m][h]-=a[p][h]*a[m][p]/v;for(a[p][p]/=v,h=s;h<u;h++)a[p][h]/=v}return a},triaUpSolve:function(c,i){var a=c[0].length,s=t.zeros(1,a)[0],u,v=!1;return i[0].length!=null&&(i=i.map(function(h){return h[0]}),v=!0),t.arange(a-1,-1,-1).forEach(function(h){u=t.arange(h+1,a).map(function(p){return s[p]*c[h][p]}),s[h]=(i[h]-t.sum(u))/c[h][h]}),v?s.map(function(h){return[h]}):s},triaLowSolve:function(c,i){var a=c[0].length,s=t.zeros(1,a)[0],u,v=!1;return i[0].length!=null&&(i=i.map(function(h){return h[0]}),v=!0),t.arange(a).forEach(function(h){u=t.arange(h).map(function(p){return c[h][p]*s[p]}),s[h]=(i[h]-t.sum(u))/c[h][h]}),v?s.map(function(h){return[h]}):s},lu:function(c){var i=c.length,a=t.identity(i),s=t.zeros(c.length,c[0].length),u;return t.arange(i).forEach(function(v){s[0][v]=c[0][v]}),t.arange(1,i).forEach(function(v){t.arange(v).forEach(function(h){u=t.arange(h).map(function(p){return a[v][p]*s[p][h]}),a[v][h]=(c[v][h]-t.sum(u))/s[h][h]}),t.arange(v,i).forEach(function(h){u=t.arange(v).map(function(p){return a[v][p]*s[p][h]}),s[v][h]=c[u.length][h]-t.sum(u)})}),[a,s]},cholesky:function(c){var i=c.length,a=t.zeros(c.length,c[0].length),s;return t.arange(i).forEach(function(u){s=t.arange(u).map(function(v){return o.pow(a[u][v],2)}),a[u][u]=o.sqrt(c[u][u]-t.sum(s)),t.arange(u+1,i).forEach(function(v){s=t.arange(u).map(function(h){return a[u][h]*a[v][h]}),a[v][u]=(c[u][v]-t.sum(s))/a[u][u]})}),a},gauss_jacobi:function(c,i,a,s){for(var u=0,v=0,h=c.length,p=[],m=[],E=[],y,w,T,R;u<h;u++)for(p[u]=[],m[u]=[],E[u]=[],v=0;v<h;v++)u>v?(p[u][v]=c[u][v],m[u][v]=E[u][v]=0):u<v?(m[u][v]=c[u][v],p[u][v]=E[u][v]=0):(E[u][v]=c[u][v],p[u][v]=m[u][v]=0);for(T=t.multiply(t.multiply(t.inv(E),t.add(p,m)),-1),w=t.multiply(t.inv(E),i),y=a,R=t.add(t.multiply(T,a),w),u=2;o.abs(t.norm(t.subtract(R,y)))>s;)y=R,R=t.add(t.multiply(T,y),w),u++;return R},gauss_seidel:function(c,i,a,s){for(var u=0,v=c.length,h=[],p=[],m=[],E,y,w,T,R;u<v;u++)for(h[u]=[],p[u]=[],m[u]=[],E=0;E<v;E++)u>E?(h[u][E]=c[u][E],p[u][E]=m[u][E]=0):u<E?(p[u][E]=c[u][E],h[u][E]=m[u][E]=0):(m[u][E]=c[u][E],h[u][E]=p[u][E]=0);for(T=t.multiply(t.multiply(t.inv(t.add(m,h)),p),-1),w=t.multiply(t.inv(t.add(m,h)),i),y=a,R=t.add(t.multiply(T,a),w),u=2;o.abs(t.norm(t.subtract(R,y)))>s;)y=R,R=t.add(t.multiply(T,y),w),u=u+1;return R},SOR:function(c,i,a,s,u){for(var v=0,h=c.length,p=[],m=[],E=[],y,w,T,R,A;v<h;v++)for(p[v]=[],m[v]=[],E[v]=[],y=0;y<h;y++)v>y?(p[v][y]=c[v][y],m[v][y]=E[v][y]=0):v<y?(m[v][y]=c[v][y],p[v][y]=E[v][y]=0):(E[v][y]=c[v][y],p[v][y]=m[v][y]=0);for(R=t.multiply(t.inv(t.add(E,t.multiply(p,u))),t.subtract(t.multiply(E,1-u),t.multiply(m,u))),T=t.multiply(t.multiply(t.inv(t.add(E,t.multiply(p,u))),i),u),w=a,A=t.add(t.multiply(R,a),T),v=2;o.abs(t.norm(t.subtract(A,w)))>s;)w=A,A=t.add(t.multiply(R,w),T),v++;return A},householder:function(c){for(var i=c.length,a=c[0].length,s=0,u=[],v=[],h,p,m,E,y;s<i-1;s++){for(h=0,E=s+1;E<a;E++)h+=c[E][s]*c[E][s];for(y=c[s+1][s]>0?-1:1,h=y*o.sqrt(h),p=o.sqrt((h*h-c[s+1][s]*h)/2),u=t.zeros(i,1),u[s+1][0]=(c[s+1][s]-h)/(2*p),m=s+2;m<i;m++)u[m][0]=c[m][s]/(2*p);v=t.subtract(t.identity(i,a),t.multiply(t.multiply(u,t.transpose(u)),2)),c=t.multiply(v,t.multiply(c,v))}return c},QR:function(){var d=t.sum,c=t.arange;function i(a){var s=a.length,u=a[0].length,v=t.zeros(u,u);a=t.copy(a);var h,p,m;for(p=0;p<u;p++){for(v[p][p]=o.sqrt(d(c(s).map(function(E){return a[E][p]*a[E][p]}))),h=0;h<s;h++)a[h][p]=a[h][p]/v[p][p];for(m=p+1;m<u;m++)for(v[p][m]=d(c(s).map(function(E){return a[E][p]*a[E][m]})),h=0;h<s;h++)a[h][m]=a[h][m]-a[h][p]*v[p][m]}return[a,v]}return i}(),lstsq:function(){function d(i){i=t.copy(i);var a=i.length,s=t.identity(a);return t.arange(a-1,-1,-1).forEach(function(u){t.sliceAssign(s,{row:u},t.divide(t.slice(s,{row:u}),i[u][u])),t.sliceAssign(i,{row:u},t.divide(t.slice(i,{row:u}),i[u][u])),t.arange(u).forEach(function(v){var h=t.multiply(i[v][u],-1),p=t.slice(i,{row:v}),m=t.multiply(t.slice(i,{row:u}),h);t.sliceAssign(i,{row:v},t.add(p,m));var E=t.slice(s,{row:v}),y=t.multiply(t.slice(s,{row:u}),h);t.sliceAssign(s,{row:v},t.add(E,y))})}),s}function c(i,a){var s=!1;a[0].length===void 0&&(a=a.map(function(R){return[R]}),s=!0);var u=t.QR(i),v=u[0],h=u[1],p=i[0].length,m=t.slice(v,{col:{end:p}}),E=t.slice(h,{row:{end:p}}),y=d(E),w=t.transpose(m);w[0].length===void 0&&(w=[w]);var T=t.multiply(t.multiply(y,w),a);return T.length===void 0&&(T=[[T]]),s?T.map(function(R){return R[0]}):T}return c}(),jacobi:function(c){for(var i=1,a=c.length,s=t.identity(a,a),u=[],v,h,p,m,E,y,w,T;i===1;){for(y=c[0][1],m=0,E=1,h=0;h<a;h++)for(p=0;p<a;p++)h!=p&&y<o.abs(c[h][p])&&(y=o.abs(c[h][p]),m=h,E=p);for(c[m][m]===c[E][E]?w=c[m][E]>0?o.PI/4:-o.PI/4:w=o.atan(2*c[m][E]/(c[m][m]-c[E][E]))/2,T=t.identity(a,a),T[m][m]=o.cos(w),T[m][E]=-o.sin(w),T[E][m]=o.sin(w),T[E][E]=o.cos(w),s=t.multiply(s,T),v=t.multiply(t.multiply(t.inv(T),c),T),c=v,i=0,h=1;h<a;h++)for(p=1;p<a;p++)h!=p&&o.abs(c[h][p])>.001&&(i=1)}for(h=0;h<a;h++)u.push(c[h][h]);return[s,u]},rungekutta:function(c,i,a,s,u,v){var h,p,m,E,y;if(v===2)for(;s<=a;)h=i*c(s,u),p=i*c(s+i,u+h),m=u+(h+p)/2,u=m,s=s+i;if(v===4)for(;s<=a;)h=i*c(s,u),p=i*c(s+i/2,u+h/2),E=i*c(s+i/2,u+p/2),y=i*c(s+i,u+E),m=u+(h+2*p+2*E+y)/6,u=m,s=s+i;return u},romberg:function(c,i,a,s){for(var u=0,v=(a-i)/2,h=[],p=[],m=[],E,y,w,T,R;u<s/2;){for(R=c(i),w=i,T=0;w<=a;w=w+v,T++)h[T]=w;for(E=h.length,w=1;w<E-1;w++)R+=(w%2!==0?4:2)*c(h[w]);R=v/3*(R+c(a)),m[u]=R,v/=2,u++}for(y=m.length,E=1;y!==1;){for(w=0;w<y-1;w++)p[w]=(o.pow(4,E)*m[w+1]-m[w])/(o.pow(4,E)-1);y=p.length,m=p,p=[],E++}return m},richardson:function(c,i,a,s){function u(A,O){for(var M=0,b=A.length,k;M<b;M++)A[M]===O&&(k=M);return k}for(var v=o.abs(a-c[u(c,a)+1]),h=0,p=[],m=[],E,y,w,T,R;s>=v;)E=u(c,a+s),y=u(c,a),p[h]=(i[E]-2*i[y]+i[2*y-E])/(s*s),s/=2,h++;for(T=p.length,w=1;T!=1;){for(R=0;R<T-1;R++)m[R]=(o.pow(4,w)*p[R+1]-p[R])/(o.pow(4,w)-1);T=m.length,p=m,m=[],w++}return p},simpson:function(c,i,a,s){for(var u=(a-i)/s,v=c(i),h=[],p=i,m=0,E=1,y;p<=a;p=p+u,m++)h[m]=p;for(y=h.length;E<y-1;E++)v+=(E%2!==0?4:2)*c(h[E]);return u/3*(v+c(a))},hermite:function(c,i,a,s){for(var u=c.length,v=0,h=0,p=[],m=[],E=[],y=[],w;h<u;h++){for(p[h]=1,w=0;w<u;w++)h!=w&&(p[h]*=(s-c[w])/(c[h]-c[w]));for(m[h]=0,w=0;w<u;w++)h!=w&&(m[h]+=1/(c[h]-c[w]));E[h]=(1-2*(s-c[h])*m[h])*(p[h]*p[h]),y[h]=(s-c[h])*(p[h]*p[h]),v+=E[h]*i[h]+y[h]*a[h]}return v},lagrange:function(c,i,a){for(var s=0,u=0,v,h,p=c.length;u<p;u++){for(h=i[u],v=0;v<p;v++)u!=v&&(h*=(a-c[v])/(c[u]-c[v]));s+=h}return s},cubic_spline:function(c,i,a){for(var s=c.length,u=0,v,h=[],p=[],m=[],E=[],y=[],w=[],T=[];u<s-1;u++)y[u]=c[u+1]-c[u];for(m[0]=0,u=1;u<s-1;u++)m[u]=3/y[u]*(i[u+1]-i[u])-3/y[u-1]*(i[u]-i[u-1]);for(u=1;u<s-1;u++)h[u]=[],p[u]=[],h[u][u-1]=y[u-1],h[u][u]=2*(y[u-1]+y[u]),h[u][u+1]=y[u],p[u][0]=m[u];for(E=t.multiply(t.inv(h),p),v=0;v<s-1;v++)w[v]=(i[v+1]-i[v])/y[v]-y[v]*(E[v+1][0]+2*E[v][0])/3,T[v]=(E[v+1][0]-E[v][0])/(3*y[v]);for(v=0;v<s&&!(c[v]>a);v++);return v-=1,i[v]+(a-c[v])*w[v]+t.sq(a-c[v])*E[v]+(a-c[v])*t.sq(a-c[v])*T[v]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(c){var i=c.length,a=c[0].length,s=0,u,v,h=[],p=[],m=[],E=[],y=[],w=[],T=[],R=[],A=[],O=[];for(s=0;s<i;s++)h[s]=t.sum(c[s])/a;for(s=0;s<a;s++)for(T[s]=[],u=0;u<i;u++)T[s][u]=c[u][s]-h[u];for(T=t.transpose(T),s=0;s<i;s++)for(R[s]=[],u=0;u<i;u++)R[s][u]=t.dot([T[s]],[T[u]])/(a-1);for(m=t.jacobi(R),A=m[0],p=m[1],O=t.transpose(A),s=0;s<p.length;s++)for(u=s;u<p.length;u++)p[s]<p[u]&&(v=p[s],p[s]=p[u],p[u]=v,E=O[s],O[s]=O[u],O[u]=E);for(w=t.transpose(T),s=0;s<i;s++)for(y[s]=[],u=0;u<w.length;u++)y[s][u]=t.dot([O[s]],[w[u]]);return[c,p,O,y]}}),function(d){for(var c=0;c<d.length;c++)(function(i){t.fn[i]=function(a,s){var u=this;return s?(setTimeout(function(){s.call(u,t.fn[i].call(u,a))},15),this):typeof t[i](this,a)=="number"?t[i](this,a):t(t[i](this,a))}})(d[c])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(n,Math),function(t,o){var f=[].slice,l=t.utils.isNumber,g=t.utils.isArray;t.extend({zscore:function(){var i=f.call(arguments);return l(i[1])?(i[0]-i[1])/i[2]:(i[0]-t.mean(i[1]))/t.stdev(i[1],i[2])},ztest:function(){var i=f.call(arguments),a;return g(i[1])?(a=t.zscore(i[0],i[1],i[3]),i[2]===1?t.normal.cdf(-o.abs(a),0,1):t.normal.cdf(-o.abs(a),0,1)*2):i.length>2?(a=t.zscore(i[0],i[1],i[2]),i[3]===1?t.normal.cdf(-o.abs(a),0,1):t.normal.cdf(-o.abs(a),0,1)*2):(a=i[0],i[1]===1?t.normal.cdf(-o.abs(a),0,1):t.normal.cdf(-o.abs(a),0,1)*2)}}),t.extend(t.fn,{zscore:function(i,a){return(i-this.mean())/this.stdev(a)},ztest:function(i,a,s){var u=o.abs(this.zscore(i,s));return a===1?t.normal.cdf(-u,0,1):t.normal.cdf(-u,0,1)*2}}),t.extend({tscore:function(){var i=f.call(arguments);return i.length===4?(i[0]-i[1])/(i[2]/o.sqrt(i[3])):(i[0]-t.mean(i[1]))/(t.stdev(i[1],!0)/o.sqrt(i[1].length))},ttest:function(){var i=f.call(arguments),a;return i.length===5?(a=o.abs(t.tscore(i[0],i[1],i[2],i[3])),i[4]===1?t.studentt.cdf(-a,i[3]-1):t.studentt.cdf(-a,i[3]-1)*2):l(i[1])?(a=o.abs(i[0]),i[2]==1?t.studentt.cdf(-a,i[1]-1):t.studentt.cdf(-a,i[1]-1)*2):(a=o.abs(t.tscore(i[0],i[1])),i[2]==1?t.studentt.cdf(-a,i[1].length-1):t.studentt.cdf(-a,i[1].length-1)*2)}}),t.extend(t.fn,{tscore:function(i){return(i-this.mean())/(this.stdev(!0)/o.sqrt(this.cols()))},ttest:function(i,a){return a===1?1-t.studentt.cdf(o.abs(this.tscore(i)),this.cols()-1):t.studentt.cdf(-o.abs(this.tscore(i)),this.cols()-1)*2}}),t.extend({anovafscore:function(){var i=f.call(arguments),a,s,u,v,h,p,m,E;if(i.length===1){for(h=new Array(i[0].length),m=0;m<i[0].length;m++)h[m]=i[0][m];i=h}for(s=new Array,m=0;m<i.length;m++)s=s.concat(i[m]);for(u=t.mean(s),a=0,m=0;m<i.length;m++)a=a+i[m].length*o.pow(t.mean(i[m])-u,2);for(a/=i.length-1,p=0,m=0;m<i.length;m++)for(v=t.mean(i[m]),E=0;E<i[m].length;E++)p+=o.pow(i[m][E]-v,2);return p/=s.length-i.length,a/p},anovaftest:function(){var i=f.call(arguments),a,s,u,v;if(l(i[0]))return 1-t.centralF.cdf(i[0],i[1],i[2]);var h=t.anovafscore(i);for(a=i.length-1,u=0,v=0;v<i.length;v++)u=u+i[v].length;return s=u-a-1,1-t.centralF.cdf(h,a,s)},ftest:function(i,a,s){return 1-t.centralF.cdf(i,a,s)}}),t.extend(t.fn,{anovafscore:function(){return t.anovafscore(this.toArray())},anovaftes:function(){var i=0,a;for(a=0;a<this.length;a++)i=i+this[a].length;return t.ftest(this.anovafscore(),this.length-1,i-this.length)}}),t.extend({qscore:function(){var i=f.call(arguments),a,s,u,v,h;return l(i[0])?(a=i[0],s=i[1],u=i[2],v=i[3],h=i[4]):(a=t.mean(i[0]),s=t.mean(i[1]),u=i[0].length,v=i[1].length,h=i[2]),o.abs(a-s)/(h*o.sqrt((1/u+1/v)/2))},qtest:function(){var i=f.call(arguments),a;i.length===3?(a=i[0],i=i.slice(1)):i.length===7?(a=t.qscore(i[0],i[1],i[2],i[3],i[4]),i=i.slice(5)):(a=t.qscore(i[0],i[1],i[2]),i=i.slice(3));var s=i[0],u=i[1];return 1-t.tukey.cdf(a,u,s-u)},tukeyhsd:function(i){for(var a=t.pooledstdev(i),s=i.map(function(E){return t.mean(E)}),u=i.reduce(function(E,y){return E+y.length},0),v=[],h=0;h<i.length;++h)for(var p=h+1;p<i.length;++p){var m=t.qtest(s[h],s[p],i[h].length,i[p].length,a,u,i.length);v.push([[h,p],m])}return v}}),t.extend({normalci:function(){var i=f.call(arguments),a=new Array(2),s;return i.length===4?s=o.abs(t.normal.inv(i[1]/2,0,1)*i[2]/o.sqrt(i[3])):s=o.abs(t.normal.inv(i[1]/2,0,1)*t.stdev(i[2])/o.sqrt(i[2].length)),a[0]=i[0]-s,a[1]=i[0]+s,a},tci:function(){var i=f.call(arguments),a=new Array(2),s;return i.length===4?s=o.abs(t.studentt.inv(i[1]/2,i[3]-1)*i[2]/o.sqrt(i[3])):s=o.abs(t.studentt.inv(i[1]/2,i[2].length-1)*t.stdev(i[2],!0)/o.sqrt(i[2].length)),a[0]=i[0]-s,a[1]=i[0]+s,a},significant:function(i,a){return i<a}}),t.extend(t.fn,{normalci:function(i,a){return t.normalci(i,a,this.toArray())},tci:function(i,a){return t.tci(i,a,this.toArray())}});function d(c,i,a,s){if(c>1||a>1||c<=0||a<=0)throw new Error("Proportions should be greater than 0 and less than 1");var u=(c*i+a*s)/(i+s),v=o.sqrt(u*(1-u)*(1/i+1/s));return(c-a)/v}t.extend(t.fn,{oneSidedDifferenceOfProportions:function(i,a,s,u){var v=d(i,a,s,u);return t.ztest(v,1)},twoSidedDifferenceOfProportions:function(i,a,s,u){var v=d(i,a,s,u);return t.ztest(v,2)}})}(n,Math),n.models=function(){function t(d){var c=d[0].length,i=n.arange(c).map(function(a){var s=n.arange(c).filter(function(u){return u!==a});return o(n.col(d,a).map(function(u){return u[0]}),n.col(d,s))});return i}function o(d,c){var i=d.length,a=c[0].length-1,s=i-a-1,u=n.lstsq(c,d),v=n.multiply(c,u.map(function(T){return[T]})).map(function(T){return T[0]}),h=n.subtract(d,v),p=n.mean(d),m=n.sum(v.map(function(T){return Math.pow(T-p,2)})),E=n.sum(d.map(function(T,R){return Math.pow(T-v[R],2)})),y=m+E,w=m/y;return{exog:c,endog:d,nobs:i,df_model:a,df_resid:s,coef:u,predict:v,resid:h,ybar:p,SST:y,SSE:m,SSR:E,R2:w}}function f(d){var c=t(d.exog),i=Math.sqrt(d.SSR/d.df_resid),a=c.map(function(p){var m=p.SST,E=p.R2;return i/Math.sqrt(m*(1-E))}),s=d.coef.map(function(p,m){return(p-0)/a[m]}),u=s.map(function(p){var m=n.studentt.cdf(p,d.df_resid);return(m>.5?1-m:m)*2}),v=n.studentt.inv(.975,d.df_resid),h=d.coef.map(function(p,m){var E=v*a[m];return[p-E,p+E]});return{se:a,t:s,p:u,sigmaHat:i,interval95:h}}function l(d){var c=d.R2/d.df_model/((1-d.R2)/d.df_resid),i=function(s,u,v){return n.beta.cdf(s/(v/u+s),u/2,v/2)},a=1-i(c,d.df_model,d.df_resid);return{F_statistic:c,pvalue:a}}function g(d,c){var i=o(d,c),a=f(i),s=l(i),u=1-(1-i.R2)*((i.nobs-1)/i.df_resid);return i.t=a,i.f=s,i.adjust_R2=u,i}return{ols:g}}(),n.extend({buildxmatrix:function(){for(var o=new Array(arguments.length),f=0;f<arguments.length;f++){var l=[1];o[f]=l.concat(arguments[f])}return n(o)},builddxmatrix:function(){for(var o=new Array(arguments[0].length),f=0;f<arguments[0].length;f++){var l=[1];o[f]=l.concat(arguments[0][f])}return n(o)},buildjxmatrix:function(o){for(var f=new Array(o.length),l=0;l<o.length;l++)f[l]=o[l];return n.builddxmatrix(f)},buildymatrix:function(o){return n(o).transpose()},buildjymatrix:function(o){return o.transpose()},matrixmult:function(o,f){var l,g,d,c,i;if(o.cols()==f.rows()){if(f.rows()>1){for(c=[],l=0;l<o.rows();l++)for(c[l]=[],g=0;g<f.cols();g++){for(i=0,d=0;d<o.cols();d++)i+=o.toArray()[l][d]*f.toArray()[d][g];c[l][g]=i}return n(c)}for(c=[],l=0;l<o.rows();l++)for(c[l]=[],g=0;g<f.cols();g++){for(i=0,d=0;d<o.cols();d++)i+=o.toArray()[l][d]*f.toArray()[g];c[l][g]=i}return n(c)}},regress:function(o,f){var l=n.xtranspxinv(o),g=o.transpose(),d=n.matrixmult(n(l),g);return n.matrixmult(d,f)},regresst:function(o,f,l){var g=n.regress(o,f),d={};d.anova={};var c=n.jMatYBar(o,g);d.yBar=c;var i=f.mean();d.anova.residuals=n.residuals(f,c),d.anova.ssr=n.ssr(c,i),d.anova.msr=d.anova.ssr/(o[0].length-1),d.anova.sse=n.sse(f,c),d.anova.mse=d.anova.sse/(f.length-(o[0].length-1)-1),d.anova.sst=n.sst(f,i),d.anova.mst=d.anova.sst/(f.length-1),d.anova.r2=1-d.anova.sse/d.anova.sst,d.anova.r2<0&&(d.anova.r2=0),d.anova.fratio=d.anova.msr/d.anova.mse,d.anova.pvalue=n.anovaftest(d.anova.fratio,o[0].length-1,f.length-(o[0].length-1)-1),d.anova.rmse=Math.sqrt(d.anova.mse),d.anova.r2adj=1-d.anova.mse/d.anova.mst,d.anova.r2adj<0&&(d.anova.r2adj=0),d.stats=new Array(o[0].length);for(var a=n.xtranspxinv(o),s,u,v,h=0;h<g.length;h++)s=Math.sqrt(d.anova.mse*Math.abs(a[h][h])),u=Math.abs(g[h]/s),v=n.ttest(u,f.length-o[0].length-1,l),d.stats[h]=[g[h],s,u,v];return d.regress=g,d},xtranspx:function(o){return n.matrixmult(o.transpose(),o)},xtranspxinv:function(o){var f=n.matrixmult(o.transpose(),o),l=n.inv(f);return l},jMatYBar:function(o,f){var l=n.matrixmult(o,f);return new n(l)},residuals:function(o,f){return n.matrixsubtract(o,f)},ssr:function(o,f){for(var l=0,g=0;g<o.length;g++)l+=Math.pow(o[g]-f,2);return l},sse:function(o,f){for(var l=0,g=0;g<o.length;g++)l+=Math.pow(o[g]-f[g],2);return l},sst:function(o,f){for(var l=0,g=0;g<o.length;g++)l+=Math.pow(o[g]-f,2);return l},matrixsubtract:function(o,f){for(var l=new Array(o.length),g=0;g<o.length;g++){l[g]=new Array(o[g].length);for(var d=0;d<o[g].length;d++)l[g][d]=o[g][d]-f[g][d]}return n(l)}}),n.jStat=n,n})}(Mr)),Mr.exports}var Wo,$a;function wf(){if($a)return Wo;$a=1;const e=Fe(),r=Tc(),{FormulaHelpers:n,Types:t}=Ve(),o=n,f=Ef(),l=Cc(),g=536870911,d=-536870912,c=511,i=-512,a=/^\s?[+-]?\s?[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?\s?$/,s=/^\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)?)\s?[ij]\s?$/,u=/^\s?([+-]?\s?[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)?)\s?[ij]\s?$/;function v(p){p=o.accept(p);let m=0,E=0,y="i";if(typeof p=="number")return{real:p,im:E,unit:y};if(typeof p=="boolean")throw e.VALUE;let w=p.match(a);if(w)return m=Number(w[0]),{real:m,im:E,unit:y};if(w=p.match(s),w)return E=Number(/^\s?[+-]?\s?$/.test(w[1])?w[1]+"1":w[1]),y=w[0].slice(-1),{real:m,im:E,unit:y};if(w=p.match(u),w)return m=Number(w[1]),E=Number(/^\s?[+-]?\s?$/.test(w[3])?w[3]+"1":w[3]),y=w[0].slice(-1),{real:m,im:E,unit:y};throw e.NUM}const h={BESSELI:(p,m)=>{if(p=o.accept(p,t.NUMBER_NO_BOOLEAN),m=o.accept(m,t.NUMBER_NO_BOOLEAN),m=Math.trunc(m),m<0)throw e.NUM;return f.besseli(p,m)},BESSELJ:(p,m)=>{if(p=o.accept(p,t.NUMBER_NO_BOOLEAN),m=o.accept(m,t.NUMBER_NO_BOOLEAN),m=Math.trunc(m),m<0)throw e.NUM;return f.besselj(p,m)},BESSELK:(p,m)=>{if(p=o.accept(p,t.NUMBER_NO_BOOLEAN),m=o.accept(m,t.NUMBER_NO_BOOLEAN),m=Math.trunc(m),m<0)throw e.NUM;return f.besselk(p,m)},BESSELY:(p,m)=>{if(p=o.accept(p,t.NUMBER_NO_BOOLEAN),m=o.accept(m,t.NUMBER_NO_BOOLEAN),m=Math.trunc(m),m<0)throw e.NUM;return f.bessely(p,m)},BIN2DEC:p=>{p=o.accept(p,t.NUMBER_NO_BOOLEAN);let m=p.toString();if(m.length>10)throw e.NUM;return m.length===10&&m.substring(0,1)==="1"?parseInt(m.substring(1),2)+i:parseInt(m,2)},BIN2HEX:(p,m)=>{p=o.accept(p,t.NUMBER_NO_BOOLEAN),m=o.accept(m,t.NUMBER_NO_BOOLEAN,null);const E=p.toString();if(E.length>10)throw e.NUM;if(E.length===10&&E.substring(0,1)==="1")return(parseInt(E.substring(1),2)+0xfffffffe00).toString(16).toUpperCase();const y=parseInt(p,2).toString(16);if(m==null)return y.toUpperCase();if(m<0)throw e.NUM;if(m=Math.trunc(m),m>=y.length)return(r.REPT("0",m-y.length)+y).toUpperCase();throw e.NUM},BIN2OCT:(p,m)=>{p=o.accept(p,t.NUMBER_NO_BOOLEAN),m=o.accept(m,t.NUMBER,null);let E=p.toString();if(E.length>10)throw e.NUM;if(E.length===10&&E.substr(0,1)==="1")return(parseInt(E.substr(1),2)+1073741312).toString(8);let y=parseInt(p,2).toString(8);if(m==null)return y.toUpperCase();if(m<0)throw e.NUM;if(m=Math.trunc(m),m>=y.length)return r.REPT("0",m-y.length)+y;throw e.NUM},BITAND:(p,m)=>{if(p=o.accept(p,t.NUMBER),m=o.accept(m,t.NUMBER),p<0||m<0||Math.floor(p)!==p||Math.floor(m)!==m||p>0xffffffffffff||m>0xffffffffffff)throw e.NUM;return p&m},BITLSHIFT:(p,m)=>{if(p=o.accept(p,t.NUMBER),m=o.accept(m,t.NUMBER),m=Math.trunc(m),Math.abs(m)>53||p<0||Math.floor(p)!==p||p>0xffffffffffff)throw e.NUM;const E=m>=0?p*2**m:Math.trunc(p/2**-m);if(E>0xffffffffffff)throw e.NUM;return E},BITOR:(p,m)=>{if(p=o.accept(p,t.NUMBER),m=o.accept(m,t.NUMBER),p<0||m<0||Math.floor(p)!==p||Math.floor(m)!==m||p>0xffffffffffff||m>0xffffffffffff)throw e.NUM;return p|m},BITRSHIFT:(p,m)=>(p=o.accept(p,t.NUMBER),m=o.accept(m,t.NUMBER),h.BITLSHIFT(p,-m)),BITXOR:(p,m)=>{if(p=o.accept(p,t.NUMBER),m=o.accept(m,t.NUMBER),p<0||p>0xffffffffffff||Math.floor(p)!==p||m<0||m>0xffffffffffff||Math.floor(m)!==m)throw e.NUM;return p^m},COMPLEX:(p,m,E)=>{if(p=o.accept(p,t.NUMBER_NO_BOOLEAN),m=o.accept(m,t.NUMBER_NO_BOOLEAN),E=o.accept(E,t.STRING,"i"),E!=="i"&&E!=="j")throw e.VALUE;if(p===0&&m===0)return 0;if(p===0)return m===1?E:m===-1?"-"+E:m.toString()+E;if(m===0)return p.toString();{let y=m>0?"+":"";return m===1?p.toString()+y+E:m===-1?p.toString()+y+"-"+E:p.toString()+y+m.toString()+E}},DEC2BIN:(p,m)=>{if(p=o.accept(p,t.NUMBER),m=o.accept(m,t.NUMBER,null),p<i||p>c)throw e.NUM;if(p<0)return"1"+r.REPT("0",9-(512+p).toString(2).length)+(512+p).toString(2);let E=parseInt(p,10).toString(2);if(m==null)return E;if(m=Math.trunc(m),m<=0||m<E.length)throw e.NUM;return r.REPT("0",m-E.length)+E},DEC2HEX:(p,m)=>{if(p=o.accept(p,t.NUMBER),m=o.accept(m,t.NUMBER,null),p<-549755813888||p>549755813888)throw e.NUM;if(p<0)return(1099511627776+p).toString(16).toUpperCase();let E=parseInt(p,10).toString(16);if(m==null)return E.toUpperCase();if(m=Math.trunc(m),m<=0||m<E.length)throw e.NUM;return r.REPT("0",m-E.length)+E.toUpperCase()},DEC2OCT:(p,m)=>{if(p=o.accept(p,t.NUMBER),m=o.accept(m,t.NUMBER,null),p<-536870912||p>536870912)throw e.NUM;if(p<0)return(p+1073741824).toString(8);let E=parseInt(p,10).toString(8);if(m==null)return E.toUpperCase();if(m=Math.trunc(m),m<=0||m<E.length)throw e.NUM;return r.REPT("0",m-E.length)+E},DELTA:(p,m)=>(p=o.accept(p,t.NUMBER_NO_BOOLEAN),m=o.accept(m,t.NUMBER_NO_BOOLEAN,0),p===m?1:0),ERF:(p,m)=>(p=o.accept(p,t.NUMBER_NO_BOOLEAN),m=o.accept(m,t.NUMBER_NO_BOOLEAN,0),l.erf(p)),ERFC:p=>(p=o.accept(p,t.NUMBER_NO_BOOLEAN),l.erfc(p)),GESTEP:(p,m)=>(p=o.accept(p,t.NUMBER_NO_BOOLEAN),m=o.accept(m,t.NUMBER_NO_BOOLEAN,0),p>=m?1:0),HEX2BIN:(p,m)=>{if(p=o.accept(p,t.STRING),m=o.accept(m,t.NUMBER,null),p.length>10||!/^[0-9a-fA-F]*$/.test(p))throw e.NUM;let E=p.length===10&&p.substr(0,1).toLowerCase()==="f",y=E?parseInt(p,16)-1099511627776:parseInt(p,16);if(y<i||y>c)throw e.NUM;if(E)return"1"+r.REPT("0",9-(y+512).toString(2).length)+(y+512).toString(2);let w=y.toString(2);if(m==null)return w;if(m=Math.trunc(m),m<=0||m<w.length)throw e.NUM;return r.REPT("0",m-w.length)+w},HEX2DEC:p=>{if(p=o.accept(p,t.STRING),p.length>10||!/^[0-9a-fA-F]*$/.test(p))throw e.NUM;let m=parseInt(p,16);return m>=549755813888?m-1099511627776:m},HEX2OCT:(p,m)=>{if(p=o.accept(p,t.STRING),p.length>10||!/^[0-9a-fA-F]*$/.test(p))throw e.NUM;let E=h.HEX2DEC(p);if(E>g||E<d)throw e.NUM;return h.DEC2OCT(E,m)},IMABS:p=>{const{real:m,im:E}=v(p);return Math.sqrt(Math.pow(m,2)+Math.pow(E,2))},IMAGINARY:p=>v(p).im,IMARGUMENT:p=>{const{real:m,im:E}=v(p);if(m===0&&E===0)throw e.DIV0;return m===0&&E>0?Math.PI/2:m===0&&E<0?-Math.PI/2:m<0&&E===0?Math.PI:m>0&&E===0?0:m>0?Math.atan(E/m):m<0&&E>0?Math.atan(E/m)+Math.PI:Math.atan(E/m)-Math.PI},IMCONJUGATE:p=>{const{real:m,im:E,unit:y}=v(p);return E!==0?h.COMPLEX(m,-E,y):""+m},IMCOS:p=>{const{real:m,im:E,unit:y}=v(p);let w=Math.cos(m)*(Math.exp(E)+Math.exp(-E))/2,T=-Math.sin(m)*(Math.exp(E)-Math.exp(-E))/2;return h.COMPLEX(w,T,y)},IMCOSH:p=>{const{real:m,im:E,unit:y}=v(p);let w=Math.cos(E)*(Math.exp(m)+Math.exp(-m))/2,T=-Math.sin(E)*(Math.exp(m)-Math.exp(-m))/2;return h.COMPLEX(w,-T,y)},IMCOT:p=>{p=o.accept(p);let m=h.IMCOS(p),E=h.IMSIN(p);return h.IMDIV(m,E)},IMCSC:p=>(p=o.accept(p),h.IMDIV("1",h.IMSIN(p))),IMCSCH:p=>(p=o.accept(p),h.IMDIV("1",h.IMSINH(p))),IMDIV:(p,m)=>{const E=v(p),y=E.real,w=E.im,T=E.unit,R=v(m),A=R.real,O=R.im,M=R.unit;if(A===0&&O===0||T!==M)throw e.NUM;let b=T,k=Math.pow(A,2)+Math.pow(O,2);return h.COMPLEX((y*A+w*O)/k,(w*A-y*O)/k,b)},IMEXP:p=>{const{real:m,im:E,unit:y}=v(p);let w=Math.exp(m);return h.COMPLEX(w*Math.cos(E),w*Math.sin(E),y)},IMLN:p=>{const{real:m,im:E,unit:y}=v(p);return h.COMPLEX(Math.log(Math.sqrt(Math.pow(m,2)+Math.pow(E,2))),Math.atan(E/m),y)},IMLOG10:p=>{const{real:m,im:E,unit:y}=v(p);let w=Math.log(Math.sqrt(Math.pow(m,2)+Math.pow(E,2)))/Math.log(10),T=Math.atan(E/m)/Math.log(10);return h.COMPLEX(w,T,y)},IMLOG2:p=>{const{real:m,im:E,unit:y}=v(p);let w=Math.log(Math.sqrt(Math.pow(m,2)+Math.pow(E,2)))/Math.log(2),T=Math.atan(E/m)/Math.log(2);return h.COMPLEX(w,T,y)},IMPOWER:(p,m)=>{let{unit:E}=v(p);m=o.accept(m,t.NUMBER_NO_BOOLEAN);let y=Math.pow(h.IMABS(p),m),w=h.IMARGUMENT(p),T=y*Math.cos(m*w),R=y*Math.sin(m*w);return h.COMPLEX(T,R,E)},IMPRODUCT:(...p)=>{let m,E=0;return o.flattenParams(p,null,!1,y=>{if(E===0)m=o.accept(y),v(m);else{const w=v(m),T=w.real,R=w.im,A=w.unit,O=v(y),M=O.real,b=O.im,k=O.unit;if(A!==k)throw e.VALUE;m=h.COMPLEX(T*M-R*b,T*b+R*M)}E++},1),m},IMREAL:p=>v(p).real,IMSEC:p=>h.IMDIV("1",h.IMCOS(p)),IMSECH:p=>h.IMDIV("1",h.IMCOSH(p)),IMSIN:p=>{const{real:m,im:E,unit:y}=v(p);let w=Math.sin(m)*(Math.exp(E)+Math.exp(-E))/2,T=Math.cos(m)*(Math.exp(E)-Math.exp(-E))/2;return h.COMPLEX(w,T,y)},IMSINH:p=>{const{real:m,im:E,unit:y}=v(p);let w=Math.cos(E)*(Math.exp(m)-Math.exp(-m))/2,T=Math.sin(E)*(Math.exp(m)+Math.exp(-m))/2;return h.COMPLEX(w,T,y)},IMSQRT:p=>{const{unit:m}=v(p);let E=Math.sqrt(h.IMABS(p)),y=h.IMARGUMENT(p);return h.COMPLEX(E*Math.cos(y/2),E*Math.sin(y/2),m)},IMSUB:(p,m)=>{const E=v(p),y=E.real,w=E.im,T=E.unit,R=v(m),A=R.real,O=R.im,M=R.unit;if(T!==M)throw e.VALUE;return h.COMPLEX(y-A,w-O,T)},IMSUM:(...p)=>{let m=0,E=0,y;return o.flattenParams(p,null,!1,w=>{const{real:T,im:R,unit:A}=v(w);if(y||(y=A),y!==A)throw e.VALUE;m+=T,E+=R}),h.COMPLEX(m,E,y)},IMTAN:p=>{const{unit:m}=v(p);return h.IMDIV(h.IMSIN(p),h.IMCOS(p),m)},OCT2BIN:(p,m)=>{if(p=o.accept(p,t.STRING),m=o.accept(m,t.NUMBER,null),p.length>10||m>10||m!==null&&m<0)throw e.NUM;m=Math.trunc(m);let E=p.length===10&&p.substring(0,1)==="7",y=h.OCT2DEC(p);if(y<i||y>c)return e.NUM;if(E)return"1"+r.REPT("0",9-(512+y).toString(2).length)+(512+y).toString(2);let w=y.toString(2);if(m===0)return w;if(m<w.length)throw e.NUM;return r.REPT("0",m-w.length)+w},OCT2DEC:p=>{if(p=o.accept(p,t.STRING),p.length>10)throw e.NUM;for(const E of p)if(E<"0"||E>"7")throw e.NUM;let m=parseInt(p,8);return m>=536870912?m-1073741824:m},OCT2HEX:(p,m)=>{if(p=o.accept(p,t.STRING),m=o.accept(m,t.NUMBER_NO_BOOLEAN,null),p.length>10)throw e.NUM;for(const w of p)if(w<"0"||w>"7")throw e.NUM;if(m=Math.trunc(m),m<0||m>10)throw e.NUM;let E=h.OCT2DEC(p),y=h.DEC2HEX(E);if(m===0)return y;if(m<y.length)throw e.NUM;return r.REPT("0",m-y.length)+y}};return Wo=h,Wo}var Ho,qa;function Rf(){if(qa)return Ho;qa=1;const e=Fe(),{FormulaHelpers:r,Types:n,WildCard:t,Address:o}=Ve(),f=ao(),l=r;return Ho={ADDRESS:(d,c,i,a,s)=>{if(d=l.accept(d,n.NUMBER),c=l.accept(c,n.NUMBER),i=l.accept(i,n.NUMBER,1),a=l.accept(a,n.BOOLEAN,!0),s=l.accept(s,n.STRING,""),d<1||c<1||i<1||i>4)throw e.VALUE;let u="";return s.length>0&&(/[^A-Za-z_.\d\u007F-\uFFFF]/.test(s)?u+=`'${s}'!`:u+=s+"!"),a?(u+=i===1||i===3?"$":"",u+=o.columnNumberToName(c),u+=i===1||i===2?"$":"",u+=d):(u+="R",u+=i===4||i===3?`[${d}]`:d,u+="C",u+=i===4||i===2?`[${c}]`:c),u},AREAS:d=>(d=l.accept(d),d instanceof f?d.length:1),CHOOSE:(d,...c)=>{},COLUMN:(d,c)=>{if(c==null){if(d.position.col!=null)return d.position.col;throw Error("FormulaParser.parse is called without position parameter.")}else{if(typeof c!="object"||Array.isArray(c))throw e.VALUE;if(l.isCellRef(c))return c.ref.col;if(l.isRangeRef(c))return c.ref.from.col;throw Error("ReferenceFunctions.COLUMN should not reach here.")}},COLUMNS:(d,c)=>{if(c==null)throw Error("COLUMNS requires one argument");if(typeof c!="object"||Array.isArray(c))throw e.VALUE;if(l.isCellRef(c))return 1;if(l.isRangeRef(c))return Math.abs(c.ref.from.col-c.ref.to.col)+1;throw Error("ReferenceFunctions.COLUMNS should not reach here.")},HLOOKUP:(d,c,i,a)=>{d=l.accept(d);try{c=l.accept(c,n.ARRAY,void 0,!1)}catch(u){throw u instanceof e?e.NA:u}if(i=l.accept(i,n.NUMBER),a=l.accept(a,n.BOOLEAN,!0),i<1)throw e.VALUE;if(c[i-1]===void 0)throw e.REF;const s=typeof d;if(a){let u=s===typeof c[0][0]?c[0][0]:null;for(let v=1;v<c[0].length;v++){const h=c[0][v];if(typeof h===s){if(u>d&&h>d)throw e.NA;if(h===d)return c[i-1][v];if(u!=null&&h>d&&u<=d)return c[i-1][v-1];u=h}}if(u==null)throw e.NA;return u}else{let u=-1;if(t.isWildCard(d)?u=c[0].findIndex(v=>t.toRegex(d,"i").test(v)):u=c[0].findIndex(v=>v===d),u===-1)throw e.NA;return c[i-1][u]}},INDEX:(d,c,i,a,s)=>{i=d.utils.extractRefValue(i),i={value:i.val,isArray:i.isArray},i=l.accept(i,n.NUMBER),i=Math.trunc(i),a==null?a=1:(a=d.utils.extractRefValue(a),a={value:a.val,isArray:a.isArray},a=l.accept(a,n.NUMBER,1),a=Math.trunc(a)),s==null?s=1:(s=d.utils.extractRefValue(s),s={value:s.val,isArray:s.isArray},s=l.accept(s,n.NUMBER,1),s=Math.trunc(s));let u=c;if(c instanceof f)u=c.refs[s-1];else if(s>1)throw e.REF;if(i===0&&a===0)return u;if(i===0){if(l.isRangeRef(u)){if(u.ref.to.col-u.ref.from.col<a-1)throw e.REF;return u.ref.from.col+=a-1,u.ref.to.col=u.ref.from.col,u}else if(Array.isArray(u)){const v=[];return u.forEach(h=>v.push([h[a-1]])),v}}if(a===0){if(l.isRangeRef(u)){if(u.ref.to.row-u.ref.from.row<i-1)throw e.REF;return u.ref.from.row+=i-1,u.ref.to.row=u.ref.from.row,u}else if(Array.isArray(u))return u[a-1]}if(i!==0&&a!==0){if(l.isRangeRef(u)){if(u=u.ref,u.to.row-u.from.row<i-1||u.to.col-u.from.col<a-1)throw e.REF;return{ref:{row:u.from.row+i-1,col:u.from.col+a-1}}}else if(l.isCellRef(u)){if(u=u.ref,i>1||a>1)throw e.REF;return{ref:{row:u.row+i-1,col:u.col+a-1}}}else if(Array.isArray(u)){if(u.length<i||u[0].length<a)throw e.REF;return u[i-1][a-1]}}},MATCH:()=>{},ROW:(d,c)=>{if(c==null){if(d.position.row!=null)return d.position.row;throw Error("FormulaParser.parse is called without position parameter.")}else{if(typeof c!="object"||Array.isArray(c))throw e.VALUE;if(l.isCellRef(c))return c.ref.row;if(l.isRangeRef(c))return c.ref.from.row;throw Error("ReferenceFunctions.ROW should not reach here.")}},ROWS:(d,c)=>{if(c==null)throw Error("ROWS requires one argument");if(typeof c!="object"||Array.isArray(c))throw e.VALUE;if(l.isCellRef(c))return 1;if(l.isRangeRef(c))return Math.abs(c.ref.from.row-c.ref.to.row)+1;throw Error("ReferenceFunctions.ROWS should not reach here.")},TRANSPOSE:d=>{d=l.accept(d,n.ARRAY,void 0,!1);const c=[];for(let i=0;i<d[0].length;i++){c[i]=[];for(let a=0;a<d.length;a++)c[i][a]=d[a][i]}return c},VLOOKUP:(d,c,i,a)=>{d=l.accept(d);try{c=l.accept(c,n.ARRAY,void 0,!1)}catch(u){throw u instanceof e?e.NA:u}if(i=l.accept(i,n.NUMBER),a=l.accept(a,n.BOOLEAN,!0),i<1)throw e.VALUE;if(c[0][i-1]===void 0)throw e.REF;const s=typeof d;if(a){let u=s===typeof c[0][0]?c[0][0]:null;for(let v=1;v<c.length;v++){const h=c[v],p=c[v][0];if(typeof p===s){if(u>d&&p>d)throw e.NA;if(p===d)return h[i-1];if(u!=null&&p>d&&u<=d)return c[v-1][i-1];u=p}}if(u==null)throw e.NA;return u}else{let u=-1;if(t.isWildCard(d)?u=c.findIndex(v=>t.toRegex(d,"i").test(v[0])):u=c.findIndex(v=>v[0]===d),u===-1)throw e.NA;return c[u][i-1]}}},Ho}var $o,za;function Nf(){if(za)return $o;za=1;const e=Fe(),{FormulaHelpers:r,Types:n}=Ve(),t=r,o={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A":7};return $o={CELL:(l,g)=>{},"ERROR.TYPE":l=>{if(l=t.accept(l),l instanceof e)return o[l.toString()];throw e.NA},INFO:()=>{},ISBLANK:l=>l.ref?l.value==null||l.value==="":!1,ISERR:l=>(l=t.accept(l),l instanceof e&&l.toString()!=="#N/A"),ISERROR:l=>(l=t.accept(l),l instanceof e),ISEVEN:l=>(l=t.accept(l,n.NUMBER),l=Math.trunc(l),l%2===0),ISLOGICAL:l=>(l=t.accept(l),typeof l=="boolean"),ISNA:l=>(l=t.accept(l),l instanceof e&&l.toString()==="#N/A"),ISNONTEXT:l=>(l=t.accept(l),typeof l!="string"),ISNUMBER:l=>(l=t.accept(l),typeof l=="number"),ISREF:l=>!l.ref||t.isCellRef(l)&&(l.ref.row>1048576||l.ref.col>16384)||t.isRangeRef(l)&&(l.ref.from.row>1048576||l.ref.from.col>16384||l.ref.to.row>1048576||l.ref.to.col>16384)?!1:(l=t.accept(l),!(l instanceof e&&l.toString()==="#REF!")),ISTEXT:l=>(l=t.accept(l),typeof l=="string"),N:l=>{l=t.accept(l);const g=typeof l;if(g==="number")return l;if(g==="boolean")return Number(l);if(l instanceof e)throw l;return 0},NA:()=>{throw e.NA},TYPE:l=>{if(l.ref){if(t.isRangeRef(l))return 16;if(t.isCellRef(l)&&(l=t.accept(l),typeof l=="string"&&l.length===0))return 1}l=t.accept(l);const g=typeof l;if(g==="number")return 1;if(g==="string")return 2;if(g==="boolean")return 4;if(l instanceof e)return 16;if(Array.isArray(l))return 64}},$o}var qo,Ka;function Tf(){if(Ka)return qo;Ka=1;const e=Fe(),{FormulaHelpers:r,Types:n}=Ve(),t=r,o=Cc(),f=Ac(),l=2.5066282746310002,g={"BETA.DIST":(d,c,i,a,s,u)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),a=t.accept(a,n.BOOLEAN),s=t.accept(s,n.NUMBER,0),u=t.accept(u,n.NUMBER,1),c<=0||i<=0||d<s||d>u||s===u)throw e.NUM;return d=(d-s)/(u-s),a?o.beta.cdf(d,c,i):o.beta.pdf(d,c,i)/(u-s)},"BETA.INV":(d,c,i,a,s)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),a=t.accept(a,n.NUMBER,0),s=t.accept(s,n.NUMBER,1),c<=0||i<=0||d<=0||d>1)throw e.NUM;return o.beta.inv(d,c,i)*(s-a)+a},"BINOM.DIST":(d,c,i,a)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),a=t.accept(a,n.BOOLEAN),c<0||i<0||i>1||d<0||d>c)throw e.NUM;return a?o.binomial.cdf(d,c,i):o.binomial.pdf(d,c,i)},"BINOM.DIST.RANGE":(d,c,i,a)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),a=t.accept(a,n.NUMBER,i),d<0||c<0||c>1||i<0||i>d||a<i||a>d)throw e.NUM;let s=0;for(let u=i;u<=a;u++)s+=f.COMBIN(d,u)*Math.pow(c,u)*Math.pow(1-c,d-u);return s},"BINOM.INV":(d,c,i)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),d<0||c<0||c>1||i<0||i>1)throw e.NUM;let a=0;for(;a<=d;){if(o.binomial.cdf(a,d,c)>=i)return a;a++}},"CHISQ.DIST":(d,c,i)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),c=Math.trunc(c),d<0||c<1||c>10**10)throw e.NUM;return i?o.chisquare.cdf(d,c):o.chisquare.pdf(d,c)},"CHISQ.DIST.RT":(d,c)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),c=Math.trunc(c),d<0||c<1||c>10**10)throw e.NUM;return 1-o.chisquare.cdf(d,c)},"CHISQ.INV":(d,c)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),c=Math.trunc(c),d<0||d>1||c<1||c>10**10)throw e.NUM;return o.chisquare.inv(d,c)},"CHISQ.INV.RT":(d,c)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),c=Math.trunc(c),d<0||d>1||c<1||c>10**10)throw e.NUM;return o.chisquare.inv(1-d,c)},"CHISQ.TEST":(d,c)=>{const i=t.accept(d,n.ARRAY,void 0,!1,!1),a=t.accept(c,n.ARRAY,void 0,!1,!1);if(i.length!==a.length||i[0].length!==a[0].length||i.length===1&&i[0].length===1)throw e.NA;const s=i.length,u=i[0].length;let v=(s-1)*(u-1);s===1?v=u-1:v=s-1;let h=0;for(let w=0;w<s;w++)for(let T=0;T<u;T++)if(!(typeof i[w][T]!="number"||typeof a[w][T]!="number")){if(a[w][T]===0)throw e.DIV0;h+=Math.pow(i[w][T]-a[w][T],2)/a[w][T]}let p=Math.exp(-.5*h);v%2===1&&(p=p*Math.sqrt(2*h/Math.PI));let m=v;for(;m>=2;)p=p*h/m,m=m-2;let E=p,y=v;for(;E>1e-15*p;)y=y+2,E=E*h/y,p=p+E;return 1-p},"CONFIDENCE.NORM":(d,c,i)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),i=Math.trunc(i),d<=0||d>=1||c<=0||i<1)throw e.NUM;return o.normalci(1,d,c,i)[1]-1},"CONFIDENCE.T":(d,c,i)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),i=Math.trunc(i),d<=0||d>=1||c<=0||i<1)throw e.NUM;if(i===1)throw e.DIV0;return o.tci(1,d,c,i)[1]-1},CORREL:(d,c)=>{if(d=t.accept(d,n.ARRAY,void 0,!0,!0),c=t.accept(c,n.ARRAY,void 0,!0,!0),d.length!==c.length)throw e.NA;const i=[],a=[];for(let s=0;s<d.length;s++)typeof d[s]!="number"||typeof c[s]!="number"||(i.push(d[s]),a.push(c[s]));if(i.length<=1)throw e.DIV0;return o.corrcoeff(i,a)},"COVARIANCE.P":(d,c)=>{if(d=t.accept(d,n.ARRAY,void 0,!0,!0),c=t.accept(c,n.ARRAY,void 0,!0,!0),d.length!==c.length)throw e.NA;const i=[],a=[];for(let h=0;h<d.length;h++)typeof d[h]!="number"||typeof c[h]!="number"||(i.push(d[h]),a.push(c[h]));const s=o.mean(i),u=o.mean(a);let v=0;for(let h=0;h<i.length;h++)v+=(i[h]-s)*(a[h]-u);return v/i.length},"COVARIANCE.S":(d,c)=>{if(d=t.accept(d,n.ARRAY,void 0,!0,!0),c=t.accept(c,n.ARRAY,void 0,!0,!0),d.length!==c.length)throw e.NA;const i=[],a=[];for(let s=0;s<d.length;s++)typeof d[s]!="number"||typeof c[s]!="number"||(i.push(d[s]),a.push(c[s]));if(i.length<=1)throw e.DIV0;return o.covariance(i,a)},DEVSQ:(...d)=>{let c=0,i=[];t.flattenParams(d,n.NUMBER,!0,(s,u)=>{typeof s=="number"&&(c+=s,i.push(s))});const a=c/i.length;c=0;for(let s=0;s<i.length;s++)c+=(i[s]-a)**2;return c},"EXPON.DIST":(d,c,i)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.BOOLEAN),d<0||c<=0)throw e.NUM;return i?o.exponential.cdf(d,c):o.exponential.pdf(d,c)},"F.DIST":(d,c,i,a)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),a=t.accept(a,n.BOOLEAN),d<0||c<1||i<1)throw e.NUM;return c=Math.trunc(c),i=Math.trunc(i),a?o.centralF.cdf(d,c,i):o.centralF.pdf(d,c,i)},"F.DIST.RT":(d,c,i)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),d<0||c<1||i<1)throw e.NUM;return c=Math.trunc(c),i=Math.trunc(i),1-o.centralF.cdf(d,c,i)},"F.INV":(d,c,i)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),d<0||d>1||c<1||i<1)throw e.NUM;return c=Math.trunc(c),i=Math.trunc(i),o.centralF.inv(d,c,i)},"F.INV.RT":(d,c,i)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),d<0||d>1||c<1||c>=Math.pow(10,10)||i<1||i>=Math.pow(10,10))throw e.NUM;return c=Math.trunc(c),i=Math.trunc(i),o.centralF.inv(1-d,c,i)},"F.TEST":(d,c)=>{d=t.accept(d,n.ARRAY,void 0,!0,!0),c=t.accept(c,n.ARRAY,void 0,!0,!0);const i=[],a=[];let s=0,u=0;for(let p=0;p<Math.max(d.length,c.length);p++)typeof d[p]=="number"&&(i.push(d[p]),s+=d[p]),typeof c[p]=="number"&&(a.push(c[p]),u+=c[p]);if(i.length<=1||a.length<=1)throw e.DIV0;s/=i.length,u/=a.length;let v=0,h=0;for(let p=0;p<i.length;p++)v+=(s-i[p])**2;v/=i.length-1;for(let p=0;p<a.length;p++)h+=(u-a[p])**2;return h/=a.length-1,o.centralF.cdf(v/h,i.length-1,a.length-1)*2},FISHER:d=>{if(d=t.accept(d,n.NUMBER),d<=-1||d>=1)throw e.NUM;return Math.log((1+d)/(1-d))/2},FISHERINV:d=>{d=t.accept(d,n.NUMBER);let c=Math.exp(2*d);return(c-1)/(c+1)},FORECAST:(d,c,i)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.ARRAY,void 0,!0,!0),i=t.accept(i,n.ARRAY,void 0,!0,!0),i.length!==c.length)throw e.NA;const a=[],s=[];let u=!0;for(let w=0;w<c.length;w++)typeof c[w]!="number"||typeof i[w]!="number"||(a.push(c[w]),s.push(i[w]),i[w]!==i[0]&&(u=!1));if(u)throw e.DIV0;const v=o.mean(a),h=o.mean(s);let p=0,m=0;for(let w=0;w<a.length;w++)p+=(s[w]-h)*(a[w]-v),m+=(s[w]-h)**2;const E=p/m;return v-E*h+E*d},"FORECAST.ETS":()=>{},"FORECAST.ETS.CONFINT":()=>{},"FORECAST.ETS.SEASONALITY":()=>{},"FORECAST.ETS.STAT":()=>{},"FORECAST.LINEAR":(...d)=>g.FORECAST(...d),FREQUENCY:(d,c)=>{d=t.accept(d,n.ARRAY,void 0,!0,!0),c=t.accept(c,n.ARRAY,void 0,!0,!0);const i=[];for(let s=0;s<c.length;s++)typeof c[s]=="number"&&i.push(c[s]);i.sort(),i.push(1/0);const a=[];for(let s=0;s<i.length;s++){a[s]=[],a[s][0]=0;for(let u=0;u<d.length;u++){if(typeof d[u]!="number")continue;d[u]<=i[s]&&(a[s][0]++,d[u]=null)}}return a},GAMMA:d=>{if(d=t.accept(d,n.NUMBER),d===0||d<0&&d===Math.trunc(d))throw e.NUM;return o.gammafn(d)},"GAMMA.DIST":(d,c,i,a)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),a=t.accept(a,n.BOOLEAN),d<0||c<=0||i<=0)throw e.NUM;return a?o.gamma.cdf(d,c,i,!0):o.gamma.pdf(d,c,i,!1)},"GAMMA.INV":(d,c,i)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),d<0||d>1||c<=0||i<=0)throw e.NUM;return o.gamma.inv(d,c,i)},GAMMALN:d=>{if(d=t.accept(d,n.NUMBER),d<=0)throw e.NUM;return o.gammaln(d)},"GAMMALN.PRECISE":d=>{if(d=t.accept(d,n.NUMBER),d<=0)throw e.NUM;return o.gammaln(d)},GAUSS:d=>(d=t.accept(d,n.NUMBER),o.normal.cdf(d,0,1)-.5),GEOMEAN:(...d)=>{const c=[];return t.flattenParams(d,n.NUMBER,!0,(i,a)=>{typeof i=="number"&&c.push(i)}),o.geomean(c)},GROWTH:(d,c,i,a)=>{d=t.accept(d,n.ARRAY,void 0,!0,!0);for(let T=0;T<d.length;T++)if(typeof d[T]!="number")throw e.VALUE;c=t.accept(c,n.ARRAY,null,!0,!0);const s=c==null;if(c==null){c=[];for(let T=1;T<=d.length;T++)c.push(T)}else{if(c.length!==d.length)throw e.REF;for(let T=0;T<c.length;T++)if(typeof c[T]!="number")throw e.VALUE}if(i=t.accept(i,n.ARRAY,null,!1,!0),i==null&&s){i=[];for(let T=1;T<=d.length;T++)i.push(T);i=[i]}else i==null&&(i=Array.isArray(c[0])?c:[c]);a=t.accept(a,n.BOOLEAN,!0);const u=d.length;let v=0,h=0,p=0,m=0;for(let T=0;T<u;T++){const R=c[T],A=Math.log(d[T]);v+=R,h+=A,p+=R*A,m+=R*R}v/=u,h/=u,p/=u,m/=u;let E,y;a?(E=(p-v*h)/(m-v*v),y=h-E*v):(E=p/m,y=0);const w=[];for(let T=0;T<i.length;T++){w[T]=[];for(let R=0;R<i[0].length;R++){if(typeof i[T][R]!="number")throw e.VALUE;w[T][R]=Math.exp(y+E*i[T][R])}}return w},HARMEAN:(...d)=>{let c=0,i=0;return t.flattenParams(d,n.NUMBER,!0,(a,s)=>{typeof a=="number"&&(i+=1/a,c++)}),c/i},"HYPGEOM.DIST":(d,c,i,a,s)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),a=t.accept(a,n.NUMBER),s=t.accept(s,n.BOOLEAN),d=Math.trunc(d),c=Math.trunc(c),i=Math.trunc(i),a=Math.trunc(a),a<=0||d<0||c<=0||i<=0||c>a||i>a||c<d||i<d||d<c-a+i)throw e.NUM;function u(h,p,m,E){return f.COMBIN(m,h)*f.COMBIN(E-m,p-h)/f.COMBIN(E,p)}function v(h,p,m,E){let y=0;for(let w=0;w<=h;w++)y+=u(w,p,m,E);return y}return s?v(d,c,i,a):u(d,c,i,a)},INTERCEPT:(d,c)=>{if(d=t.accept(d,n.ARRAY,void 0,!0,!0),c=t.accept(c,n.ARRAY,void 0,!0,!0),c.length!==d.length)throw e.NA;const i=[],a=[];for(let m=0;m<d.length;m++)typeof d[m]!="number"||typeof c[m]!="number"||(i.push(d[m]),a.push(c[m]));if(i.length<=1)throw e.DIV0;const s=o.mean(i),u=o.mean(a);let v=0,h=0;for(let m=0;m<i.length;m++)v+=(a[m]-u)*(i[m]-s),h+=(a[m]-u)**2;const p=v/h;return s-p*u},KURT:(...d)=>{let c=0,i=[];t.flattenParams(d,n.NUMBER,!0,(u,v)=>{typeof u=="number"&&(c+=u,i.push(u))});const a=i.length;c/=a;let s=0;for(let u=0;u<a;u++)s+=Math.pow(i[u]-c,4);return s=s/Math.pow(o.stdev(i,!0),4),a*(a+1)/((a-1)*(a-2)*(a-3))*s-3*(a-1)*(a-1)/((a-2)*(a-3))},LINEST:()=>{},LOGEST:()=>{},"LOGNORM.DIST":(d,c,i,a)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),a=t.accept(a,n.BOOLEAN),d<=0||i<=0)throw e.NUM;return a?o.lognormal.cdf(d,c,i):o.lognormal.pdf(d,c,i)},"LOGNORM.INV":(d,c,i)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),d<=0||d>=1||i<=0)throw e.NUM;return o.lognormal.inv(d,c,i)},"MODE.MULT":()=>{},"MODE.SNGL":()=>{},"NEGBINOM.DIST":(d,c,i,a)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),a=t.accept(a,n.BOOLEAN),d=Math.trunc(d),c=Math.trunc(c),i<0||i>1||d<0||c<1)throw e.NUM;return a?o.negbin.cdf(d,c,i):o.negbin.pdf(d,c,i)},"NORM.DIST":(d,c,i,a)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),a=t.accept(a,n.BOOLEAN),i<=0)throw e.NUM;return a?o.normal.cdf(d,c,i):o.normal.pdf(d,c,i)},"NORM.INV":(d,c,i)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),d<=0||d>=1||i<=0)throw e.NUM;return o.normal.inv(d,c,i)},"NORM.S.DIST":(d,c)=>(d=t.accept(d,n.NUMBER),c=t.accept(c,n.BOOLEAN),c?o.normal.cdf(d,0,1):o.normal.pdf(d,0,1)),"NORM.S.INV":d=>{if(d=t.accept(d,n.NUMBER),d<=0||d>=1)throw e.NUM;return o.normal.inv(d,0,1)},PEARSON:()=>{},"PERCENTILE.EXC":()=>{},"PERCENTILE.INC":()=>{},"PERCENTRANK.EXC":()=>{},"PERCENTRANK.INC":()=>{},PERMUTATIONA:()=>{},PHI:d=>(d=t.accept(d,n.NUMBER),Math.exp(-.5*d*d)/l),"POISSON.DIST":(d,c,i)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.BOOLEAN),d<0||c<0)throw e.NUM;return d=Math.trunc(d),i?o.poisson.cdf(d,c):o.poisson.pdf(d,c)},PROB:()=>{},"QUARTILE.EXC":()=>{},"QUARTILE.INC":()=>{},"RANK.AVG":()=>{},"RANK.EQ":()=>{},RSQ:()=>{},SKEW:()=>{},"SKEW.P":()=>{},SLOPE:()=>{},STANDARDIZE:(d,c,i)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),i<=0)throw e.NUM;return(d-c)/i},"STDEV.P":()=>{},"STDEV.S":()=>{},STDEVA:()=>{},STDEVPA:()=>{},STEYX:()=>{},"T.DIST":(d,c,i)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.BOOLEAN),c<1)throw e.NUM;return i?o.studentt.cdf(d,c):o.studentt.pdf(d,c)},"T.DIST.2T":(d,c)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),c<1||d<0)throw e.NUM;return(1-o.studentt.cdf(d,c))*2},"T.DIST.RT":(d,c)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),c<1)throw e.NUM;return 1-o.studentt.cdf(d,c)},"T.INV":(d,c)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),d<=0||d>1||c<1)throw e.NUM;return c=c%1===0?c:Math.trunc(c),o.studentt.inv(d,c)},"T.INV.2T":(d,c)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),d<=0||d>1||c<1)throw e.NUM;return c=c%1===0?c:Math.trunc(c),Math.abs(o.studentt.inv(d/2,c))},"T.TEST":()=>{},TREND:()=>{},TRIMMEAN:()=>{},"VAR.P":()=>{},"VAR.S":()=>{},VARA:()=>{},VARPA:()=>{},"WEIBULL.DIST":(d,c,i,a)=>{if(d=t.accept(d,n.NUMBER),c=t.accept(c,n.NUMBER),i=t.accept(i,n.NUMBER),a=t.accept(a,n.BOOLEAN),d<0||c<=0||i<=0)throw e.NUM;return a?1-Math.exp(-Math.pow(d/i,c)):Math.pow(d,c-1)*Math.exp(-Math.pow(d/i,c))*c/Math.pow(i,c)},"Z.TEST":()=>{}};return qo={DistributionFunctions:g},qo}var zo,Ya;function Af(){if(Ya)return zo;Ya=1;const e=Fe(),{FormulaHelpers:r,Types:n,Criteria:t,Address:o}=Ve(),{Infix:f}=so(),l=r,{DistributionFunctions:g}=Tf();return zo=Object.assign({AVEDEV:(...c)=>{let i=0;const a=[];l.flattenParams(c,n.NUMBER,!0,(u,v)=>{typeof u=="number"&&(i+=u,a.push(u))});const s=i/a.length;i=0;for(let u=0;u<a.length;u++)i+=Math.abs(a[u]-s);return i/a.length},AVERAGE:(...c)=>{let i=0,a=0;return l.flattenParams(c,n.NUMBER,!0,(s,u)=>{typeof s=="number"&&(i+=s,a++)}),i/a},AVERAGEA:(...c)=>{let i=0,a=0;return l.flattenParams(c,n.NUMBER,!0,(s,u)=>{const v=typeof s;v==="number"?(i+=s,a++):v==="string"&&a++}),i/a},AVERAGEIF:(c,i,a,s)=>{const u=l.retrieveRanges(c,i,s);i=u[0],s=u[1],a=l.retrieveArg(c,a);const v=a.isArray;a=t.parse(l.accept(a));let h=0,p=0;if(i.forEach((m,E)=>{m.forEach((y,w)=>{const T=s[E][w];typeof T=="number"&&(a.op==="wc"?a.match===a.value.test(y)&&(h+=T,p++):f.compareOp(y,a.op,a.value,Array.isArray(y),v)&&(h+=T,p++))})}),p===0)throw e.DIV0;return h/p},AVERAGEIFS:()=>{},COUNT:(...c)=>{let i=0;return l.flattenParams(c,null,!0,(a,s)=>{(s.isLiteral&&!isNaN(a)||typeof a=="number")&&i++}),i},COUNTIF:(c,i)=>{c=l.accept(c,n.ARRAY,void 0,!1,!0);const a=i.isArray;i=l.accept(i);let s=0;return i=t.parse(i),c.forEach(u=>{u.forEach(v=>{i.op==="wc"?i.match===i.value.test(v)&&s++:f.compareOp(v,i.op,i.value,Array.isArray(v),a)&&s++})}),s},LARGE:()=>{},MAX:()=>{},MAXA:()=>{},MAXIFS:()=>{},MEDIAN:()=>{},MIN:()=>{},MINA:()=>{},MINIFS:()=>{},PERMUT:()=>{},PERMUTATIONA:()=>{},SMALL:()=>{}},g),zo}var Ko,Xa;function Cf(){if(Xa)return Ko;Xa=1;const e=Fe(),{FormulaHelpers:r,Types:n}=Ve(),t=r,o=1e3*60*60*24,f=new Date(Date.UTC(1900,0,1)),l=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],g=[void 0,[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],void 0,void 0,void 0,void 0,void 0,void 0,void 0,[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],d=[void 0,[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0],[1],[2],[3],[4],[5],[6]],c=/^\s*(\d\d?)\s*(:\s*\d\d?)?\s*(:\s*\d\d?)?\s*(pm|am)?\s*$/i,i=/^\s*((\d\d?)\s*([-\/])\s*(\d\d?))([\d:.apm\s]*)$/i,a=/^\s*((\d\d?)\s*([-/])\s*(jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*))([\d:.apm\s]*)$/i,s=/^\s*((jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*)\s*([-/])\s*(\d\d?))([\d:.apm\s]*)$/i;function u(R){const A=R.match(i),O=R.match(a),M=R.match(s);return A?R=A[1]+A[3]+new Date().getFullYear()+A[5]:O?R=O[1]+O[3]+new Date().getFullYear()+O[5]:M&&(R=M[1]+M[3]+new Date().getFullYear()+M[5]),new Date(Date.parse(`${R} UTC`))}function v(R){const A=R.match(c);if(!A)return;const O=A[2]?A[2]:":00",M=A[3]?A[3]:":00",b=A[4]?" "+A[4]:"",k=new Date(Date.parse(`1/1/1900 ${A[1]+O+M+b} UTC`));let F=new Date;return F=new Date(Date.UTC(F.getFullYear(),F.getMonth(),F.getDate(),F.getHours(),F.getMinutes(),F.getSeconds(),F.getMilliseconds())),new Date(Date.UTC(F.getUTCFullYear(),F.getUTCMonth(),F.getUTCDate(),k.getUTCHours(),k.getUTCMinutes(),k.getUTCSeconds(),k.getUTCMilliseconds()))}function h(R){const A=R>-22038912e5?2:1;return Math.floor((R-f)/864e5)+A}function p(R){if(R<0)throw e.VALUE;return R<=60?new Date(f.getTime()+(R-1)*864e5):new Date(f.getTime()+(R-2)*864e5)}function m(R){if(R instanceof Date)return{date:R};R=t.accept(R);let A=!0,O;return isNaN(R)?(O=v(R),O?A=!1:O=u(R)):(R=Number(R),O=p(R)),{date:O,isDateGiven:A}}function E(R){return m(R).date}function y(R,A){return R.getUTCFullYear()===A.getUTCFullYear()&&R.getUTCMonth()===A.getUTCMonth()&&R.getUTCDate()===A.getUTCDate()}function w(R){return R===1900?!0:new Date(R,1,29).getMonth()===1}const T={DATE:(R,A,O)=>{if(R=t.accept(R,n.NUMBER),A=t.accept(A,n.NUMBER),O=t.accept(O,n.NUMBER),R<0||R>=1e4)throw e.NUM;return R<1900&&(R+=1900),h(Date.UTC(R,A-1,O))},DATEDIF:(R,A,O)=>{if(R=E(R),A=E(A),O=t.accept(O,n.STRING).toLowerCase(),R>A)throw e.NUM;const M=A.getUTCFullYear()-R.getUTCFullYear(),b=A.getUTCMonth()-R.getUTCMonth(),k=A.getUTCDate()-R.getUTCDate();let F;switch(O){case"y":return F=b<0||b===0&&k<0?-1:0,F+M;case"m":return F=k<0?-1:0,M*12+b+F;case"d":return Math.floor(A-R)/o;case"md":return R.setUTCFullYear(A.getUTCFullYear()),k<0?R.setUTCMonth(A.getUTCMonth()-1):R.setUTCMonth(A.getUTCMonth()),Math.floor(A-R)/o;case"ym":return F=k<0?-1:0,(F+M*12+b)%12;case"yd":return b<0||b===0&&k<0?R.setUTCFullYear(A.getUTCFullYear()-1):R.setUTCFullYear(A.getUTCFullYear()),Math.floor(A-R)/o}},DATEVALUE:R=>{R=t.accept(R,n.STRING);const{date:A,isDateGiven:O}=m(R);if(!O)return 0;const M=h(A);if(M<0||M>2958465)throw e.VALUE;return M},DAY:R=>E(R).getUTCDate(),DAYS:(R,A)=>{R=E(R),A=E(A);let O=0;return A<-22038912e5&&-22038912e5<R&&(O=1),Math.floor(R-A)/o+O},DAYS360:(R,A,O)=>{R=E(R),A=E(A),O=t.accept(O,n.BOOLEAN,!1),R.getUTCDate()===31&&R.setUTCDate(30),!O&&R.getUTCDate()<30&&A.getUTCDate()>30?A.setUTCMonth(A.getUTCMonth()+1,1):A.getUTCDate()===31&&A.setUTCDate(30);const M=A.getUTCFullYear()-R.getUTCFullYear(),b=A.getUTCMonth()-R.getUTCMonth(),k=A.getUTCDate()-R.getUTCDate();return b*30+k+M*12*30},EDATE:(R,A)=>(R=E(R),A=t.accept(A,n.NUMBER),R.setUTCMonth(R.getUTCMonth()+A),h(R)),EOMONTH:(R,A)=>(R=E(R),A=t.accept(A,n.NUMBER),R.setUTCMonth(R.getUTCMonth()+A+1,0),h(R)),HOUR:R=>E(R).getUTCHours(),ISOWEEKNUM:R=>{const A=E(R),O=new Date(Date.UTC(A.getFullYear(),A.getMonth(),A.getDate())),M=O.getUTCDay();O.setUTCDate(O.getUTCDate()+4-M);const b=new Date(Date.UTC(O.getUTCFullYear(),0,1));return Math.ceil(((O-b)/864e5+1)/7)},MINUTE:R=>E(R).getUTCMinutes(),MONTH:R=>E(R).getUTCMonth()+1,NETWORKDAYS:(R,A,O)=>{R=E(R),A=E(A);let M=1;if(R>A){M=-1;const F=R;R=A,A=F}const b=[];O!=null&&t.flattenParams([O],n.NUMBER,!1,F=>{b.push(E(F))});let k=0;for(;R<=A;){if(R.getUTCDay()!==0&&R.getUTCDay()!==6){let F=!1;for(let $=0;$<b.length;$++)if(y(R,b[$])){F=!0;break}F||k++}R.setUTCDate(R.getUTCDate()+1)}return M*k},"NETWORKDAYS.INTL":(R,A,O,M)=>{R=E(R),A=E(A);let b=1;if(R>A){b=-1;const $=R;R=A,A=$}if(O=t.accept(O,null,1),O==="1111111")return 0;if(typeof O=="string"&&Number(O).toString()!==O){if(O.length!==7)throw e.VALUE;O=O.charAt(6)+O.slice(0,6);const $=[];for(let Y=0;Y<O.length;Y++)O.charAt(Y)==="1"&&$.push(Y);O=$}else{if(typeof O!="number")throw e.VALUE;O=d[O]}const k=[];M!=null&&t.flattenParams([M],n.NUMBER,!1,$=>{k.push(E($))});let F=0;for(;R<=A;){let $=!1;for(let Y=0;Y<O.length;Y++)if(O[Y]===R.getUTCDay()){$=!0;break}if(!$){let Y=!1;for(let W=0;W<k.length;W++)if(y(R,k[W])){Y=!0;break}Y||F++}R.setUTCDate(R.getUTCDate()+1)}return b*F},NOW:()=>{const R=new Date;return h(Date.UTC(R.getFullYear(),R.getMonth(),R.getDate(),R.getHours(),R.getMinutes(),R.getSeconds(),R.getMilliseconds()))+(3600*R.getHours()+60*R.getMinutes()+R.getSeconds())/86400},SECOND:R=>E(R).getUTCSeconds(),TIME:(R,A,O)=>{if(R=t.accept(R,n.NUMBER),A=t.accept(A,n.NUMBER),O=t.accept(O,n.NUMBER),R<0||R>32767||A<0||A>32767||O<0||O>32767)throw e.NUM;return(3600*R+60*A+O)/86400},TIMEVALUE:R=>(R=E(R),(3600*R.getUTCHours()+60*R.getUTCMinutes()+R.getUTCSeconds())/86400),TODAY:()=>{const R=new Date;return h(Date.UTC(R.getFullYear(),R.getMonth(),R.getDate()))},WEEKDAY:(R,A)=>{const O=E(R);A=t.accept(A,n.NUMBER,1);const M=O.getUTCDay(),b=g[A];if(!b)throw e.NUM;return b[M]},WEEKNUM:(R,A)=>{const O=E(R);if(A=t.accept(A,n.NUMBER,1),A===21)return T.ISOWEEKNUM(R);const M=l[A],b=new Date(Date.UTC(O.getUTCFullYear(),0,1)),k=b.getUTCDay()<M?1:0;return Math.ceil(((O-b)/864e5+1)/7)+k},WORKDAY:(R,A,O)=>T["WORKDAY.INTL"](R,A,1,O),"WORKDAY.INTL":(R,A,O,M)=>{if(R=E(R),A=t.accept(A,n.NUMBER),O=t.accept(O,null,1),O==="1111111")throw e.VALUE;if(typeof O=="string"&&Number(O).toString()!==O){if(O.length!==7)throw e.VALUE;O=O.charAt(6)+O.slice(0,6);const F=[];for(let $=0;$<O.length;$++)O.charAt($)==="1"&&F.push($);O=F}else{if(typeof O!="number")throw e.VALUE;if(O=d[O],O==null)throw e.NUM}const b=[];M!=null&&t.flattenParams([M],n.NUMBER,!1,F=>{b.push(E(F))}),R.setUTCDate(R.getUTCDate()+1);let k=0;for(;k<A;){let F=!1;for(let $=0;$<O.length;$++)if(O[$]===R.getUTCDay()){F=!0;break}if(!F){let $=!1;for(let Y=0;Y<b.length;Y++)if(y(R,b[Y])){$=!0;break}$||k++}R.setUTCDate(R.getUTCDate()+1)}return h(R)-1},YEAR:R=>E(R).getUTCFullYear(),YEARFRAC:(R,A,O)=>{if(R=E(R),A=E(A),R>A){const W=R;R=A,A=W}if(O=t.accept(O,n.NUMBER,0),O=Math.trunc(O),O<0||O>4)throw e.VALUE;let M=R.getUTCDate();const b=R.getUTCMonth()+1,k=R.getUTCFullYear();let F=A.getUTCDate();const $=A.getUTCMonth()+1,Y=A.getUTCFullYear();switch(O){case 0:return M===31&&F===31?(M=30,F=30):M===31?M=30:M===30&&F===31&&(F=30),Math.abs(F+$*30+Y*360-(M+b*30+k*360))/360;case 1:if(Y-k<2){const W=w(k)&&k!==1900?366:365;return T.DAYS(A,R)/W}else{const W=Y-k+1,H=(new Date(Y+1,0,1)-new Date(k,0,1))/1e3/60/60/24/W;return T.DAYS(A,R)/H}case 2:return Math.abs(T.DAYS(A,R)/360);case 3:return Math.abs(T.DAYS(A,R)/365);case 4:return Math.abs(F+$*30+Y*360-(M+b*30+k*360))/360}}};return Ko=T,Ko}var Yo,Qa;function Of(){if(Qa)return Yo;Qa=1;const e=Fe(),{FormulaHelpers:r,Types:n}=Ve(),t=r;return Yo={ENCODEURL:f=>encodeURIComponent(t.accept(f,n.STRING)),FILTERXML:()=>{},WEBSERVICE:(f,l)=>{throw e.ERROR("WEBSERVICE is not supported in sync mode.")}},Yo}var Ti="7.1.2";function Ie(e){return e&&e.length===0}function wt(e){return e==null?[]:Object.keys(e)}function et(e){for(var r=[],n=Object.keys(e),t=0;t<n.length;t++)r.push(e[n[t]]);return r}function If(e,r){for(var n=[],t=wt(e),o=0;o<t.length;o++){var f=t[o];n.push(r.call(null,e[f],f))}return n}function re(e,r){for(var n=[],t=0;t<e.length;t++)n.push(r.call(null,e[t],t));return n}function st(e){for(var r=[],n=0;n<e.length;n++){var t=e[n];Array.isArray(t)?r=r.concat(st(t)):r.push(t)}return r}function Rt(e){return Ie(e)?void 0:e[0]}function Oc(e){var r=e&&e.length;return r?e[r-1]:void 0}function ue(e,r){if(Array.isArray(e))for(var n=0;n<e.length;n++)r.call(null,e[n],n);else if(ji(e))for(var t=wt(e),n=0;n<t.length;n++){var o=t[n],f=e[o];r.call(null,f,o)}else throw Error("non exhaustive match")}function bt(e){return typeof e=="string"}function qt(e){return e===void 0}function cn(e){return e instanceof Function}function He(e,r){return r===void 0&&(r=1),e.slice(r,e.length)}function Hn(e,r){return r===void 0&&(r=1),e.slice(0,e.length-r)}function Nt(e,r){var n=[];if(Array.isArray(e))for(var t=0;t<e.length;t++){var o=e[t];r.call(null,o)&&n.push(o)}return n}function Un(e,r){return Nt(e,function(n){return!r(n)})}function Tt(e,r){for(var n=Object.keys(e),t={},o=0;o<n.length;o++){var f=n[o],l=e[f];r(l)&&(t[f]=l)}return t}function le(e,r){return ji(e)?e.hasOwnProperty(r):!1}function Se(e,r){return xn(e,function(n){return n===r})!==void 0}function tt(e){for(var r=[],n=0;n<e.length;n++)r.push(e[n]);return r}function tr(e){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function xn(e,r){for(var n=0;n<e.length;n++){var t=e[n];if(r.call(null,t))return t}}function _f(e,r){for(var n=[],t=0;t<e.length;t++){var o=e[t];r.call(null,o)&&n.push(o)}return n}function $e(e,r,n){for(var t=Array.isArray(e),o=t?e:et(e),f=t?[]:wt(e),l=n,g=0;g<o.length;g++)l=r.call(null,l,o[g],t?g:f[g]);return l}function nr(e){return Un(e,function(r){return r==null})}function Ji(e,r){r===void 0&&(r=function(t){return t});var n=[];return $e(e,function(t,o){var f=r(o);return Se(n,f)?t:(n.push(f),t.concat(o))},[])}function Mt(e){return Array.isArray(e)}function zt(e){return e instanceof RegExp}function ji(e){return e instanceof Object}function dt(e,r){for(var n=0;n<e.length;n++)if(!r(e[n],n))return!1;return!0}function co(e,r){return Un(e,function(n){return Se(r,n)})}function Ic(e,r){for(var n=0;n<e.length;n++)if(r(e[n]))return!0;return!1}function Mf(e,r){for(var n=0;n<e.length;n++)if(e[n]===r)return n;return-1}function At(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];for(var t=0;t<r.length;t++)for(var o=r[t],f=wt(o),l=0;l<f.length;l++){var g=f[l];e[g]=o[g]}return e}function xf(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];for(var t=0;t<r.length;t++)for(var o=r[t],f=wt(o),l=0;l<f.length;l++){var g=f[l];le(e,g)||(e[g]=o[g])}return e}function ea(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return xf.apply(null,[{}].concat(e))}function bf(e,r){var n={};return ue(e,function(t){var o=r(t),f=n[o];f?f.push(t):n[o]=[t]}),n}function Za(e,r){for(var n=tr(e),t=wt(r),o=0;o<t.length;o++){var f=t[o],l=r[f];n[f]=l}return n}function Be(){}function Ja(e){return e}function Lf(e){for(var r=[],n=0;n<e.length;n++){var t=e[n];r.push(t!==void 0?t:void 0)}return r}function Ai(e){console&&console.error&&console.error("Error: "+e)}function _c(e){console&&console.warn&&console.warn("Warning: "+e)}function ja(){return typeof Map=="function"}function Uf(e,r){r.forEach(function(n){var t=n.prototype;Object.getOwnPropertyNames(t).forEach(function(o){if(o!=="constructor"){var f=Object.getOwnPropertyDescriptor(t,o);f&&(f.get||f.set)?Object.defineProperty(e.prototype,o,f):e.prototype[o]=n.prototype[o]}})})}function Mc(e){function r(){}r.prototype=e;var n=new r;function t(){return typeof n.bar}return t(),t(),e}function Gr(e){return e[e.length-1]}function xc(e){var r=new Date().getTime(),n=e(),t=new Date().getTime(),o=t-r;return{time:o,value:n}}var xr={exports:{}},kf=xr.exports,es;function Pf(){return es||(es=1,function(e){(function(r,n){e.exports?e.exports=n():r.regexpToAst=n()})(typeof self<"u"?self:kf,function(){function r(){}r.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},r.prototype.restoreState=function(h){this.idx=h.idx,this.input=h.input,this.groupIdx=h.groupIdx},r.prototype.pattern=function(h){this.idx=0,this.input=h,this.groupIdx=0,this.consumeChar("/");var p=this.disjunction();this.consumeChar("/");for(var m={type:"Flags",loc:{begin:this.idx,end:h.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":g(m,"global");break;case"i":g(m,"ignoreCase");break;case"m":g(m,"multiLine");break;case"u":g(m,"unicode");break;case"y":g(m,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:m,value:p,loc:this.loc(0)}},r.prototype.disjunction=function(){var h=[],p=this.idx;for(h.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),h.push(this.alternative());return{type:"Disjunction",value:h,loc:this.loc(p)}},r.prototype.alternative=function(){for(var h=[],p=this.idx;this.isTerm();)h.push(this.term());return{type:"Alternative",value:h,loc:this.loc(p)}},r.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},r.prototype.assertion=function(){var h=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(h)};case"$":return{type:"EndAnchor",loc:this.loc(h)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(h)};case"B":return{type:"NonWordBoundary",loc:this.loc(h)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var p;switch(this.popChar()){case"=":p="Lookahead";break;case"!":p="NegativeLookahead";break}d(p);var m=this.disjunction();return this.consumeChar(")"),{type:p,value:m,loc:this.loc(h)}}c()},r.prototype.quantifier=function(h){var p,m=this.idx;switch(this.popChar()){case"*":p={atLeast:0,atMost:1/0};break;case"+":p={atLeast:1,atMost:1/0};break;case"?":p={atLeast:0,atMost:1};break;case"{":var E=this.integerIncludingZero();switch(this.popChar()){case"}":p={atLeast:E,atMost:E};break;case",":var y;this.isDigit()?(y=this.integerIncludingZero(),p={atLeast:E,atMost:y}):p={atLeast:E,atMost:1/0},this.consumeChar("}");break}if(h===!0&&p===void 0)return;d(p);break}if(!(h===!0&&p===void 0))return d(p),this.peekChar(0)==="?"?(this.consumeChar("?"),p.greedy=!1):p.greedy=!0,p.type="Quantifier",p.loc=this.loc(m),p},r.prototype.atom=function(){var h,p=this.idx;switch(this.peekChar()){case".":h=this.dotAll();break;case"\\":h=this.atomEscape();break;case"[":h=this.characterClass();break;case"(":h=this.group();break}return h===void 0&&this.isPatternCharacter()&&(h=this.patternCharacter()),d(h),h.loc=this.loc(p),this.isQuantifier()&&(h.quantifier=this.quantifier()),h},r.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[f(`
`),f("\r"),f("\u2028"),f("\u2029")]}},r.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},r.prototype.decimalEscapeAtom=function(){var h=this.positiveInteger();return{type:"GroupBackReference",value:h}},r.prototype.characterClassEscape=function(){var h,p=!1;switch(this.popChar()){case"d":h=a;break;case"D":h=a,p=!0;break;case"s":h=u;break;case"S":h=u,p=!0;break;case"w":h=s;break;case"W":h=s,p=!0;break}return d(h),{type:"Set",value:h,complement:p}},r.prototype.controlEscapeAtom=function(){var h;switch(this.popChar()){case"f":h=f("\f");break;case"n":h=f(`
`);break;case"r":h=f("\r");break;case"t":h=f("	");break;case"v":h=f("\v");break}return d(h),{type:"Character",value:h}},r.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var h=this.popChar();if(/[a-zA-Z]/.test(h)===!1)throw Error("Invalid ");var p=h.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:p}},r.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:f("\0")}},r.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},r.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},r.prototype.identityEscapeAtom=function(){var h=this.popChar();return{type:"Character",value:f(h)}},r.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var h=this.popChar();return{type:"Character",value:f(h)}}},r.prototype.characterClass=function(){var h=[],p=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),p=!0);this.isClassAtom();){var m=this.classAtom(),E=m.type==="Character";if(E&&this.isRangeDash()){this.consumeChar("-");var y=this.classAtom(),w=y.type==="Character";if(w){if(y.value<m.value)throw Error("Range out of order in character class");h.push({from:m.value,to:y.value})}else l(m.value,h),h.push(f("-")),l(y.value,h)}else l(m.value,h)}return this.consumeChar("]"),{type:"Set",complement:p,value:h}},r.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},r.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:f("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},r.prototype.group=function(){var h=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),h=!1;break;default:this.groupIdx++;break}var p=this.disjunction();this.consumeChar(")");var m={type:"Group",capturing:h,value:p};return h&&(m.idx=this.groupIdx),m},r.prototype.positiveInteger=function(){var h=this.popChar();if(o.test(h)===!1)throw Error("Expecting a positive integer");for(;t.test(this.peekChar(0));)h+=this.popChar();return parseInt(h,10)},r.prototype.integerIncludingZero=function(){var h=this.popChar();if(t.test(h)===!1)throw Error("Expecting an integer");for(;t.test(this.peekChar(0));)h+=this.popChar();return parseInt(h,10)},r.prototype.patternCharacter=function(){var h=this.popChar();switch(h){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:f(h)}}},r.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},r.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},r.prototype.isDigit=function(){return t.test(this.peekChar(0))},r.prototype.isClassAtom=function(h){switch(h===void 0&&(h=0),this.peekChar(h)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},r.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},r.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},r.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},r.prototype.isQuantifier=function(){var h=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(h)}},r.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},r.prototype.parseHexDigits=function(h){for(var p="",m=0;m<h;m++){var E=this.popChar();if(n.test(E)===!1)throw Error("Expecting a HexDecimal digits");p+=E}var y=parseInt(p,16);return{type:"Character",value:y}},r.prototype.peekChar=function(h){return h===void 0&&(h=0),this.input[this.idx+h]},r.prototype.popChar=function(){var h=this.peekChar(0);return this.consumeChar(),h},r.prototype.consumeChar=function(h){if(h!==void 0&&this.input[this.idx]!==h)throw Error("Expected: '"+h+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++},r.prototype.loc=function(h){return{begin:h,end:this.idx}};var n=/[0-9a-fA-F]/,t=/[0-9]/,o=/[1-9]/;function f(h){return h.charCodeAt(0)}function l(h,p){h.length!==void 0?h.forEach(function(m){p.push(m)}):p.push(h)}function g(h,p){if(h[p]===!0)throw"duplicate flag "+p;h[p]=!0}function d(h){if(h===void 0)throw Error("Internal Error - Should never get here!")}function c(){throw Error("Internal Error - Should never get here!")}var i,a=[];for(i=f("0");i<=f("9");i++)a.push(i);var s=[f("_")].concat(a);for(i=f("a");i<=f("z");i++)s.push(i);for(i=f("A");i<=f("Z");i++)s.push(i);var u=[f(" "),f("\f"),f(`
`),f("\r"),f("	"),f("\v"),f("	"),f(" "),f(" "),f(" "),f(" "),f(" "),f(" "),f(" "),f(" "),f(" "),f(" "),f(" "),f(" "),f(" "),f("\u2028"),f("\u2029"),f(" "),f(" "),f("　"),f("\uFEFF")];function v(){}return v.prototype.visitChildren=function(h){for(var p in h){var m=h[p];h.hasOwnProperty(p)&&(m.type!==void 0?this.visit(m):Array.isArray(m)&&m.forEach(function(E){this.visit(E)},this))}},v.prototype.visit=function(h){switch(h.type){case"Pattern":this.visitPattern(h);break;case"Flags":this.visitFlags(h);break;case"Disjunction":this.visitDisjunction(h);break;case"Alternative":this.visitAlternative(h);break;case"StartAnchor":this.visitStartAnchor(h);break;case"EndAnchor":this.visitEndAnchor(h);break;case"WordBoundary":this.visitWordBoundary(h);break;case"NonWordBoundary":this.visitNonWordBoundary(h);break;case"Lookahead":this.visitLookahead(h);break;case"NegativeLookahead":this.visitNegativeLookahead(h);break;case"Character":this.visitCharacter(h);break;case"Set":this.visitSet(h);break;case"Group":this.visitGroup(h);break;case"GroupBackReference":this.visitGroupBackReference(h);break;case"Quantifier":this.visitQuantifier(h);break}this.visitChildren(h)},v.prototype.visitPattern=function(h){},v.prototype.visitFlags=function(h){},v.prototype.visitDisjunction=function(h){},v.prototype.visitAlternative=function(h){},v.prototype.visitStartAnchor=function(h){},v.prototype.visitEndAnchor=function(h){},v.prototype.visitWordBoundary=function(h){},v.prototype.visitNonWordBoundary=function(h){},v.prototype.visitLookahead=function(h){},v.prototype.visitNegativeLookahead=function(h){},v.prototype.visitCharacter=function(h){},v.prototype.visitSet=function(h){},v.prototype.visitGroup=function(h){},v.prototype.visitGroupBackReference=function(h){},v.prototype.visitQuantifier=function(h){},{RegExpParser:r,BaseRegExpVisitor:v,VERSION:"0.5.0"}})}(xr)),xr.exports}var rr=Pf(),br={},Sf=new rr.RegExpParser;function uo(e){var r=e.toString();if(br.hasOwnProperty(r))return br[r];var n=Sf.pattern(r);return br[r]=n,n}function Ff(){br={}}var Bf=function(){var e=function(r,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var f in o)Object.prototype.hasOwnProperty.call(o,f)&&(t[f]=o[f])},e(r,n)};return function(r,n){e(r,n);function t(){this.constructor=r}r.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}}(),bc="Complement Sets are not supported for first char optimization",Wr=`Unable to use "first char" lexer optimizations:
`;function Df(e,r){r===void 0&&(r=!1);try{var n=uo(e),t=Ci(n.value,{},n.flags.ignoreCase);return t}catch(f){if(f.message===bc)r&&_c(""+Wr+("	Unable to optimize: < "+e.toString()+` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var o="";r&&(o=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),Ai(Wr+`
`+("	Failed parsing: < "+e.toString()+` >
`)+("	Using the regexp-to-ast library version: "+rr.VERSION+`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+o)}}return[]}function Ci(e,r,n){switch(e.type){case"Disjunction":for(var t=0;t<e.value.length;t++)Ci(e.value[t],r,n);break;case"Alternative":for(var o=e.value,t=0;t<o.length;t++){var f=o[t];switch(f.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var l=f;switch(l.type){case"Character":mr(l.value,r,n);break;case"Set":if(l.complement===!0)throw Error(bc);ue(l.value,function(c){if(typeof c=="number")mr(c,r,n);else{var i=c;if(n===!0)for(var a=i.from;a<=i.to;a++)mr(a,r,n);else{for(var a=i.from;a<=i.to&&a<Bn;a++)mr(a,r,n);if(i.to>=Bn)for(var s=i.from>=Bn?i.from:Bn,u=i.to,v=en(s),h=en(u),p=v;p<=h;p++)r[p]=p}}});break;case"Group":Ci(l.value,r,n);break;default:throw Error("Non Exhaustive Match")}var g=l.quantifier!==void 0&&l.quantifier.atLeast===0;if(l.type==="Group"&&Oi(l)===!1||l.type!=="Group"&&g===!1)break}break;default:throw Error("non exhaustive match!")}return et(r)}function mr(e,r,n){var t=en(e);r[t]=t,n===!0&&Vf(e,r)}function Vf(e,r){var n=String.fromCharCode(e),t=n.toUpperCase();if(t!==n){var o=en(t.charCodeAt(0));r[o]=o}else{var f=n.toLowerCase();if(f!==n){var o=en(f.charCodeAt(0));r[o]=o}}}function ts(e,r){return xn(e.value,function(n){if(typeof n=="number")return Se(r,n);var t=n;return xn(r,function(o){return t.from<=o&&o<=t.to})!==void 0})}function Oi(e){return e.quantifier&&e.quantifier.atLeast===0?!0:e.value?Mt(e.value)?dt(e.value,Oi):Oi(e.value):!1}var Gf=function(e){Bf(r,e);function r(n){var t=e.call(this)||this;return t.targetCharCodes=n,t.found=!1,t}return r.prototype.visitChildren=function(n){if(this.found!==!0){switch(n.type){case"Lookahead":this.visitLookahead(n);return;case"NegativeLookahead":this.visitNegativeLookahead(n);return}e.prototype.visitChildren.call(this,n)}},r.prototype.visitCharacter=function(n){Se(this.targetCharCodes,n.value)&&(this.found=!0)},r.prototype.visitSet=function(n){n.complement?ts(n,this.targetCharCodes)===void 0&&(this.found=!0):ts(n,this.targetCharCodes)!==void 0&&(this.found=!0)},r}(rr.BaseRegExpVisitor);function ta(e,r){if(r instanceof RegExp){var n=uo(r),t=new Gf(e);return t.visit(n),t.found}else return xn(r,function(o){return Se(e,o.charCodeAt(0))})!==void 0}var Lc=function(){var e=function(r,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var f in o)Object.prototype.hasOwnProperty.call(o,f)&&(t[f]=o[f])},e(r,n)};return function(r,n){e(r,n);function t(){this.constructor=r}r.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}}(),Lt="PATTERN",pn="defaultMode",gr="modes",Uc=typeof new RegExp("(?:)").sticky=="boolean";function Wf(e,r){r=ea(r,{useSticky:Uc,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(E,y){return y()}});var n=r.tracer;n("initCharCodeToOptimizedIndexMap",function(){fd()});var t;n("Reject Lexer.NA",function(){t=Un(e,function(E){return E[Lt]===yt.NA})});var o=!1,f;n("Transform Patterns",function(){o=!1,f=re(t,function(E){var y=E[Lt];if(zt(y)){var w=y.source;return w.length===1&&w!=="^"&&w!=="$"&&w!=="."&&!y.ignoreCase?w:w.length===2&&w[0]==="\\"&&!Se(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],w[1])?w[1]:r.useSticky?rs(y):ns(y)}else{if(cn(y))return o=!0,{exec:y};if(le(y,"exec"))return o=!0,y;if(typeof y=="string"){if(y.length===1)return y;var T=y.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),R=new RegExp(T);return r.useSticky?rs(R):ns(R)}else throw Error("non exhaustive match")}})});var l,g,d,c,i;n("misc mapping",function(){l=re(t,function(E){return E.tokenTypeIdx}),g=re(t,function(E){var y=E.GROUP;if(y!==yt.SKIPPED){if(bt(y))return y;if(qt(y))return!1;throw Error("non exhaustive match")}}),d=re(t,function(E){var y=E.LONGER_ALT;if(y){var w=Mf(t,y);return w}}),c=re(t,function(E){return E.PUSH_MODE}),i=re(t,function(E){return le(E,"POP_MODE")})});var a;n("Line Terminator Handling",function(){var E=Sc(r.lineTerminatorCharacters);a=re(t,function(y){return!1}),r.positionTracking!=="onlyOffset"&&(a=re(t,function(y){if(le(y,"LINE_BREAKS"))return y.LINE_BREAKS;if(Pc(y,E)===!1)return ta(E,y.PATTERN)}))});var s,u,v,h;n("Misc Mapping #2",function(){s=re(t,kc),u=re(f,cd),v=$e(t,function(E,y){var w=y.GROUP;return bt(w)&&w!==yt.SKIPPED&&(E[w]=[]),E},{}),h=re(f,function(E,y){return{pattern:f[y],longerAlt:d[y],canLineTerminator:a[y],isCustom:s[y],short:u[y],group:g[y],push:c[y],pop:i[y],tokenTypeIdx:l[y],tokenType:t[y]}})});var p=!0,m=[];return r.safeMode||n("First Char Optimization",function(){m=$e(t,function(E,y,w){if(typeof y.PATTERN=="string"){var T=y.PATTERN.charCodeAt(0),R=en(T);Xo(E,R,h[w])}else if(Mt(y.START_CHARS_HINT)){var A;ue(y.START_CHARS_HINT,function(M){var b=typeof M=="string"?M.charCodeAt(0):M,k=en(b);A!==k&&(A=k,Xo(E,k,h[w]))})}else if(zt(y.PATTERN))if(y.PATTERN.unicode)p=!1,r.ensureOptimizations&&Ai(""+Wr+("	Unable to analyze < "+y.PATTERN.toString()+` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var O=Df(y.PATTERN,r.ensureOptimizations);Ie(O)&&(p=!1),ue(O,function(M){Xo(E,M,h[w])})}else r.ensureOptimizations&&Ai(""+Wr+("	TokenType: <"+y.name+`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),p=!1;return E},[])}),n("ArrayPacking",function(){m=Lf(m)}),{emptyGroups:v,patternIdxToConfig:h,charCodeToPatternIdxToConfig:m,hasCustom:o,canBeOptimized:p}}function Hf(e,r){var n=[],t=qf(e);n=n.concat(t.errors);var o=zf(t.valid),f=o.valid;return n=n.concat(o.errors),n=n.concat($f(f)),n=n.concat(ed(f)),n=n.concat(td(f,r)),n=n.concat(nd(f)),n}function $f(e){var r=[],n=Nt(e,function(t){return zt(t[Lt])});return r=r.concat(Yf(n)),r=r.concat(Zf(n)),r=r.concat(Jf(n)),r=r.concat(jf(n)),r=r.concat(Xf(n)),r}function qf(e){var r=Nt(e,function(o){return!le(o,Lt)}),n=re(r,function(o){return{message:"Token Type: ->"+o.name+"<- missing static 'PATTERN' property",type:Le.MISSING_PATTERN,tokenTypes:[o]}}),t=co(e,r);return{errors:n,valid:t}}function zf(e){var r=Nt(e,function(o){var f=o[Lt];return!zt(f)&&!cn(f)&&!le(f,"exec")&&!bt(f)}),n=re(r,function(o){return{message:"Token Type: ->"+o.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:Le.INVALID_PATTERN,tokenTypes:[o]}}),t=co(e,r);return{errors:n,valid:t}}var Kf=/[^\\][\$]/;function Yf(e){var r=function(o){Lc(f,o);function f(){var l=o!==null&&o.apply(this,arguments)||this;return l.found=!1,l}return f.prototype.visitEndAnchor=function(l){this.found=!0},f}(rr.BaseRegExpVisitor),n=Nt(e,function(o){var f=o[Lt];try{var l=uo(f),g=new r;return g.visit(l),g.found}catch{return Kf.test(f.source)}}),t=re(n,function(o){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+o.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Le.EOI_ANCHOR_FOUND,tokenTypes:[o]}});return t}function Xf(e){var r=Nt(e,function(t){var o=t[Lt];return o.test("")}),n=re(r,function(t){return{message:"Token Type: ->"+t.name+"<- static 'PATTERN' must not match an empty string",type:Le.EMPTY_MATCH_PATTERN,tokenTypes:[t]}});return n}var Qf=/[^\\[][\^]|^\^/;function Zf(e){var r=function(o){Lc(f,o);function f(){var l=o!==null&&o.apply(this,arguments)||this;return l.found=!1,l}return f.prototype.visitStartAnchor=function(l){this.found=!0},f}(rr.BaseRegExpVisitor),n=Nt(e,function(o){var f=o[Lt];try{var l=uo(f),g=new r;return g.visit(l),g.found}catch{return Qf.test(f.source)}}),t=re(n,function(o){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+o.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Le.SOI_ANCHOR_FOUND,tokenTypes:[o]}});return t}function Jf(e){var r=Nt(e,function(t){var o=t[Lt];return o instanceof RegExp&&(o.multiline||o.global)}),n=re(r,function(t){return{message:"Token Type: ->"+t.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:Le.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[t]}});return n}function jf(e){var r=[],n=re(e,function(f){return $e(e,function(l,g){return f.PATTERN.source===g.PATTERN.source&&!Se(r,g)&&g.PATTERN!==yt.NA&&(r.push(g),l.push(g)),l},[])});n=nr(n);var t=Nt(n,function(f){return f.length>1}),o=re(t,function(f){var l=re(f,function(d){return d.name}),g=Rt(f).PATTERN;return{message:"The same RegExp pattern ->"+g+"<-"+("has been used in all of the following Token Types: "+l.join(", ")+" <-"),type:Le.DUPLICATE_PATTERNS_FOUND,tokenTypes:f}});return o}function ed(e){var r=Nt(e,function(t){if(!le(t,"GROUP"))return!1;var o=t.GROUP;return o!==yt.SKIPPED&&o!==yt.NA&&!bt(o)}),n=re(r,function(t){return{message:"Token Type: ->"+t.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:Le.INVALID_GROUP_TYPE_FOUND,tokenTypes:[t]}});return n}function td(e,r){var n=Nt(e,function(o){return o.PUSH_MODE!==void 0&&!Se(r,o.PUSH_MODE)}),t=re(n,function(o){var f="Token Type: ->"+o.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+o.PUSH_MODE+"<-which does not exist";return{message:f,type:Le.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[o]}});return t}function nd(e){var r=[],n=$e(e,function(t,o,f){var l=o.PATTERN;return l===yt.NA||(bt(l)?t.push({str:l,idx:f,tokenType:o}):zt(l)&&od(l)&&t.push({str:l.source,idx:f,tokenType:o})),t},[]);return ue(e,function(t,o){ue(n,function(f){var l=f.str,g=f.idx,d=f.tokenType;if(o<g&&rd(l,t.PATTERN)){var c="Token: ->"+d.name+`<- can never be matched.
`+("Because it appears AFTER the Token Type ->"+t.name+"<-")+`in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;r.push({message:c,type:Le.UNREACHABLE_PATTERN,tokenTypes:[t,d]})}})}),r}function rd(e,r){if(zt(r)){var n=r.exec(e);return n!==null&&n.index===0}else{if(cn(r))return r(e,0,[],{});if(le(r,"exec"))return r.exec(e,0,[],{});if(typeof r=="string")return r===e;throw Error("non exhaustive match")}}function od(e){var r=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return xn(r,function(n){return e.source.indexOf(n)!==-1})===void 0}function ns(e){var r=e.ignoreCase?"i":"";return new RegExp("^(?:"+e.source+")",r)}function rs(e){var r=e.ignoreCase?"iy":"y";return new RegExp(""+e.source,r)}function id(e,r,n){var t=[];return le(e,pn)||t.push({message:"A MultiMode Lexer cannot be initialized without a <"+pn+`> property in its definition
`,type:Le.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),le(e,gr)||t.push({message:"A MultiMode Lexer cannot be initialized without a <"+gr+`> property in its definition
`,type:Le.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),le(e,gr)&&le(e,pn)&&!le(e.modes,e.defaultMode)&&t.push({message:"A MultiMode Lexer cannot be initialized with a "+pn+": <"+e.defaultMode+`>which does not exist
`,type:Le.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),le(e,gr)&&ue(e.modes,function(o,f){ue(o,function(l,g){qt(l)&&t.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+("<"+f+"> at index: <"+g+`>
`),type:Le.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),t}function ad(e,r,n){var t=[],o=!1,f=nr(st(If(e.modes,function(d){return d}))),l=Un(f,function(d){return d[Lt]===yt.NA}),g=Sc(n);return r&&ue(l,function(d){var c=Pc(d,g);if(c!==!1){var i=ld(d,c),a={message:i,type:c.issue,tokenType:d};t.push(a)}else le(d,"LINE_BREAKS")?d.LINE_BREAKS===!0&&(o=!0):ta(g,d.PATTERN)&&(o=!0)}),r&&!o&&t.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:Le.NO_LINE_BREAKS_FLAGS}),t}function sd(e){var r={},n=wt(e);return ue(n,function(t){var o=e[t];if(Mt(o))r[t]=[];else throw Error("non exhaustive match")}),r}function kc(e){var r=e.PATTERN;if(zt(r))return!1;if(cn(r))return!0;if(le(r,"exec"))return!0;if(bt(r))return!1;throw Error("non exhaustive match")}function cd(e){return bt(e)&&e.length===1?e.charCodeAt(0):!1}var ud={test:function(e){for(var r=e.length,n=this.lastIndex;n<r;n++){var t=e.charCodeAt(n);if(t===10)return this.lastIndex=n+1,!0;if(t===13)return e.charCodeAt(n+1)===10?this.lastIndex=n+2:this.lastIndex=n+1,!0}return!1},lastIndex:0};function Pc(e,r){if(le(e,"LINE_BREAKS"))return!1;if(zt(e.PATTERN)){try{ta(r,e.PATTERN)}catch(n){return{issue:Le.IDENTIFY_TERMINATOR,errMsg:n.message}}return!1}else{if(bt(e.PATTERN))return!1;if(kc(e))return{issue:Le.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function ld(e,r){if(r.issue===Le.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+("	The problem is in the <"+e.name+`> Token Type
`)+("	 Root cause: "+r.errMsg+`.
`)+"	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(r.issue===Le.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+("	The problem is in the <"+e.name+`> Token Type
`)+"	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function Sc(e){var r=re(e,function(n){return bt(n)&&n.length>0?n.charCodeAt(0):n});return r}function Xo(e,r,n){e[r]===void 0?e[r]=[n]:e[r].push(n)}var Bn=256;function en(e){return e<Bn?e:Lr[e]}var Lr=[];function fd(){if(Ie(Lr)){Lr=new Array(65536);for(var e=0;e<65536;e++)Lr[e]=e>255?255+~~(e/255):e}}function lo(e,r){var n=e.tokenTypeIdx;return n===r.tokenTypeIdx?!0:r.isParent===!0&&r.categoryMatchesMap[n]===!0}function Hr(e,r){return e.tokenTypeIdx===r.tokenTypeIdx}var os=1,Fc={};function or(e){var r=dd(e);hd(r),vd(r),pd(r),ue(r,function(n){n.isParent=n.categoryMatches.length>0})}function dd(e){for(var r=tt(e),n=e,t=!0;t;){n=nr(st(re(n,function(f){return f.CATEGORIES})));var o=co(n,r);r=r.concat(o),Ie(o)?t=!1:n=o}return r}function hd(e){ue(e,function(r){Dc(r)||(Fc[os]=r,r.tokenTypeIdx=os++),is(r)&&!Mt(r.CATEGORIES)&&(r.CATEGORIES=[r.CATEGORIES]),is(r)||(r.CATEGORIES=[]),md(r)||(r.categoryMatches=[]),gd(r)||(r.categoryMatchesMap={})})}function pd(e){ue(e,function(r){r.categoryMatches=[],ue(r.categoryMatchesMap,function(n,t){r.categoryMatches.push(Fc[t].tokenTypeIdx)})})}function vd(e){ue(e,function(r){Bc([],r)})}function Bc(e,r){ue(e,function(n){r.categoryMatchesMap[n.tokenTypeIdx]=!0}),ue(r.CATEGORIES,function(n){var t=e.concat(r);Se(t,n)||Bc(t,n)})}function Dc(e){return le(e,"tokenTypeIdx")}function is(e){return le(e,"CATEGORIES")}function md(e){return le(e,"categoryMatches")}function gd(e){return le(e,"categoryMatchesMap")}function Ed(e){return le(e,"tokenTypeIdx")}var Vc={buildUnableToPopLexerModeMessage:function(e){return"Unable to pop Lexer Mode after encountering Token ->"+e.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(e,r,n,t,o){return"unexpected character: ->"+e.charAt(r)+"<- at offset: "+r+","+(" skipped "+n+" characters.")}},Le;(function(e){e[e.MISSING_PATTERN=0]="MISSING_PATTERN",e[e.INVALID_PATTERN=1]="INVALID_PATTERN",e[e.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",e[e.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",e[e.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",e[e.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",e[e.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",e[e.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",e[e.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",e[e.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",e[e.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",e[e.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",e[e.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",e[e.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",e[e.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",e[e.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",e[e.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})(Le||(Le={}));var Dn={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:Vc,traceInitPerf:!1,skipValidations:!1};Object.freeze(Dn);var yt=function(){function e(r,n){var t=this;if(n===void 0&&(n=Dn),this.lexerDefinition=r,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},typeof n=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=Za(Dn,n);var o=this.config.traceInitPerf;o===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof o=="number"&&(this.traceInitMaxIdent=o,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var f,l=!0;t.TRACE_INIT("Lexer Config handling",function(){if(t.config.lineTerminatorsPattern===Dn.lineTerminatorsPattern)t.config.lineTerminatorsPattern=ud;else if(t.config.lineTerminatorCharacters===Dn.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(n.safeMode&&n.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');t.trackStartLines=/full|onlyStart/i.test(t.config.positionTracking),t.trackEndLines=/full/i.test(t.config.positionTracking),Mt(r)?(f={modes:{}},f.modes[pn]=tt(r),f[pn]=pn):(l=!1,f=tr(r))}),t.config.skipValidations===!1&&(t.TRACE_INIT("performRuntimeChecks",function(){t.lexerDefinitionErrors=t.lexerDefinitionErrors.concat(id(f,t.trackStartLines,t.config.lineTerminatorCharacters))}),t.TRACE_INIT("performWarningRuntimeChecks",function(){t.lexerDefinitionWarning=t.lexerDefinitionWarning.concat(ad(f,t.trackStartLines,t.config.lineTerminatorCharacters))})),f.modes=f.modes?f.modes:{},ue(f.modes,function(i,a){f.modes[a]=Un(i,function(s){return qt(s)})});var g=wt(f.modes);if(ue(f.modes,function(i,a){t.TRACE_INIT("Mode: <"+a+"> processing",function(){if(t.modes.push(a),t.config.skipValidations===!1&&t.TRACE_INIT("validatePatterns",function(){t.lexerDefinitionErrors=t.lexerDefinitionErrors.concat(Hf(i,g))}),Ie(t.lexerDefinitionErrors)){or(i);var s;t.TRACE_INIT("analyzeTokenTypes",function(){s=Wf(i,{lineTerminatorCharacters:t.config.lineTerminatorCharacters,positionTracking:n.positionTracking,ensureOptimizations:n.ensureOptimizations,safeMode:n.safeMode,tracer:t.TRACE_INIT.bind(t)})}),t.patternIdxToConfig[a]=s.patternIdxToConfig,t.charCodeToPatternIdxToConfig[a]=s.charCodeToPatternIdxToConfig,t.emptyGroups=Za(t.emptyGroups,s.emptyGroups),t.hasCustom=s.hasCustom||t.hasCustom,t.canModeBeOptimized[a]=s.canBeOptimized}})}),t.defaultMode=f.defaultMode,!Ie(t.lexerDefinitionErrors)&&!t.config.deferDefinitionErrorsHandling){var d=re(t.lexerDefinitionErrors,function(i){return i.message}),c=d.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+c)}ue(t.lexerDefinitionWarning,function(i){_c(i.message)}),t.TRACE_INIT("Choosing sub-methods implementations",function(){if(Uc?(t.chopInput=Ja,t.match=t.matchWithTest):(t.updateLastIndex=Be,t.match=t.matchWithExec),l&&(t.handleModes=Be),t.trackStartLines===!1&&(t.computeNewColumn=Ja),t.trackEndLines===!1&&(t.updateTokenEndLineColumnLocation=Be),/full/i.test(t.config.positionTracking))t.createTokenInstance=t.createFullToken;else if(/onlyStart/i.test(t.config.positionTracking))t.createTokenInstance=t.createStartOnlyToken;else if(/onlyOffset/i.test(t.config.positionTracking))t.createTokenInstance=t.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+t.config.positionTracking+'"');t.hasCustom?(t.addToken=t.addTokenUsingPush,t.handlePayload=t.handlePayloadWithCustom):(t.addToken=t.addTokenUsingMemberAccess,t.handlePayload=t.handlePayloadNoCustom)}),t.TRACE_INIT("Failed Optimization Warnings",function(){var i=$e(t.canModeBeOptimized,function(a,s,u){return s===!1&&a.push(u),a},[]);if(n.ensureOptimizations&&!Ie(i))throw Error("Lexer Modes: < "+i.join(", ")+` > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),t.TRACE_INIT("clearRegExpParserCache",function(){Ff()}),t.TRACE_INIT("toFastProperties",function(){Mc(t)})})}return e.prototype.tokenize=function(r,n){if(n===void 0&&(n=this.defaultMode),!Ie(this.lexerDefinitionErrors)){var t=re(this.lexerDefinitionErrors,function(l){return l.message}),o=t.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+o)}var f=this.tokenizeInternal(r,n);return f},e.prototype.tokenizeInternal=function(r,n){var t=this,o,f,l,g,d,c,i,a,s,u,v,h,p,m,E=r,y=E.length,w=0,T=0,R=this.hasCustom?0:Math.floor(r.length/10),A=new Array(R),O=[],M=this.trackStartLines?1:void 0,b=this.trackStartLines?1:void 0,k=sd(this.emptyGroups),F=this.trackStartLines,$=this.config.lineTerminatorsPattern,Y=0,W=[],S=[],H=[],J=[];Object.freeze(J);var ee=void 0;function D(){return W}function Z(me){var Ne=en(me),fe=S[Ne];return fe===void 0?J:fe}var I=function(me){if(H.length===1&&me.tokenType.PUSH_MODE===void 0){var Ne=t.config.errorMessageProvider.buildUnableToPopLexerModeMessage(me);O.push({offset:me.startOffset,line:me.startLine!==void 0?me.startLine:void 0,column:me.startColumn!==void 0?me.startColumn:void 0,length:me.image.length,message:Ne})}else{H.pop();var fe=Oc(H);W=t.patternIdxToConfig[fe],S=t.charCodeToPatternIdxToConfig[fe],Y=W.length;var X=t.canModeBeOptimized[fe]&&t.config.safeMode===!1;S&&X?ee=Z:ee=D}};function _(me){H.push(me),S=this.charCodeToPatternIdxToConfig[me],W=this.patternIdxToConfig[me],Y=W.length,Y=W.length;var Ne=this.canModeBeOptimized[me]&&this.config.safeMode===!1;S&&Ne?ee=Z:ee=D}_.call(this,n);for(var C;w<y;){d=null;var P=E.charCodeAt(w),x=ee(P),z=x.length;for(o=0;o<z;o++){C=x[o];var L=C.pattern;c=null;var V=C.short;if(V!==!1?P===V&&(d=L):C.isCustom===!0?(m=L.exec(E,w,A,k),m!==null?(d=m[0],m.payload!==void 0&&(c=m.payload)):d=null):(this.updateLastIndex(L,w),d=this.match(L,r,w)),d!==null){if(g=C.longerAlt,g!==void 0){var te=W[g],j=te.pattern;i=null,te.isCustom===!0?(m=j.exec(E,w,A,k),m!==null?(l=m[0],m.payload!==void 0&&(i=m.payload)):l=null):(this.updateLastIndex(j,w),l=this.match(j,r,w)),l&&l.length>d.length&&(d=l,c=i,C=te)}break}}if(d!==null){if(a=d.length,s=C.group,s!==void 0&&(u=C.tokenTypeIdx,v=this.createTokenInstance(d,w,u,C.tokenType,M,b,a),this.handlePayload(v,c),s===!1?T=this.addToken(A,T,v):k[s].push(v)),r=this.chopInput(r,a),w=w+a,b=this.computeNewColumn(b,a),F===!0&&C.canLineTerminator===!0){var ne=0,ie=void 0,he=void 0;$.lastIndex=0;do ie=$.test(d),ie===!0&&(he=$.lastIndex-1,ne++);while(ie===!0);ne!==0&&(M=M+ne,b=a-he,this.updateTokenEndLineColumnLocation(v,s,he,ne,M,b,a))}this.handleModes(C,I,_,v)}else{for(var ce=w,Ae=M,we=b,de=!1;!de&&w<y;)for(E.charCodeAt(w),r=this.chopInput(r,1),w++,f=0;f<Y;f++){var ae=W[f],L=ae.pattern,V=ae.short;if(V!==!1?E.charCodeAt(w)===V&&(de=!0):ae.isCustom===!0?de=L.exec(E,w,A,k)!==null:(this.updateLastIndex(L,w),de=L.exec(r)!==null),de===!0)break}h=w-ce,p=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(E,ce,h,Ae,we),O.push({offset:ce,line:Ae,column:we,length:h,message:p})}}return this.hasCustom||(A.length=T),{tokens:A,groups:k,errors:O}},e.prototype.handleModes=function(r,n,t,o){if(r.pop===!0){var f=r.push;n(o),f!==void 0&&t.call(this,f)}else r.push!==void 0&&t.call(this,r.push)},e.prototype.chopInput=function(r,n){return r.substring(n)},e.prototype.updateLastIndex=function(r,n){r.lastIndex=n},e.prototype.updateTokenEndLineColumnLocation=function(r,n,t,o,f,l,g){var d,c;n!==void 0&&(d=t===g-1,c=d?-1:0,o===1&&d===!0||(r.endLine=f+c,r.endColumn=l-1+-c))},e.prototype.computeNewColumn=function(r,n){return r+n},e.prototype.createTokenInstance=function(){return null},e.prototype.createOffsetOnlyToken=function(r,n,t,o){return{image:r,startOffset:n,tokenTypeIdx:t,tokenType:o}},e.prototype.createStartOnlyToken=function(r,n,t,o,f,l){return{image:r,startOffset:n,startLine:f,startColumn:l,tokenTypeIdx:t,tokenType:o}},e.prototype.createFullToken=function(r,n,t,o,f,l,g){return{image:r,startOffset:n,endOffset:n+g-1,startLine:f,endLine:f,startColumn:l,endColumn:l+g-1,tokenTypeIdx:t,tokenType:o}},e.prototype.addToken=function(r,n,t){return 666},e.prototype.addTokenUsingPush=function(r,n,t){return r.push(t),n},e.prototype.addTokenUsingMemberAccess=function(r,n,t){return r[n]=t,n++,n},e.prototype.handlePayload=function(r,n){},e.prototype.handlePayloadNoCustom=function(r,n){},e.prototype.handlePayloadWithCustom=function(r,n){n!==null&&(r.payload=n)},e.prototype.match=function(r,n,t){return null},e.prototype.matchWithTest=function(r,n,t){var o=r.test(n);return o===!0?n.substring(t,r.lastIndex):null},e.prototype.matchWithExec=function(r,n){var t=r.exec(n);return t!==null?t[0]:t},e.prototype.TRACE_INIT=function(r,n){if(this.traceInitPerf===!0){this.traceInitIndent++;var t=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(t+"--> <"+r+">");var o=xc(n),f=o.time,l=o.value,g=f>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&g(t+"<-- <"+r+"> time: "+f+"ms"),this.traceInitIndent--,l}else return n()},e.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",e.NA=/NOT_APPLICABLE/,e}();function vn(e){return Gc(e)?e.LABEL:e.name}function yd(e){return e.name}function Gc(e){return bt(e.LABEL)&&e.LABEL!==""}var wd="parent",as="categories",ss="label",cs="group",us="push_mode",ls="pop_mode",fs="longer_alt",ds="line_breaks",hs="start_chars_hint";function na(e){return Rd(e)}function Rd(e){var r=e.pattern,n={};if(n.name=e.name,qt(r)||(n.PATTERN=r),le(e,wd))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return le(e,as)&&(n.CATEGORIES=e[as]),or([n]),le(e,ss)&&(n.LABEL=e[ss]),le(e,cs)&&(n.GROUP=e[cs]),le(e,ls)&&(n.POP_MODE=e[ls]),le(e,us)&&(n.PUSH_MODE=e[us]),le(e,fs)&&(n.LONGER_ALT=e[fs]),le(e,ds)&&(n.LINE_BREAKS=e[ds]),le(e,hs)&&(n.START_CHARS_HINT=e[hs]),n}var tn=na({name:"EOF",pattern:yt.NA});or([tn]);function fo(e,r,n,t,o,f,l,g){return{image:r,startOffset:n,endOffset:t,startLine:o,endLine:f,startColumn:l,endColumn:g,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}}function Nd(e,r){return lo(e,r)}var Xt=function(){var e=function(r,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var f in o)Object.prototype.hasOwnProperty.call(o,f)&&(t[f]=o[f])},e(r,n)};return function(r,n){e(r,n);function t(){this.constructor=r}r.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}}(),kt=function(){function e(r){this._definition=r}return Object.defineProperty(e.prototype,"definition",{get:function(){return this._definition},set:function(r){this._definition=r},enumerable:!1,configurable:!0}),e.prototype.accept=function(r){r.visit(this),ue(this.definition,function(n){n.accept(r)})},e}(),Je=function(e){Xt(r,e);function r(n){var t=e.call(this,[])||this;return t.idx=1,At(t,Tt(n,function(o){return o!==void 0})),t}return Object.defineProperty(r.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(n){},enumerable:!1,configurable:!0}),r.prototype.accept=function(n){n.visit(this)},r}(kt),gn=function(e){Xt(r,e);function r(n){var t=e.call(this,n.definition)||this;return t.orgText="",At(t,Tt(n,function(o){return o!==void 0})),t}return r}(kt),Ke=function(e){Xt(r,e);function r(n){var t=e.call(this,n.definition)||this;return t.ignoreAmbiguities=!1,At(t,Tt(n,function(o){return o!==void 0})),t}return r}(kt),ze=function(e){Xt(r,e);function r(n){var t=e.call(this,n.definition)||this;return t.idx=1,At(t,Tt(n,function(o){return o!==void 0})),t}return r}(kt),pt=function(e){Xt(r,e);function r(n){var t=e.call(this,n.definition)||this;return t.idx=1,At(t,Tt(n,function(o){return o!==void 0})),t}return r}(kt),vt=function(e){Xt(r,e);function r(n){var t=e.call(this,n.definition)||this;return t.idx=1,At(t,Tt(n,function(o){return o!==void 0})),t}return r}(kt),Ue=function(e){Xt(r,e);function r(n){var t=e.call(this,n.definition)||this;return t.idx=1,At(t,Tt(n,function(o){return o!==void 0})),t}return r}(kt),ut=function(e){Xt(r,e);function r(n){var t=e.call(this,n.definition)||this;return t.idx=1,At(t,Tt(n,function(o){return o!==void 0})),t}return r}(kt),lt=function(e){Xt(r,e);function r(n){var t=e.call(this,n.definition)||this;return t.idx=1,t.ignoreAmbiguities=!1,t.hasPredicates=!1,At(t,Tt(n,function(o){return o!==void 0})),t}return Object.defineProperty(r.prototype,"definition",{get:function(){return this._definition},set:function(n){this._definition=n},enumerable:!1,configurable:!0}),r}(kt),Me=function(){function e(r){this.idx=1,At(this,Tt(r,function(n){return n!==void 0}))}return e.prototype.accept=function(r){r.visit(this)},e}();function Wc(e){return re(e,Gn)}function Gn(e){function r(o){return re(o,Gn)}if(e instanceof Je)return{type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};if(e instanceof Ke)return{type:"Alternative",definition:r(e.definition)};if(e instanceof ze)return{type:"Option",idx:e.idx,definition:r(e.definition)};if(e instanceof pt)return{type:"RepetitionMandatory",idx:e.idx,definition:r(e.definition)};if(e instanceof vt)return{type:"RepetitionMandatoryWithSeparator",idx:e.idx,separator:Gn(new Me({terminalType:e.separator})),definition:r(e.definition)};if(e instanceof ut)return{type:"RepetitionWithSeparator",idx:e.idx,separator:Gn(new Me({terminalType:e.separator})),definition:r(e.definition)};if(e instanceof Ue)return{type:"Repetition",idx:e.idx,definition:r(e.definition)};if(e instanceof lt)return{type:"Alternation",idx:e.idx,definition:r(e.definition)};if(e instanceof Me){var n={type:"Terminal",name:e.terminalType.name,label:vn(e.terminalType),idx:e.idx},t=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(n.pattern=zt(t)?t.source:t),n}else{if(e instanceof gn)return{type:"Rule",name:e.name,orgText:e.orgText,definition:r(e.definition)};throw Error("non exhaustive match")}}var ho=function(){function e(){}return e.prototype.walk=function(r,n){var t=this;n===void 0&&(n=[]),ue(r.definition,function(o,f){var l=He(r.definition,f+1);if(o instanceof Je)t.walkProdRef(o,l,n);else if(o instanceof Me)t.walkTerminal(o,l,n);else if(o instanceof Ke)t.walkFlat(o,l,n);else if(o instanceof ze)t.walkOption(o,l,n);else if(o instanceof pt)t.walkAtLeastOne(o,l,n);else if(o instanceof vt)t.walkAtLeastOneSep(o,l,n);else if(o instanceof ut)t.walkManySep(o,l,n);else if(o instanceof Ue)t.walkMany(o,l,n);else if(o instanceof lt)t.walkOr(o,l,n);else throw Error("non exhaustive match")})},e.prototype.walkTerminal=function(r,n,t){},e.prototype.walkProdRef=function(r,n,t){},e.prototype.walkFlat=function(r,n,t){var o=n.concat(t);this.walk(r,o)},e.prototype.walkOption=function(r,n,t){var o=n.concat(t);this.walk(r,o)},e.prototype.walkAtLeastOne=function(r,n,t){var o=[new ze({definition:r.definition})].concat(n,t);this.walk(r,o)},e.prototype.walkAtLeastOneSep=function(r,n,t){var o=ps(r,n,t);this.walk(r,o)},e.prototype.walkMany=function(r,n,t){var o=[new ze({definition:r.definition})].concat(n,t);this.walk(r,o)},e.prototype.walkManySep=function(r,n,t){var o=ps(r,n,t);this.walk(r,o)},e.prototype.walkOr=function(r,n,t){var o=this,f=n.concat(t);ue(r.definition,function(l){var g=new Ke({definition:[l]});o.walk(g,f)})},e}();function ps(e,r,n){var t=[new ze({definition:[new Me({terminalType:e.separator})].concat(e.definition)})],o=t.concat(r,n);return o}var En=function(){function e(){}return e.prototype.visit=function(r){var n=r;switch(n.constructor){case Je:return this.visitNonTerminal(n);case Ke:return this.visitAlternative(n);case ze:return this.visitOption(n);case pt:return this.visitRepetitionMandatory(n);case vt:return this.visitRepetitionMandatoryWithSeparator(n);case ut:return this.visitRepetitionWithSeparator(n);case Ue:return this.visitRepetition(n);case lt:return this.visitAlternation(n);case Me:return this.visitTerminal(n);case gn:return this.visitRule(n);default:throw Error("non exhaustive match")}},e.prototype.visitNonTerminal=function(r){},e.prototype.visitAlternative=function(r){},e.prototype.visitOption=function(r){},e.prototype.visitRepetition=function(r){},e.prototype.visitRepetitionMandatory=function(r){},e.prototype.visitRepetitionMandatoryWithSeparator=function(r){},e.prototype.visitRepetitionWithSeparator=function(r){},e.prototype.visitAlternation=function(r){},e.prototype.visitTerminal=function(r){},e.prototype.visitRule=function(r){},e}(),Td=function(){var e=function(r,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var f in o)Object.prototype.hasOwnProperty.call(o,f)&&(t[f]=o[f])},e(r,n)};return function(r,n){e(r,n);function t(){this.constructor=r}r.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}}();function Ad(e){return e instanceof Ke||e instanceof ze||e instanceof Ue||e instanceof pt||e instanceof vt||e instanceof ut||e instanceof Me||e instanceof gn}function $r(e,r){r===void 0&&(r=[]);var n=e instanceof ze||e instanceof Ue||e instanceof ut;return n?!0:e instanceof lt?Ic(e.definition,function(t){return $r(t,r)}):e instanceof Je&&Se(r,e)?!1:e instanceof kt?(e instanceof Je&&r.push(e),dt(e.definition,function(t){return $r(t,r)})):!1}function Cd(e){return e instanceof lt}function It(e){if(e instanceof Je)return"SUBRULE";if(e instanceof ze)return"OPTION";if(e instanceof lt)return"OR";if(e instanceof pt)return"AT_LEAST_ONE";if(e instanceof vt)return"AT_LEAST_ONE_SEP";if(e instanceof ut)return"MANY_SEP";if(e instanceof Ue)return"MANY";if(e instanceof Me)return"CONSUME";throw Error("non exhaustive match")}var Hc=function(e){Td(r,e);function r(){var n=e!==null&&e.apply(this,arguments)||this;return n.separator="-",n.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},n}return r.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},r.prototype.visitTerminal=function(n){var t=n.terminalType.name+this.separator+"Terminal";le(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(n)},r.prototype.visitNonTerminal=function(n){var t=n.nonTerminalName+this.separator+"Terminal";le(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(n)},r.prototype.visitOption=function(n){this.dslMethods.option.push(n)},r.prototype.visitRepetitionWithSeparator=function(n){this.dslMethods.repetitionWithSeparator.push(n)},r.prototype.visitRepetitionMandatory=function(n){this.dslMethods.repetitionMandatory.push(n)},r.prototype.visitRepetitionMandatoryWithSeparator=function(n){this.dslMethods.repetitionMandatoryWithSeparator.push(n)},r.prototype.visitRepetition=function(n){this.dslMethods.repetition.push(n)},r.prototype.visitAlternation=function(n){this.dslMethods.alternation.push(n)},r}(En),Er=new Hc;function Od(e){Er.reset(),e.accept(Er);var r=Er.dslMethods;return Er.reset(),r}function ir(e){if(e instanceof Je)return ir(e.referencedRule);if(e instanceof Me)return Md(e);if(Ad(e))return Id(e);if(Cd(e))return _d(e);throw Error("non exhaustive match")}function Id(e){for(var r=[],n=e.definition,t=0,o=n.length>t,f,l=!0;o&&l;)f=n[t],l=$r(f),r=r.concat(ir(f)),t=t+1,o=n.length>t;return Ji(r)}function _d(e){var r=re(e.definition,function(n){return ir(n)});return Ji(st(r))}function Md(e){return[e.terminalType]}var $c="_~IN~_",xd=function(){var e=function(r,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var f in o)Object.prototype.hasOwnProperty.call(o,f)&&(t[f]=o[f])},e(r,n)};return function(r,n){e(r,n);function t(){this.constructor=r}r.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}}(),bd=function(e){xd(r,e);function r(n){var t=e.call(this)||this;return t.topProd=n,t.follows={},t}return r.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},r.prototype.walkTerminal=function(n,t,o){},r.prototype.walkProdRef=function(n,t,o){var f=Ud(n.referencedRule,n.idx)+this.topProd.name,l=t.concat(o),g=new Ke({definition:l}),d=ir(g);this.follows[f]=d},r}(ho);function Ld(e){var r={};return ue(e,function(n){var t=new bd(n).startWalking();At(r,t)}),r}function Ud(e,r){return e.name+r+$c}var ra={buildMismatchTokenMessage:function(e){var r=e.expected,n=e.actual;e.previous,e.ruleName;var t=Gc(r),o=t?"--> "+vn(r)+" <--":"token of type --> "+r.name+" <--",f="Expecting "+o+" but found --> '"+n.image+"' <--";return f},buildNotAllInputParsedMessage:function(e){var r=e.firstRedundant;return e.ruleName,"Redundant input, expecting EOF but found: "+r.image},buildNoViableAltMessage:function(e){var r=e.expectedPathsPerAlt,n=e.actual;e.previous;var t=e.customUserDescription;e.ruleName;var o="Expecting: ",f=Rt(n).image,l=`
but found: '`+f+"'";if(t)return o+t+l;var g=$e(r,function(a,s){return a.concat(s)},[]),d=re(g,function(a){return"["+re(a,function(s){return vn(s)}).join(", ")+"]"}),c=re(d,function(a,s){return"  "+(s+1)+". "+a}),i=`one of these possible Token sequences:
`+c.join(`
`);return o+i+l},buildEarlyExitMessage:function(e){var r=e.expectedIterationPaths,n=e.actual,t=e.customUserDescription;e.ruleName;var o="Expecting: ",f=Rt(n).image,l=`
but found: '`+f+"'";if(t)return o+t+l;var g=re(r,function(c){return"["+re(c,function(i){return vn(i)}).join(",")+"]"}),d=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+("<"+g.join(" ,")+">");return o+d+l}};Object.freeze(ra);var qc={buildRuleNotFoundError:function(e,r){var n="Invalid grammar, reference to a rule which is not defined: ->"+r.nonTerminalName+`<-
inside top level rule: ->`+e.name+"<-";return n}},po={buildDuplicateFoundError:function(e,r){function n(i){return i instanceof Me?i.terminalType.name:i instanceof Je?i.nonTerminalName:""}var t=e.name,o=Rt(r),f=o.idx,l=It(o),g=n(o),d=f>0,c="->"+l+(d?f:"")+"<- "+(g?"with argument: ->"+g+"<-":"")+`
                  appears more than once (`+r.length+" times) in the top level rule: ->"+t+`<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return c=c.replace(/[ \t]+/g," "),c=c.replace(/\s\s+/g,`
`),c},buildNamespaceConflictError:function(e){var r=`Namespace conflict found in grammar.
`+("The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+e.name+`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return r},buildAlternationPrefixAmbiguityError:function(e){var r=re(e.prefixPath,function(o){return vn(o)}).join(", "),n=e.alternation.idx===0?"":e.alternation.idx,t="Ambiguous alternatives: <"+e.ambiguityIndices.join(" ,")+`> due to common lookahead prefix
`+("in <OR"+n+"> inside <"+e.topLevelRule.name+`> Rule,
`)+("<"+r+`> may appears as a prefix path in all these alternatives.
`)+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return t},buildAlternationAmbiguityError:function(e){var r=re(e.prefixPath,function(o){return vn(o)}).join(", "),n=e.alternation.idx===0?"":e.alternation.idx,t="Ambiguous Alternatives Detected: <"+e.ambiguityIndices.join(" ,")+"> in <OR"+n+">"+(" inside <"+e.topLevelRule.name+`> Rule,
`)+("<"+r+`> may appears as a prefix path in all these alternatives.
`);return t=t+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,t},buildEmptyRepetitionError:function(e){var r=It(e.repetition);e.repetition.idx!==0&&(r+=e.repetition.idx);var n="The repetition <"+r+"> within Rule <"+e.topLevelRule.name+`> can never consume any tokens.
This could lead to an infinite loop.`;return n},buildTokenNameError:function(e){return"deprecated"},buildEmptyAlternationError:function(e){var r="Ambiguous empty alternative: <"+(e.emptyChoiceIdx+1)+">"+(" in <OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+`> Rule.
`)+"Only the last alternative may be an empty alternative.";return r},buildTooManyAlternativesError:function(e){var r=`An Alternation cannot have more than 256 alternatives:
`+("<OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+`> Rule.
 has `+(e.alternation.definition.length+1)+" alternatives.");return r},buildLeftRecursionError:function(e){var r=e.topLevelRule.name,n=re(e.leftRecursionPath,function(f){return f.name}),t=r+" --> "+n.concat([r]).join(" --> "),o=`Left Recursion found in grammar.
`+("rule: <"+r+`> can be invoked from itself (directly or indirectly)
`)+(`without consuming any Tokens. The grammar path that causes this is: 
 `+t+`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.`;return o},buildInvalidRuleNameError:function(e){return"deprecated"},buildDuplicateRuleNameError:function(e){var r;e.topLevelRule instanceof gn?r=e.topLevelRule.name:r=e.topLevelRule;var n="Duplicate definition, rule: ->"+r+"<- is already defined in the grammar: ->"+e.grammarName+"<-";return n}},kd=function(){var e=function(r,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var f in o)Object.prototype.hasOwnProperty.call(o,f)&&(t[f]=o[f])},e(r,n)};return function(r,n){e(r,n);function t(){this.constructor=r}r.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}}();function Pd(e,r){var n=new Sd(e,r);return n.resolveRefs(),n.errors}var Sd=function(e){kd(r,e);function r(n,t){var o=e.call(this)||this;return o.nameToTopRule=n,o.errMsgProvider=t,o.errors=[],o}return r.prototype.resolveRefs=function(){var n=this;ue(et(this.nameToTopRule),function(t){n.currTopLevel=t,t.accept(n)})},r.prototype.visitNonTerminal=function(n){var t=this.nameToTopRule[n.nonTerminalName];if(t)n.referencedRule=t;else{var o=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,n);this.errors.push({message:o,type:je.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:n.nonTerminalName})}},r}(En),yn=function(){var e=function(r,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var f in o)Object.prototype.hasOwnProperty.call(o,f)&&(t[f]=o[f])},e(r,n)};return function(r,n){e(r,n);function t(){this.constructor=r}r.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}}(),Fd=function(e){yn(r,e);function r(n,t){var o=e.call(this)||this;return o.topProd=n,o.path=t,o.possibleTokTypes=[],o.nextProductionName="",o.nextProductionOccurrence=0,o.found=!1,o.isAtEndOfPath=!1,o}return r.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=tt(this.path.ruleStack).reverse(),this.occurrenceStack=tt(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},r.prototype.walk=function(n,t){t===void 0&&(t=[]),this.found||e.prototype.walk.call(this,n,t)},r.prototype.walkProdRef=function(n,t,o){if(n.referencedRule.name===this.nextProductionName&&n.idx===this.nextProductionOccurrence){var f=t.concat(o);this.updateExpectedNext(),this.walk(n.referencedRule,f)}},r.prototype.updateExpectedNext=function(){Ie(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},r}(ho),Bd=function(e){yn(r,e);function r(n,t){var o=e.call(this,n,t)||this;return o.path=t,o.nextTerminalName="",o.nextTerminalOccurrence=0,o.nextTerminalName=o.path.lastTok.name,o.nextTerminalOccurrence=o.path.lastTokOccurrence,o}return r.prototype.walkTerminal=function(n,t,o){if(this.isAtEndOfPath&&n.terminalType.name===this.nextTerminalName&&n.idx===this.nextTerminalOccurrence&&!this.found){var f=t.concat(o),l=new Ke({definition:f});this.possibleTokTypes=ir(l),this.found=!0}},r}(Fd),vo=function(e){yn(r,e);function r(n,t){var o=e.call(this)||this;return o.topRule=n,o.occurrence=t,o.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},o}return r.prototype.startWalking=function(){return this.walk(this.topRule),this.result},r}(ho),Dd=function(e){yn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.walkMany=function(n,t,o){if(n.idx===this.occurrence){var f=Rt(t.concat(o));this.result.isEndOfRule=f===void 0,f instanceof Me&&(this.result.token=f.terminalType,this.result.occurrence=f.idx)}else e.prototype.walkMany.call(this,n,t,o)},r}(vo),vs=function(e){yn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.walkManySep=function(n,t,o){if(n.idx===this.occurrence){var f=Rt(t.concat(o));this.result.isEndOfRule=f===void 0,f instanceof Me&&(this.result.token=f.terminalType,this.result.occurrence=f.idx)}else e.prototype.walkManySep.call(this,n,t,o)},r}(vo),Vd=function(e){yn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.walkAtLeastOne=function(n,t,o){if(n.idx===this.occurrence){var f=Rt(t.concat(o));this.result.isEndOfRule=f===void 0,f instanceof Me&&(this.result.token=f.terminalType,this.result.occurrence=f.idx)}else e.prototype.walkAtLeastOne.call(this,n,t,o)},r}(vo),ms=function(e){yn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.walkAtLeastOneSep=function(n,t,o){if(n.idx===this.occurrence){var f=Rt(t.concat(o));this.result.isEndOfRule=f===void 0,f instanceof Me&&(this.result.token=f.terminalType,this.result.occurrence=f.idx)}else e.prototype.walkAtLeastOneSep.call(this,n,t,o)},r}(vo);function Ii(e,r,n){n===void 0&&(n=[]),n=tt(n);var t=[],o=0;function f(c){return c.concat(He(e,o+1))}function l(c){var i=Ii(f(c),r,n);return t.concat(i)}for(;n.length<r&&o<e.length;){var g=e[o];if(g instanceof Ke)return l(g.definition);if(g instanceof Je)return l(g.definition);if(g instanceof ze)t=l(g.definition);else if(g instanceof pt){var d=g.definition.concat([new Ue({definition:g.definition})]);return l(d)}else if(g instanceof vt){var d=[new Ke({definition:g.definition}),new Ue({definition:[new Me({terminalType:g.separator})].concat(g.definition)})];return l(d)}else if(g instanceof ut){var d=g.definition.concat([new Ue({definition:[new Me({terminalType:g.separator})].concat(g.definition)})]);t=l(d)}else if(g instanceof Ue){var d=g.definition.concat([new Ue({definition:g.definition})]);t=l(d)}else{if(g instanceof lt)return ue(g.definition,function(c){Ie(c.definition)===!1&&(t=l(c.definition))}),t;if(g instanceof Me)n.push(g.terminalType);else throw Error("non exhaustive match")}o++}return t.push({partialPath:n,suffixDef:He(e,o)}),t}function zc(e,r,n,t){var o="EXIT_NONE_TERMINAL",f=[o],l="EXIT_ALTERNATIVE",g=!1,d=r.length,c=d-t-1,i=[],a=[];for(a.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!Ie(a);){var s=a.pop();if(s===l){g&&Oc(a).idx<=c&&a.pop();continue}var u=s.def,v=s.idx,h=s.ruleStack,p=s.occurrenceStack;if(!Ie(u)){var m=u[0];if(m===o){var E={idx:v,def:He(u),ruleStack:Hn(h),occurrenceStack:Hn(p)};a.push(E)}else if(m instanceof Me)if(v<d-1){var y=v+1,w=r[y];if(n(w,m.terminalType)){var E={idx:y,def:He(u),ruleStack:h,occurrenceStack:p};a.push(E)}}else if(v===d-1)i.push({nextTokenType:m.terminalType,nextTokenOccurrence:m.idx,ruleStack:h,occurrenceStack:p}),g=!0;else throw Error("non exhaustive match");else if(m instanceof Je){var T=tt(h);T.push(m.nonTerminalName);var R=tt(p);R.push(m.idx);var E={idx:v,def:m.definition.concat(f,He(u)),ruleStack:T,occurrenceStack:R};a.push(E)}else if(m instanceof ze){var A={idx:v,def:He(u),ruleStack:h,occurrenceStack:p};a.push(A),a.push(l);var O={idx:v,def:m.definition.concat(He(u)),ruleStack:h,occurrenceStack:p};a.push(O)}else if(m instanceof pt){var M=new Ue({definition:m.definition,idx:m.idx}),b=m.definition.concat([M],He(u)),E={idx:v,def:b,ruleStack:h,occurrenceStack:p};a.push(E)}else if(m instanceof vt){var k=new Me({terminalType:m.separator}),M=new Ue({definition:[k].concat(m.definition),idx:m.idx}),b=m.definition.concat([M],He(u)),E={idx:v,def:b,ruleStack:h,occurrenceStack:p};a.push(E)}else if(m instanceof ut){var A={idx:v,def:He(u),ruleStack:h,occurrenceStack:p};a.push(A),a.push(l);var k=new Me({terminalType:m.separator}),F=new Ue({definition:[k].concat(m.definition),idx:m.idx}),b=m.definition.concat([F],He(u)),O={idx:v,def:b,ruleStack:h,occurrenceStack:p};a.push(O)}else if(m instanceof Ue){var A={idx:v,def:He(u),ruleStack:h,occurrenceStack:p};a.push(A),a.push(l);var F=new Ue({definition:m.definition,idx:m.idx}),b=m.definition.concat([F],He(u)),O={idx:v,def:b,ruleStack:h,occurrenceStack:p};a.push(O)}else if(m instanceof lt)for(var $=m.definition.length-1;$>=0;$--){var Y=m.definition[$],W={idx:v,def:Y.definition.concat(He(u)),ruleStack:h,occurrenceStack:p};a.push(W),a.push(l)}else if(m instanceof Ke)a.push({idx:v,def:m.definition.concat(He(u)),ruleStack:h,occurrenceStack:p});else if(m instanceof gn)a.push(Gd(m,v,h,p));else throw Error("non exhaustive match")}}return i}function Gd(e,r,n,t){var o=tt(n);o.push(e.name);var f=tt(t);return f.push(1),{idx:r,def:e.definition,ruleStack:o,occurrenceStack:f}}var Kc=function(){var e=function(r,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var f in o)Object.prototype.hasOwnProperty.call(o,f)&&(t[f]=o[f])},e(r,n)};return function(r,n){e(r,n);function t(){this.constructor=r}r.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}}(),Oe;(function(e){e[e.OPTION=0]="OPTION",e[e.REPETITION=1]="REPETITION",e[e.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",e[e.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",e[e.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",e[e.ALTERNATION=5]="ALTERNATION"})(Oe||(Oe={}));function Wd(e){if(e instanceof ze)return Oe.OPTION;if(e instanceof Ue)return Oe.REPETITION;if(e instanceof pt)return Oe.REPETITION_MANDATORY;if(e instanceof vt)return Oe.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof ut)return Oe.REPETITION_WITH_SEPARATOR;if(e instanceof lt)return Oe.ALTERNATION;throw Error("non exhaustive match")}function Hd(e,r,n,t,o,f){var l=oa(e,r,n),g=Qc(l)?Hr:lo;return f(l,t,g,o)}function $d(e,r,n,t,o,f){var l=ia(e,r,o,n),g=Qc(l)?Hr:lo;return f(l[0],g,t)}function qd(e,r,n,t){var o=e.length,f=dt(e,function(d){return dt(d,function(c){return c.length===1})});if(r)return function(d){for(var c=re(d,function(y){return y.GATE}),i=0;i<o;i++){var a=e[i],s=a.length,u=c[i];if(!(u!==void 0&&u.call(this)===!1))e:for(var v=0;v<s;v++){for(var h=a[v],p=h.length,m=0;m<p;m++){var E=this.LA(m+1);if(n(E,h[m])===!1)continue e}return i}}};if(f&&!t){var l=re(e,function(d){return st(d)}),g=$e(l,function(d,c,i){return ue(c,function(a){le(d,a.tokenTypeIdx)||(d[a.tokenTypeIdx]=i),ue(a.categoryMatches,function(s){le(d,s)||(d[s]=i)})}),d},[]);return function(){var d=this.LA(1);return g[d.tokenTypeIdx]}}else return function(){for(var d=0;d<o;d++){var c=e[d],i=c.length;e:for(var a=0;a<i;a++){for(var s=c[a],u=s.length,v=0;v<u;v++){var h=this.LA(v+1);if(n(h,s[v])===!1)continue e}return d}}}}function zd(e,r,n){var t=dt(e,function(c){return c.length===1}),o=e.length;if(t&&!n){var f=st(e);if(f.length===1&&Ie(f[0].categoryMatches)){var l=f[0],g=l.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===g}}else{var d=$e(f,function(c,i,a){return c[i.tokenTypeIdx]=!0,ue(i.categoryMatches,function(s){c[s]=!0}),c},[]);return function(){var c=this.LA(1);return d[c.tokenTypeIdx]===!0}}}else return function(){e:for(var c=0;c<o;c++){for(var i=e[c],a=i.length,s=0;s<a;s++){var u=this.LA(s+1);if(r(u,i[s])===!1)continue e}return!0}return!1}}var Kd=function(e){Kc(r,e);function r(n,t,o){var f=e.call(this)||this;return f.topProd=n,f.targetOccurrence=t,f.targetProdType=o,f}return r.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},r.prototype.checkIsTarget=function(n,t,o,f){return n.idx===this.targetOccurrence&&this.targetProdType===t?(this.restDef=o.concat(f),!0):!1},r.prototype.walkOption=function(n,t,o){this.checkIsTarget(n,Oe.OPTION,t,o)||e.prototype.walkOption.call(this,n,t,o)},r.prototype.walkAtLeastOne=function(n,t,o){this.checkIsTarget(n,Oe.REPETITION_MANDATORY,t,o)||e.prototype.walkOption.call(this,n,t,o)},r.prototype.walkAtLeastOneSep=function(n,t,o){this.checkIsTarget(n,Oe.REPETITION_MANDATORY_WITH_SEPARATOR,t,o)||e.prototype.walkOption.call(this,n,t,o)},r.prototype.walkMany=function(n,t,o){this.checkIsTarget(n,Oe.REPETITION,t,o)||e.prototype.walkOption.call(this,n,t,o)},r.prototype.walkManySep=function(n,t,o){this.checkIsTarget(n,Oe.REPETITION_WITH_SEPARATOR,t,o)||e.prototype.walkOption.call(this,n,t,o)},r}(ho),Yc=function(e){Kc(r,e);function r(n,t,o){var f=e.call(this)||this;return f.targetOccurrence=n,f.targetProdType=t,f.targetRef=o,f.result=[],f}return r.prototype.checkIsTarget=function(n,t){n.idx===this.targetOccurrence&&this.targetProdType===t&&(this.targetRef===void 0||n===this.targetRef)&&(this.result=n.definition)},r.prototype.visitOption=function(n){this.checkIsTarget(n,Oe.OPTION)},r.prototype.visitRepetition=function(n){this.checkIsTarget(n,Oe.REPETITION)},r.prototype.visitRepetitionMandatory=function(n){this.checkIsTarget(n,Oe.REPETITION_MANDATORY)},r.prototype.visitRepetitionMandatoryWithSeparator=function(n){this.checkIsTarget(n,Oe.REPETITION_MANDATORY_WITH_SEPARATOR)},r.prototype.visitRepetitionWithSeparator=function(n){this.checkIsTarget(n,Oe.REPETITION_WITH_SEPARATOR)},r.prototype.visitAlternation=function(n){this.checkIsTarget(n,Oe.ALTERNATION)},r}(En);function gs(e){for(var r=new Array(e),n=0;n<e;n++)r[n]=[];return r}function Qo(e){for(var r=[""],n=0;n<e.length;n++){for(var t=e[n],o=[],f=0;f<r.length;f++){var l=r[f];o.push(l+"_"+t.tokenTypeIdx);for(var g=0;g<t.categoryMatches.length;g++){var d="_"+t.categoryMatches[g];o.push(l+d)}}r=o}return r}function Yd(e,r,n){for(var t=0;t<e.length;t++)if(t!==n)for(var o=e[t],f=0;f<r.length;f++){var l=r[f];if(o[l]===!0)return!1}return!0}function Xc(e,r){for(var n=re(e,function(i){return Ii([i],1)}),t=gs(n.length),o=re(n,function(i){var a={};return ue(i,function(s){var u=Qo(s.partialPath);ue(u,function(v){a[v]=!0})}),a}),f=n,l=1;l<=r;l++){var g=f;f=gs(g.length);for(var d=function(i){for(var a=g[i],s=0;s<a.length;s++){var u=a[s].partialPath,v=a[s].suffixDef,h=Qo(u),p=Yd(o,h,i);if(p||Ie(v)||u.length===r){var m=t[i];if(_i(m,u)===!1){m.push(u);for(var E=0;E<h.length;E++){var y=h[E];o[i][y]=!0}}}else{var w=Ii(v,l+1,u);f[i]=f[i].concat(w),ue(w,function(T){var R=Qo(T.partialPath);ue(R,function(A){o[i][A]=!0})})}}},c=0;c<g.length;c++)d(c)}return t}function oa(e,r,n,t){var o=new Yc(e,Oe.ALTERNATION,t);return r.accept(o),Xc(o.result,n)}function ia(e,r,n,t){var o=new Yc(e,n);r.accept(o);var f=o.result,l=new Kd(r,e,n),g=l.startWalking(),d=new Ke({definition:f}),c=new Ke({definition:g});return Xc([d,c],t)}function _i(e,r){e:for(var n=0;n<e.length;n++){var t=e[n];if(t.length===r.length){for(var o=0;o<t.length;o++){var f=r[o],l=t[o],g=f===l||l.categoryMatchesMap[f.tokenTypeIdx]!==void 0;if(g===!1)continue e}return!0}}return!1}function Xd(e,r){return e.length<r.length&&dt(e,function(n,t){var o=r[t];return n===o||o.categoryMatchesMap[n.tokenTypeIdx]})}function Qc(e){return dt(e,function(r){return dt(r,function(n){return dt(n,function(t){return Ie(t.categoryMatches)})})})}var aa=function(){var e=function(r,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var f in o)Object.prototype.hasOwnProperty.call(o,f)&&(t[f]=o[f])},e(r,n)};return function(r,n){e(r,n);function t(){this.constructor=r}r.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}}();function Qd(e,r,n,t,o){var f=re(e,function(u){return Zd(u,t)}),l=re(e,function(u){return Jc(u,u,t)}),g=[],d=[],c=[];dt(l,Ie)&&(g=re(e,function(u){return nh(u,t)}),d=re(e,function(u){return rh(u,r,t)}),c=ah(e,r,t));var i=uh(e,n,t),a=re(e,function(u){return ih(u,t)}),s=re(e,function(u){return eh(u,e,o,t)});return st(f.concat(c,l,g,d,i,a,s))}function Zd(e,r){var n=new jd;e.accept(n);var t=n.allProductions,o=bf(t,Jd),f=Tt(o,function(g){return g.length>1}),l=re(et(f),function(g){var d=Rt(g),c=r.buildDuplicateFoundError(e,g),i=It(d),a={message:c,type:je.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:i,occurrence:d.idx},s=Zc(d);return s&&(a.parameter=s),a});return l}function Jd(e){return It(e)+"_#_"+e.idx+"_#_"+Zc(e)}function Zc(e){return e instanceof Me?e.terminalType.name:e instanceof Je?e.nonTerminalName:""}var jd=function(e){aa(r,e);function r(){var n=e!==null&&e.apply(this,arguments)||this;return n.allProductions=[],n}return r.prototype.visitNonTerminal=function(n){this.allProductions.push(n)},r.prototype.visitOption=function(n){this.allProductions.push(n)},r.prototype.visitRepetitionWithSeparator=function(n){this.allProductions.push(n)},r.prototype.visitRepetitionMandatory=function(n){this.allProductions.push(n)},r.prototype.visitRepetitionMandatoryWithSeparator=function(n){this.allProductions.push(n)},r.prototype.visitRepetition=function(n){this.allProductions.push(n)},r.prototype.visitAlternation=function(n){this.allProductions.push(n)},r.prototype.visitTerminal=function(n){this.allProductions.push(n)},r}(En);function eh(e,r,n,t){var o=[],f=$e(r,function(g,d){return d.name===e.name?g+1:g},0);if(f>1){var l=t.buildDuplicateRuleNameError({topLevelRule:e,grammarName:n});o.push({message:l,type:je.DUPLICATE_RULE_NAME,ruleName:e.name})}return o}function th(e,r,n){var t=[],o;return Se(r,e)||(o="Invalid rule override, rule: ->"+e+"<- cannot be overridden in the grammar: ->"+n+"<-as it is not defined in any of the super grammars ",t.push({message:o,type:je.INVALID_RULE_OVERRIDE,ruleName:e})),t}function Jc(e,r,n,t){t===void 0&&(t=[]);var o=[],f=Ur(r.definition);if(Ie(f))return[];var l=e.name,g=Se(f,e);g&&o.push({message:n.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:t}),type:je.LEFT_RECURSION,ruleName:l});var d=co(f,t.concat([e])),c=re(d,function(i){var a=tt(t);return a.push(i),Jc(e,i,n,a)});return o.concat(st(c))}function Ur(e){var r=[];if(Ie(e))return r;var n=Rt(e);if(n instanceof Je)r.push(n.referencedRule);else if(n instanceof Ke||n instanceof ze||n instanceof pt||n instanceof vt||n instanceof ut||n instanceof Ue)r=r.concat(Ur(n.definition));else if(n instanceof lt)r=st(re(n.definition,function(l){return Ur(l.definition)}));else if(!(n instanceof Me))throw Error("non exhaustive match");var t=$r(n),o=e.length>1;if(t&&o){var f=He(e);return r.concat(Ur(f))}else return r}var sa=function(e){aa(r,e);function r(){var n=e!==null&&e.apply(this,arguments)||this;return n.alternations=[],n}return r.prototype.visitAlternation=function(n){this.alternations.push(n)},r}(En);function nh(e,r){var n=new sa;e.accept(n);var t=n.alternations,o=$e(t,function(f,l){var g=Hn(l.definition),d=re(g,function(c,i){var a=zc([c],[],null,1);return Ie(a)?{message:r.buildEmptyAlternationError({topLevelRule:e,alternation:l,emptyChoiceIdx:i}),type:je.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:l.idx,alternative:i+1}:null});return f.concat(nr(d))},[]);return o}function rh(e,r,n){var t=new sa;e.accept(t);var o=t.alternations;o=Un(o,function(l){return l.ignoreAmbiguities===!0});var f=$e(o,function(l,g){var d=g.idx,c=g.maxLookahead||r,i=oa(d,e,c,g),a=sh(i,g,e,n),s=ch(i,g,e,n);return l.concat(a,s)},[]);return f}var oh=function(e){aa(r,e);function r(){var n=e!==null&&e.apply(this,arguments)||this;return n.allProductions=[],n}return r.prototype.visitRepetitionWithSeparator=function(n){this.allProductions.push(n)},r.prototype.visitRepetitionMandatory=function(n){this.allProductions.push(n)},r.prototype.visitRepetitionMandatoryWithSeparator=function(n){this.allProductions.push(n)},r.prototype.visitRepetition=function(n){this.allProductions.push(n)},r}(En);function ih(e,r){var n=new sa;e.accept(n);var t=n.alternations,o=$e(t,function(f,l){return l.definition.length>255&&f.push({message:r.buildTooManyAlternativesError({topLevelRule:e,alternation:l}),type:je.TOO_MANY_ALTS,ruleName:e.name,occurrence:l.idx}),f},[]);return o}function ah(e,r,n){var t=[];return ue(e,function(o){var f=new oh;o.accept(f);var l=f.allProductions;ue(l,function(g){var d=Wd(g),c=g.maxLookahead||r,i=g.idx,a=ia(i,o,d,c),s=a[0];if(Ie(st(s))){var u=n.buildEmptyRepetitionError({topLevelRule:o,repetition:g});t.push({message:u,type:je.NO_NON_EMPTY_LOOKAHEAD,ruleName:o.name})}})}),t}function sh(e,r,n,t){var o=[],f=$e(e,function(g,d,c){return r.definition[c].ignoreAmbiguities===!0||ue(d,function(i){var a=[c];ue(e,function(s,u){c!==u&&_i(s,i)&&r.definition[u].ignoreAmbiguities!==!0&&a.push(u)}),a.length>1&&!_i(o,i)&&(o.push(i),g.push({alts:a,path:i}))}),g},[]),l=re(f,function(g){var d=re(g.alts,function(i){return i+1}),c=t.buildAlternationAmbiguityError({topLevelRule:n,alternation:r,ambiguityIndices:d,prefixPath:g.path});return{message:c,type:je.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:r.idx,alternatives:[g.alts]}});return l}function ch(e,r,n,t){var o=[],f=$e(e,function(l,g,d){var c=re(g,function(i){return{idx:d,path:i}});return l.concat(c)},[]);return ue(f,function(l){var g=r.definition[l.idx];if(g.ignoreAmbiguities!==!0){var d=l.idx,c=l.path,i=_f(f,function(s){return r.definition[s.idx].ignoreAmbiguities!==!0&&s.idx<d&&Xd(s.path,c)}),a=re(i,function(s){var u=[s.idx+1,d+1],v=r.idx===0?"":r.idx,h=t.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:r,ambiguityIndices:u,prefixPath:s.path});return{message:h,type:je.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:v,alternatives:u}});o=o.concat(a)}}),o}function uh(e,r,n){var t=[],o=re(r,function(f){return f.name});return ue(e,function(f){var l=f.name;if(Se(o,l)){var g=n.buildNamespaceConflictError(f);t.push({message:g,type:je.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:l})}}),t}function jc(e){e=ea(e,{errMsgProvider:qc});var r={};return ue(e.rules,function(n){r[n.name]=n}),Pd(r,e.errMsgProvider)}function eu(e){return e=ea(e,{errMsgProvider:po}),Qd(e.rules,e.maxLookahead,e.tokenTypes,e.errMsgProvider,e.grammarName)}function lh(e){ue(e.rules,function(r){var n=new Hc;r.accept(n),ue(n.dslMethods,function(t){ue(t,function(o,f){o.idx=f+1})})})}var ar=function(){var e=function(r,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var f in o)Object.prototype.hasOwnProperty.call(o,f)&&(t[f]=o[f])},e(r,n)};return function(r,n){e(r,n);function t(){this.constructor=r}r.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}}(),tu="MismatchedTokenException",nu="NoViableAltException",ru="EarlyExitException",ou="NotAllInputParsedException",iu=[tu,nu,ru,ou];Object.freeze(iu);function $n(e){return Se(iu,e.name)}var mo=function(e){ar(r,e);function r(n,t){var o=this.constructor,f=e.call(this,n)||this;return f.token=t,f.resyncedTokens=[],Object.setPrototypeOf(f,o.prototype),Error.captureStackTrace&&Error.captureStackTrace(f,f.constructor),f}return r}(Error),ca=function(e){ar(r,e);function r(n,t,o){var f=e.call(this,n,t)||this;return f.previousToken=o,f.name=tu,f}return r}(mo),au=function(e){ar(r,e);function r(n,t,o){var f=e.call(this,n,t)||this;return f.previousToken=o,f.name=nu,f}return r}(mo),su=function(e){ar(r,e);function r(n,t){var o=e.call(this,n,t)||this;return o.name=ou,o}return r}(mo),cu=function(e){ar(r,e);function r(n,t,o){var f=e.call(this,n,t)||this;return f.previousToken=o,f.name=ru,f}return r}(mo),Zo={},uu="InRuleRecoveryException";function lu(e){this.name=uu,this.message=e}lu.prototype=Error.prototype;var fh=function(){function e(){}return e.prototype.initRecoverable=function(r){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=le(r,"recoveryEnabled")?r.recoveryEnabled:Kt.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=dh)},e.prototype.getTokenToInsert=function(r){var n=fo(r,"",NaN,NaN,NaN,NaN,NaN,NaN);return n.isInsertedInRecovery=!0,n},e.prototype.canTokenTypeBeInsertedInRecovery=function(r){return!0},e.prototype.tryInRepetitionRecovery=function(r,n,t,o){for(var f=this,l=this.findReSyncTokenType(),g=this.exportLexerState(),d=[],c=!1,i=this.LA(1),a=this.LA(1),s=function(){var u=f.LA(0),v=f.errorMessageProvider.buildMismatchTokenMessage({expected:o,actual:i,previous:u,ruleName:f.getCurrRuleFullName()}),h=new ca(v,i,f.LA(0));h.resyncedTokens=Hn(d),f.SAVE_ERROR(h)};!c;)if(this.tokenMatcher(a,o)){s();return}else if(t.call(this)){s(),r.apply(this,n);return}else this.tokenMatcher(a,l)?c=!0:(a=this.SKIP_TOKEN(),this.addToResyncTokens(a,d));this.importLexerState(g)},e.prototype.shouldInRepetitionRecoveryBeTried=function(r,n,t){return!(t===!1||r===void 0||n===void 0||this.tokenMatcher(this.LA(1),r)||this.isBackTracking()||this.canPerformInRuleRecovery(r,this.getFollowsForInRuleRecovery(r,n)))},e.prototype.getFollowsForInRuleRecovery=function(r,n){var t=this.getCurrentGrammarPath(r,n),o=this.getNextPossibleTokenTypes(t);return o},e.prototype.tryInRuleRecovery=function(r,n){if(this.canRecoverWithSingleTokenInsertion(r,n)){var t=this.getTokenToInsert(r);return t}if(this.canRecoverWithSingleTokenDeletion(r)){var o=this.SKIP_TOKEN();return this.consumeToken(),o}throw new lu("sad sad panda")},e.prototype.canPerformInRuleRecovery=function(r,n){return this.canRecoverWithSingleTokenInsertion(r,n)||this.canRecoverWithSingleTokenDeletion(r)},e.prototype.canRecoverWithSingleTokenInsertion=function(r,n){var t=this;if(!this.canTokenTypeBeInsertedInRecovery(r)||Ie(n))return!1;var o=this.LA(1),f=xn(n,function(l){return t.tokenMatcher(o,l)})!==void 0;return f},e.prototype.canRecoverWithSingleTokenDeletion=function(r){var n=this.tokenMatcher(this.LA(2),r);return n},e.prototype.isInCurrentRuleReSyncSet=function(r){var n=this.getCurrFollowKey(),t=this.getFollowSetFromFollowKey(n);return Se(t,r)},e.prototype.findReSyncTokenType=function(){for(var r=this.flattenFollowSet(),n=this.LA(1),t=2;;){var o=n.tokenType;if(Se(r,o))return o;n=this.LA(t),t++}},e.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return Zo;var r=this.getLastExplicitRuleShortName(),n=this.getLastExplicitRuleOccurrenceIndex(),t=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(r),idxInCallingRule:n,inRule:this.shortRuleNameToFullName(t)}},e.prototype.buildFullFollowKeyStack=function(){var r=this,n=this.RULE_STACK,t=this.RULE_OCCURRENCE_STACK;return re(n,function(o,f){return f===0?Zo:{ruleName:r.shortRuleNameToFullName(o),idxInCallingRule:t[f],inRule:r.shortRuleNameToFullName(n[f-1])}})},e.prototype.flattenFollowSet=function(){var r=this,n=re(this.buildFullFollowKeyStack(),function(t){return r.getFollowSetFromFollowKey(t)});return st(n)},e.prototype.getFollowSetFromFollowKey=function(r){if(r===Zo)return[tn];var n=r.ruleName+r.idxInCallingRule+$c+r.inRule;return this.resyncFollows[n]},e.prototype.addToResyncTokens=function(r,n){return this.tokenMatcher(r,tn)||n.push(r),n},e.prototype.reSyncTo=function(r){for(var n=[],t=this.LA(1);this.tokenMatcher(t,r)===!1;)t=this.SKIP_TOKEN(),this.addToResyncTokens(t,n);return Hn(n)},e.prototype.attemptInRepetitionRecovery=function(r,n,t,o,f,l,g){},e.prototype.getCurrentGrammarPath=function(r,n){var t=this.getHumanReadableRuleStack(),o=tt(this.RULE_OCCURRENCE_STACK),f={ruleStack:t,occurrenceStack:o,lastTok:r,lastTokOccurrence:n};return f},e.prototype.getHumanReadableRuleStack=function(){var r=this;return re(this.RULE_STACK,function(n){return r.shortRuleNameToFullName(n)})},e}();function dh(e,r,n,t,o,f,l){var g=this.getKeyForAutomaticLookahead(t,o),d=this.firstAfterRepMap[g];if(d===void 0){var c=this.getCurrRuleFullName(),i=this.getGAstProductions()[c],a=new f(i,o);d=a.startWalking(),this.firstAfterRepMap[g]=d}var s=d.token,u=d.occurrence,v=d.isEndOfRule;this.RULE_STACK.length===1&&v&&s===void 0&&(s=tn,u=1),this.shouldInRepetitionRecoveryBeTried(s,u,l)&&this.tryInRepetitionRecovery(e,r,n,s)}var hh=4,un=8,fu=1<<un,du=2<<un,Mi=3<<un,xi=4<<un,bi=5<<un,kr=6<<un;function Jo(e,r,n){return n|r|e}var ph=function(){function e(){}return e.prototype.initLooksAhead=function(r){this.dynamicTokensEnabled=le(r,"dynamicTokensEnabled")?r.dynamicTokensEnabled:Kt.dynamicTokensEnabled,this.maxLookahead=le(r,"maxLookahead")?r.maxLookahead:Kt.maxLookahead,this.lookAheadFuncsCache=ja()?new Map:[],ja()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},e.prototype.preComputeLookaheadFunctions=function(r){var n=this;ue(r,function(t){n.TRACE_INIT(t.name+" Rule Lookahead",function(){var o=Od(t),f=o.alternation,l=o.repetition,g=o.option,d=o.repetitionMandatory,c=o.repetitionMandatoryWithSeparator,i=o.repetitionWithSeparator;ue(f,function(a){var s=a.idx===0?"":a.idx;n.TRACE_INIT(""+It(a)+s,function(){var u=Hd(a.idx,t,a.maxLookahead||n.maxLookahead,a.hasPredicates,n.dynamicTokensEnabled,n.lookAheadBuilderForAlternatives),v=Jo(n.fullRuleNameToShort[t.name],fu,a.idx);n.setLaFuncCache(v,u)})}),ue(l,function(a){n.computeLookaheadFunc(t,a.idx,Mi,Oe.REPETITION,a.maxLookahead,It(a))}),ue(g,function(a){n.computeLookaheadFunc(t,a.idx,du,Oe.OPTION,a.maxLookahead,It(a))}),ue(d,function(a){n.computeLookaheadFunc(t,a.idx,xi,Oe.REPETITION_MANDATORY,a.maxLookahead,It(a))}),ue(c,function(a){n.computeLookaheadFunc(t,a.idx,kr,Oe.REPETITION_MANDATORY_WITH_SEPARATOR,a.maxLookahead,It(a))}),ue(i,function(a){n.computeLookaheadFunc(t,a.idx,bi,Oe.REPETITION_WITH_SEPARATOR,a.maxLookahead,It(a))})})})},e.prototype.computeLookaheadFunc=function(r,n,t,o,f,l){var g=this;this.TRACE_INIT(""+l+(n===0?"":n),function(){var d=$d(n,r,f||g.maxLookahead,g.dynamicTokensEnabled,o,g.lookAheadBuilderForOptional),c=Jo(g.fullRuleNameToShort[r.name],t,n);g.setLaFuncCache(c,d)})},e.prototype.lookAheadBuilderForOptional=function(r,n,t){return zd(r,n,t)},e.prototype.lookAheadBuilderForAlternatives=function(r,n,t,o){return qd(r,n,t,o)},e.prototype.getKeyForAutomaticLookahead=function(r,n){var t=this.getLastExplicitRuleShortName();return Jo(t,r,n)},e.prototype.getLaFuncFromCache=function(r){},e.prototype.getLaFuncFromMap=function(r){return this.lookAheadFuncsCache.get(r)},e.prototype.getLaFuncFromObj=function(r){return this.lookAheadFuncsCache[r]},e.prototype.setLaFuncCache=function(r,n){},e.prototype.setLaFuncCacheUsingMap=function(r,n){this.lookAheadFuncsCache.set(r,n)},e.prototype.setLaFuncUsingObj=function(r,n){this.lookAheadFuncsCache[r]=n},e}();function Es(e,r){isNaN(e.startOffset)===!0?(e.startOffset=r.startOffset,e.endOffset=r.endOffset):e.endOffset<r.endOffset&&(e.endOffset=r.endOffset)}function ys(e,r){isNaN(e.startOffset)===!0?(e.startOffset=r.startOffset,e.startColumn=r.startColumn,e.startLine=r.startLine,e.endOffset=r.endOffset,e.endColumn=r.endColumn,e.endLine=r.endLine):e.endOffset<r.endOffset&&(e.endOffset=r.endOffset,e.endColumn=r.endColumn,e.endLine=r.endLine)}function vh(e,r,n){e.children[n]===void 0?e.children[n]=[r]:e.children[n].push(r)}function mh(e,r,n){e.children[r]===void 0?e.children[r]=[n]:e.children[r].push(n)}function gh(e){return go(e.constructor)}var ws="name";function go(e){var r=e.name;return r||"anonymous"}function hu(e,r){var n=Object.getOwnPropertyDescriptor(e,ws);return qt(n)||n.configurable?(Object.defineProperty(e,ws,{enumerable:!1,configurable:!0,writable:!1,value:r}),!0):!1}function Eh(e,r){for(var n=wt(e),t=n.length,o=0;o<t;o++)for(var f=n[o],l=e[f],g=l.length,d=0;d<g;d++){var c=l[d];c.tokenTypeIdx===void 0&&this[c.name](c.children,r)}}function yh(e,r){var n=function(){};hu(n,e+"BaseSemantics");var t={visit:function(o,f){if(Mt(o)&&(o=o[0]),!qt(o))return this[o.name](o.children,f)},validateVisitor:function(){var o=Rh(this,r);if(!Ie(o)){var f=re(o,function(l){return l.msg});throw Error("Errors Detected in CST Visitor <"+go(this.constructor)+`>:
	`+(""+f.join(`

`).replace(/\n/g,`
	`)))}}};return n.prototype=t,n.prototype.constructor=n,n._RULE_NAMES=r,n}function wh(e,r,n){var t=function(){};hu(t,e+"BaseSemanticsWithDefaults");var o=Object.create(n.prototype);return ue(r,function(f){o[f]=Eh}),t.prototype=o,t.prototype.constructor=t,t}var qr;(function(e){e[e.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",e[e.MISSING_METHOD=1]="MISSING_METHOD"})(qr||(qr={}));function Rh(e,r){var n=Nh(e,r),t=Ah(e,r);return n.concat(t)}function Nh(e,r){var n=re(r,function(t){if(!cn(e[t]))return{msg:"Missing visitor method: <"+t+"> on "+go(e.constructor)+" CST Visitor.",type:qr.MISSING_METHOD,methodName:t}});return nr(n)}var Th=["constructor","visit","validateVisitor"];function Ah(e,r){var n=[];for(var t in e)cn(e[t])&&!Se(Th,t)&&!Se(r,t)&&n.push({msg:"Redundant visitor method: <"+t+"> on "+go(e.constructor)+` CST Visitor
There is no Grammar Rule corresponding to this method's name.
`,type:qr.REDUNDANT_METHOD,methodName:t});return n}var Ch=function(){function e(){}return e.prototype.initTreeBuilder=function(r){if(this.CST_STACK=[],this.outputCst=r.outputCst,this.nodeLocationTracking=le(r,"nodeLocationTracking")?r.nodeLocationTracking:Kt.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=Be,this.cstFinallyStateUpdate=Be,this.cstPostTerminal=Be,this.cstPostNonTerminal=Be,this.cstPostRule=Be;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=ys,this.setNodeLocationFromNode=ys,this.cstPostRule=Be,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=Be,this.setNodeLocationFromNode=Be,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Es,this.setNodeLocationFromNode=Es,this.cstPostRule=Be,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=Be,this.setNodeLocationFromNode=Be,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=Be,this.setNodeLocationFromNode=Be,this.cstPostRule=Be,this.setInitialNodeLocation=Be;else throw Error('Invalid <nodeLocationTracking> config option: "'+r.nodeLocationTracking+'"')},e.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(r){r.location={startOffset:NaN,endOffset:NaN}},e.prototype.setInitialNodeLocationOnlyOffsetRegular=function(r){r.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},e.prototype.setInitialNodeLocationFullRecovery=function(r){r.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.setInitialNodeLocationFullRegular=function(r){var n=this.LA(1);r.location={startOffset:n.startOffset,startLine:n.startLine,startColumn:n.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.cstInvocationStateUpdate=function(r,n){var t={name:r,children:{}};this.setInitialNodeLocation(t),this.CST_STACK.push(t)},e.prototype.cstFinallyStateUpdate=function(){this.CST_STACK.pop()},e.prototype.cstPostRuleFull=function(r){var n=this.LA(0),t=r.location;t.startOffset<=n.startOffset?(t.endOffset=n.endOffset,t.endLine=n.endLine,t.endColumn=n.endColumn):(t.startOffset=NaN,t.startLine=NaN,t.startColumn=NaN)},e.prototype.cstPostRuleOnlyOffset=function(r){var n=this.LA(0),t=r.location;t.startOffset<=n.startOffset?t.endOffset=n.endOffset:t.startOffset=NaN},e.prototype.cstPostTerminal=function(r,n){var t=this.CST_STACK[this.CST_STACK.length-1];vh(t,n,r),this.setNodeLocationFromToken(t.location,n)},e.prototype.cstPostNonTerminal=function(r,n){var t=this.CST_STACK[this.CST_STACK.length-1];mh(t,n,r),this.setNodeLocationFromNode(t.location,r.location)},e.prototype.getBaseCstVisitorConstructor=function(){if(qt(this.baseCstVisitorConstructor)){var r=yh(this.className,wt(this.gastProductionsCache));return this.baseCstVisitorConstructor=r,r}return this.baseCstVisitorConstructor},e.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(qt(this.baseCstVisitorWithDefaultsConstructor)){var r=wh(this.className,wt(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=r,r}return this.baseCstVisitorWithDefaultsConstructor},e.prototype.getLastExplicitRuleShortName=function(){var r=this.RULE_STACK;return r[r.length-1]},e.prototype.getPreviousExplicitRuleShortName=function(){var r=this.RULE_STACK;return r[r.length-2]},e.prototype.getLastExplicitRuleOccurrenceIndex=function(){var r=this.RULE_OCCURRENCE_STACK;return r[r.length-1]},e}(),Oh=function(){function e(){}return e.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(e.prototype,"input",{get:function(){return this.tokVector},set:function(r){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=r,this.tokVectorLength=r.length},enumerable:!1,configurable:!0}),e.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):Kr},e.prototype.LA=function(r){var n=this.currIdx+r;return n<0||this.tokVectorLength<=n?Kr:this.tokVector[n]},e.prototype.consumeToken=function(){this.currIdx++},e.prototype.exportLexerState=function(){return this.currIdx},e.prototype.importLexerState=function(r){this.currIdx=r},e.prototype.resetLexerState=function(){this.currIdx=-1},e.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},e.prototype.getLexerPosition=function(){return this.exportLexerState()},e}(),Ih=function(){function e(){}return e.prototype.ACTION=function(r){return r.call(this)},e.prototype.consume=function(r,n,t){return this.consumeInternal(n,r,t)},e.prototype.subrule=function(r,n,t){return this.subruleInternal(n,r,t)},e.prototype.option=function(r,n){return this.optionInternal(n,r)},e.prototype.or=function(r,n){return this.orInternal(n,r)},e.prototype.many=function(r,n){return this.manyInternal(r,n)},e.prototype.atLeastOne=function(r,n){return this.atLeastOneInternal(r,n)},e.prototype.CONSUME=function(r,n){return this.consumeInternal(r,0,n)},e.prototype.CONSUME1=function(r,n){return this.consumeInternal(r,1,n)},e.prototype.CONSUME2=function(r,n){return this.consumeInternal(r,2,n)},e.prototype.CONSUME3=function(r,n){return this.consumeInternal(r,3,n)},e.prototype.CONSUME4=function(r,n){return this.consumeInternal(r,4,n)},e.prototype.CONSUME5=function(r,n){return this.consumeInternal(r,5,n)},e.prototype.CONSUME6=function(r,n){return this.consumeInternal(r,6,n)},e.prototype.CONSUME7=function(r,n){return this.consumeInternal(r,7,n)},e.prototype.CONSUME8=function(r,n){return this.consumeInternal(r,8,n)},e.prototype.CONSUME9=function(r,n){return this.consumeInternal(r,9,n)},e.prototype.SUBRULE=function(r,n){return this.subruleInternal(r,0,n)},e.prototype.SUBRULE1=function(r,n){return this.subruleInternal(r,1,n)},e.prototype.SUBRULE2=function(r,n){return this.subruleInternal(r,2,n)},e.prototype.SUBRULE3=function(r,n){return this.subruleInternal(r,3,n)},e.prototype.SUBRULE4=function(r,n){return this.subruleInternal(r,4,n)},e.prototype.SUBRULE5=function(r,n){return this.subruleInternal(r,5,n)},e.prototype.SUBRULE6=function(r,n){return this.subruleInternal(r,6,n)},e.prototype.SUBRULE7=function(r,n){return this.subruleInternal(r,7,n)},e.prototype.SUBRULE8=function(r,n){return this.subruleInternal(r,8,n)},e.prototype.SUBRULE9=function(r,n){return this.subruleInternal(r,9,n)},e.prototype.OPTION=function(r){return this.optionInternal(r,0)},e.prototype.OPTION1=function(r){return this.optionInternal(r,1)},e.prototype.OPTION2=function(r){return this.optionInternal(r,2)},e.prototype.OPTION3=function(r){return this.optionInternal(r,3)},e.prototype.OPTION4=function(r){return this.optionInternal(r,4)},e.prototype.OPTION5=function(r){return this.optionInternal(r,5)},e.prototype.OPTION6=function(r){return this.optionInternal(r,6)},e.prototype.OPTION7=function(r){return this.optionInternal(r,7)},e.prototype.OPTION8=function(r){return this.optionInternal(r,8)},e.prototype.OPTION9=function(r){return this.optionInternal(r,9)},e.prototype.OR=function(r){return this.orInternal(r,0)},e.prototype.OR1=function(r){return this.orInternal(r,1)},e.prototype.OR2=function(r){return this.orInternal(r,2)},e.prototype.OR3=function(r){return this.orInternal(r,3)},e.prototype.OR4=function(r){return this.orInternal(r,4)},e.prototype.OR5=function(r){return this.orInternal(r,5)},e.prototype.OR6=function(r){return this.orInternal(r,6)},e.prototype.OR7=function(r){return this.orInternal(r,7)},e.prototype.OR8=function(r){return this.orInternal(r,8)},e.prototype.OR9=function(r){return this.orInternal(r,9)},e.prototype.MANY=function(r){this.manyInternal(0,r)},e.prototype.MANY1=function(r){this.manyInternal(1,r)},e.prototype.MANY2=function(r){this.manyInternal(2,r)},e.prototype.MANY3=function(r){this.manyInternal(3,r)},e.prototype.MANY4=function(r){this.manyInternal(4,r)},e.prototype.MANY5=function(r){this.manyInternal(5,r)},e.prototype.MANY6=function(r){this.manyInternal(6,r)},e.prototype.MANY7=function(r){this.manyInternal(7,r)},e.prototype.MANY8=function(r){this.manyInternal(8,r)},e.prototype.MANY9=function(r){this.manyInternal(9,r)},e.prototype.MANY_SEP=function(r){this.manySepFirstInternal(0,r)},e.prototype.MANY_SEP1=function(r){this.manySepFirstInternal(1,r)},e.prototype.MANY_SEP2=function(r){this.manySepFirstInternal(2,r)},e.prototype.MANY_SEP3=function(r){this.manySepFirstInternal(3,r)},e.prototype.MANY_SEP4=function(r){this.manySepFirstInternal(4,r)},e.prototype.MANY_SEP5=function(r){this.manySepFirstInternal(5,r)},e.prototype.MANY_SEP6=function(r){this.manySepFirstInternal(6,r)},e.prototype.MANY_SEP7=function(r){this.manySepFirstInternal(7,r)},e.prototype.MANY_SEP8=function(r){this.manySepFirstInternal(8,r)},e.prototype.MANY_SEP9=function(r){this.manySepFirstInternal(9,r)},e.prototype.AT_LEAST_ONE=function(r){this.atLeastOneInternal(0,r)},e.prototype.AT_LEAST_ONE1=function(r){return this.atLeastOneInternal(1,r)},e.prototype.AT_LEAST_ONE2=function(r){this.atLeastOneInternal(2,r)},e.prototype.AT_LEAST_ONE3=function(r){this.atLeastOneInternal(3,r)},e.prototype.AT_LEAST_ONE4=function(r){this.atLeastOneInternal(4,r)},e.prototype.AT_LEAST_ONE5=function(r){this.atLeastOneInternal(5,r)},e.prototype.AT_LEAST_ONE6=function(r){this.atLeastOneInternal(6,r)},e.prototype.AT_LEAST_ONE7=function(r){this.atLeastOneInternal(7,r)},e.prototype.AT_LEAST_ONE8=function(r){this.atLeastOneInternal(8,r)},e.prototype.AT_LEAST_ONE9=function(r){this.atLeastOneInternal(9,r)},e.prototype.AT_LEAST_ONE_SEP=function(r){this.atLeastOneSepFirstInternal(0,r)},e.prototype.AT_LEAST_ONE_SEP1=function(r){this.atLeastOneSepFirstInternal(1,r)},e.prototype.AT_LEAST_ONE_SEP2=function(r){this.atLeastOneSepFirstInternal(2,r)},e.prototype.AT_LEAST_ONE_SEP3=function(r){this.atLeastOneSepFirstInternal(3,r)},e.prototype.AT_LEAST_ONE_SEP4=function(r){this.atLeastOneSepFirstInternal(4,r)},e.prototype.AT_LEAST_ONE_SEP5=function(r){this.atLeastOneSepFirstInternal(5,r)},e.prototype.AT_LEAST_ONE_SEP6=function(r){this.atLeastOneSepFirstInternal(6,r)},e.prototype.AT_LEAST_ONE_SEP7=function(r){this.atLeastOneSepFirstInternal(7,r)},e.prototype.AT_LEAST_ONE_SEP8=function(r){this.atLeastOneSepFirstInternal(8,r)},e.prototype.AT_LEAST_ONE_SEP9=function(r){this.atLeastOneSepFirstInternal(9,r)},e.prototype.RULE=function(r,n,t){if(t===void 0&&(t=Yr),Se(this.definedRulesNames,r)){var o=po.buildDuplicateRuleNameError({topLevelRule:r,grammarName:this.className}),f={message:o,type:je.DUPLICATE_RULE_NAME,ruleName:r};this.definitionErrors.push(f)}this.definedRulesNames.push(r);var l=this.defineRule(r,n,t);return this[r]=l,l},e.prototype.OVERRIDE_RULE=function(r,n,t){t===void 0&&(t=Yr);var o=[];o=o.concat(th(r,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,o);var f=this.defineRule(r,n,t);return this[r]=f,f},e.prototype.BACKTRACK=function(r,n){return function(){this.isBackTrackingStack.push(1);var t=this.saveRecogState();try{return r.apply(this,n),!0}catch(o){if($n(o))return!1;throw o}finally{this.reloadRecogState(t),this.isBackTrackingStack.pop()}}},e.prototype.getGAstProductions=function(){return this.gastProductionsCache},e.prototype.getSerializedGastProductions=function(){return Wc(et(this.gastProductionsCache))},e}(),_h=function(){function e(){}return e.prototype.initRecognizerEngine=function(r,n){if(this.className=gh(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=Hr,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},le(n,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(Mt(r)){if(Ie(r))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof r[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(Mt(r))this.tokensMap=$e(r,function(l,g){return l[g.name]=g,l},{});else if(le(r,"modes")&&dt(st(et(r.modes)),Ed)){var t=st(et(r.modes)),o=Ji(t);this.tokensMap=$e(o,function(l,g){return l[g.name]=g,l},{})}else if(ji(r))this.tokensMap=tr(r);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=tn;var f=dt(et(r),function(l){return Ie(l.categoryMatches)});this.tokenMatcher=f?Hr:lo,or(et(this.tokensMap))},e.prototype.defineRule=function(r,n,t){if(this.selfAnalysisDone)throw Error("Grammar rule <"+r+`> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);var o=le(t,"resyncEnabled")?t.resyncEnabled:Yr.resyncEnabled,f=le(t,"recoveryValueFunc")?t.recoveryValueFunc:Yr.recoveryValueFunc,l=this.ruleShortNameIdx<<hh+un;this.ruleShortNameIdx++,this.shortRuleNameToFull[l]=r,this.fullRuleNameToShort[r]=l;function g(i){try{if(this.outputCst===!0){n.apply(this,i);var a=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(a),a}else return n.apply(this,i)}catch(s){return this.invokeRuleCatch(s,o,f)}finally{this.ruleFinallyStateUpdate()}}var d;d=function(i,a){return i===void 0&&(i=0),this.ruleInvocationStateUpdate(l,r,i),g.call(this,a)};var c="ruleName";return d[c]=r,d.originalGrammarAction=n,d},e.prototype.invokeRuleCatch=function(r,n,t){var o=this.RULE_STACK.length===1,f=n&&!this.isBackTracking()&&this.recoveryEnabled;if($n(r)){var l=r;if(f){var g=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(g))if(l.resyncedTokens=this.reSyncTo(g),this.outputCst){var d=this.CST_STACK[this.CST_STACK.length-1];return d.recoveredNode=!0,d}else return t();else{if(this.outputCst){var d=this.CST_STACK[this.CST_STACK.length-1];d.recoveredNode=!0,l.partialCstResult=d}throw l}}else{if(o)return this.moveToTerminatedState(),t();throw l}}else throw r},e.prototype.optionInternal=function(r,n){var t=this.getKeyForAutomaticLookahead(du,n);return this.optionInternalLogic(r,n,t)},e.prototype.optionInternalLogic=function(r,n,t){var o=this,f=this.getLaFuncFromCache(t),l,g;if(r.DEF!==void 0){if(l=r.DEF,g=r.GATE,g!==void 0){var d=f;f=function(){return g.call(o)&&d.call(o)}}}else l=r;if(f.call(this)===!0)return l.call(this)},e.prototype.atLeastOneInternal=function(r,n){var t=this.getKeyForAutomaticLookahead(xi,r);return this.atLeastOneInternalLogic(r,n,t)},e.prototype.atLeastOneInternalLogic=function(r,n,t){var o=this,f=this.getLaFuncFromCache(t),l,g;if(n.DEF!==void 0){if(l=n.DEF,g=n.GATE,g!==void 0){var d=f;f=function(){return g.call(o)&&d.call(o)}}}else l=n;if(f.call(this)===!0)for(var c=this.doSingleRepetition(l);f.call(this)===!0&&c===!0;)c=this.doSingleRepetition(l);else throw this.raiseEarlyExitException(r,Oe.REPETITION_MANDATORY,n.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[r,n],f,xi,r,Vd)},e.prototype.atLeastOneSepFirstInternal=function(r,n){var t=this.getKeyForAutomaticLookahead(kr,r);this.atLeastOneSepFirstInternalLogic(r,n,t)},e.prototype.atLeastOneSepFirstInternalLogic=function(r,n,t){var o=this,f=n.DEF,l=n.SEP,g=this.getLaFuncFromCache(t);if(g.call(this)===!0){f.call(this);for(var d=function(){return o.tokenMatcher(o.LA(1),l)};this.tokenMatcher(this.LA(1),l)===!0;)this.CONSUME(l),f.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[r,l,d,f,ms],d,kr,r,ms)}else throw this.raiseEarlyExitException(r,Oe.REPETITION_MANDATORY_WITH_SEPARATOR,n.ERR_MSG)},e.prototype.manyInternal=function(r,n){var t=this.getKeyForAutomaticLookahead(Mi,r);return this.manyInternalLogic(r,n,t)},e.prototype.manyInternalLogic=function(r,n,t){var o=this,f=this.getLaFuncFromCache(t),l,g;if(n.DEF!==void 0){if(l=n.DEF,g=n.GATE,g!==void 0){var d=f;f=function(){return g.call(o)&&d.call(o)}}}else l=n;for(var c=!0;f.call(this)===!0&&c===!0;)c=this.doSingleRepetition(l);this.attemptInRepetitionRecovery(this.manyInternal,[r,n],f,Mi,r,Dd,c)},e.prototype.manySepFirstInternal=function(r,n){var t=this.getKeyForAutomaticLookahead(bi,r);this.manySepFirstInternalLogic(r,n,t)},e.prototype.manySepFirstInternalLogic=function(r,n,t){var o=this,f=n.DEF,l=n.SEP,g=this.getLaFuncFromCache(t);if(g.call(this)===!0){f.call(this);for(var d=function(){return o.tokenMatcher(o.LA(1),l)};this.tokenMatcher(this.LA(1),l)===!0;)this.CONSUME(l),f.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[r,l,d,f,vs],d,bi,r,vs)}},e.prototype.repetitionSepSecondInternal=function(r,n,t,o,f){for(;t();)this.CONSUME(n),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[r,n,t,o,f],t,kr,r,f)},e.prototype.doSingleRepetition=function(r){var n=this.getLexerPosition();r.call(this);var t=this.getLexerPosition();return t>n},e.prototype.orInternal=function(r,n){var t=this.getKeyForAutomaticLookahead(fu,n),o=Mt(r)?r:r.DEF,f=this.getLaFuncFromCache(t),l=f.call(this,o);if(l!==void 0){var g=o[l];return g.ALT.call(this)}this.raiseNoAltException(n,r.ERR_MSG)},e.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var r=this.LA(1),n=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:r,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new su(n,r))}},e.prototype.subruleInternal=function(r,n,t){var o;try{var f=t!==void 0?t.ARGS:void 0;return o=r.call(this,n,f),this.cstPostNonTerminal(o,t!==void 0&&t.LABEL!==void 0?t.LABEL:r.ruleName),o}catch(l){this.subruleInternalError(l,t,r.ruleName)}},e.prototype.subruleInternalError=function(r,n,t){throw $n(r)&&r.partialCstResult!==void 0&&(this.cstPostNonTerminal(r.partialCstResult,n!==void 0&&n.LABEL!==void 0?n.LABEL:t),delete r.partialCstResult),r},e.prototype.consumeInternal=function(r,n,t){var o;try{var f=this.LA(1);this.tokenMatcher(f,r)===!0?(this.consumeToken(),o=f):this.consumeInternalError(r,f,t)}catch(l){o=this.consumeInternalRecovery(r,n,l)}return this.cstPostTerminal(t!==void 0&&t.LABEL!==void 0?t.LABEL:r.name,o),o},e.prototype.consumeInternalError=function(r,n,t){var o,f=this.LA(0);throw t!==void 0&&t.ERR_MSG?o=t.ERR_MSG:o=this.errorMessageProvider.buildMismatchTokenMessage({expected:r,actual:n,previous:f,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new ca(o,n,f))},e.prototype.consumeInternalRecovery=function(r,n,t){if(this.recoveryEnabled&&t.name==="MismatchedTokenException"&&!this.isBackTracking()){var o=this.getFollowsForInRuleRecovery(r,n);try{return this.tryInRuleRecovery(r,o)}catch(f){throw f.name===uu?t:f}}else throw t},e.prototype.saveRecogState=function(){var r=this.errors,n=tt(this.RULE_STACK);return{errors:r,lexerState:this.exportLexerState(),RULE_STACK:n,CST_STACK:this.CST_STACK}},e.prototype.reloadRecogState=function(r){this.errors=r.errors,this.importLexerState(r.lexerState),this.RULE_STACK=r.RULE_STACK},e.prototype.ruleInvocationStateUpdate=function(r,n,t){this.RULE_OCCURRENCE_STACK.push(t),this.RULE_STACK.push(r),this.cstInvocationStateUpdate(n,r)},e.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},e.prototype.getCurrRuleFullName=function(){var r=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[r]},e.prototype.shortRuleNameToFullName=function(r){return this.shortRuleNameToFull[r]},e.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),tn)},e.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},e}(),Mh=function(){function e(){}return e.prototype.initErrorHandler=function(r){this._errors=[],this.errorMessageProvider=le(r,"errorMessageProvider")?r.errorMessageProvider:Kt.errorMessageProvider},e.prototype.SAVE_ERROR=function(r){if($n(r))return r.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:tt(this.RULE_OCCURRENCE_STACK)},this._errors.push(r),r;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(e.prototype,"errors",{get:function(){return tt(this._errors)},set:function(r){this._errors=r},enumerable:!1,configurable:!0}),e.prototype.raiseEarlyExitException=function(r,n,t){for(var o=this.getCurrRuleFullName(),f=this.getGAstProductions()[o],l=ia(r,f,n,this.maxLookahead),g=l[0],d=[],c=1;c<=this.maxLookahead;c++)d.push(this.LA(c));var i=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:g,actual:d,previous:this.LA(0),customUserDescription:t,ruleName:o});throw this.SAVE_ERROR(new cu(i,this.LA(1),this.LA(0)))},e.prototype.raiseNoAltException=function(r,n){for(var t=this.getCurrRuleFullName(),o=this.getGAstProductions()[t],f=oa(r,o,this.maxLookahead),l=[],g=1;g<=this.maxLookahead;g++)l.push(this.LA(g));var d=this.LA(0),c=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:f,actual:l,previous:d,customUserDescription:n,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new au(c,this.LA(1),d))},e}(),xh=function(){function e(){}return e.prototype.initContentAssist=function(){},e.prototype.computeContentAssist=function(r,n){var t=this.gastProductionsCache[r];if(qt(t))throw Error("Rule ->"+r+"<- does not exist in this grammar.");return zc([t],n,this.tokenMatcher,this.maxLookahead)},e.prototype.getNextPossibleTokenTypes=function(r){var n=Rt(r.ruleStack),t=this.getGAstProductions(),o=t[n],f=new Bd(o,r).startWalking();return f},e}(),Eo={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(Eo);var Rs=!0,Ns=Math.pow(2,un)-1,pu=na({name:"RECORDING_PHASE_TOKEN",pattern:yt.NA});or([pu]);var vu=fo(pu,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(vu);var bh={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}},Lh=function(){function e(){}return e.prototype.initGastRecorder=function(r){this.recordingProdStack=[],this.RECORDING_PHASE=!1},e.prototype.enableRecording=function(){var r=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var n=function(o){var f=o>0?o:"";r["CONSUME"+f]=function(l,g){return this.consumeInternalRecord(l,o,g)},r["SUBRULE"+f]=function(l,g){return this.subruleInternalRecord(l,o,g)},r["OPTION"+f]=function(l){return this.optionInternalRecord(l,o)},r["OR"+f]=function(l){return this.orInternalRecord(l,o)},r["MANY"+f]=function(l){this.manyInternalRecord(o,l)},r["MANY_SEP"+f]=function(l){this.manySepFirstInternalRecord(o,l)},r["AT_LEAST_ONE"+f]=function(l){this.atLeastOneInternalRecord(o,l)},r["AT_LEAST_ONE_SEP"+f]=function(l){this.atLeastOneSepFirstInternalRecord(o,l)}},t=0;t<10;t++)n(t);r.consume=function(o,f,l){return this.consumeInternalRecord(f,o,l)},r.subrule=function(o,f,l){return this.subruleInternalRecord(f,o,l)},r.option=function(o,f){return this.optionInternalRecord(f,o)},r.or=function(o,f){return this.orInternalRecord(f,o)},r.many=function(o,f){this.manyInternalRecord(o,f)},r.atLeastOne=function(o,f){this.atLeastOneInternalRecord(o,f)},r.ACTION=r.ACTION_RECORD,r.BACKTRACK=r.BACKTRACK_RECORD,r.LA=r.LA_RECORD})},e.prototype.disableRecording=function(){var r=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var n=0;n<10;n++){var t=n>0?n:"";delete r["CONSUME"+t],delete r["SUBRULE"+t],delete r["OPTION"+t],delete r["OR"+t],delete r["MANY"+t],delete r["MANY_SEP"+t],delete r["AT_LEAST_ONE"+t],delete r["AT_LEAST_ONE_SEP"+t]}delete r.consume,delete r.subrule,delete r.option,delete r.or,delete r.many,delete r.atLeastOne,delete r.ACTION,delete r.BACKTRACK,delete r.LA})},e.prototype.ACTION_RECORD=function(r){},e.prototype.BACKTRACK_RECORD=function(r,n){return function(){return!0}},e.prototype.LA_RECORD=function(r){return Kr},e.prototype.topLevelRuleRecord=function(r,n){try{var t=new gn({definition:[],name:r});return t.name=r,this.recordingProdStack.push(t),n.call(this),this.recordingProdStack.pop(),t}catch(o){if(o.KNOWN_RECORDER_ERROR!==!0)try{o.message=o.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw o}throw o}},e.prototype.optionInternalRecord=function(r,n){return Sn.call(this,ze,r,n)},e.prototype.atLeastOneInternalRecord=function(r,n){Sn.call(this,pt,n,r)},e.prototype.atLeastOneSepFirstInternalRecord=function(r,n){Sn.call(this,vt,n,r,Rs)},e.prototype.manyInternalRecord=function(r,n){Sn.call(this,Ue,n,r)},e.prototype.manySepFirstInternalRecord=function(r,n){Sn.call(this,ut,n,r,Rs)},e.prototype.orInternalRecord=function(r,n){return Uh.call(this,r,n)},e.prototype.subruleInternalRecord=function(r,n,t){if(zr(n),!r||le(r,"ruleName")===!1){var o=new Error("<SUBRULE"+Ts(n)+"> argument is invalid"+(" expecting a Parser method reference but got: <"+JSON.stringify(r)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw o.KNOWN_RECORDER_ERROR=!0,o}var f=Gr(this.recordingProdStack),l=r.ruleName,g=new Je({idx:n,nonTerminalName:l,referencedRule:void 0});return f.definition.push(g),this.outputCst?bh:Eo},e.prototype.consumeInternalRecord=function(r,n,t){if(zr(n),!Dc(r)){var o=new Error("<CONSUME"+Ts(n)+"> argument is invalid"+(" expecting a TokenType reference but got: <"+JSON.stringify(r)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw o.KNOWN_RECORDER_ERROR=!0,o}var f=Gr(this.recordingProdStack),l=new Me({idx:n,terminalType:r});return f.definition.push(l),vu},e}();function Sn(e,r,n,t){t===void 0&&(t=!1),zr(n);var o=Gr(this.recordingProdStack),f=cn(r)?r:r.DEF,l=new e({definition:[],idx:n});return t&&(l.separator=r.SEP),le(r,"MAX_LOOKAHEAD")&&(l.maxLookahead=r.MAX_LOOKAHEAD),this.recordingProdStack.push(l),f.call(this),o.definition.push(l),this.recordingProdStack.pop(),Eo}function Uh(e,r){var n=this;zr(r);var t=Gr(this.recordingProdStack),o=Mt(e)===!1,f=o===!1?e:e.DEF,l=new lt({definition:[],idx:r,ignoreAmbiguities:o&&e.IGNORE_AMBIGUITIES===!0});le(e,"MAX_LOOKAHEAD")&&(l.maxLookahead=e.MAX_LOOKAHEAD);var g=Ic(f,function(d){return cn(d.GATE)});return l.hasPredicates=g,t.definition.push(l),ue(f,function(d){var c=new Ke({definition:[]});l.definition.push(c),le(d,"IGNORE_AMBIGUITIES")?c.ignoreAmbiguities=d.IGNORE_AMBIGUITIES:le(d,"GATE")&&(c.ignoreAmbiguities=!0),n.recordingProdStack.push(c),d.ALT.call(n),n.recordingProdStack.pop()}),Eo}function Ts(e){return e===0?"":""+e}function zr(e){if(e<0||e>Ns){var r=new Error("Invalid DSL Method idx value: <"+e+`>
	`+("Idx value must be a none negative value smaller than "+(Ns+1)));throw r.KNOWN_RECORDER_ERROR=!0,r}}var kh=function(){function e(){}return e.prototype.initPerformanceTracer=function(r){if(le(r,"traceInitPerf")){var n=r.traceInitPerf,t=typeof n=="number";this.traceInitMaxIdent=t?n:1/0,this.traceInitPerf=t?n>0:n}else this.traceInitMaxIdent=0,this.traceInitPerf=Kt.traceInitPerf;this.traceInitIndent=-1},e.prototype.TRACE_INIT=function(r,n){if(this.traceInitPerf===!0){this.traceInitIndent++;var t=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(t+"--> <"+r+">");var o=xc(n),f=o.time,l=o.value,g=f>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&g(t+"<-- <"+r+"> time: "+f+"ms"),this.traceInitIndent--,l}else return n()},e}(),mu=function(){var e=function(r,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var f in o)Object.prototype.hasOwnProperty.call(o,f)&&(t[f]=o[f])},e(r,n)};return function(r,n){e(r,n);function t(){this.constructor=r}r.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}}(),Kr=fo(tn,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(Kr);var Kt=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:ra,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),Yr=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),je;(function(e){e[e.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",e[e.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",e[e.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",e[e.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",e[e.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",e[e.LEFT_RECURSION=5]="LEFT_RECURSION",e[e.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",e[e.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",e[e.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",e[e.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",e[e.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",e[e.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",e[e.TOO_MANY_ALTS=12]="TOO_MANY_ALTS"})(je||(je={}));function Ph(e){return e===void 0&&(e=void 0),function(){return e}}var ua=function(){function e(r,n){this.definitionErrors=[],this.selfAnalysisDone=!1;var t=this;if(t.initErrorHandler(n),t.initLexerAdapter(),t.initLooksAhead(n),t.initRecognizerEngine(r,n),t.initRecoverable(n),t.initTreeBuilder(n),t.initContentAssist(),t.initGastRecorder(n),t.initPerformanceTracer(n),le(n,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=le(n,"skipValidations")?n.skipValidations:Kt.skipValidations}return e.performSelfAnalysis=function(r){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")},e.prototype.performSelfAnalysis=function(){var r=this;this.TRACE_INIT("performSelfAnalysis",function(){var n;r.selfAnalysisDone=!0;var t=r.className;r.TRACE_INIT("toFastProps",function(){Mc(r)}),r.TRACE_INIT("Grammar Recording",function(){try{r.enableRecording(),ue(r.definedRulesNames,function(f){var l=r[f],g=l.originalGrammarAction,d=void 0;r.TRACE_INIT(f+" Rule",function(){d=r.topLevelRuleRecord(f,g)}),r.gastProductionsCache[f]=d})}finally{r.disableRecording()}});var o=[];if(r.TRACE_INIT("Grammar Resolving",function(){o=jc({rules:et(r.gastProductionsCache)}),r.definitionErrors.push.apply(r.definitionErrors,o)}),r.TRACE_INIT("Grammar Validations",function(){if(Ie(o)&&r.skipValidations===!1){var f=eu({rules:et(r.gastProductionsCache),maxLookahead:r.maxLookahead,tokenTypes:et(r.tokensMap),errMsgProvider:po,grammarName:t});r.definitionErrors.push.apply(r.definitionErrors,f)}}),Ie(r.definitionErrors)&&(r.recoveryEnabled&&r.TRACE_INIT("computeAllProdsFollows",function(){var f=Ld(et(r.gastProductionsCache));r.resyncFollows=f}),r.TRACE_INIT("ComputeLookaheadFunctions",function(){r.preComputeLookaheadFunctions(et(r.gastProductionsCache))})),!e.DEFER_DEFINITION_ERRORS_HANDLING&&!Ie(r.definitionErrors))throw n=re(r.definitionErrors,function(f){return f.message}),new Error(`Parser Definition Errors detected:
 `+n.join(`
-------------------------------
`))})},e.DEFER_DEFINITION_ERRORS_HANDLING=!1,e}();Uf(ua,[fh,ph,Ch,Oh,_h,Ih,Mh,xh,Lh,kh]);var Sh=function(e){mu(r,e);function r(n,t){t===void 0&&(t=Kt);var o=this,f=tr(t);return f.outputCst=!0,o=e.call(this,n,f)||this,o}return r}(ua),Fh=function(e){mu(r,e);function r(n,t){t===void 0&&(t=Kt);var o=this,f=tr(t);return f.outputCst=!1,o=e.call(this,n,f)||this,o}return r}(ua);function Bh(e,r){var n=r===void 0?{}:r,t=n.resourceBase,o=t===void 0?"https://unpkg.com/chevrotain@"+Ti+"/diagrams/":t,f=n.css,l=f===void 0?"https://unpkg.com/chevrotain@"+Ti+"/diagrams/diagrams.css":f,g=`
<!-- This is a generated file -->
<!DOCTYPE html>
<meta charset="utf-8">
<style>
  body {
    background-color: hsl(30, 20%, 95%)
  }
</style>

`,d=`
<link rel='stylesheet' href='`+l+`'>
`,c=`
<script src='`+o+`vendor/railroad-diagrams.js'><\/script>
<script src='`+o+`src/diagrams_builder.js'><\/script>
<script src='`+o+`src/diagrams_behavior.js'><\/script>
<script src='`+o+`src/main.js'><\/script>
`,i=`
<div id="diagrams" align="center"></div>    
`,a=`
<script>
    window.serializedGrammar = `+JSON.stringify(e,null,"  ")+`;
<\/script>
`,s=`
<script>
    var diagramsDiv = document.getElementById("diagrams");
    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);
<\/script>
`;return g+d+c+i+a+s}var De=`
`;function Dh(e){return`
(function (root, factory) {
    if (typeof define === 'function' && define.amd) {
        // AMD. Register as an anonymous module.
        define(['chevrotain'], factory);
    } else if (typeof module === 'object' && module.exports) {
        // Node. Does not work with strict CommonJS, but
        // only CommonJS-like environments that support module.exports,
        // like Node.
        module.exports = factory(require('chevrotain'));
    } else {
        // Browser globals (root is window)
        root.returnExports = factory(root.b);
    }
}(typeof self !== 'undefined' ? self : this, function (chevrotain) {

`+gu(e)+`
    
return {
    `+e.name+": "+e.name+` 
}
}));
`}function Vh(e){return`    
`+gu(e)+`
return new `+e.name+`(tokenVocabulary, config)    
`}function gu(e){var r=`
function `+e.name+`(tokenVocabulary, config) {
    // invoke super constructor
    // No support for embedded actions currently, so we can 'hardcode'
    // The use of CstParser.
    chevrotain.CstParser.call(this, tokenVocabulary, config)

    const $ = this

    `+Gh(e.rules)+`

    // very important to call this after all the rules have been defined.
    // otherwise the parser may not work correctly as it will lack information
    // derived during the self analysis phase.
    this.performSelfAnalysis(this)
}

// inheritance as implemented in javascript in the previous decade... :(
`+e.name+`.prototype = Object.create(chevrotain.CstParser.prototype)
`+e.name+".prototype.constructor = "+e.name+`    
    `;return r}function Gh(e){var r=re(e,function(n){return Wh(n,1)});return r.join(`
`)}function Wh(e,r){var n=Ze(r,'$.RULE("'+e.name+'", function() {')+De;return n+=yo(e.definition,r+1),n+=Ze(r+1,"})")+De,n}function Hh(e,r){var n=e.terminalType.name;return Ze(r,"$.CONSUME"+e.idx+"(this.tokensMap."+n+")"+De)}function $h(e,r){return Ze(r,"$.SUBRULE"+e.idx+"($."+e.nonTerminalName+")"+De)}function qh(e,r){var n=Ze(r,"$.OR"+e.idx+"([")+De,t=re(e.definition,function(o){return zh(o,r+1)});return n+=t.join(","+De),n+=De+Ze(r,"])"+De),n}function zh(e,r){var n=Ze(r,"{")+De;return n+=Ze(r+1,"ALT: function() {")+De,n+=yo(e.definition,r+1),n+=Ze(r+1,"}")+De,n+=Ze(r,"}"),n}function Kh(e,r){if(e instanceof Je)return $h(e,r);if(e instanceof ze)return Fn("OPTION",e,r);if(e instanceof pt)return Fn("AT_LEAST_ONE",e,r);if(e instanceof vt)return Fn("AT_LEAST_ONE_SEP",e,r);if(e instanceof ut)return Fn("MANY_SEP",e,r);if(e instanceof Ue)return Fn("MANY",e,r);if(e instanceof lt)return qh(e,r);if(e instanceof Me)return Hh(e,r);if(e instanceof Ke)return yo(e.definition,r);throw Error("non exhaustive match")}function Fn(e,r,n){var t=Ze(n,"$."+(e+r.idx)+"(");return r.separator?(t+="{"+De,t+=Ze(n+1,"SEP: this.tokensMap."+r.separator.name)+","+De,t+="DEF: "+As(r.definition,n+2)+De,t+=Ze(n,"}")+De):t+=As(r.definition,n+1),t+=Ze(n,")")+De,t}function As(e,r){var n="function() {"+De;return n+=yo(e,r),n+=Ze(r,"}")+De,n}function yo(e,r){var n="";return ue(e,function(t){n+=Kh(t,r+1)}),n}function Ze(e,r){var n=Array(e*4+1).join(" ");return n+r}function Yh(e){var r=Vh({name:e.name,rules:e.rules}),n=new Function("tokenVocabulary","config","chevrotain",r);return function(t){return n(e.tokenVocabulary,t,require("../api"))}}function Xh(e){return Dh({name:e.name,rules:e.rules})}function Qh(){console.warn(`The clearCache function was 'soft' removed from the Chevrotain API.
	 It performs no action other than printing this message.
	 Please avoid using it as it will be completely removed in the future`)}var Zh=function(){function e(){throw new Error(`The Parser class has been deprecated, use CstParser or EmbeddedActionsParser instead.	
See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_7-0-0`)}return e}();const Jh=Object.freeze(Object.defineProperty({__proto__:null,Alternation:lt,Alternative:Ke,CstParser:Sh,EMPTY_ALT:Ph,EOF:tn,EarlyExitException:cu,EmbeddedActionsParser:Fh,GAstVisitor:En,Lexer:yt,get LexerDefinitionErrorType(){return Le},MismatchedTokenException:ca,NoViableAltException:au,NonTerminal:Je,NotAllInputParsedException:su,Option:ze,Parser:Zh,get ParserDefinitionErrorType(){return je},Repetition:Ue,RepetitionMandatory:pt,RepetitionMandatoryWithSeparator:vt,RepetitionWithSeparator:ut,Rule:gn,Terminal:Me,VERSION:Ti,assignOccurrenceIndices:lh,clearCache:Qh,createSyntaxDiagramsCode:Bh,createToken:na,createTokenInstance:fo,defaultGrammarResolverErrorProvider:qc,defaultGrammarValidatorErrorProvider:po,defaultLexerErrorProvider:Vc,defaultParserErrorProvider:ra,generateParserFactory:Yh,generateParserModule:Xh,isRecognitionException:$n,resolveGrammar:jc,serializeGrammar:Wc,serializeProduction:Gn,tokenLabel:vn,tokenMatcher:Nd,tokenName:yd,validateGrammar:eu},Symbol.toStringTag,{value:"Module"})),la=uf(Jh);var jo,Cs;function fa(){if(Cs)return jo;Cs=1;const{createToken:e,Lexer:r}=la,n=Fe(),t={},o=e({name:"WhiteSpace",pattern:/\s+/,group:r.SKIPPED}),f=e({name:"String",pattern:/"(""|[^"])*"/}),l=e({name:"SingleQuotedString",pattern:/'(''|[^'])*'/}),g=e({name:"SheetQuoted",pattern:/'((?![\\\/\[\]*?:]).)+?'!/}),d=e({name:"Function",pattern:/[A-Za-z_]+[A-Za-z_0-9.]*\(/}),c=e({name:"FormulaErrorT",pattern:/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A/}),i=e({name:"RefError",pattern:/#REF!/}),a=e({name:"Name",pattern:/[a-zA-Z_][a-zA-Z0-9_.?]*/}),s=e({name:"Sheet",pattern:/[A-Za-z_.\d\u007F-\uFFFF]+!/}),u=e({name:"Cell",pattern:/[$]?[A-Za-z]{1,3}[$]?[1-9][0-9]*/,longer_alt:a}),v=e({name:"Number",pattern:/[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?/}),h=e({name:"Boolean",pattern:/TRUE|FALSE/i}),p=e({name:"Column",pattern:/[$]?[A-Za-z]{1,3}/,longer_alt:a}),m=e({name:"At",pattern:/@/}),E=e({name:"Comma",pattern:/,/}),y=e({name:"Colon",pattern:/:/}),w=e({name:"Semicolon",pattern:/;/}),T=e({name:"OpenParen",pattern:/\(/}),R=e({name:"CloseParen",pattern:/\)/}),A=e({name:"OpenSquareParen",pattern:/\[/}),O=e({name:"CloseSquareParen",pattern:/]/});e({name:"exclamationMark",pattern:/!/});const M=e({name:"OpenCurlyParen",pattern:/{/}),b=e({name:"CloseCurlyParen",pattern:/}/}),k=e({name:"QuoteS",pattern:/'/}),F=e({name:"MulOp",pattern:/\*/}),$=e({name:"PlusOp",pattern:/\+/}),Y=e({name:"DivOp",pattern:/\//}),W=e({name:"MinOp",pattern:/-/}),S=e({name:"ConcatOp",pattern:/&/}),H=e({name:"ExOp",pattern:/\^/}),J=e({name:"PercentOp",pattern:/%/}),ee=e({name:"GtOp",pattern:/>/}),D=e({name:"EqOp",pattern:/=/}),Z=e({name:"LtOp",pattern:/</}),I=e({name:"NeqOp",pattern:/<>/}),_=e({name:"GteOp",pattern:/>=/}),C=e({name:"LteOp",pattern:/<=/}),P=[o,f,g,l,d,c,i,s,u,h,p,a,v,m,E,y,w,T,R,A,O,M,b,k,F,$,Y,W,S,H,F,J,I,_,C,ee,D,Z],x=new r(P,{ensureOptimizations:!0});return P.forEach(z=>{t[z.name]=z}),jo={tokenVocabulary:t,lex:function(z){const L=x.tokenize(z);if(L.errors.length>0){const V=L.errors[0],te=V.line,j=V.column;let ne=`
`+z.split(`
`)[te-1]+`
`;throw ne+=Array(j-1).fill(" ").join("")+`^
`,V.message=ne+`Error at position ${te}:${j}
`+V.message,V.errorLocation={line:te,column:j},n.ERROR(V.message,V)}return L}},jo}var ei,Os;function Eu(){if(Os)return ei;Os=1;const e=fa(),{EmbeddedActionsParser:r}=la,n=e.tokenVocabulary,{String:t,SheetQuoted:o,ExcelRefFunction:f,ExcelConditionalRefFunction:l,Function:g,FormulaErrorT:d,RefError:c,Cell:i,Sheet:a,Name:s,Number:u,Boolean:v,Column:h,Comma:p,Colon:m,Semicolon:E,OpenParen:y,CloseParen:w,OpenCurlyParen:T,CloseCurlyParen:R,MulOp:A,PlusOp:O,DivOp:M,MinOp:b,ConcatOp:k,ExOp:F,PercentOp:$,NeqOp:Y,GteOp:W,LteOp:S,GtOp:H,EqOp:J,LtOp:ee}=e.tokenVocabulary;class D extends r{constructor(I,_){super(n,{outputCst:!1,maxLookahead:1,skipValidations:!0}),this.utils=_,this.binaryOperatorsPrecedence=[["^"],["*","/"],["+","-"],["&"],["<",">","=","<>","<=",">="]];const C=this;C.RULE("formulaWithBinaryOp",()=>{const P=[],x=[C.SUBRULE(C.formulaWithPercentOp)];return C.MANY(()=>{P.push(C.OR(C.c1||(C.c1=[{ALT:()=>C.CONSUME(H).image},{ALT:()=>C.CONSUME(J).image},{ALT:()=>C.CONSUME(ee).image},{ALT:()=>C.CONSUME(Y).image},{ALT:()=>C.CONSUME(W).image},{ALT:()=>C.CONSUME(S).image},{ALT:()=>C.CONSUME(k).image},{ALT:()=>C.CONSUME(O).image},{ALT:()=>C.CONSUME(b).image},{ALT:()=>C.CONSUME(A).image},{ALT:()=>C.CONSUME(M).image},{ALT:()=>C.CONSUME(F).image}]))),x.push(C.SUBRULE2(C.formulaWithPercentOp))}),C.ACTION(()=>{for(const z of this.binaryOperatorsPrecedence)for(let L=0,V=P.length;L<V;L++){const te=P[L];z.includes(te)&&(P.splice(L,1),x.splice(L,2,this.utils.applyInfix(x[L],te,x[L+1])),L--,V--)}}),x[0]}),C.RULE("plusMinusOp",()=>C.OR([{ALT:()=>C.CONSUME(O).image},{ALT:()=>C.CONSUME(b).image}])),C.RULE("formulaWithPercentOp",()=>{let P=C.SUBRULE(C.formulaWithUnaryOp);return C.OPTION(()=>{const x=C.CONSUME($).image;P=C.ACTION(()=>this.utils.applyPostfix(P,x))}),P}),C.RULE("formulaWithUnaryOp",()=>{const P=[];C.MANY(()=>{const z=C.OR([{ALT:()=>C.CONSUME(O).image},{ALT:()=>C.CONSUME(b).image}]);P.push(z)});const x=C.SUBRULE(C.formulaWithIntersect);return P.length>0?C.ACTION(()=>this.utils.applyPrefix(P,x)):x}),C.RULE("formulaWithIntersect",()=>{let P=C.SUBRULE(C.formulaWithRange);const x=[P];return C.MANY({GATE:()=>{const z=C.LA(0);return C.LA(1).startOffset>z.endOffset+1},DEF:()=>{x.push(C.SUBRULE3(C.formulaWithRange))}}),x.length>1?C.ACTION(()=>C.ACTION(()=>this.utils.applyIntersect(x))):P}),C.RULE("formulaWithRange",()=>{const P=C.SUBRULE(C.formula),x=[P];return C.MANY(()=>{C.CONSUME(m),x.push(C.SUBRULE2(C.formula))}),x.length>1?C.ACTION(()=>C.ACTION(()=>this.utils.applyRange(x))):P}),C.RULE("formula",()=>C.OR9([{ALT:()=>C.SUBRULE(C.referenceWithoutInfix)},{ALT:()=>C.SUBRULE(C.paren)},{ALT:()=>C.SUBRULE(C.constant)},{ALT:()=>C.SUBRULE(C.functionCall)},{ALT:()=>C.SUBRULE(C.constantArray)}])),C.RULE("paren",()=>{C.CONSUME(y);let P;const x=[];return x.push(C.SUBRULE(C.formulaWithBinaryOp)),C.MANY(()=>{C.CONSUME(p),x.push(C.SUBRULE2(C.formulaWithBinaryOp))}),x.length>1?P=C.ACTION(()=>this.utils.applyUnion(x)):P=x[0],C.CONSUME(w),P}),C.RULE("constantArray",()=>{const P=[[]];let x=0;return C.CONSUME(T),P[x].push(C.SUBRULE(C.constantForArray)),C.MANY(()=>{const z=C.OR([{ALT:()=>C.CONSUME(p).image},{ALT:()=>C.CONSUME(E).image}]),L=C.SUBRULE2(C.constantForArray);z===","||(x++,P[x]=[]),P[x].push(L)}),C.CONSUME(R),C.ACTION(()=>this.utils.toArray(P))}),C.RULE("constantForArray",()=>C.OR([{ALT:()=>{const P=C.OPTION(()=>C.SUBRULE(C.plusMinusOp)),x=C.CONSUME(u).image,z=C.ACTION(()=>this.utils.toNumber(x));return P?C.ACTION(()=>this.utils.applyPrefix([P],z)):z}},{ALT:()=>{const P=C.CONSUME(t).image;return C.ACTION(()=>this.utils.toString(P))}},{ALT:()=>{const P=C.CONSUME(v).image;return C.ACTION(()=>this.utils.toBoolean(P))}},{ALT:()=>{const P=C.CONSUME(d).image;return C.ACTION(()=>this.utils.toError(P))}},{ALT:()=>{const P=C.CONSUME(c).image;return C.ACTION(()=>this.utils.toError(P))}}])),C.RULE("constant",()=>C.OR([{ALT:()=>{const P=C.CONSUME(u).image;return C.ACTION(()=>this.utils.toNumber(P))}},{ALT:()=>{const P=C.CONSUME(t).image;return C.ACTION(()=>this.utils.toString(P))}},{ALT:()=>{const P=C.CONSUME(v).image;return C.ACTION(()=>this.utils.toBoolean(P))}},{ALT:()=>{const P=C.CONSUME(d).image;return C.ACTION(()=>this.utils.toError(P))}}])),C.RULE("functionCall",()=>{const P=C.CONSUME(g).image.slice(0,-1),x=C.SUBRULE(C.arguments);return C.CONSUME(w),C.ACTION(()=>I.callFunction(P,x))}),C.RULE("arguments",()=>{C.MANY2(()=>{C.CONSUME2(p)});const P=[];return C.OPTION(()=>{P.push(C.SUBRULE(C.formulaWithBinaryOp)),C.MANY(()=>{C.CONSUME1(p),P.push(null),C.OPTION3(()=>{P.pop(),P.push(C.SUBRULE2(C.formulaWithBinaryOp))})})}),P}),C.RULE("referenceWithoutInfix",()=>C.OR([{ALT:()=>C.SUBRULE(C.referenceItem)},{ALT:()=>{const P=C.SUBRULE(C.prefixName),x=C.SUBRULE2(C.formulaWithRange);return C.ACTION(()=>{if(this.utils.isFormulaError(x))return x;x.ref.sheet=P}),x}}])),C.RULE("referenceItem",()=>C.OR([{ALT:()=>{const P=C.CONSUME(i).image;return C.ACTION(()=>this.utils.parseCellAddress(P))}},{ALT:()=>{const P=C.CONSUME(s).image;return C.ACTION(()=>I.getVariable(P))}},{ALT:()=>{const P=C.CONSUME(h).image;return C.ACTION(()=>this.utils.parseCol(P))}},{ALT:()=>{const P=C.CONSUME(c).image;return C.ACTION(()=>this.utils.toError(P))}}])),C.RULE("prefixName",()=>C.OR([{ALT:()=>C.CONSUME(a).image.slice(0,-1)},{ALT:()=>C.CONSUME(o).image.slice(1,-2).replace(/''/g,"'")}])),this.performSelfAnalysis()}}return ei={Parser:D},ei}var ti,Is;function yu(){if(Is)return ti;Is=1;const e=Fe(),{Address:r}=Ve(),{Prefix:n,Postfix:t,Infix:o,Operators:f}=so(),l=ao(),g=1048576,d=16384,{NotAllInputParsedException:c}=la;class i{constructor(s){this.context=s}columnNameToNumber(s){return r.columnNameToNumber(s)}parseCellAddress(s){const u=s.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{address:u[0],col:this.columnNameToNumber(u[2]),row:+u[4]}}}parseRow(s){const u=+s;if(!Number.isInteger(u))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+s}}}parseCol(s){return{ref:{col:this.columnNameToNumber(s),row:void 0}}}parseColRange(s,u){return s=this.columnNameToNumber(s),u=this.columnNameToNumber(u),{ref:{from:{col:Math.min(s,u),row:null},to:{col:Math.max(s,u),row:null}}}}parseRowRange(s,u){return{ref:{from:{col:null,row:Math.min(s,u)},to:{col:null,row:Math.max(s,u)}}}}_applyPrefix(s,u,v){return this.isFormulaError(u)?u:n.unaryOp(s,u,v)}async applyPrefixAsync(s,u){const{val:v,isArray:h}=this.extractRefValue(await u);return this._applyPrefix(s,v,h)}applyPrefix(s,u){if(this.context.async)return this.applyPrefixAsync(s,u);{const{val:v,isArray:h}=this.extractRefValue(u);return this._applyPrefix(s,v,h)}}_applyPostfix(s,u,v){return this.isFormulaError(s)?s:t.percentOp(s,v,u)}async applyPostfixAsync(s,u){const{val:v,isArray:h}=this.extractRefValue(await s);return this._applyPostfix(v,h,u)}applyPostfix(s,u){if(this.context.async)return this.applyPostfixAsync(s,u);{const{val:v,isArray:h}=this.extractRefValue(s);return this._applyPostfix(v,h,u)}}_applyInfix(s,u,v){const h=s.val,p=s.isArray,m=v.val,E=v.isArray;if(this.isFormulaError(h))return h;if(this.isFormulaError(m))return m;if(f.compareOp.includes(u))return o.compareOp(h,u,m,p,E);if(f.concatOp.includes(u))return o.concatOp(h,u,m,p,E);if(f.mathOp.includes(u))return o.mathOp(h,u,m,p,E);throw new Error(`Unrecognized infix: ${u}`)}async applyInfixAsync(s,u,v){const h=this.extractRefValue(await s),p=this.extractRefValue(await v);return this._applyInfix(h,u,p)}applyInfix(s,u,v){if(this.context.async)return this.applyInfixAsync(s,u,v);{const h=this.extractRefValue(s),p=this.extractRefValue(v);return this._applyInfix(h,u,p)}}applyIntersect(s){if(this.isFormulaError(s[0]))return s[0];if(!s[0].ref)throw Error(`Expecting a reference, but got ${s[0]}.`);let u,v,h,p,m,E;const y=s.shift().ref;if(m=y.sheet,y.from)u=Math.max(y.from.row,y.to.row),h=Math.min(y.from.row,y.to.row),v=Math.max(y.from.col,y.to.col),p=Math.min(y.from.col,y.to.col);else{if(y.row===void 0||y.col===void 0)throw Error("Cannot intersect the whole row or column.");u=h=y.row,v=p=y.col}let w;return s.forEach(T=>{if(this.isFormulaError(T))return T;if(T=T.ref,!T)throw Error(`Expecting a reference, but got ${T}.`);if(T.from){const R=Math.max(T.from.row,T.to.row),A=Math.min(T.from.row,T.to.row),O=Math.max(T.from.col,T.to.col),M=Math.min(T.from.col,T.to.col);(A>u||R<h||M>v||O<p||m!==T.sheet)&&(w=e.NULL),u=Math.min(u,R),h=Math.max(h,A),v=Math.min(v,O),p=Math.max(p,M)}else{if(T.row===void 0||T.col===void 0)throw Error("Cannot intersect the whole row or column.");(T.row>u||T.row<h||T.col>v||T.col<p||m!==T.sheet)&&(w=e.NULL),u=h=T.row,v=p=T.col}}),w||(u===h&&v===p?E={ref:{sheet:m,row:u,col:v}}:E={ref:{sheet:m,from:{row:h,col:p},to:{row:u,col:v}}},E.ref.sheet||delete E.ref.sheet,E)}applyUnion(s){const u=new l;for(let v=0;v<s.length;v++){if(this.isFormulaError(s[v]))return s[v];u.add(this.extractRefValue(s[v]).val,s[v])}return u}applyRange(s){let u,v=-1,h=-1,p=g+1,m=d+1;return s.forEach(E=>{if(this.isFormulaError(E))return E;typeof E=="number"&&(E=this.parseRow(E)),E=E.ref,E.row===void 0&&(p=1,v=g),E.col===void 0&&(m=1,h=d),E.row>v&&(v=E.row),E.row<p&&(p=E.row),E.col>h&&(h=E.col),E.col<m&&(m=E.col)}),v===p&&h===m?u={ref:{row:v,col:h}}:u={ref:{from:{row:p,col:m},to:{row:v,col:h}}},u}extractRefValue(s){let u=s,v=!1;return Array.isArray(u)&&(v=!0),s.ref?{val:this.context.retrieveRef(s),isArray:v}:{val:u,isArray:v}}toArray(s){return s}toNumber(s){return Number(s)}toString(s){return s.substring(1,s.length-1).replace(/""/g,'"')}toBoolean(s){return s==="TRUE"}toError(s){return new e(s.toUpperCase())}isFormulaError(s){return s instanceof e}static formatChevrotainError(s,u){let v,h,p="";return s instanceof c?(v=s.token.startLine,h=s.token.startColumn):(v=s.previousToken.startLine,h=s.previousToken.startColumn+1),p+=`
`+u.split(`
`)[v-1]+`
`,p+=Array(h-1).fill(" ").join("")+`^
`,p+=`Error at position ${v}:${h}
`+s.message,s.errorLocation={line:v,column:h},e.ERROR(p,s)}}return ti=i,ti}var ni,_s;function jh(){if(_s)return ni;_s=1;const e=Tc(),r=Ac(),n=mf(),t=gf(),o=wf(),f=Rf(),l=Nf(),g=Af(),d=Cf(),c=Of(),i=Fe(),{FormulaHelpers:a}=Ve(),{Parser:s,allTokens:u}=Eu(),v=fa(),h=yu();class p{constructor(E,y=!1){this.logs=[],this.isTest=y,this.utils=new h(this),E=Object.assign({functions:{},functionsNeedContext:{},onVariable:()=>null,onCell:()=>0,onRange:()=>[[0]]},E),this.onVariable=E.onVariable,this.functions=Object.assign({},d,g,l,f,o,t,e,r,n,c,E.functions,E.functionsNeedContext),this.onRange=E.onRange,this.onCell=E.onCell,this.funsNullAs0=Object.keys(r).concat(Object.keys(n)).concat(Object.keys(t)).concat(Object.keys(o)).concat(Object.keys(f)).concat(Object.keys(g)).concat(Object.keys(d)),this.funsNeedContextAndNoDataRetrieve=["ROW","ROWS","COLUMN","COLUMNS","SUMIF","INDEX","AVERAGEIF","IF"],this.funsNeedContext=[...Object.keys(E.functionsNeedContext),...this.funsNeedContextAndNoDataRetrieve,"INDEX","OFFSET","INDIRECT","IF","CHOOSE","WEBSERVICE"],this.funsPreserveRef=Object.keys(l),this.parser=new s(this,this.utils)}static get allTokens(){return u}getCell(E){return E.sheet==null&&(E.sheet=this.position?this.position.sheet:void 0),this.onCell(E)}getRange(E){return E.sheet==null&&(E.sheet=this.position?this.position.sheet:void 0),this.onRange(E)}getVariable(E){const y={ref:this.onVariable(E,this.position.sheet,this.position)};return y.ref==null?i.NAME:y}retrieveRef(E){return a.isRangeRef(E)?this.getRange(E.ref):a.isCellRef(E)?this.getCell(E.ref):E}_callFunction(E,y){E.indexOf("_xlfn.")===0&&(E=E.slice(6)),E=E.toUpperCase();const w=this.funsNullAs0.includes(E)?0:"";if(this.funsNeedContextAndNoDataRetrieve.includes(E)||(y=y.map(T=>{if(T===null)return{value:w,isArray:!1,omitted:!0};const R=this.utils.extractRefValue(T);return this.funsPreserveRef.includes(E)?{value:R.val,isArray:R.isArray,ref:T.ref}:{value:R.val,isArray:R.isArray,isRangeRef:!!a.isRangeRef(T),isCellRef:!!a.isCellRef(T)}})),this.functions[E]){let T;try{!this.funsNeedContextAndNoDataRetrieve.includes(E)&&!this.funsNeedContext.includes(E)?T=this.functions[E](...y):T=this.functions[E](this,...y)}catch(R){if(R instanceof i)return R;throw R}if(T===void 0){if(this.isTest)return this.logs.includes(E)||this.logs.push(E),{value:0,ref:{}};throw i.NOT_IMPLEMENTED(E)}return T}else{if(this.isTest)return this.logs.includes(E)||this.logs.push(E),{value:0,ref:{}};throw i.NOT_IMPLEMENTED(E)}}async callFunctionAsync(E,y){const w=[];for(const R of y)w.push(await R);const T=await this._callFunction(E,w);return a.checkFunctionResult(T)}callFunction(E,y){if(this.async)return this.callFunctionAsync(E,y);{const w=this._callFunction(E,y);return a.checkFunctionResult(w)}}supportedFunctions(){const E=[];return Object.keys(this.functions).forEach(w=>{try{if(this.functions[w](0,0,0,0,0,0,0,0,0,0,0)===void 0)return;E.push(w)}catch(T){T instanceof Error&&E.push(w)}}),E.sort()}checkFormulaResult(E,y=!1){const w=typeof E;if(w==="number"){if(isNaN(E))return i.VALUE;if(!isFinite(E))return i.NUM;E+=0}else if(w==="object"){if(E instanceof i)return E;if(y){if(E.ref&&(E=this.retrieveRef(E)),typeof E=="object"&&!Array.isArray(E)&&E!=null)return i.VALUE}else if(E.ref&&E.ref.row&&!E.ref.from)E=this.retrieveRef(E);else if(E.ref&&E.ref.from&&E.ref.from.col===E.ref.to.col)E=this.retrieveRef({ref:{row:E.ref.from.row,col:E.ref.from.col}});else if(Array.isArray(E))E=E[0][0];else return i.VALUE}return E}parse(E,y,w=!1){if(E.length===0)throw Error("Input must not be empty.");this.position=y,this.async=!1;const T=v.lex(E);this.parser.input=T.tokens;let R;try{if(R=this.parser.formulaWithBinaryOp(),R=this.checkFormulaResult(R,w),R instanceof i)return R}catch(A){throw i.ERROR(A.message,A)}if(this.parser.errors.length>0){const A=this.parser.errors[0];throw h.formatChevrotainError(A,E)}return R}async parseAsync(E,y,w=!1){if(E.length===0)throw Error("Input must not be empty.");this.position=y,this.async=!0;const T=v.lex(E);this.parser.input=T.tokens;let R;try{if(R=await this.parser.formulaWithBinaryOp(),R=this.checkFormulaResult(R,w),R instanceof i)return R}catch(A){throw i.ERROR(A.message,A)}if(this.parser.errors.length>0){const A=this.parser.errors[0];throw h.formatChevrotainError(A,E)}return R}}return ni={FormulaParser:p,FormulaHelpers:a},ni}var ri,Ms;function e0(){if(Ms)return ri;Ms=1;const e=Fe(),{FormulaHelpers:r,Types:n,Address:t}=Ve(),{Prefix:o,Postfix:f,Infix:l,Operators:g}=so(),d=ao(),c=1048576,i=16384;class a{constructor(u){this.context=u}columnNameToNumber(u){return t.columnNameToNumber(u)}parseCellAddress(u){const v=u.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{col:this.columnNameToNumber(v[2]),row:+v[4]}}}parseRow(u){const v=+u;if(!Number.isInteger(v))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+u}}}parseCol(u){return{ref:{col:this.columnNameToNumber(u),row:void 0}}}applyPrefix(u,v){return this.extractRefValue(v),0}applyPostfix(u,v){return this.extractRefValue(u),0}applyInfix(u,v,h){return this.extractRefValue(u),this.extractRefValue(h),0}applyIntersect(u){if(this.isFormulaError(u[0]))return u[0];if(!u[0].ref)throw Error(`Expecting a reference, but got ${u[0]}.`);let v,h,p,m,E,y;const w=u.shift().ref;if(E=w.sheet,w.from)v=Math.max(w.from.row,w.to.row),p=Math.min(w.from.row,w.to.row),h=Math.max(w.from.col,w.to.col),m=Math.min(w.from.col,w.to.col);else{if(w.row===void 0||w.col===void 0)throw Error("Cannot intersect the whole row or column.");v=p=w.row,h=m=w.col}let T;return u.forEach(R=>{if(this.isFormulaError(R))return R;if(R=R.ref,!R)throw Error(`Expecting a reference, but got ${R}.`);if(R.from){const A=Math.max(R.from.row,R.to.row),O=Math.min(R.from.row,R.to.row),M=Math.max(R.from.col,R.to.col),b=Math.min(R.from.col,R.to.col);(O>v||A<p||b>h||M<m||E!==R.sheet)&&(T=e.NULL),v=Math.min(v,A),p=Math.max(p,O),h=Math.min(h,M),m=Math.max(m,b)}else{if(R.row===void 0||R.col===void 0)throw Error("Cannot intersect the whole row or column.");(R.row>v||R.row<p||R.col>h||R.col<m||E!==R.sheet)&&(T=e.NULL),v=p=R.row,h=m=R.col}}),T||(v===p&&h===m?y={ref:{sheet:E,row:v,col:h}}:y={ref:{sheet:E,from:{row:p,col:m},to:{row:v,col:h}}},y.ref.sheet||delete y.ref.sheet,y)}applyUnion(u){const v=new d;for(let h=0;h<u.length;h++){if(this.isFormulaError(u[h]))return u[h];v.add(this.extractRefValue(u[h]).val,u[h])}return v}applyRange(u){let v,h=-1,p=-1,m=c+1,E=i+1;return u.forEach(y=>{if(this.isFormulaError(y))return y;typeof y=="number"&&(y=this.parseRow(y)),y=y.ref,y.row===void 0&&(m=1,h=c),y.col===void 0&&(E=1,p=i),y.row>h&&(h=y.row),y.row<m&&(m=y.row),y.col>p&&(p=y.col),y.col<E&&(E=y.col)}),h===m&&p===E?v={ref:{row:h,col:p}}:v={ref:{from:{row:m,col:E},to:{row:h,col:p}}},v}extractRefValue(u){const v=Array.isArray(u);return u.ref?{val:this.context.retrieveRef(u),isArray:v}:{val:u,isArray:v}}toArray(u){return u}toNumber(u){return Number(u)}toString(u){return u.substring(1,u.length-1).replace(/""/g,'"')}toBoolean(u){return u==="TRUE"}toError(u){return new e(u.toUpperCase())}isFormulaError(u){return u instanceof e}}return ri=a,ri}var oi,xs;function t0(){if(xs)return oi;xs=1;const e=Fe(),{FormulaHelpers:r}=Ve(),{Parser:n}=Eu(),t=fa(),o=e0(),{formatChevrotainError:f}=yu();class l{constructor(d){this.data=[],this.utils=new o(this),d=Object.assign({onVariable:()=>null},d),this.utils=new o(this),this.onVariable=d.onVariable,this.functions={},this.parser=new n(this,this.utils)}getCell(d){return d.row!=null&&(d.sheet==null&&(d.sheet=this.position?this.position.sheet:void 0),this.data.findIndex(i=>i.from&&i.from.row<=d.row&&i.to.row>=d.row&&i.from.col<=d.col&&i.to.col>=d.col||i.row===d.row&&i.col===d.col&&i.sheet===d.sheet)===-1&&this.data.push(d)),0}getRange(d){return d.from.row!=null&&(d.sheet==null&&(d.sheet=this.position?this.position.sheet:void 0),this.data.findIndex(i=>i.from&&i.from.row===d.from.row&&i.from.col===d.from.col&&i.to.row===d.to.row&&i.to.col===d.to.col)===-1&&this.data.push(d)),[[0]]}getVariable(d){const c={ref:this.onVariable(d,this.position.sheet)};return c.ref==null?e.NAME:(r.isCellRef(c)?this.getCell(c.ref):this.getRange(c.ref),0)}retrieveRef(d){return r.isRangeRef(d)?this.getRange(d.ref):r.isCellRef(d)?this.getCell(d.ref):d}callFunction(d,c){return c.forEach(i=>{i!=null&&this.retrieveRef(i)}),{value:0,ref:{}}}checkFormulaResult(d){this.retrieveRef(d)}parse(d,c,i=!1){if(d.length===0)throw Error("Input must not be empty.");this.data=[],this.position=c;const a=t.lex(d);this.parser.input=a.tokens;try{const s=this.parser.formulaWithBinaryOp();this.checkFormulaResult(s)}catch(s){if(!i)throw e.ERROR(s.message,s)}if(this.parser.errors.length>0&&!i){const s=this.parser.errors[0];throw f(s,d)}return this.data}}return oi={DepParser:l},oi}var ii,bs;function n0(){if(bs)return ii;bs=1;const{FormulaParser:e}=jh(),{DepParser:r}=t0(),n=Nc(),t=Fe();return Object.assign(e,{MAX_ROW:1048576,MAX_COLUMN:16384,SSF:n,DepParser:r,FormulaError:t,...Ve()}),ii=e,ii}var nn=n0();const r0=Zi(nn);var ai={exports:{}},si={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ls;function o0(){return Ls||(Ls=1,function(e){function r(S,H){var J=S.length;S.push(H);e:for(;0<J;){var ee=J-1>>>1,D=S[ee];if(0<o(D,H))S[ee]=H,S[J]=D,J=ee;else break e}}function n(S){return S.length===0?null:S[0]}function t(S){if(S.length===0)return null;var H=S[0],J=S.pop();if(J!==H){S[0]=J;e:for(var ee=0,D=S.length,Z=D>>>1;ee<Z;){var I=2*(ee+1)-1,_=S[I],C=I+1,P=S[C];if(0>o(_,J))C<D&&0>o(P,_)?(S[ee]=P,S[C]=J,ee=C):(S[ee]=_,S[I]=J,ee=I);else if(C<D&&0>o(P,J))S[ee]=P,S[C]=J,ee=C;else break e}}return H}function o(S,H){var J=S.sortIndex-H.sortIndex;return J!==0?J:S.id-H.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var f=performance;e.unstable_now=function(){return f.now()}}else{var l=Date,g=l.now();e.unstable_now=function(){return l.now()-g}}var d=[],c=[],i=1,a=null,s=3,u=!1,v=!1,h=!1,p=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function y(S){for(var H=n(c);H!==null;){if(H.callback===null)t(c);else if(H.startTime<=S)t(c),H.sortIndex=H.expirationTime,r(d,H);else break;H=n(c)}}function w(S){if(h=!1,y(S),!v)if(n(d)!==null)v=!0,Y();else{var H=n(c);H!==null&&W(w,H.startTime-S)}}var T=!1,R=-1,A=5,O=-1;function M(){return!(e.unstable_now()-O<A)}function b(){if(T){var S=e.unstable_now();O=S;var H=!0;try{e:{v=!1,h&&(h=!1,m(R),R=-1),u=!0;var J=s;try{t:{for(y(S),a=n(d);a!==null&&!(a.expirationTime>S&&M());){var ee=a.callback;if(typeof ee=="function"){a.callback=null,s=a.priorityLevel;var D=ee(a.expirationTime<=S);if(S=e.unstable_now(),typeof D=="function"){a.callback=D,y(S),H=!0;break t}a===n(d)&&t(d),y(S)}else t(d);a=n(d)}if(a!==null)H=!0;else{var Z=n(c);Z!==null&&W(w,Z.startTime-S),H=!1}}break e}finally{a=null,s=J,u=!1}H=void 0}}finally{H?k():T=!1}}}var k;if(typeof E=="function")k=function(){E(b)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,$=F.port2;F.port1.onmessage=b,k=function(){$.postMessage(null)}}else k=function(){p(b,0)};function Y(){T||(T=!0,k())}function W(S,H){R=p(function(){S(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(S){S.callback=null},e.unstable_continueExecution=function(){v||u||(v=!0,Y())},e.unstable_forceFrameRate=function(S){0>S||125<S?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<S?Math.floor(1e3/S):5},e.unstable_getCurrentPriorityLevel=function(){return s},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(S){switch(s){case 1:case 2:case 3:var H=3;break;default:H=s}var J=s;s=H;try{return S()}finally{s=J}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(S,H){switch(S){case 1:case 2:case 3:case 4:case 5:break;default:S=3}var J=s;s=S;try{return H()}finally{s=J}},e.unstable_scheduleCallback=function(S,H,J){var ee=e.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?ee+J:ee):J=ee,S){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=J+D,S={id:i++,callback:H,priorityLevel:S,startTime:J,expirationTime:D,sortIndex:-1},J>ee?(S.sortIndex=J,r(c,S),n(d)===null&&S===n(c)&&(h?(m(R),R=-1):h=!0,W(w,J-ee))):(S.sortIndex=D,r(d,S),v||u||(v=!0,Y())),S},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(S){var H=s;return function(){var J=s;s=H;try{return S.apply(this,arguments)}finally{s=J}}}}(si)),si}var Us;function i0(){return Us||(Us=1,ai.exports=o0()),ai.exports}var ci=i0(),sr=lf();const a0=Zi(sr),Xr=Symbol(),s0=Symbol(),c0=typeof window>"u"||/ServerSideRendering/.test(window.navigator&&window.navigator.userAgent),wu=c0?N.useEffect:N.useLayoutEffect,u0=ci.unstable_runWithPriority?e=>{try{ci.unstable_runWithPriority(ci.unstable_NormalPriority,e)}catch(r){if(r.message==="Not implemented.")e();else throw r}}:e=>e(),l0=e=>({value:n,children:t})=>{const o=N.useRef(n),f=N.useRef(0),[l,g]=N.useState(null);l&&(l(n),g(null));const d=N.useRef();if(!d.current){const c=new Set,i=(a,s)=>{sr.unstable_batchedUpdates(()=>{f.current+=1;const u={n:f.current};s!=null&&s.suspense&&(u.n*=-1,u.p=new Promise(v=>{g(()=>h=>{u.v=h,delete u.p,v(h)})})),c.forEach(v=>v(u)),a()})};d.current={[Xr]:{v:o,n:f,l:c,u:i}}}return wu(()=>{o.current=n,f.current+=1,u0(()=>{d.current[Xr].l.forEach(c=>{c({n:f.current,v:n})})})},[n]),N.createElement(e,{value:d.current},t)};function f0(e){const r=N.createContext({[Xr]:{v:{current:e},n:{current:-1},l:new Set,u:n=>n()}});return r[s0]=r.Provider,r.Provider=l0(r.Provider),delete r.Consumer,r}function Ru(e,r){const n=N.useContext(e)[Xr],{v:{current:t},n:{current:o},l:f}=n,l=r(t),[g,d]=N.useReducer((c,i)=>{if(!i)return[t,l];if("p"in i)throw i.p;if(i.n===o)return Object.is(c[1],l)?c:[t,l];try{if("v"in i){if(Object.is(c[0],i.v))return c;const a=r(i.v);return Object.is(c[1],a)?c:[i.v,a]}}catch{}return[...c]},[t,l]);return Object.is(g[1],l)||d(),wu(()=>(f.add(d),()=>{f.delete(d)}),[f]),g[1]}var Li=function(e,r){return Li=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o])},Li(e,r)};function ln(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");Li(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}var Q=function(){return Q=Object.assign||function(r){for(var n,t=1,o=arguments.length;t<o;t++){n=arguments[t];for(var f in n)Object.prototype.hasOwnProperty.call(n,f)&&(r[f]=n[f])}return r},Q.apply(this,arguments)};function qn(e,r){var n={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},t,o,f,l;return l={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function g(c){return function(i){return d([c,i])}}function d(c){if(t)throw new TypeError("Generator is already executing.");for(;l&&(l=0,c[0]&&(n=0)),n;)try{if(t=1,o&&(f=c[0]&2?o.return:c[0]?o.throw||((f=o.return)&&f.call(o),0):o.next)&&!(f=f.call(o,c[1])).done)return f;switch(o=0,f&&(c=[c[0]&2,f.value]),c[0]){case 0:case 1:f=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,o=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(f=n.trys,!(f=f.length>0&&f[f.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!f||c[1]>f[0]&&c[1]<f[3])){n.label=c[1];break}if(c[0]===6&&n.label<f[1]){n.label=f[1],f=c;break}if(f&&n.label<f[2]){n.label=f[2],n.ops.push(c);break}f[2]&&n.ops.pop(),n.trys.pop();continue}c=r.call(e,n)}catch(i){c=[6,i],o=0}finally{t=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function xe(e){var r=typeof Symbol=="function"&&Symbol.iterator,n=r&&e[r],t=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&t>=e.length&&(e=void 0),{value:e&&e[t++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function _e(e,r){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var t=n.call(e),o,f=[],l;try{for(;(r===void 0||r-- >0)&&!(o=t.next()).done;)f.push(o.value)}catch(g){l={error:g}}finally{try{o&&!o.done&&(n=t.return)&&n.call(t)}finally{if(l)throw l.error}}return f}function Qe(e,r,n){if(arguments.length===2)for(var t=0,o=r.length,f;t<o;t++)(f||!(t in r))&&(f||(f=Array.prototype.slice.call(r,0,t)),f[t]=r[t]);return e.concat(f||Array.prototype.slice.call(r))}var Nu="SET_DATA",Tu="SET_CREATE_FORMULA_PARSER",Au="SELECT_ENTIRE_ROW",Cu="SELECT_ENTIRE_COLUMN",Ou="SELECT_ENTIRE_WORKSHEET",Iu="SET_SELECTION",_u="SELECT",Mu="ACTIVATE",xu="SET_CELL_DATA",bu="SET_CELL_DIMENSIONS",Lu="COPY",Ui="CUT",Uu="PASTE",ku="EDIT",Pu="VIEW",d0="CLEAR",Su="BLUR",Fu="KEY_PRESS",Bu="KEY_DOWN",Du="DRAG_START",Vu="DRAG_END",Gu="COMMIT";function h0(e){return{type:Nu,payload:{data:e}}}function p0(e){return{type:Tu,payload:{createFormulaParser:e}}}function v0(e,r){return{type:Au,payload:{row:e,extend:r}}}function m0(e,r){return{type:Cu,payload:{column:e,extend:r}}}function g0(){return{type:Ou}}function E0(e){return{type:Iu,payload:{selection:e}}}function y0(e){return{type:_u,payload:{point:e}}}function w0(e){return{type:Mu,payload:{point:e}}}function Wu(e,r){return{type:xu,payload:{active:e,data:r}}}function R0(e,r){return{type:bu,payload:{point:e,dimensions:r}}}function N0(e){return{type:Uu,payload:{data:e}}}function T0(e){return{type:Fu,payload:{event:e}}}function A0(e){return{type:Bu,payload:{event:e}}}function C0(){return{type:Du}}function O0(){return{type:Vu}}function I0(e){return{type:Gu,payload:{changes:e}}}function _0(){return{type:Lu}}function M0(){return{type:Ui}}function x0(){return{type:ku}}function b0(){return{type:Pu}}function L0(){return{type:Su}}function ME(e,r){for(var n=Array(e),t=0;t<e;t++)n[t]=Array(r);return n}function at(e,r){var n=r[e.row];if(n!==void 0)return n[e.column]}function Hu(e,r,n){for(var t=[],o=r.column-e.column,f=e.row;f<=r.row;f++){var l=f-e.row;t[l]=t[l]||Array(o);for(var g=e.column;g<=r.column;g++)t[l][g-e.column]=at({row:f,column:g},n)}return t}function Vt(e,r,n){var t=Qe([],_e(n),!1),o=n[0],f=o?Qe([],_e(o),!1):[];f.length-1<e.column&&(f[e.column]=void 0,t[0]=f);var l=n[e.row]?Qe([],_e(n[e.row]),!1):[];return l[e.column]=r,t[e.row]=l,t}function U0(e,r,n){var t=n[0];t||(t=[],n[0]=t),e.row in n||(n[e.row]=[]),e.column in t||(t[e.column]=void 0),n[e.row][e.column]=r}function ks(e,r){if(!Qr(e,r))return r;var n=Qe([],_e(r),!1),t=Qe([],_e(r[e.row]),!1);return t[e.column]=void 0,n[e.row]=t,n}function k0(e,r){var n,t,o=[];try{for(var f=xe(da(r)),l=f.next();!l.done;l=f.next()){var g=_e(l.value,2),d=g[0],c=g[1];U0(d,e(c,d),o)}}catch(i){n={error:i}}finally{try{l&&!l.done&&(t=f.return)&&t.call(f)}finally{if(n)throw n.error}}return o}function da(e){var r,n,t,o,f,l,g,d,c,i,a,s,u,v,h,p,m;return qn(this,function(E){switch(E.label){case 0:E.trys.push([0,11,12,13]),r=xe(e.entries()),n=r.next(),E.label=1;case 1:if(n.done)return[3,10];t=_e(n.value,2),o=t[0],f=t[1],E.label=2;case 2:E.trys.push([2,7,8,9]),l=(p=void 0,xe(f.entries())),g=l.next(),E.label=3;case 3:return g.done?[3,6]:(d=_e(g.value,2),c=d[0],i=d[1],a={row:o,column:c},[4,[a,i]]);case 4:E.sent(),E.label=5;case 5:return g=l.next(),[3,3];case 6:return[3,9];case 7:return s=E.sent(),p={error:s},[3,9];case 8:try{g&&!g.done&&(m=l.return)&&m.call(l)}finally{if(p)throw p.error}return[7];case 9:return n=r.next(),[3,1];case 10:return[3,13];case 11:return u=E.sent(),v={error:u},[3,13];case 12:try{n&&!n.done&&(h=r.return)&&h.call(r)}finally{if(v)throw v.error}return[7];case 13:return[2]}})}function P0(e,r,n){r===void 0&&(r="	"),n===void 0&&(n=`
`);for(var t="",o=fn(e),f=o.rows,l=o.columns,g=0;g<f;g++){g&&(t+=n);for(var d=0;d<l;d++)d&&(t+=r),e[g]&&d in e[g]&&(t+=String(e[g][d]))}return t}function S0(e,r,n,t){n===void 0&&(n="	"),t===void 0&&(t=/\r\n|\n|\r/);var o=e.replace(/"([^"]*?)"/g,function(f,l){return l.replace(/\n/g,"\\n")});return o.split(t).map(function(f){return f.split(n).map(function(l){return l.replace(/\\n/g,`
`)}).map(r)})}function Qr(e,r){var n=r[0];return n&&e.row>=0&&e.column>=0&&Number.isInteger(e.row)&&Number.isInteger(e.column)&&e.column<n.length&&e.row<r.length}function fn(e){return{columns:Ro(e),rows:wo(e)}}function wo(e){return e.length}function Ro(e){var r=e[0];return r?r.length:0}function F0(e,r){var n=fn(e),t=n.rows,o=n.columns;if(t>=r.rows&&o>=r.columns)return e;var f={rows:r.rows>t?r.rows:t,columns:r.columns>o?r.columns:o},l=Qe([],_e(e),!1);if(f.columns>o){var g=f.columns-o;l=l.map(function(i){return Qe(Qe([],_e(i),!1),_e(Array(g).fill(void 0)),!1)})}if(f.rows>t){var d=f.rows-t,c=Array(f.columns).fill(void 0);l=Qe(Qe([],_e(l),!1),_e(Array(d).fill(c)),!1)}return l}function B0(e,r){for(var n=[],t=0;t<e.length;t++)for(var o=0;o<e[t].length;o++){var f=e[t][o];n.push(r?r(f,{row:t,column:o}):f)}return n}function ha(e){var r=fn(e);return{row:r.rows-1,column:r.columns-1}}var Gt=function(){function e(r,n){this.start={row:Math.min(r.row,n.row),column:Math.min(r.column,n.column)},this.end={row:Math.max(r.row,n.row),column:Math.max(r.column,n.column)}}return e.prototype[Symbol.iterator]=function(){var r,n;return qn(this,function(t){switch(t.label){case 0:r=this.start.row,t.label=1;case 1:if(!(r<=this.end.row))return[3,6];n=this.start.column,t.label=2;case 2:return n<=this.end.column?[4,{row:r,column:n}]:[3,5];case 3:t.sent(),t.label=4;case 4:return n++,[3,2];case 5:return r++,[3,1];case 6:return[2]}})},e.prototype.size=function(){var r=this.end.row+1-this.start.row,n=this.end.column+1-this.start.column;return r*n},e.prototype.has=function(r){return r.row>=this.start.row&&r.column>=this.start.column&&r.row<=this.end.row&&r.column<=this.end.column},e.prototype.mask=function(r){return new e({row:r.start.row>this.start.row?r.start.row:this.start.row,column:r.start.column>this.start.column?r.start.column:this.start.column},{row:r.end.row<this.end.row?r.end.row:this.end.row,column:r.end.column<this.end.column?r.end.column:this.end.column})},e.prototype.equals=function(r){return this.start.row===r.start.row&&this.start.column===r.start.column&&this.end.row===r.end.row&&this.end.column===r.end.column},e}();function D0(e,r){return e.column===r.column&&e.row===r.row}var Pr={row:0,column:0},pa=function(){function e(){}return e}(),$u=function(e){ln(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.toRange=function(n){return null},r.prototype.normalizeTo=function(n){return this},r.prototype.hasEntireRow=function(n){return!1},r.prototype.hasEntireColumn=function(n){return!1},r.prototype.size=function(){return 0},r.prototype.has=function(){return!1},r.prototype.equals=function(n){return n instanceof r},r}(pa),On=function(e){ln(r,e);function r(n){var t=e.call(this)||this;return t.range=n,t}return r.prototype.toRange=function(n){return this.range},r.prototype.normalizeTo=function(n){var t=Yu(n),o=new r(this.range.mask(t));return o},r.prototype.hasEntireRow=function(n){return!1},r.prototype.hasEntireColumn=function(n){return!1},r.prototype.size=function(n){var t=this.toRange(n);return t?t.size():0},r.prototype.has=function(n,t){var o=this.toRange(n);return o!==null&&o.has(t)},r.prototype.equals=function(n){return n instanceof r&&this.range.equals(n.range)},r}(pa),qu=function(e){ln(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r}(pa),zu=function(e){ln(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.toRange=function(n){return Yu(n)},r.prototype.normalizeTo=function(n){return this},r.prototype.hasEntireColumn=function(n){return!0},r.prototype.hasEntireRow=function(n){return!0},r.prototype.size=function(n){return Ro(n)*wo(n)},r.prototype.has=function(n,t){return!0},r.prototype.equals=function(n){return n instanceof r},r}(qu),Ku=function(e){ln(r,e);function r(n,t){var o=this;if(!Ps(n))throw new Ss("start");if(!Ps(t))throw new Ss("end");return o=e.call(this)||this,o.start=Math.min(n,t),o.end=Math.max(n,t),o}return r.prototype.equals=function(n){return n instanceof r&&this.constructor===n.constructor&&this.start===n.start&&this.end===n.end},r}(qu),Zr=function(e){ln(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.toRange=function(n){var t=ha(n);return new Gt({row:this.start,column:0},{row:this.end,column:t.column})},r.prototype.normalizeTo=function(n){var t=wo(n),o=new r(Math.max(this.start,0),Math.min(this.end,t-1));return o},r.prototype.hasEntireRow=function(n){return n>=this.start&&n<=this.end},r.prototype.hasEntireColumn=function(n){return!1},r.prototype.size=function(n){var t=this.end-this.start+1;return t*Ro(n)},r.prototype.has=function(n,t){return t.row>=this.start&&t.row<=this.end},r}(Ku),Jr=function(e){ln(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.toRange=function(n){var t=ha(n);return new Gt({row:0,column:this.start},{row:t.row,column:this.end})},r.prototype.normalizeTo=function(n){var t=Ro(n),o=new r(Math.max(this.start,0),Math.min(this.end,t-1));return o},r.prototype.hasEntireRow=function(n){return!1},r.prototype.hasEntireColumn=function(n){return n>=this.start&&n<=this.end},r.prototype.size=function(n){var t=this.end-this.start+1;return t*wo(n)},r.prototype.has=function(n,t){return t.column>=this.start&&t.column<=this.end},r}(Ku);function Yu(e){var r=ha(e);return new Gt(Pr,r)}function Ps(e){return Number.isInteger(e)&&e>=0}var Ss=function(e){ln(r,e);function r(n){return e.call(this,"".concat(n," is not a valid index. It must be 0 or a positive integer"))||this}return r}(Error),Xu="text/plain",V0=":focus-within";function G0(e){e.selectionStart=e.selectionEnd=e.value.length}function Sr(e,r,n){r===void 0&&(r=0),n===void 0&&(n=1);var t=[];if(Math.sign(e-r)===-1){for(var o=r;o>e;o-=n)t.push(o);return t}for(var o=r;o<e;o+=n)t.push(o);return t}function ki(e,r){return!!(e&&D0(r,e))}function ui(e){return{width:e.offsetWidth,height:e.offsetHeight,left:e.offsetLeft,top:e.offsetTop}}function W0(e,r){var n;(n=e.clipboardData)===null||n===void 0||n.setData(Xu,r)}function H0(e){return window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData?e.clipboardData.getData(Xu):""}function Pi(e,r,n){var t=r&&r[e.row],o=n&&n[e.column];return t&&o&&Q(Q({},t),o)}function Qu(e,r,n){var t=Pi(n.start,e,r),o=Pi(n.end,e,r);return t&&o&&{width:o.left+o.width-t.left,height:o.top+o.height-t.top,top:t.top,left:t.left}}function $0(e,r,n,t){var o=t.toRange(n);return o?Qu(e,r,o):void 0}function q0(e){var r=k0(function(n){return(n==null?void 0:n.value)||""},e);return P0(r)}function z0(e,r,n){var t=fn(e),o=t.columns,f=t.rows;return{rows:r?Math.max(f,r.length):f,columns:n?Math.max(o,n.length):o}}function li(e,r){return e!==null&&r==="view"&&Zu(e)}function Zu(e){return e.matches(V0)}function K0(e){return typeof e=="string"&&e.includes(`
`)}function Dt(e){return"".concat(e.row,",").concat(e.column)}function Si(e){var r=_e(e.split(","),2),n=r[0],t=r[1];return{row:Number(n),column:Number(t)}}var Bt=function(){function e(r){this.set=r}return e.from=function(r){var n,t,o=new Set;try{for(var f=xe(r),l=f.next();!l.done;l=f.next()){var g=l.value;o.add(Dt(g))}}catch(d){n={error:d}}finally{try{l&&!l.done&&(t=f.return)&&t.call(f)}finally{if(n)throw n.error}}return new e(o)},e.prototype.has=function(r){return this.set.has(Dt(r))},Object.defineProperty(e.prototype,"size",{get:function(){return this.set.size},enumerable:!1,configurable:!0}),e.prototype.add=function(r){var n=new Set(this.set);return n.add(Dt(r)),new e(n)},e.prototype.delete=function(r){var n=new Set(this.set);return n.delete(Dt(r))?new e(n):this},e.prototype.difference=function(r){var n,t,o=this;try{for(var f=xe(r),l=f.next();!l.done;l=f.next()){var g=l.value;o=o.delete(g)}}catch(d){n={error:d}}finally{try{l&&!l.done&&(t=f.return)&&t.call(f)}finally{if(n)throw n.error}}return o},e.prototype.union=function(r){var n,t,o=this;try{for(var f=xe(r),l=f.next();!l.done;l=f.next()){var g=l.value;o=o.add(g)}}catch(d){n={error:d}}finally{try{l&&!l.done&&(t=f.return)&&t.call(f)}finally{if(n)throw n.error}}return o},e.prototype[Symbol.iterator]=function(){var r,n,t,o,f,l;return qn(this,function(g){switch(g.label){case 0:g.trys.push([0,5,6,7]),r=xe(this.set),n=r.next(),g.label=1;case 1:return n.done?[3,4]:(t=n.value,[4,Si(t)]);case 2:g.sent(),g.label=3;case 3:return n=r.next(),[3,1];case 4:return[3,7];case 5:return o=g.sent(),f={error:o},[3,7];case 6:try{n&&!n.done&&(l=r.return)&&l.call(r)}finally{if(f)throw f.error}return[7];case 7:return[2]}})},e}(),Y0="=";function zn(e){return typeof e=="string"&&e.startsWith(Y0)&&e.length>1}function va(e){return e.slice(1)}function Kn(e,r){return new r0(Q(Q({},r),{onCell:function(n){var t={row:n.row-1,column:n.col-1},o=at(t,e);return isNaN(o==null?void 0:o.value)?o==null?void 0:o.value:Number(o==null?void 0:o.value)},onRange:function(n){var t=fn(e),o={row:n.from.row-1,column:n.from.col-1},f={row:Math.min(n.to.row-1,t.rows-1),column:Math.min(n.to.col-1,t.columns-1)},l=Hu(o,f,e);return B0(l,function(g){return isNaN(g==null?void 0:g.value)?g==null?void 0:g.value:Number(g==null?void 0:g.value)})}}))}var X0=new nn.DepParser;function Ju(e,r,n){var t=fn(n),o=t.rows,f=t.columns;try{var l=X0.parse(e,ju(r)),g=Bt.from(l.flatMap(function(d){var c="from"in d;if(c){var i=d.from,a=d.to,s={row:i.row-1,column:i.col-1},u={row:Math.min(a.row-1,o-1),column:Math.min(a.col-1,f-1)},v=new Gt(s,u);return Array.from(v)}return{row:d.row-1,column:d.col-1}}));return g}catch(d){if(d instanceof nn.FormulaError)return Bt.from([]);throw d}}function Q0(e,r,n){try{var t=ju(r),o=n.parse(e,t);return o instanceof nn.FormulaError?o.toString():o}catch(f){if(f instanceof nn.FormulaError)return f.toString();throw f}}function ju(e){return{row:e.row+1,col:e.column+1,sheet:"Sheet1"}}var Z0=function(){function e(r){r===void 0&&(r=new Map),this.forwards=r}return e.from=function(r){var n,t,o=new Map;try{for(var f=xe(r),l=f.next();!l.done;l=f.next()){var g=_e(l.value,2),d=g[0],c=g[1];o.set(Dt(d),c)}}catch(i){n={error:i}}finally{try{l&&!l.done&&(t=f.return)&&t.call(f)}finally{if(n)throw n.error}}return new e(o)},e.prototype.set=function(r,n){var t=new e(new Map(this.forwards));return n.size===0?(t.forwards.delete(Dt(r)),t):(t.forwards.set(Dt(r),n),t)},e.prototype.get=function(r){return this.forwards.get(Dt(r))||Bt.from([])},e.prototype.getBackwards=function(r){var n,t,o=Bt.from([]);try{for(var f=xe(this.forwards),l=f.next();!l.done;l=f.next()){var g=_e(l.value,2),d=g[0],c=g[1];c.has(r)&&(o=o.add(Si(d)))}}catch(i){n={error:i}}finally{try{l&&!l.done&&(t=f.return)&&t.call(f)}finally{if(n)throw n.error}}return o},e.prototype.getBackwardsRecursive=function(r,n){var t,o;n===void 0&&(n=Bt.from([]));var f=this.getBackwards(r),l=n;try{for(var g=xe(f),d=g.next();!d.done;d=g.next()){var c=d.value;l.has(c)||(l=l.add(c),f=f.union(this.getBackwardsRecursive(c,l)))}}catch(i){t={error:i}}finally{try{d&&!d.done&&(o=g.return)&&o.call(g)}finally{if(t)throw t.error}}return f},e.prototype.hasCircularDependency=function(r){for(var n,t,o=Bt.from([]),f=[r];f.length>0;){var l=f.pop();if(l){if(o.has(l))return!0;o=o.add(l);var g=this.get(l);if(g)try{for(var d=(n=void 0,xe(g)),c=d.next();!c.done;c=d.next()){var i=c.value;f.push(i)}}catch(a){n={error:a}}finally{try{c&&!c.done&&(t=d.return)&&t.call(d)}finally{if(n)throw n.error}}}}return!1},e.prototype[Symbol.iterator]=function(){var r,n,t,o,f,l,g,d,c,i,a,s,u,v,h,p,m;return qn(this,function(E){switch(E.label){case 0:r=new Set,E.label=1;case 1:E.trys.push([1,13,14,15]),n=xe(this.forwards),t=n.next(),E.label=2;case 2:return t.done?[3,12]:(o=_e(t.value,2),f=o[0],l=o[1],g=Si(f),r.add(f),[4,[g,l]]);case 3:E.sent(),E.label=4;case 4:E.trys.push([4,9,10,11]),d=(p=void 0,xe(l)),c=d.next(),E.label=5;case 5:return c.done?[3,8]:(i=c.value,a=Dt(i),!r.has(a)&&!this.forwards.has(a)?(r.add(a),[4,[i,Bt.from([])]]):[3,7]);case 6:E.sent(),E.label=7;case 7:return c=d.next(),[3,5];case 8:return[3,11];case 9:return s=E.sent(),p={error:s},[3,11];case 10:try{c&&!c.done&&(m=d.return)&&m.call(d)}finally{if(p)throw p.error}return[7];case 11:return t=n.next(),[3,2];case 12:return[3,15];case 13:return u=E.sent(),v={error:u},[3,15];case 14:try{t&&!t.done&&(h=n.return)&&h.call(n)}finally{if(v)throw v.error}return[7];case 15:return[2]}})},e.prototype.traverseBFSBackwards=function(){var r,n,t,o,f,g,l,g,d,c,i,a,s,u,v,h;return qn(this,function(p){switch(p.label){case 0:r=Bt.from([]),n=[];try{for(t=xe(this),o=t.next();!o.done;o=t.next())f=_e(o.value,2),g=f[0],l=f[1],l.size===0&&(r=r.add(g),n.push(g))}catch(m){s={error:m}}finally{try{o&&!o.done&&(u=t.return)&&u.call(t)}finally{if(s)throw s.error}}p.label=1;case 1:return n.length>0?(g=n.shift(),g?[4,g]:[3,1]):[3,3];case 2:if(p.sent(),d=this.getBackwards(g),d.size===0)return[3,1];try{for(c=(v=void 0,xe(d)),i=c.next();!i.done;i=c.next())a=i.value,!r.has(a)&&this.get(a).difference(r).size===0&&(n.push(a),r=r.add(a))}catch(m){v={error:m}}finally{try{i&&!i.done&&(h=c.return)&&h.call(c)}finally{if(v)throw v.error}}return[3,1];case 3:return[2]}})},e}(),Zt=function(){function e(r,n,t,o){this.createFormulaParser=r,this.data=n,this.referenceGraph=t||tp(n),this.evaluatedData=o||np(n,this.referenceGraph,this.createFormulaParser)}return e}();function J0(e,r,n){var t=Vt(r,n,e.data),o=zn(n.value)?j0(e.referenceGraph,r,n,t):e.referenceGraph,f=e.createFormulaParser(t),l=ep(e.evaluatedData,t,o,r,n,f);return new Zt(e.createFormulaParser,t,o,l)}function j0(e,r,n,t){var o=Ju(va(n.value),r,t),f=e.set(r,o);return f}function ep(e,r,n,t,o,f){var l,g,d,c;if(n.hasCircularDependency(t)){var i=Bt.from([t]),a=Vt(t,Q(Q({},o),{value:nn.FormulaError.REF}),e);try{for(var s=xe(n.getBackwardsRecursive(t)),u=s.next();!u.done;u=s.next()){var v=u.value;if(i.has(v))break;i=i.add(v);var h=at(v,r);h&&(a=Vt(v,Q(Q({},h),{value:nn.FormulaError.REF}),a))}}catch(A){l={error:A}}finally{try{u&&!u.done&&(g=s.return)&&g.call(s)}finally{if(l)throw l.error}}return a}var p=e,m=zn(o.value)?Fi(o.value,t,f):o.value,E=Q(Q({},o),{value:m});p=Vt(t,E,p);try{for(var y=xe(n.getBackwardsRecursive(t)),w=y.next();!w.done;w=y.next()){var v=w.value,h=at(v,r);if(h){var T=zn(h.value)?Fi(h.value,t,f):h.value,R=Q(Q({},h),{value:T});p=Vt(v,R,p)}}}catch(A){d={error:A}}finally{try{w&&!w.done&&(c=y.return)&&c.call(y)}finally{if(d)throw d.error}}return p}function tp(e){var r,n,t=[];try{for(var o=xe(da(e)),f=o.next();!f.done;f=o.next()){var l=_e(f.value,2),g=l[0],d=l[1];if(d&&zn(d.value)){var c=Ju(va(d.value),g,e);t.push([g,c])}}}catch(i){r={error:i}}finally{try{f&&!f.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return Z0.from(t)}function np(e,r,n){var t,o,f=e,l=n(f);try{for(var g=xe(r.traverseBFSBackwards()),d=g.next();!d.done;d=g.next()){var c=d.value,i=at(c,e);if(i&&zn(i.value)){var a=Fi(i.value,c,l);f=Vt(c,Q(Q({},i),{value:a}),f),l=n(f)}}}catch(s){t={error:s}}finally{try{d&&!d.done&&(o=g.return)&&o.call(g)}finally{if(t)throw t.error}}return f}function Fi(e,r,n){var t=va(e);try{return Q0(t,r,n)}catch{return nn.FormulaError.REF}}var Bi={active:null,mode:"view",rowDimensions:{},columnDimensions:{},lastChanged:null,hasPasted:!1,cut:!1,dragging:!1,model:new Zt(Kn,[]),selected:new $u,copied:null,lastCommit:null};function rp(e,r){var n,t,o,f,l,g;switch(r.type){case Nu:{var d=r.payload.data,c=e.active&&Qr(e.active,d)?e.active:null,i=e.selected.normalizeTo(d);return Q(Q({},e),{model:new Zt(e.model.createFormulaParser,d),active:c,selected:i})}case Tu:{var a=r.payload.createFormulaParser;return Q(Q({},e),{model:new Zt(a,e.model.data)})}case Au:{var s=r.payload,u=s.row,v=s.extend,h=e.active;return Q(Q({},e),{selected:v&&h?new Zr(h.row,u):new Zr(u,u),active:v&&h?h:Q(Q({},Pr),{row:u}),mode:"view"})}case Cu:{var p=r.payload,m=p.column,v=p.extend,h=e.active;return Q(Q({},e),{selected:v&&h?new Jr(h.column,m):new Jr(m,m),active:v&&h?h:Q(Q({},Pr),{column:m}),mode:"view"})}case Ou:return Q(Q({},e),{selected:new zu,active:Pr,mode:"view"});case Iu:{var E=r.payload.selection,y=E.toRange(e.model.data),h=e.active&&E.has(e.model.data,e.active)?e.active:y==null?void 0:y.start;return Q(Q({},e),{selected:E,active:h||null,mode:"view"})}case _u:{var w=r.payload.point;return e.active&&!ki(e.active,w)?Q(Q({},e),{selected:new On(new Gt(w,e.active)),mode:"view"}):e}case Mu:{var w=r.payload.point;return Q(Q({},e),{selected:new On(new Gt(w,w)),active:w,mode:ki(e.active,w)?"edit":"view"})}case xu:{var T=r.payload,h=T.active,R=T.data;return Vi(e)?e:Q(Q({},e),{model:J0(e.model,h,R),lastChanged:h})}case bu:{var A=r.payload,w=A.point,O=A.dimensions,M=e.rowDimensions[w.row],b=e.columnDimensions[w.column];return M&&b&&M.top===O.top&&M.height===O.height&&b.left===O.left&&b.width===O.width?e:Q(Q({},e),{rowDimensions:Q(Q({},e.rowDimensions),(n={},n[w.row]={top:O.top,height:O.height},n)),columnDimensions:Q(Q({},e.columnDimensions),(t={},t[w.column]={left:O.left,width:O.width},t))})}case Lu:case Ui:{var k=e.selected.toRange(e.model.data);return Q(Q({},e),{copied:k,cut:r.type===Ui,hasPasted:!1})}case Uu:{var F=r.payload.data,h=e.active;if(!h)return e;var $=S0(F,function(we){return{value:we}}),Y=fn($),k=e.selected.toRange(e.model.data);if(k&&Y.rows===1&&Y.columns===1){var W=at({row:0,column:0},$),S=e.cut&&e.copied?ks(e.copied.start,e.model.data):e.model.data,H=[];try{for(var J=xe(k||[]),ee=J.next();!ee.done;ee=J.next()){var w=ee.value,D=at(w,e.model.data);H.push({prevCell:D||null,nextCell:W||null}),S=Vt(w,W,S)}}catch(we){o={error:we}}finally{try{ee&&!ee.done&&(f=J.return)&&f.call(J)}finally{if(o)throw o.error}}return Q(Q({},e),{model:new Zt(Kn,S),copied:null,cut:!1,hasPasted:!0,mode:"view",lastCommit:H})}var Z={rows:h.row+Y.rows,columns:h.column+Y.columns},I=F0(e.model.data,Z),_={data:I,commit:[]};try{for(var C=xe(da($)),P=C.next();!P.done;P=C.next()){var x=_e(P.value,2),w=x[0],W=x[1],z=_.commit||[],L={row:w.row+h.row,column:w.column+h.column},V=_.data;if(e.cut){if(e.copied){var te={row:w.row+e.copied.start.row,column:w.column+e.copied.start.column};V=ks(te,_.data)}z=Qe(Qe([],_e(z),!1),[{prevCell:W||null,nextCell:null}],!1)}Qr(L,I)||(_={data:V,commit:z});var D=at(L,V)||null;z=Qe(Qe([],_e(z),!1),[{prevCell:D,nextCell:W||null}],!1),_.data=Vt(L,Q(Q({value:void 0},D),W),V),_.commit=z}}catch(we){l={error:we}}finally{try{P&&!P.done&&(g=C.return)&&g.call(C)}finally{if(l)throw l.error}}return Q(Q({},e),{model:new Zt(Kn,_.data),selected:new On(new Gt(h,{row:h.row+Y.rows-1,column:h.column+Y.columns-1})),copied:null,cut:!1,hasPasted:!0,mode:"view",lastCommit:_.commit})}case ku:return Fr(e);case Pu:return tl(e);case d0:return jr(e);case Su:return el(e);case Fu:{var j=r.payload.event;if(Vi(e)||j.metaKey)return e;if(e.mode==="view"&&e.active){var k=e.selected.toRange(e.model.data);return(k==null?void 0:k.size())===1?Fr(jr(e)):Fr(e)}return e}case Bu:{var ne=r.payload.event,ie=rl(e,ne);return ie?Q(Q({},e),ie(e,ne)):e}case Du:return Q(Q({},e),{dragging:!0});case Vu:return Q(Q({},e),{dragging:!1});case Gu:{var he=r.payload.changes;return Q(Q({},e),nl(he))}default:throw new Error("Unknown action")}}function Fr(e){return Vi(e)?e:Q(Q({},e),{mode:"edit"})}function jr(e){var r,n;if(!e.active)return e;var t=function(u){return u&&!u.readOnly},o=function(u){return t(u)?Object.assign({},u,{value:void 0}):u},f=e.selected.toRange(e.model.data),l=[],g=e.model.data;try{for(var d=xe(f||[]),c=d.next();!c.done;c=d.next()){var i=c.value,a=at(i,e.model.data),s=o(a);l.push({prevCell:a||null,nextCell:s||null}),g=Vt(i,s,g)}}catch(u){r={error:u}}finally{try{c&&!c.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}return Q(Q(Q({},e),{model:new Zt(Kn,g)}),nl(l))}function el(e){return Q(Q({},e),{active:null,selected:new $u})}function tl(e){return Q(Q({},e),{mode:"view"})}function nl(e){return{lastCommit:e}}var hn=function(e,r){return function(n){if(n.active){var t=fn(n.model.data),o=n.active.column+r,f=o>=t.columns,l={row:n.active.row+e+(f?1:0),column:(n.active.column+r)%t.columns};return Qr(l,n.model.data)?Q(Q({},n),{active:l,selected:new On(new Gt(l,l)),mode:"view"}):Q(Q({},n),{mode:"view"})}}},Di={ArrowUp:hn(-1,0),ArrowDown:hn(1,0),ArrowLeft:hn(0,-1),ArrowRight:hn(0,1),Tab:hn(0,1),Enter:Fr,Backspace:jr,Delete:jr,Escape:el},op={Escape:tl,Tab:Di.Tab,Enter:Di.ArrowDown},ip={Tab:hn(0,-1)},Pe;(function(e){e.Left="Left",e.Right="Right",e.Top="Top",e.Bottom="Bottom"})(Pe||(Pe={}));var ap={ArrowUp:function(e){return Q(Q({},e),{selected:yr(e.selected,e.active,e.model.data,Pe.Top)})},ArrowDown:function(e){return Q(Q({},e),{selected:yr(e.selected,e.active,e.model.data,Pe.Bottom)})},ArrowLeft:function(e){return Q(Q({},e),{selected:yr(e.selected,e.active,e.model.data,Pe.Left)})},ArrowRight:function(e){return Q(Q({},e),{selected:yr(e.selected,e.active,e.model.data,Pe.Right)})},Tab:hn(0,-1)},sp={},cp={};function rl(e,r){var n=r.key,t;return e.mode==="edit"?r.shiftKey?t=ip:t=op:r.shiftKey&&r.metaKey?t=sp:r.shiftKey?t=ap:r.metaKey?t=cp:t=Di,t[n]}function up(e,r){return rl(e,r)!==void 0}function Vi(e){var r=lp(e);return!!(r!=null&&r.readOnly)}function lp(e){var r=e.active&&at(e.active,e.model.data);return r||null}function yr(e,r,n,t){if(!r)return e;if(e instanceof On){var o=fp(e,r,n,t);return o}return e instanceof Jr?hp(e,r,n,t):e instanceof Zr?dp(e,r,n,t):e}function fp(e,r,n,t){var o,f=t===Pe.Left||t===Pe.Right?"column":"row",l=t===Pe.Left||t===Pe.Top?"start":"end",g=l==="start"?-1:1,d=e.range.has(Q(Q({},r),(o={},o[f]=r[f]+g*-1,o))),c=d?l==="start"?"end":"start":l,i=new Gt(e.range.start,e.range.end);i[c][f]+=g;var a=new On(i).normalizeTo(n);return a}function dp(e,r,n,t){if(t===Pe.Left||t===Pe.Right)return e;var o=t===Pe.Top?-1:1,f=t===Pe.Top?"start":"end",l=f==="start"?"end":"start",g=Q({},e);(t===Pe.Top?e.end>r.row:e.start<r.row)?g[l]=e[l]+o:g[f]=e[f]+o;var d=new Zr(Math.max(g.start,0),Math.max(g.end,0));return d.normalizeTo(n)}function hp(e,r,n,t){if(t===Pe.Top||t===Pe.Bottom)return e;var o=t===Pe.Left?-1:1,f=t===Pe.Left?"start":"end",l=f==="start"?"end":"start",g=Q({},e);(t===Pe.Left?e.end>r.row:e.start<r.row)?g[l]=e[l]+o:g[f]=e[f]+o;var d=new Jr(Math.max(g.start,0),Math.max(g.end,0));return d.normalizeTo(n)}var ma=f0([Bi,function(){}]),pp=function(e){var r=e.children,n=e.columns,t=e.hideColumnIndicators,o=n+(t?0:1),f=Sr(o).map(function(l){return N.createElement("col",{key:l})});return N.createElement("table",{className:"Spreadsheet__table"},N.createElement("colgroup",null,f),N.createElement("tbody",null,r))},vp=function(e){return N.createElement("tr",Q({},e))},mp=function(e){return N.createElement("tr",Q({},e))};function cr(){return Ru(ma,function(e){var r=_e(e,2);r[0];var n=r[1];return n})}function ke(e){return Ru(ma,function(r){var n=_e(r,1),t=n[0];return e(t)})}var gp=function(e){var r=e.selected,n=e.onSelect,t=N.useCallback(function(){n()},[n]);return N.createElement("th",{className:sn("Spreadsheet__header",{"Spreadsheet__header--selected":r}),onClick:t,tabIndex:0})},Ep=function(e){return function(n){var t=cr(),o=N.useCallback(function(){return t(g0())},[t]),f=ke(function(l){return l.selected instanceof zu});return N.createElement(e,Q({},n,{selected:f,onSelect:o}))}},yp=function(e){var r=e.column,n=e.label,t=e.selected,o=e.onSelect,f=N.useCallback(function(l){o(r,l.shiftKey)},[o,r]);return N.createElement("th",{className:sn("Spreadsheet__header",{"Spreadsheet__header--selected":t}),onClick:f,tabIndex:0},n!==void 0?n:Rp(r))},wp=function(e){return function(n){var t=cr(),o=N.useCallback(function(l,g){return t(m0(l,g))},[t]),f=ke(function(l){return l.selected.hasEntireColumn(n.column)});return N.createElement(e,Q({},n,{selected:f,onSelect:o}))}};function Rp(e){for(var r="",n=e;n>=0;)r=String.fromCharCode(65+n%26)+r,n=Math.floor(n/26)-1;return r}var Np=function(e){var r=e.row,n=e.label,t=e.selected,o=e.onSelect,f=N.useCallback(function(l){o(r,l.shiftKey)},[o,r]);return N.createElement("th",{className:sn("Spreadsheet__header",{"Spreadsheet__header--selected":t}),onClick:f,tabIndex:0},n!==void 0?n:r+1)},Tp=function(e){return function(n){var t=cr(),o=ke(function(l){return l.selected.hasEntireRow(n.row)}),f=N.useCallback(function(l,g){return t(v0(l,g))},[t]);return N.createElement(e,Q({},n,{selected:o,onSelect:f}))}},Ap=function(e){var r=e.row,n=e.column,t=e.DataViewer,o=e.selected,f=e.active,l=e.dragging,g=e.mode,d=e.data,c=e.evaluatedData,i=e.select,a=e.activate,s=e.setCellDimensions,u=e.setCellData,v=N.useRef(null),h=N.useMemo(function(){return{row:r,column:n}},[r,n]),p=N.useCallback(function(E){g==="view"&&(s(h,ui(E.currentTarget)),E.shiftKey?i(h):a(h))},[g,s,h,i,a]),m=N.useCallback(function(E){l&&(s(h,ui(E.currentTarget)),i(h))},[s,i,l,h]);return N.useEffect(function(){var E=v.current;o&&E&&s(h,ui(E)),E&&f&&g==="view"&&E.focus()},[s,o,f,g,h,d]),d&&d.DataViewer&&(t=d.DataViewer),N.createElement("td",{ref:v,className:sn("Spreadsheet__cell",d==null?void 0:d.className,{"Spreadsheet__cell--readonly":d==null?void 0:d.readOnly}),onMouseOver:m,onMouseDown:p,tabIndex:0},N.createElement(t,{row:r,column:n,cell:d,evaluatedCell:c,setCellData:u}))},Cp=function(e){return function(n){var t=n.row,o=n.column,f=cr(),l=N.useMemo(function(){return{row:t,column:o}},[t,o]),g=N.useCallback(function(E){return f(Wu(l,E))},[f,l]),d=N.useCallback(function(E){return f(y0(E))},[f]),c=N.useCallback(function(E){return f(w0(E))},[f]),i=N.useCallback(function(E,y){return f(R0(E,y))},[f]),a=ke(function(E){return ki(E.active,l)}),s=ke(function(E){return a?E.mode:"view"}),u=ke(function(E){return at(l,E.model.data)}),v=ke(function(E){return at(l,E.model.evaluatedData)}),h=ke(function(E){return E.selected.has(E.model.data,l)}),p=ke(function(E){return E.dragging}),m=ke(function(E){var y;return((y=E.copied)===null||y===void 0?void 0:y.has(l))||!1});return N.createElement(e,Q({},n,{selected:h,active:a,copied:m,dragging:p,mode:s,evaluatedData:v,data:u,select:d,activate:c,setCellDimensions:i,setCellData:g}))}},Op="TRUE",Ip="FALSE",_p=function(e){var r=e.cell,n=e.evaluatedCell,t=Mp(r,n);return typeof t=="boolean"?N.createElement("span",{className:"Spreadsheet__data-viewer Spreadsheet__data-viewer--boolean"},xp(t)):N.createElement("span",{className:sn("Spreadsheet__data-viewer",{"Spreadsheet__data-viewer--preserve-breaks":K0(t)})},t)};function Mp(e,r){var n,t=(n=r==null?void 0:r.value)!==null&&n!==void 0?n:e==null?void 0:e.value;return t&&typeof t=="object"?t.toString():t}function xp(e){return e?Op:Ip}var bp=function(e){var r,n=e.onChange,t=e.cell,o=N.useRef(null),f=N.useCallback(function(g){n(Q(Q({},t),{value:g.target.value}))},[n,t]);N.useEffect(function(){o.current&&G0(o.current)},[o]);var l=(r=t==null?void 0:t.value)!==null&&r!==void 0?r:"";return N.createElement("div",{className:"Spreadsheet__data-editor"},N.createElement("input",{ref:o,type:"text",onChange:f,value:l,autoFocus:!0}))},Lp=function(e){var r=N.useRef(null),n=cr(),t=N.useCallback(function(E,y){return n(Wu(E,y))},[n]),o=N.useCallback(function(){return n(x0())},[n]),f=N.useCallback(function(E){return n(I0(E))},[n]),l=N.useCallback(function(){n(b0())},[n]),g=ke(function(E){return E.active}),d=ke(function(E){return E.mode}),c=ke(function(E){return E.active?at(E.active,E.model.data):void 0}),i=ke(function(E){return g?Pi(g,E.rowDimensions,E.columnDimensions):void 0}),a=N.useMemo(function(){return!g||!i},[g,i]),s=N.useRef(void 0),u=N.useRef(null),v=N.useRef(void 0),h=N.useCallback(function(E){g&&t(g,E)},[t,g]);N.useEffect(function(){var E=r.current;!a&&E&&E.focus()},[r,a]),N.useEffect(function(){var E=u.current,y=v.current;if(u.current=g,v.current=c,!(!E||!y)){var w=(g==null?void 0:g.row)!==E.row||(g==null?void 0:g.column)!==E.column,T=d!=="edit";if(w||T){var R=s.current;y!==R?f([{prevCell:R||null,nextCell:y}]):!w&&c!==y&&f([{prevCell:y,nextCell:c||null}]),s.current=c}}});var p=c&&c.DataEditor||e.DataEditor,m=c&&c.readOnly;return a?null:N.createElement("div",{ref:r,className:sn("Spreadsheet__active-cell","Spreadsheet__active-cell--".concat(d)),style:i,onClick:d==="view"&&!m?o:void 0,tabIndex:0},d==="edit"&&g&&N.createElement(p,{row:g.row,column:g.column,cell:c,onChange:h,exitEditMode:l}))},ol=function(e){var r,n=e.dimensions,t=e.dragging,o=e.hidden,f=e.variant,l=n||{},g=l.width,d=l.height,c=l.top,i=l.left;return N.createElement("div",{className:sn("Spreadsheet__floating-rect",(r={},r["Spreadsheet__floating-rect--".concat(f)]=f,r["Spreadsheet__floating-rect--dragging"]=t,r["Spreadsheet__floating-rect--hidden"]=o,r)),style:{width:g,height:d,top:c,left:i}})},Up=function(){var e=ke(function(o){return o.selected}),r=ke(function(o){return e&&$0(o.rowDimensions,o.columnDimensions,o.model.data,o.selected)}),n=ke(function(o){return o.dragging}),t=ke(function(o){return o.selected.size(o.model.data)<2});return N.createElement(ol,{variant:"selected",dimensions:r,dragging:n,hidden:t})},kp=function(){var e=ke(function(t){return t.copied}),r=ke(function(t){return e&&Qu(t.rowDimensions,t.columnDimensions,e)}),n=e===null;return N.createElement(ol,{variant:"copied",dimensions:r,hidden:n,dragging:!1})};function Pp(e,r){r===void 0&&(r={});var n=r.insertAt;if(!(typeof document>"u")){var t=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",n==="top"&&t.firstChild?t.insertBefore(o,t.firstChild):t.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}var Sp=`.Spreadsheet {
  --background-color: white;
  --text-color: black;
  --readonly-text-color: rgba(0, 0, 0, 0.4);
  --outline-color: #4285f4;
  --outline-background-color: rgba(160, 195, 255, 0.2);
  --border-color: hsl(2deg, 0%, 91%);
  --header-background-color: rgba(0, 0, 0, 0.04);
  --elevation: 0 2px 5px rgba(0, 0, 0, 0.4);

  position: relative;
  overflow: visible;
  background: var(--background-color);
  color: var(--text-color);
  display: inline-block;
}

.Spreadsheet--dark-mode {
  --background-color: black;
  --text-color: white;
  --readonly-text-color: rgba(255, 255, 255, 0.4);
  --header-background-color: rgba(255, 255, 255, 0.04);
  --border-color: hsl(2deg, 0%, 19%);
}

.Spreadsheet__active-cell {
  position: absolute;
  border: 2px solid var(--outline-color);
  box-sizing: border-box;
}

.Spreadsheet__active-cell--edit {
  background: var(--background-color);
  box-shadow: var(--elevation);
}

.Spreadsheet__table {
  border-collapse: collapse;
  table-layout: fixed;
}

.Spreadsheet__cell,
.Spreadsheet__active-cell {
  cursor: cell;
}

.Spreadsheet__cell {
  outline: none;
}

.Spreadsheet__cell--readonly {
  color: var(--readonly-text-color);
}

.Spreadsheet__cell,
.Spreadsheet__header {
  min-width: 6em;
  min-height: 1.9em;
  height: 1.9em;
  max-height: 1.9em;
  border: 1px solid var(--border-color);
  overflow: hidden;
  word-break: keep-all;
  white-space: nowrap;
  text-align: left;
  box-sizing: border-box;
  user-select: none;
}

.Spreadsheet__header {
  background: var(--header-background-color);
  color: var(--readonly-text-color);
  text-align: center;
  font: inherit;
}

.Spreadsheet__header--selected {
  background: #5f6268;
  color: #fff;
}

.Spreadsheet__header,
.Spreadsheet__data-viewer,
.Spreadsheet__data-editor input {
  padding: 4px;
  box-sizing: border-box;
}

.Spreadsheet__data-viewer--preserve-breaks {
  white-space: pre-wrap;
}

.Spreadsheet__data-editor,
.Spreadsheet__data-editor input {
  width: 100%;
  height: 100%;
}

.Spreadsheet__data-editor input {
  font: inherit;
  color: inherit;
  background: none;
  border: none;
  outline: none;
  margin: 0;
}

.Spreadsheet__data-viewer--boolean {
  text-align: center;
}

.Spreadsheet__floating-rect {
  position: absolute;
  pointer-events: none;
  box-sizing: border-box;
}

.Spreadsheet__floating-rect--hidden {
  display: none;
}

.Spreadsheet__floating-rect--selected {
  background: var(--outline-background-color);
  border: 2px var(--outline-color) solid;
}

.Spreadsheet__floating-rect--dragging {
  border: none;
}

.Spreadsheet__floating-rect--copied {
  border: 2px var(--outline-color) dashed;
}
`;Pp(Sp);var Fp=function(e){var r,n=e.className,t=e.darkMode,o=e.columnLabels,f=e.rowLabels,l=e.hideColumnIndicators,g=e.hideRowIndicators,d=e.onKeyDown,c=e.Table,i=c===void 0?pp:c,a=e.Row,s=a===void 0?vp:a,u=e.HeaderRow,v=u===void 0?mp:u,h=e.DataEditor,p=h===void 0?bp:h,m=e.DataViewer,E=m===void 0?_p:m,y=e.onChange,w=y===void 0?function(){}:y,T=e.onModeChange,R=T===void 0?function(){}:T,A=e.onSelect,O=A===void 0?function(){}:A,M=e.onActivate,b=M===void 0?function(){}:M,k=e.onBlur,F=k===void 0?function(){}:k,$=e.onCellCommit,Y=$===void 0?function(){}:$,W=e.onEvaluatedDataChange,S=W===void 0?function(){}:W,H=N.useMemo(function(){var oe=e.createFormulaParser||Kn,be=new Zt(oe,e.data);return Q(Q({},Bi),{model:be,selected:e.selected||Bi.selected})},[e.createFormulaParser,e.data,e.selected]),J=N.useReducer(rp,H),ee=_e(J,2),D=ee[0],Z=ee[1],I=N.useMemo(function(){return z0(D.model.data,f,o)},[D.model.data,f,o]),_=D.mode,C=N.useRef(null),P=function(oe){return N.useCallback(function(){for(var be=[],We=0;We<arguments.length;We++)be[We]=arguments[We];return Z(oe.apply(void 0,Qe([],_e(be),!1)))},[oe])},x=P(M0),z=P(_0),L=P(N0),V=P(A0),te=P(T0),j=P(C0),ne=P(O0),ie=P(h0),he=P(p0),ce=P(L0),Ae=P(E0),we=N.useRef(D.active);N.useEffect(function(){if(D.active!==we.current)if(D.active)b(D.active);else{var oe=C.current;oe&&Zu(oe)&&document.activeElement&&document.activeElement.blur(),F()}we.current=D.active},[b,F,D.active]);var de=N.useRef(D.model.data);N.useEffect(function(){D.model.data!==de.current&&D.model.data!==e.data&&w(D.model.data),de.current=D.model.data},[D.model.data,w,e.data]);var ae=N.useRef(D.model.evaluatedData);N.useEffect(function(){var oe,be;((oe=D==null?void 0:D.model)===null||oe===void 0?void 0:oe.evaluatedData)!==(ae==null?void 0:ae.current)&&S((be=D==null?void 0:D.model)===null||be===void 0?void 0:be.evaluatedData),ae.current=D.model.evaluatedData},[(r=D==null?void 0:D.model)===null||r===void 0?void 0:r.evaluatedData,S]);var me=N.useRef(D.selected);N.useEffect(function(){D.selected.equals(me.current)||(!e.selected||!D.selected.equals(e.selected))&&O(D.selected),me.current=D.selected},[D.selected,O,e.selected]);var Ne=N.useRef(D.mode);N.useEffect(function(){D.mode!==Ne.current&&R(D.mode),Ne.current=D.mode},[D.mode,R]);var fe=N.useRef(D.lastCommit);N.useEffect(function(){var oe,be;if(D.lastCommit&&D.lastCommit!==fe.current)try{for(var We=xe(D.lastCommit),ft=We.next();!ft.done;ft=We.next()){var Ft=ft.value;Y(Ft.prevCell,Ft.nextCell,D.lastChanged)}}catch(Et){oe={error:Et}}finally{try{ft&&!ft.done&&(be=We.return)&&be.call(We)}finally{if(oe)throw oe.error}}},[Y,D.lastChanged,D.lastCommit]);var X=N.useRef(e.selected);N.useEffect(function(){e.selected&&X.current&&!e.selected.equals(X.current)&&Ae(e.selected),X.current=e.selected},[e.selected,Ae]);var U=N.useRef(e.data);N.useEffect(function(){e.data!==U.current&&ie(e.data),U.current=e.data},[e.data,ie]);var B=N.useRef(e.createFormulaParser);N.useEffect(function(){e.createFormulaParser!==B.current&&e.createFormulaParser&&he(e.createFormulaParser),B.current=e.createFormulaParser},[e.createFormulaParser,he]);var q=N.useCallback(function(oe){var be=D.model,We=D.selected,ft=be.data,Ft=We.toRange(ft);if(Ft){var Et=Hu(Ft.start,Ft.end,ft),pr=q0(Et);W0(oe,pr)}},[D]),K=N.useCallback(function(oe){li(C.current,_)&&(oe.preventDefault(),oe.stopPropagation(),q(oe),x())},[_,q,x]),se=N.useCallback(function(oe){li(C.current,_)&&(oe.preventDefault(),oe.stopPropagation(),q(oe),z())},[_,q,z]),Ee=N.useCallback(function(oe){if(li(C.current,_)&&(oe.preventDefault(),oe.stopPropagation(),oe.clipboardData)){var be=H0(oe);L(be)}},[_,L]),Te=N.useCallback(function(oe){oe.persist(),d&&d(oe),oe.defaultPrevented||(up(D,oe)&&oe.nativeEvent.preventDefault(),V(oe))},[D,d,V]),Ce=N.useCallback(function(){ne(),document.removeEventListener("mouseup",Ce)},[ne]),ve=N.useCallback(function(oe){!D.dragging&&oe.buttons===1&&(j(),document.addEventListener("mouseup",Ce))},[D,j,Ce]),ge=N.useCallback(function(oe){oe.currentTarget.contains(oe.relatedTarget)||ce()},[ce]),Ye=N.useMemo(function(){return Cp(e.Cell||Ap)},[e.Cell]),Ct=N.useMemo(function(){return Ep(e.CornerIndicator||gp)},[e.CornerIndicator]),gt=N.useMemo(function(){return Tp(e.RowIndicator||Np)},[e.RowIndicator]),Ot=N.useMemo(function(){return wp(e.ColumnIndicator||yp)},[e.ColumnIndicator]);N.useEffect(function(){return document.addEventListener("cut",K),document.addEventListener("copy",se),document.addEventListener("paste",Ee),function(){document.removeEventListener("cut",K),document.removeEventListener("copy",se),document.removeEventListener("paste",Ee)}},[K,se,Ee]);var St=N.useMemo(function(){return N.createElement(i,{columns:I.columns,hideColumnIndicators:l},N.createElement(v,null,!g&&!l&&N.createElement(Ct,null),!l&&Sr(I.columns).map(function(oe){return o?N.createElement(Ot,{key:oe,column:oe,label:oe in o?o[oe]:null}):N.createElement(Ot,{key:oe,column:oe})})),Sr(I.rows).map(function(oe){return N.createElement(s,{key:oe,row:oe},!g&&(f?N.createElement(gt,{key:oe,row:oe,label:oe in f?f[oe]:null}):N.createElement(gt,{key:oe,row:oe})),Sr(I.columns).map(function(be){return N.createElement(Ye,{key:be,row:oe,column:be,DataViewer:E})}))}))},[i,I.rows,I.columns,l,s,v,g,Ct,o,Ot,f,gt,Ye,E]),dn=N.useMemo(function(){return N.createElement(Lp,{DataEditor:p})},[p]),Mo=N.useMemo(function(){return N.createElement("div",{ref:C,className:sn("Spreadsheet",n,{"Spreadsheet--dark-mode":t}),onKeyPress:te,onKeyDown:Te,onMouseMove:ve,onBlur:ge},St,dn,N.createElement(Up,null),N.createElement(kp,null))},[n,t,te,Te,ve,ge,St,dn]);return N.createElement(ma.Provider,{value:J},Mo)};const il=N.createContext(null),xE=({children:e})=>{const[r,n]=N.useState({});return G.jsx(il.Provider,{value:{message:r,setMessage:n},children:e})};function Ge(e,r){r===void 0&&(r={});var n=r.insertAt;if(e&&typeof document<"u"){var t=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",n==="top"&&t.firstChild?t.insertBefore(o,t.firstChild):t.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}function pe(){return pe=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},pe.apply(this,arguments)}function Re(e,r,{checkForDefaultPrevented:n=!0}={}){return function(t){if(e==null||e(t),n===!1||!t.defaultPrevented)return r==null?void 0:r(t)}}function ga(...e){return r=>e.forEach(n=>function(t,o){typeof t=="function"?t(o):t!=null&&(t.current=o)}(n,r))}function nt(...e){return N.useCallback(ga(...e),e)}function kn(e,r=[]){let n=[];const t=()=>{const o=n.map(f=>N.createContext(f));return function(f){const l=(f==null?void 0:f[e])||o;return N.useMemo(()=>({[`__scope${e}`]:{...f,[e]:l}}),[f,l])}};return t.scopeName=e,[function(o,f){const l=N.createContext(f),g=n.length;function d(c){const{scope:i,children:a,...s}=c,u=(i==null?void 0:i[e][g])||l,v=N.useMemo(()=>s,Object.values(s));return N.createElement(u.Provider,{value:v},a)}return n=[...n,f],d.displayName=o+"Provider",[d,function(c,i){const a=(i==null?void 0:i[e][g])||l,s=N.useContext(a);if(s)return s;if(f!==void 0)return f;throw new Error(`\`${c}\` must be used within \`${o}\``)}]},Bp(t,...r)]}function Bp(...e){const r=e[0];if(e.length===1)return r;const n=()=>{const t=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(o){const f=t.reduce((l,{useScope:g,scopeName:d})=>({...l,...g(o)[`__scope${d}`]}),{});return N.useMemo(()=>({[`__scope${r.scopeName}`]:f}),[f])}};return n.scopeName=r.scopeName,n}function xt(e){const r=N.useRef(e);return N.useEffect(()=>{r.current=e}),N.useMemo(()=>(...n)=>{var t;return(t=r.current)===null||t===void 0?void 0:t.call(r,...n)},[])}function Ea({prop:e,defaultProp:r,onChange:n=()=>{}}){const[t,o]=function({defaultProp:d,onChange:c}){const i=N.useState(d),[a]=i,s=N.useRef(a),u=xt(c);return N.useEffect(()=>{s.current!==a&&(u(a),s.current=a)},[a,s,u]),i}({defaultProp:r,onChange:n}),f=e!==void 0,l=f?e:t,g=xt(n);return[l,N.useCallback(d=>{if(f){const c=typeof d=="function"?d(e):d;c!==e&&g(c)}else o(d)},[f,e,o,g])]}Ge(`@import url('https://unpkg.com/mirotone@5.3.0/dist/styles.css');
`);const Yn=N.forwardRef((e,r)=>{const{children:n,...t}=e,o=N.Children.toArray(n),f=o.find(Dp);if(f){const l=f.props.children,g=o.map(d=>d===f?N.Children.count(l)>1?N.Children.only(null):N.isValidElement(l)?l.props.children:null:d);return N.createElement(Gi,pe({},t,{ref:r}),N.isValidElement(l)?N.cloneElement(l,void 0,g):null)}return N.createElement(Gi,pe({},t,{ref:r}),n)});Yn.displayName="Slot";const Gi=N.forwardRef((e,r)=>{const{children:n,...t}=e;return N.isValidElement(n)?N.cloneElement(n,{...Vp(t,n.props),ref:r?ga(r,n.ref):n.ref}):N.Children.count(n)>1?N.Children.only(null):null});Gi.displayName="SlotClone";const al=({children:e})=>N.createElement(N.Fragment,null,e);function Dp(e){return N.isValidElement(e)&&e.type===al}function Vp(e,r){const n={...r};for(const t in r){const o=e[t],f=r[t];/^on[A-Z]/.test(t)?o&&f?n[t]=(...l)=>{f(...l),o(...l)}:o&&(n[t]=o):t==="style"?n[t]={...o,...f}:t==="className"&&(n[t]=[o,f].filter(Boolean).join(" "))}return{...e,...n}}const mt=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,r)=>{const n=N.forwardRef((t,o)=>{const{asChild:f,...l}=t,g=f?Yn:r;return N.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),N.createElement(g,pe({},l,{ref:o}))});return n.displayName=`Primitive.${r}`,{...e,[r]:n}},{});function sl(e,r){e&&sr.flushSync(()=>e.dispatchEvent(r))}function cl(e){const r=e+"CollectionProvider",[n,t]=kn(r),[o,f]=n(r,{collectionRef:{current:null},itemMap:new Map}),l=e+"CollectionSlot",g=e+"CollectionItemSlot",d="data-radix-collection-item";return[{Provider:c=>{const{scope:i,children:a}=c,s=qe.useRef(null),u=qe.useRef(new Map).current;return qe.createElement(o,{scope:i,itemMap:u,collectionRef:s},a)},Slot:qe.forwardRef((c,i)=>{const{scope:a,children:s}=c,u=nt(i,f(l,a).collectionRef);return qe.createElement(Yn,{ref:u},s)}),ItemSlot:qe.forwardRef((c,i)=>{const{scope:a,children:s,...u}=c,v=qe.useRef(null),h=nt(i,v),p=f(g,a);return qe.useEffect(()=>(p.itemMap.set(v,{ref:v,...u}),()=>{p.itemMap.delete(v)})),qe.createElement(Yn,{[d]:"",ref:h},s)})},function(c){const i=f(e+"CollectionConsumer",c);return qe.useCallback(()=>{const a=i.collectionRef.current;if(!a)return[];const s=Array.from(a.querySelectorAll(`[${d}]`));return Array.from(i.itemMap.values()).sort((u,v)=>s.indexOf(u.ref.current)-s.indexOf(v.ref.current))},[i.collectionRef,i.itemMap])},t]}const Gp=N.createContext(void 0);function ul(e){const r=N.useContext(Gp);return e||r||"ltr"}const Wi="dismissableLayer.update",Wp="dismissableLayer.pointerDownOutside",Hp="dismissableLayer.focusOutside";let Fs;const $p=N.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),ll=N.forwardRef((e,r)=>{var n;const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:o,onPointerDownOutside:f,onFocusOutside:l,onInteractOutside:g,onDismiss:d,...c}=e,i=N.useContext($p),[a,s]=N.useState(null),u=(n=a==null?void 0:a.ownerDocument)!==null&&n!==void 0?n:globalThis==null?void 0:globalThis.document,[,v]=N.useState({}),h=nt(r,O=>s(O)),p=Array.from(i.layers),[m]=[...i.layersWithOutsidePointerEventsDisabled].slice(-1),E=p.indexOf(m),y=a?p.indexOf(a):-1,w=i.layersWithOutsidePointerEventsDisabled.size>0,T=y>=E,R=function(O,M=globalThis==null?void 0:globalThis.document){const b=xt(O),k=N.useRef(!1),F=N.useRef(()=>{});return N.useEffect(()=>{const $=W=>{if(W.target&&!k.current){let H=function(){Ds(Wp,b,S,{discrete:!0})};const S={originalEvent:W};W.pointerType==="touch"?(M.removeEventListener("click",F.current),F.current=H,M.addEventListener("click",F.current,{once:!0})):H()}else M.removeEventListener("click",F.current);k.current=!1},Y=window.setTimeout(()=>{M.addEventListener("pointerdown",$)},0);return()=>{window.clearTimeout(Y),M.removeEventListener("pointerdown",$),M.removeEventListener("click",F.current)}},[M,b]),{onPointerDownCapture:()=>k.current=!0}}(O=>{const M=O.target,b=[...i.branches].some(k=>k.contains(M));T&&!b&&(f==null||f(O),g==null||g(O),O.defaultPrevented||d==null||d())},u),A=function(O,M=globalThis==null?void 0:globalThis.document){const b=xt(O),k=N.useRef(!1);return N.useEffect(()=>{const F=$=>{$.target&&!k.current&&Ds(Hp,b,{originalEvent:$},{discrete:!1})};return M.addEventListener("focusin",F),()=>M.removeEventListener("focusin",F)},[M,b]),{onFocusCapture:()=>k.current=!0,onBlurCapture:()=>k.current=!1}}(O=>{const M=O.target;[...i.branches].some(b=>b.contains(M))||(l==null||l(O),g==null||g(O),O.defaultPrevented||d==null||d())},u);return function(O,M=globalThis==null?void 0:globalThis.document){const b=xt(O);N.useEffect(()=>{const k=F=>{F.key==="Escape"&&b(F)};return M.addEventListener("keydown",k),()=>M.removeEventListener("keydown",k)},[b,M])}(O=>{y===i.layers.size-1&&(o==null||o(O),!O.defaultPrevented&&d&&(O.preventDefault(),d()))},u),N.useEffect(()=>{if(a)return t&&(i.layersWithOutsidePointerEventsDisabled.size===0&&(Fs=u.body.style.pointerEvents,u.body.style.pointerEvents="none"),i.layersWithOutsidePointerEventsDisabled.add(a)),i.layers.add(a),Bs(),()=>{t&&i.layersWithOutsidePointerEventsDisabled.size===1&&(u.body.style.pointerEvents=Fs)}},[a,u,t,i]),N.useEffect(()=>()=>{a&&(i.layers.delete(a),i.layersWithOutsidePointerEventsDisabled.delete(a),Bs())},[a,i]),N.useEffect(()=>{const O=()=>v({});return document.addEventListener(Wi,O),()=>document.removeEventListener(Wi,O)},[]),N.createElement(mt.div,pe({},c,{ref:h,style:{pointerEvents:w?T?"auto":"none":void 0,...e.style},onFocusCapture:Re(e.onFocusCapture,A.onFocusCapture),onBlurCapture:Re(e.onBlurCapture,A.onBlurCapture),onPointerDownCapture:Re(e.onPointerDownCapture,R.onPointerDownCapture)}))});function Bs(){const e=new CustomEvent(Wi);document.dispatchEvent(e)}function Ds(e,r,n,{discrete:t}){const o=n.originalEvent.target,f=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});r&&o.addEventListener(e,r,{once:!0}),t?sl(o,f):o.dispatchEvent(f)}let fi=0;function Vs(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}const di="focusScope.autoFocusOnMount",hi="focusScope.autoFocusOnUnmount",Gs={bubbles:!1,cancelable:!0},qp=N.forwardRef((e,r)=>{const{loop:n=!1,trapped:t=!1,onMountAutoFocus:o,onUnmountAutoFocus:f,...l}=e,[g,d]=N.useState(null),c=xt(o),i=xt(f),a=N.useRef(null),s=nt(r,h=>d(h)),u=N.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;N.useEffect(()=>{if(t){let h=function(y){if(u.paused||!g)return;const w=y.target;g.contains(w)?a.current=w:Qt(a.current,{select:!0})},p=function(y){if(u.paused||!g)return;const w=y.relatedTarget;w!==null&&(g.contains(w)||Qt(a.current,{select:!0}))},m=function(y){if(document.activeElement===document.body)for(const w of y)w.removedNodes.length>0&&Qt(g)};document.addEventListener("focusin",h),document.addEventListener("focusout",p);const E=new MutationObserver(m);return g&&E.observe(g,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",h),document.removeEventListener("focusout",p),E.disconnect()}}},[t,g,u.paused]),N.useEffect(()=>{if(g){$s.add(u);const p=document.activeElement;if(!g.contains(p)){const m=new CustomEvent(di,Gs);g.addEventListener(di,c),g.dispatchEvent(m),m.defaultPrevented||(function(E,{select:y=!1}={}){const w=document.activeElement;for(const T of E)if(Qt(T,{select:y}),document.activeElement!==w)return}((h=Ws(g),h.filter(E=>E.tagName!=="A")),{select:!0}),document.activeElement===p&&Qt(g))}return()=>{g.removeEventListener(di,c),setTimeout(()=>{const m=new CustomEvent(hi,Gs);g.addEventListener(hi,i),g.dispatchEvent(m),m.defaultPrevented||Qt(p??document.body,{select:!0}),g.removeEventListener(hi,i),$s.remove(u)},0)}}var h},[g,c,i,u]);const v=N.useCallback(h=>{if(!n&&!t||u.paused)return;const p=h.key==="Tab"&&!h.altKey&&!h.ctrlKey&&!h.metaKey,m=document.activeElement;if(p&&m){const E=h.currentTarget,[y,w]=function(T){const R=Ws(T),A=Hs(R,T),O=Hs(R.reverse(),T);return[A,O]}(E);y&&w?h.shiftKey||m!==w?h.shiftKey&&m===y&&(h.preventDefault(),n&&Qt(w,{select:!0})):(h.preventDefault(),n&&Qt(y,{select:!0})):m===E&&h.preventDefault()}},[n,t,u.paused]);return N.createElement(mt.div,pe({tabIndex:-1},l,{ref:s,onKeyDown:v}))});function Ws(e){const r=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:t=>{const o=t.tagName==="INPUT"&&t.type==="hidden";return t.disabled||t.hidden||o?NodeFilter.FILTER_SKIP:t.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)r.push(n.currentNode);return r}function Hs(e,r){for(const n of e)if(!zp(n,{upTo:r}))return n}function zp(e,{upTo:r}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(r!==void 0&&e===r)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Qt(e,{select:r=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&function(t){return t instanceof HTMLInputElement&&"select"in t}(e)&&r&&e.select()}}const $s=function(){let e=[];return{add(r){const n=e[0];r!==n&&(n==null||n.pause()),e=qs(e,r),e.unshift(r)},remove(r){var n;e=qs(e,r),(n=e[0])===null||n===void 0||n.resume()}}}();function qs(e,r){const n=[...e],t=n.indexOf(r);return t!==-1&&n.splice(t,1),n}const In=globalThis!=null&&globalThis.document?N.useLayoutEffect:()=>{},Kp=ff.useId||(()=>{});let Yp=0;function eo(e){const[r,n]=N.useState(Kp());return In(()=>{n(t=>t??String(Yp++))},[e]),r?`radix-${r}`:""}const Xp=["top","right","bottom","left"],rn=Math.min,ot=Math.max,to=Math.round,wr=Math.floor,on=e=>({x:e,y:e}),Qp={left:"right",right:"left",bottom:"top",top:"bottom"},Zp={start:"end",end:"start"};function Hi(e,r,n){return ot(e,rn(r,n))}function Yt(e,r){return typeof e=="function"?e(r):e}function Wt(e){return e.split("-")[0]}function bn(e){return e.split("-")[1]}function ya(e){return e==="x"?"y":"x"}function wa(e){return e==="y"?"height":"width"}function Pn(e){return["top","bottom"].includes(Wt(e))?"y":"x"}function Ra(e){return ya(Pn(e))}function pi(e){return e.replace(/start|end/g,r=>Zp[r])}function Rr(e){return e.replace(/left|right|bottom|top/g,r=>Qp[r])}function fl(e){return typeof e!="number"?function(r){return{top:0,right:0,bottom:0,left:0,...r}}(e):{top:e,right:e,bottom:e,left:e}}function no(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function zs(e,r,n){let{reference:t,floating:o}=e;const f=Pn(r),l=Ra(r),g=wa(l),d=Wt(r),c=f==="y",i=t.x+t.width/2-o.width/2,a=t.y+t.height/2-o.height/2,s=t[g]/2-o[g]/2;let u;switch(d){case"top":u={x:i,y:t.y-o.height};break;case"bottom":u={x:i,y:t.y+t.height};break;case"right":u={x:t.x+t.width,y:a};break;case"left":u={x:t.x-o.width,y:a};break;default:u={x:t.x,y:t.y}}switch(bn(r)){case"start":u[l]-=s*(n&&c?-1:1);break;case"end":u[l]+=s*(n&&c?-1:1)}return u}async function Xn(e,r){var n;r===void 0&&(r={});const{x:t,y:o,platform:f,rects:l,elements:g,strategy:d}=e,{boundary:c="clippingAncestors",rootBoundary:i="viewport",elementContext:a="floating",altBoundary:s=!1,padding:u=0}=Yt(r,e),v=fl(u),h=g[s?a==="floating"?"reference":"floating":a],p=no(await f.getClippingRect({element:(n=await(f.isElement==null?void 0:f.isElement(h)))==null||n?h:h.contextElement||await(f.getDocumentElement==null?void 0:f.getDocumentElement(g.floating)),boundary:c,rootBoundary:i,strategy:d})),m=a==="floating"?{...l.floating,x:t,y:o}:l.reference,E=await(f.getOffsetParent==null?void 0:f.getOffsetParent(g.floating)),y=await(f.isElement==null?void 0:f.isElement(E))&&await(f.getScale==null?void 0:f.getScale(E))||{x:1,y:1},w=no(f.convertOffsetParentRelativeRectToViewportRelativeRect?await f.convertOffsetParentRelativeRectToViewportRelativeRect({elements:g,rect:m,offsetParent:E,strategy:d}):m);return{top:(p.top-w.top+v.top)/y.y,bottom:(w.bottom-p.bottom+v.bottom)/y.y,left:(p.left-w.left+v.left)/y.x,right:(w.right-p.right+v.right)/y.x}}function Ks(e,r){return{top:e.top-r.height,right:e.right-r.width,bottom:e.bottom-r.height,left:e.left-r.width}}function Ys(e){return Xp.some(r=>e[r]>=0)}const Jp=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(r){var n,t;const{x:o,y:f,placement:l,middlewareData:g}=r,d=await async function(c,i){const{placement:a,platform:s,elements:u}=c,v=await(s.isRTL==null?void 0:s.isRTL(u.floating)),h=Wt(a),p=bn(a),m=Pn(a)==="y",E=["left","top"].includes(h)?-1:1,y=v&&m?-1:1,w=Yt(i,c);let{mainAxis:T,crossAxis:R,alignmentAxis:A}=typeof w=="number"?{mainAxis:w,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...w};return p&&typeof A=="number"&&(R=p==="end"?-1*A:A),m?{x:R*y,y:T*E}:{x:T*E,y:R*y}}(r,e);return l===((n=g.offset)==null?void 0:n.placement)&&(t=g.arrow)!=null&&t.alignmentOffset?{}:{x:o+d.x,y:f+d.y,data:{...d,placement:l}}}}};function an(e){return dl(e)?(e.nodeName||"").toLowerCase():"#document"}function it(e){var r;return(e==null||(r=e.ownerDocument)==null?void 0:r.defaultView)||window}function Ht(e){var r;return(r=(dl(e)?e.ownerDocument:e.document)||window.document)==null?void 0:r.documentElement}function dl(e){return e instanceof Node||e instanceof it(e).Node}function $t(e){return e instanceof Element||e instanceof it(e).Element}function Ut(e){return e instanceof HTMLElement||e instanceof it(e).HTMLElement}function Xs(e){return typeof ShadowRoot<"u"&&(e instanceof ShadowRoot||e instanceof it(e).ShadowRoot)}function Qn(e){const{overflow:r,overflowX:n,overflowY:t,display:o}=ht(e);return/auto|scroll|overlay|hidden|clip/.test(r+t+n)&&!["inline","contents"].includes(o)}function jp(e){return["table","td","th"].includes(an(e))}function $i(e){const r=Na(),n=ht(e);return n.transform!=="none"||n.perspective!=="none"||!!n.containerType&&n.containerType!=="normal"||!r&&!!n.backdropFilter&&n.backdropFilter!=="none"||!r&&!!n.filter&&n.filter!=="none"||["transform","perspective","filter"].some(t=>(n.willChange||"").includes(t))||["paint","layout","strict","content"].some(t=>(n.contain||"").includes(t))}function Na(){return!(typeof CSS>"u"||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function No(e){return["html","body","#document"].includes(an(e))}function ht(e){return it(e).getComputedStyle(e)}function To(e){return $t(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Ln(e){if(an(e)==="html")return e;const r=e.assignedSlot||e.parentNode||Xs(e)&&e.host||Ht(e);return Xs(r)?r.host:r}function hl(e){const r=Ln(e);return No(r)?e.ownerDocument?e.ownerDocument.body:e.body:Ut(r)&&Qn(r)?r:hl(r)}function Zn(e,r,n){var t;r===void 0&&(r=[]),n===void 0&&(n=!0);const o=hl(e),f=o===((t=e.ownerDocument)==null?void 0:t.body),l=it(o);return f?r.concat(l,l.visualViewport||[],Qn(o)?o:[],l.frameElement&&n?Zn(l.frameElement):[]):r.concat(o,Zn(o,[],n))}function pl(e){const r=ht(e);let n=parseFloat(r.width)||0,t=parseFloat(r.height)||0;const o=Ut(e),f=o?e.offsetWidth:n,l=o?e.offsetHeight:t,g=to(n)!==f||to(t)!==l;return g&&(n=f,t=l),{width:n,height:t,$:g}}function Ta(e){return $t(e)?e:e.contextElement}function _n(e){const r=Ta(e);if(!Ut(r))return on(1);const n=r.getBoundingClientRect(),{width:t,height:o,$:f}=pl(r);let l=(f?to(n.width):n.width)/t,g=(f?to(n.height):n.height)/o;return l&&Number.isFinite(l)||(l=1),g&&Number.isFinite(g)||(g=1),{x:l,y:g}}const ev=on(0);function vl(e){const r=it(e);return Na()&&r.visualViewport?{x:r.visualViewport.offsetLeft,y:r.visualViewport.offsetTop}:ev}function mn(e,r,n,t){r===void 0&&(r=!1),n===void 0&&(n=!1);const o=e.getBoundingClientRect(),f=Ta(e);let l=on(1);r&&(t?$t(t)&&(l=_n(t)):l=_n(e));const g=function(s,u,v){return u===void 0&&(u=!1),!(!v||u&&v!==it(s))&&u}(f,n,t)?vl(f):on(0);let d=(o.left+g.x)/l.x,c=(o.top+g.y)/l.y,i=o.width/l.x,a=o.height/l.y;if(f){const s=it(f),u=t&&$t(t)?it(t):t;let v=s,h=v.frameElement;for(;h&&t&&u!==v;){const p=_n(h),m=h.getBoundingClientRect(),E=ht(h),y=m.left+(h.clientLeft+parseFloat(E.paddingLeft))*p.x,w=m.top+(h.clientTop+parseFloat(E.paddingTop))*p.y;d*=p.x,c*=p.y,i*=p.x,a*=p.y,d+=y,c+=w,v=it(h),h=v.frameElement}}return no({width:i,height:a,x:d,y:c})}const tv=[":popover-open",":modal"];function ml(e){return tv.some(r=>{try{return e.matches(r)}catch{return!1}})}function gl(e){return mn(Ht(e)).left+To(e).scrollLeft}function Qs(e,r,n){let t;if(r==="viewport")t=function(o,f){const l=it(o),g=Ht(o),d=l.visualViewport;let c=g.clientWidth,i=g.clientHeight,a=0,s=0;if(d){c=d.width,i=d.height;const u=Na();(!u||u&&f==="fixed")&&(a=d.offsetLeft,s=d.offsetTop)}return{width:c,height:i,x:a,y:s}}(e,n);else if(r==="document")t=function(o){const f=Ht(o),l=To(o),g=o.ownerDocument.body,d=ot(f.scrollWidth,f.clientWidth,g.scrollWidth,g.clientWidth),c=ot(f.scrollHeight,f.clientHeight,g.scrollHeight,g.clientHeight);let i=-l.scrollLeft+gl(o);const a=-l.scrollTop;return ht(g).direction==="rtl"&&(i+=ot(f.clientWidth,g.clientWidth)-d),{width:d,height:c,x:i,y:a}}(Ht(e));else if($t(r))t=function(o,f){const l=mn(o,!0,f==="fixed"),g=l.top+o.clientTop,d=l.left+o.clientLeft,c=Ut(o)?_n(o):on(1);return{width:o.clientWidth*c.x,height:o.clientHeight*c.y,x:d*c.x,y:g*c.y}}(r,n);else{const o=vl(e);t={...r,x:r.x-o.x,y:r.y-o.y}}return no(t)}function El(e,r){const n=Ln(e);return!(n===r||!$t(n)||No(n))&&(ht(n).position==="fixed"||El(n,r))}function nv(e,r,n){const t=Ut(r),o=Ht(r),f=n==="fixed",l=mn(e,!0,f,r);let g={scrollLeft:0,scrollTop:0};const d=on(0);if(t||!t&&!f)if((an(r)!=="body"||Qn(o))&&(g=To(r)),t){const c=mn(r,!0,f,r);d.x=c.x+r.clientLeft,d.y=c.y+r.clientTop}else o&&(d.x=gl(o));return{x:l.left+g.scrollLeft-d.x,y:l.top+g.scrollTop-d.y,width:l.width,height:l.height}}function Zs(e,r){return Ut(e)&&ht(e).position!=="fixed"?r?r(e):e.offsetParent:null}function Js(e,r){const n=it(e);if(!Ut(e)||ml(e))return n;let t=Zs(e,r);for(;t&&jp(t)&&ht(t).position==="static";)t=Zs(t,r);return t&&(an(t)==="html"||an(t)==="body"&&ht(t).position==="static"&&!$i(t))?n:t||function(o){let f=Ln(o);for(;Ut(f)&&!No(f);){if($i(f))return f;f=Ln(f)}return null}(e)||n}const rv={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:r,rect:n,offsetParent:t,strategy:o}=e;const f=o==="fixed",l=Ht(t),g=!!r&&ml(r.floating);if(t===l||g&&f)return n;let d={scrollLeft:0,scrollTop:0},c=on(1);const i=on(0),a=Ut(t);if((a||!a&&!f)&&((an(t)!=="body"||Qn(l))&&(d=To(t)),Ut(t))){const s=mn(t);c=_n(t),i.x=s.x+t.clientLeft,i.y=s.y+t.clientTop}return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-d.scrollLeft*c.x+i.x,y:n.y*c.y-d.scrollTop*c.y+i.y}},getDocumentElement:Ht,getClippingRect:function(e){let{element:r,boundary:n,rootBoundary:t,strategy:o}=e;const f=[...n==="clippingAncestors"?function(d,c){const i=c.get(d);if(i)return i;let a=Zn(d,[],!1).filter(h=>$t(h)&&an(h)!=="body"),s=null;const u=ht(d).position==="fixed";let v=u?Ln(d):d;for(;$t(v)&&!No(v);){const h=ht(v),p=$i(v);p||h.position!=="fixed"||(s=null),(u?!p&&!s:!p&&h.position==="static"&&s&&["absolute","fixed"].includes(s.position)||Qn(v)&&!p&&El(d,v))?a=a.filter(m=>m!==v):s=h,v=Ln(v)}return c.set(d,a),a}(r,this._c):[].concat(n),t],l=f[0],g=f.reduce((d,c)=>{const i=Qs(r,c,o);return d.top=ot(i.top,d.top),d.right=rn(i.right,d.right),d.bottom=rn(i.bottom,d.bottom),d.left=ot(i.left,d.left),d},Qs(r,l,o));return{width:g.right-g.left,height:g.bottom-g.top,x:g.left,y:g.top}},getOffsetParent:Js,getElementRects:async function(e){const r=this.getOffsetParent||Js,n=this.getDimensions;return{reference:nv(e.reference,await r(e.floating),e.strategy),floating:{x:0,y:0,...await n(e.floating)}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:r,height:n}=pl(e);return{width:r,height:n}},getScale:_n,isElement:$t,isRTL:function(e){return ht(e).direction==="rtl"}};function ov(e,r,n,t){t===void 0&&(t={});const{ancestorScroll:o=!0,ancestorResize:f=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:g=typeof IntersectionObserver=="function",animationFrame:d=!1}=t,c=Ta(e),i=o||f?[...c?Zn(c):[],...Zn(r)]:[];i.forEach(p=>{o&&p.addEventListener("scroll",n,{passive:!0}),f&&p.addEventListener("resize",n)});const a=c&&g?function(p,m){let E,y=null;const w=Ht(p);function T(){var R;clearTimeout(E),(R=y)==null||R.disconnect(),y=null}return function R(A,O){A===void 0&&(A=!1),O===void 0&&(O=1),T();const{left:M,top:b,width:k,height:F}=p.getBoundingClientRect();if(A||m(),!k||!F)return;const $={rootMargin:-wr(b)+"px "+-wr(w.clientWidth-(M+k))+"px "+-wr(w.clientHeight-(b+F))+"px "+-wr(M)+"px",threshold:ot(0,rn(1,O))||1};let Y=!0;function W(S){const H=S[0].intersectionRatio;if(H!==O){if(!Y)return R();H?R(!1,H):E=setTimeout(()=>{R(!1,1e-7)},100)}Y=!1}try{y=new IntersectionObserver(W,{...$,root:w.ownerDocument})}catch{y=new IntersectionObserver(W,$)}y.observe(p)}(!0),T}(c,n):null;let s,u=-1,v=null;l&&(v=new ResizeObserver(p=>{let[m]=p;m&&m.target===c&&v&&(v.unobserve(r),cancelAnimationFrame(u),u=requestAnimationFrame(()=>{var E;(E=v)==null||E.observe(r)})),n()}),c&&!d&&v.observe(c),v.observe(r));let h=d?mn(e):null;return d&&function p(){const m=mn(e);!h||m.x===h.x&&m.y===h.y&&m.width===h.width&&m.height===h.height||n(),h=m,s=requestAnimationFrame(p)}(),n(),()=>{var p;i.forEach(m=>{o&&m.removeEventListener("scroll",n),f&&m.removeEventListener("resize",n)}),a==null||a(),(p=v)==null||p.disconnect(),v=null,d&&cancelAnimationFrame(s)}}const iv=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(r){const{x:n,y:t,placement:o}=r,{mainAxis:f=!0,crossAxis:l=!1,limiter:g={fn:p=>{let{x:m,y:E}=p;return{x:m,y:E}}},...d}=Yt(e,r),c={x:n,y:t},i=await Xn(r,d),a=Pn(Wt(o)),s=ya(a);let u=c[s],v=c[a];if(f){const p=s==="y"?"bottom":"right";u=Hi(u+i[s==="y"?"top":"left"],u,u-i[p])}if(l){const p=a==="y"?"bottom":"right";v=Hi(v+i[a==="y"?"top":"left"],v,v-i[p])}const h=g.fn({...r,[s]:u,[a]:v});return{...h,data:{x:h.x-n,y:h.y-t}}}}},av=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(r){var n,t;const{placement:o,middlewareData:f,rects:l,initialPlacement:g,platform:d,elements:c}=r,{mainAxis:i=!0,crossAxis:a=!0,fallbackPlacements:s,fallbackStrategy:u="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:h=!0,...p}=Yt(e,r);if((n=f.arrow)!=null&&n.alignmentOffset)return{};const m=Wt(o),E=Wt(g)===g,y=await(d.isRTL==null?void 0:d.isRTL(c.floating)),w=s||(E||!h?[Rr(g)]:function(F){const $=Rr(F);return[pi(F),$,pi($)]}(g));s||v==="none"||w.push(...function(F,$,Y,W){const S=bn(F);let H=function(J,ee,D){const Z=["left","right"],I=["right","left"],_=["top","bottom"],C=["bottom","top"];switch(J){case"top":case"bottom":return D?ee?I:Z:ee?Z:I;case"left":case"right":return ee?_:C;default:return[]}}(Wt(F),Y==="start",W);return S&&(H=H.map(J=>J+"-"+S),$&&(H=H.concat(H.map(pi)))),H}(g,h,v,y));const T=[g,...w],R=await Xn(r,p),A=[];let O=((t=f.flip)==null?void 0:t.overflows)||[];if(i&&A.push(R[m]),a){const F=function($,Y,W){W===void 0&&(W=!1);const S=bn($),H=Ra($),J=wa(H);let ee=H==="x"?S===(W?"end":"start")?"right":"left":S==="start"?"bottom":"top";return Y.reference[J]>Y.floating[J]&&(ee=Rr(ee)),[ee,Rr(ee)]}(o,l,y);A.push(R[F[0]],R[F[1]])}if(O=[...O,{placement:o,overflows:A}],!A.every(F=>F<=0)){var M,b;const F=(((M=f.flip)==null?void 0:M.index)||0)+1,$=T[F];if($)return{data:{index:F,overflows:O},reset:{placement:$}};let Y=(b=O.filter(W=>W.overflows[0]<=0).sort((W,S)=>W.overflows[1]-S.overflows[1])[0])==null?void 0:b.placement;if(!Y)switch(u){case"bestFit":{var k;const W=(k=O.map(S=>[S.placement,S.overflows.filter(H=>H>0).reduce((H,J)=>H+J,0)]).sort((S,H)=>S[1]-H[1])[0])==null?void 0:k[0];W&&(Y=W);break}case"initialPlacement":Y=g}if(o!==Y)return{reset:{placement:Y}}}return{}}}},sv=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(r){const{placement:n,rects:t,platform:o,elements:f}=r,{apply:l=()=>{},...g}=Yt(e,r),d=await Xn(r,g),c=Wt(n),i=bn(n),a=Pn(n)==="y",{width:s,height:u}=t.floating;let v,h;c==="top"||c==="bottom"?(v=c,h=i===(await(o.isRTL==null?void 0:o.isRTL(f.floating))?"start":"end")?"left":"right"):(h=c,v=i==="end"?"top":"bottom");const p=u-d[v],m=s-d[h],E=!r.middlewareData.shift;let y=p,w=m;if(a){const R=s-d.left-d.right;w=i||E?rn(m,R):R}else{const R=u-d.top-d.bottom;y=i||E?rn(p,R):R}if(E&&!i){const R=ot(d.left,0),A=ot(d.right,0),O=ot(d.top,0),M=ot(d.bottom,0);a?w=s-2*(R!==0||A!==0?R+A:ot(d.left,d.right)):y=u-2*(O!==0||M!==0?O+M:ot(d.top,d.bottom))}await l({...r,availableWidth:w,availableHeight:y});const T=await o.getDimensions(f.floating);return s!==T.width||u!==T.height?{reset:{rects:!0}}:{}}}},cv=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(r){const{rects:n}=r,{strategy:t="referenceHidden",...o}=Yt(e,r);switch(t){case"referenceHidden":{const f=Ks(await Xn(r,{...o,elementContext:"reference"}),n.reference);return{data:{referenceHiddenOffsets:f,referenceHidden:Ys(f)}}}case"escaped":{const f=Ks(await Xn(r,{...o,altBoundary:!0}),n.floating);return{data:{escapedOffsets:f,escaped:Ys(f)}}}default:return{}}}}},js=e=>({name:"arrow",options:e,async fn(r){const{x:n,y:t,placement:o,rects:f,platform:l,elements:g,middlewareData:d}=r,{element:c,padding:i=0}=Yt(e,r)||{};if(c==null)return{};const a=fl(i),s={x:n,y:t},u=Ra(o),v=wa(u),h=await l.getDimensions(c),p=u==="y",m=p?"top":"left",E=p?"bottom":"right",y=p?"clientHeight":"clientWidth",w=f.reference[v]+f.reference[u]-s[u]-f.floating[v],T=s[u]-f.reference[u],R=await(l.getOffsetParent==null?void 0:l.getOffsetParent(c));let A=R?R[y]:0;A&&await(l.isElement==null?void 0:l.isElement(R))||(A=g.floating[y]||f.floating[v]);const O=w/2-T/2,M=A/2-h[v]/2-1,b=rn(a[m],M),k=rn(a[E],M),F=b,$=A-h[v]-k,Y=A/2-h[v]/2+O,W=Hi(F,Y,$),S=!d.arrow&&bn(o)!=null&&Y!==W&&f.reference[v]/2-(Y<F?b:k)-h[v]/2<0,H=S?Y<F?Y-F:Y-$:0;return{[u]:s[u]+H,data:{[u]:W,centerOffset:Y-W-H,...S&&{alignmentOffset:H}},reset:S}}}),uv=function(e){return e===void 0&&(e={}),{options:e,fn(r){const{x:n,y:t,placement:o,rects:f,middlewareData:l}=r,{offset:g=0,mainAxis:d=!0,crossAxis:c=!0}=Yt(e,r),i={x:n,y:t},a=Pn(o),s=ya(a);let u=i[s],v=i[a];const h=Yt(g,r),p=typeof h=="number"?{mainAxis:h,crossAxis:0}:{mainAxis:0,crossAxis:0,...h};if(d){const y=s==="y"?"height":"width",w=f.reference[s]-f.floating[y]+p.mainAxis,T=f.reference[s]+f.reference[y]-p.mainAxis;u<w?u=w:u>T&&(u=T)}if(c){var m,E;const y=s==="y"?"width":"height",w=["top","left"].includes(Wt(o)),T=f.reference[a]-f.floating[y]+(w&&((m=l.offset)==null?void 0:m[a])||0)+(w?0:p.crossAxis),R=f.reference[a]+f.reference[y]+(w?0:((E=l.offset)==null?void 0:E[a])||0)-(w?p.crossAxis:0);v<T?v=T:v>R&&(v=R)}return{[s]:u,[a]:v}}}},lv=(e,r,n)=>{const t=new Map,o={platform:rv,...n},f={...o.platform,_c:t};return(async(l,g,d)=>{const{placement:c="bottom",strategy:i="absolute",middleware:a=[],platform:s}=d,u=a.filter(Boolean),v=await(s.isRTL==null?void 0:s.isRTL(g));let h=await s.getElementRects({reference:l,floating:g,strategy:i}),{x:p,y:m}=zs(h,c,v),E=c,y={},w=0;for(let T=0;T<u.length;T++){const{name:R,fn:A}=u[T],{x:O,y:M,data:b,reset:k}=await A({x:p,y:m,initialPlacement:c,placement:E,strategy:i,middlewareData:y,rects:h,platform:s,elements:{reference:l,floating:g}});p=O??p,m=M??m,y={...y,[R]:{...y[R],...b}},k&&w<=50&&(w++,typeof k=="object"&&(k.placement&&(E=k.placement),k.rects&&(h=k.rects===!0?await s.getElementRects({reference:l,floating:g,strategy:i}):k.rects),{x:p,y:m}=zs(h,E,v)),T=-1)}return{x:p,y:m,placement:E,strategy:i,middlewareData:y}})(e,r,{...o,platform:f})},fv=e=>({name:"arrow",options:e,fn(r){const{element:n,padding:t}=typeof e=="function"?e(r):e;return n&&(o=n,{}.hasOwnProperty.call(o,"current"))?n.current!=null?js({element:n.current,padding:t}).fn(r):{}:n?js({element:n,padding:t}).fn(r):{};var o}});var Br=typeof document<"u"?N.useLayoutEffect:N.useEffect;function ro(e,r){if(e===r)return!0;if(typeof e!=typeof r)return!1;if(typeof e=="function"&&e.toString()===r.toString())return!0;let n,t,o;if(e&&r&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==r.length)return!1;for(t=n;t--!=0;)if(!ro(e[t],r[t]))return!1;return!0}if(o=Object.keys(e),n=o.length,n!==Object.keys(r).length)return!1;for(t=n;t--!=0;)if(!{}.hasOwnProperty.call(r,o[t]))return!1;for(t=n;t--!=0;){const f=o[t];if((f!=="_owner"||!e.$$typeof)&&!ro(e[f],r[f]))return!1}return!0}return e!=e&&r!=r}function yl(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function ec(e,r){const n=yl(e);return Math.round(r*n)/n}function tc(e){const r=N.useRef(e);return Br(()=>{r.current=e}),r}const dv=N.forwardRef((e,r)=>{const{children:n,width:t=10,height:o=5,...f}=e;return N.createElement(mt.svg,pe({},f,{ref:r,width:t,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),e.asChild?n:N.createElement("polygon",{points:"0,0 30,0 15,10"}))}),wl="Popper",[Rl,Ao]=kn(wl),[hv,Nl]=Rl(wl),pv=N.forwardRef((e,r)=>{const{__scopePopper:n,virtualRef:t,...o}=e,f=Nl("PopperAnchor",n),l=N.useRef(null),g=nt(r,l);return N.useEffect(()=>{f.onAnchorChange((t==null?void 0:t.current)||l.current)}),t?null:N.createElement(mt.div,pe({},o,{ref:g}))}),Tl="PopperContent",[vv,mv]=Rl(Tl),gv=N.forwardRef((e,r)=>{var n,t,o,f,l,g,d,c;const{__scopePopper:i,side:a="bottom",sideOffset:s=0,align:u="center",alignOffset:v=0,arrowPadding:h=0,avoidCollisions:p=!0,collisionBoundary:m=[],collisionPadding:E=0,sticky:y="partial",hideWhenDetached:w=!1,updatePositionStrategy:T="optimized",onPlaced:R,...A}=e,O=Nl(Tl,i),[M,b]=N.useState(null),k=nt(r,ce=>b(ce)),[F,$]=N.useState(null),Y=function(ce){const[Ae,we]=N.useState(void 0);return In(()=>{if(ce){we({width:ce.offsetWidth,height:ce.offsetHeight});const de=new ResizeObserver(ae=>{if(!Array.isArray(ae)||!ae.length)return;const me=ae[0];let Ne,fe;if("borderBoxSize"in me){const X=me.borderBoxSize,U=Array.isArray(X)?X[0]:X;Ne=U.inlineSize,fe=U.blockSize}else Ne=ce.offsetWidth,fe=ce.offsetHeight;we({width:Ne,height:fe})});return de.observe(ce,{box:"border-box"}),()=>de.unobserve(ce)}we(void 0)},[ce]),Ae}(F),W=(n=Y==null?void 0:Y.width)!==null&&n!==void 0?n:0,S=(t=Y==null?void 0:Y.height)!==null&&t!==void 0?t:0,H=a+(u!=="center"?"-"+u:""),J=typeof E=="number"?E:{top:0,right:0,bottom:0,left:0,...E},ee=Array.isArray(m)?m:[m],D=ee.length>0,Z={padding:J,boundary:ee.filter(Rv),altBoundary:D},{refs:I,floatingStyles:_,placement:C,isPositioned:P,middlewareData:x}=function(ce){ce===void 0&&(ce={});const{placement:Ae="bottom",strategy:we="absolute",middleware:de=[],platform:ae,elements:{reference:me,floating:Ne}={},transform:fe=!0,whileElementsMounted:X,open:U}=ce,[B,q]=N.useState({x:0,y:0,strategy:we,placement:Ae,middlewareData:{},isPositioned:!1}),[K,se]=N.useState(de);ro(K,de)||se(de);const[Ee,Te]=N.useState(null),[Ce,ve]=N.useState(null),ge=N.useCallback(Xe=>{Xe!==Ot.current&&(Ot.current=Xe,Te(Xe))},[]),Ye=N.useCallback(Xe=>{Xe!==St.current&&(St.current=Xe,ve(Xe))},[]),Ct=me||Ee,gt=Ne||Ce,Ot=N.useRef(null),St=N.useRef(null),dn=N.useRef(B),Mo=X!=null,oe=tc(X),be=tc(ae),We=N.useCallback(()=>{if(!Ot.current||!St.current)return;const Xe={placement:Ae,strategy:we,middleware:K};be.current&&(Xe.platform=be.current),lv(Ot.current,St.current,Xe).then(vr=>{const Rn={...vr,isPositioned:!0};ft.current&&!ro(dn.current,Rn)&&(dn.current=Rn,sr.flushSync(()=>{q(Rn)}))})},[K,Ae,we,be]);Br(()=>{U===!1&&dn.current.isPositioned&&(dn.current.isPositioned=!1,q(Xe=>({...Xe,isPositioned:!1})))},[U]);const ft=N.useRef(!1);Br(()=>(ft.current=!0,()=>{ft.current=!1}),[]),Br(()=>{if(Ct&&(Ot.current=Ct),gt&&(St.current=gt),Ct&&gt){if(oe.current)return oe.current(Ct,gt,We);We()}},[Ct,gt,We,oe,Mo]);const Ft=N.useMemo(()=>({reference:Ot,floating:St,setReference:ge,setFloating:Ye}),[ge,Ye]),Et=N.useMemo(()=>({reference:Ct,floating:gt}),[Ct,gt]),pr=N.useMemo(()=>{const Xe={position:we,left:0,top:0};if(!Et.floating)return Xe;const vr=ec(Et.floating,B.x),Rn=ec(Et.floating,B.y);return fe?{...Xe,transform:"translate("+vr+"px, "+Rn+"px)",...yl(Et.floating)>=1.5&&{willChange:"transform"}}:{position:we,left:vr,top:Rn}},[we,fe,Et.floating,B.x,B.y]);return N.useMemo(()=>({...B,update:We,refs:Ft,elements:Et,floatingStyles:pr}),[B,We,Ft,Et,pr])}({strategy:"fixed",placement:H,whileElementsMounted:(...ce)=>ov(...ce,{animationFrame:T==="always"}),elements:{reference:O.anchor},middleware:[Jp({mainAxis:s+S,alignmentAxis:v}),p&&iv({mainAxis:!0,crossAxis:!1,limiter:y==="partial"?uv():void 0,...Z}),p&&av({...Z}),sv({...Z,apply:({elements:ce,rects:Ae,availableWidth:we,availableHeight:de})=>{const{width:ae,height:me}=Ae.reference,Ne=ce.floating.style;Ne.setProperty("--radix-popper-available-width",`${we}px`),Ne.setProperty("--radix-popper-available-height",`${de}px`),Ne.setProperty("--radix-popper-anchor-width",`${ae}px`),Ne.setProperty("--radix-popper-anchor-height",`${me}px`)}}),F&&fv({element:F,padding:h}),Nv({arrowWidth:W,arrowHeight:S}),w&&cv({strategy:"referenceHidden",...Z})]}),[z,L]=Al(C),V=xt(R);In(()=>{P&&(V==null||V())},[P,V]);const te=(o=x.arrow)===null||o===void 0?void 0:o.x,j=(f=x.arrow)===null||f===void 0?void 0:f.y,ne=((l=x.arrow)===null||l===void 0?void 0:l.centerOffset)!==0,[ie,he]=N.useState();return In(()=>{M&&he(window.getComputedStyle(M).zIndex)},[M]),N.createElement("div",{ref:I.setFloating,"data-radix-popper-content-wrapper":"",style:{..._,transform:P?_.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ie,"--radix-popper-transform-origin":[(g=x.transformOrigin)===null||g===void 0?void 0:g.x,(d=x.transformOrigin)===null||d===void 0?void 0:d.y].join(" ")},dir:e.dir},N.createElement(vv,{scope:i,placedSide:z,onArrowChange:$,arrowX:te,arrowY:j,shouldHideArrow:ne},N.createElement(mt.div,pe({"data-side":z,"data-align":L},A,{ref:k,style:{...A.style,animation:P?void 0:"none",opacity:(c=x.hide)!==null&&c!==void 0&&c.referenceHidden?0:void 0}}))))}),Ev="PopperArrow",yv={top:"bottom",right:"left",bottom:"top",left:"right"},wv=N.forwardRef(function(e,r){const{__scopePopper:n,...t}=e,o=mv(Ev,n),f=yv[o.placedSide];return N.createElement("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[f]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0}},N.createElement(dv,pe({},t,{ref:r,style:{...t.style,display:"block"}})))});function Rv(e){return e!==null}const Nv=e=>({name:"transformOrigin",options:e,fn(r){var n,t,o,f,l;const{placement:g,rects:d,middlewareData:c}=r,i=((n=c.arrow)===null||n===void 0?void 0:n.centerOffset)!==0,a=i?0:e.arrowWidth,s=i?0:e.arrowHeight,[u,v]=Al(g),h={start:"0%",center:"50%",end:"100%"}[v],p=((t=(o=c.arrow)===null||o===void 0?void 0:o.x)!==null&&t!==void 0?t:0)+a/2,m=((f=(l=c.arrow)===null||l===void 0?void 0:l.y)!==null&&f!==void 0?f:0)+s/2;let E="",y="";return u==="bottom"?(E=i?h:`${p}px`,y=-s+"px"):u==="top"?(E=i?h:`${p}px`,y=`${d.floating.height+s}px`):u==="right"?(E=-s+"px",y=i?h:`${m}px`):u==="left"&&(E=`${d.floating.width+s}px`,y=i?h:`${m}px`),{data:{x:E,y}}}});function Al(e){const[r,n="center"]=e.split("-");return[r,n]}const Cl=e=>{const{__scopePopper:r,children:n}=e,[t,o]=N.useState(null);return N.createElement(hv,{scope:r,anchor:t,onAnchorChange:o},n)},Ol=pv,Il=gv,Tv=wv,_l=N.forwardRef((e,r)=>{var n;const{container:t=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...o}=e;return t?a0.createPortal(N.createElement(mt.div,pe({},o,{ref:r})),t):null}),ur=e=>{const{present:r,children:n}=e,t=function(l){const[g,d]=N.useState(),c=N.useRef({}),i=N.useRef(l),a=N.useRef("none"),s=l?"mounted":"unmounted",[u,v]=function(h,p){return N.useReducer((m,E)=>{const y=p[m][E];return y??m},h)}(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return N.useEffect(()=>{const h=Nr(c.current);a.current=u==="mounted"?h:"none"},[u]),In(()=>{const h=c.current,p=i.current;if(p!==l){const m=a.current,E=Nr(h);l?v("MOUNT"):E==="none"||(h==null?void 0:h.display)==="none"?v("UNMOUNT"):v(p&&m!==E?"ANIMATION_OUT":"UNMOUNT"),i.current=l}},[l,v]),In(()=>{if(g){const h=m=>{const E=Nr(c.current).includes(m.animationName);m.target===g&&E&&sr.flushSync(()=>v("ANIMATION_END"))},p=m=>{m.target===g&&(a.current=Nr(c.current))};return g.addEventListener("animationstart",p),g.addEventListener("animationcancel",h),g.addEventListener("animationend",h),()=>{g.removeEventListener("animationstart",p),g.removeEventListener("animationcancel",h),g.removeEventListener("animationend",h)}}v("ANIMATION_END")},[g,v]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:N.useCallback(h=>{h&&(c.current=getComputedStyle(h)),d(h)},[])}}(r),o=typeof n=="function"?n({present:t.isPresent}):N.Children.only(n),f=nt(t.ref,o.ref);return typeof n=="function"||t.isPresent?N.cloneElement(o,{ref:f}):null};function Nr(e){return(e==null?void 0:e.animationName)||"none"}ur.displayName="Presence";const vi="rovingFocusGroup.onEntryFocus",Av={bubbles:!1,cancelable:!0},Aa="RovingFocusGroup",[qi,Ml,Cv]=cl(Aa),[Ov,xl]=kn(Aa,[Cv]),[Iv,_v]=Ov(Aa),Mv=N.forwardRef((e,r)=>N.createElement(qi.Provider,{scope:e.__scopeRovingFocusGroup},N.createElement(qi.Slot,{scope:e.__scopeRovingFocusGroup},N.createElement(xv,pe({},e,{ref:r}))))),xv=N.forwardRef((e,r)=>{const{__scopeRovingFocusGroup:n,orientation:t,loop:o=!1,dir:f,currentTabStopId:l,defaultCurrentTabStopId:g,onCurrentTabStopIdChange:d,onEntryFocus:c,...i}=e,a=N.useRef(null),s=nt(r,a),u=ul(f),[v=null,h]=Ea({prop:l,defaultProp:g,onChange:d}),[p,m]=N.useState(!1),E=xt(c),y=Ml(n),w=N.useRef(!1),[T,R]=N.useState(0);return N.useEffect(()=>{const A=a.current;if(A)return A.addEventListener(vi,E),()=>A.removeEventListener(vi,E)},[E]),N.createElement(Iv,{scope:n,orientation:t,dir:u,loop:o,currentTabStopId:v,onItemFocus:N.useCallback(A=>h(A),[h]),onItemShiftTab:N.useCallback(()=>m(!0),[]),onFocusableItemAdd:N.useCallback(()=>R(A=>A+1),[]),onFocusableItemRemove:N.useCallback(()=>R(A=>A-1),[])},N.createElement(mt.div,pe({tabIndex:p||T===0?-1:0,"data-orientation":t},i,{ref:s,style:{outline:"none",...e.style},onMouseDown:Re(e.onMouseDown,()=>{w.current=!0}),onFocus:Re(e.onFocus,A=>{const O=!w.current;if(A.target===A.currentTarget&&O&&!p){const M=new CustomEvent(vi,Av);if(A.currentTarget.dispatchEvent(M),!M.defaultPrevented){const b=y().filter(k=>k.focusable);bl([b.find(k=>k.active),b.find(k=>k.id===v),...b].filter(Boolean).map(k=>k.ref.current))}}w.current=!1}),onBlur:Re(e.onBlur,()=>m(!1))})))}),bv=N.forwardRef((e,r)=>{const{__scopeRovingFocusGroup:n,focusable:t=!0,active:o=!1,tabStopId:f,...l}=e,g=eo(),d=f||g,c=_v("RovingFocusGroupItem",n),i=c.currentTabStopId===d,a=Ml(n),{onFocusableItemAdd:s,onFocusableItemRemove:u}=c;return N.useEffect(()=>{if(t)return s(),()=>u()},[t,s,u]),N.createElement(qi.ItemSlot,{scope:n,id:d,focusable:t,active:o},N.createElement(mt.span,pe({tabIndex:i?0:-1,"data-orientation":c.orientation},l,{ref:r,onMouseDown:Re(e.onMouseDown,v=>{t?c.onItemFocus(d):v.preventDefault()}),onFocus:Re(e.onFocus,()=>c.onItemFocus(d)),onKeyDown:Re(e.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey)return void c.onItemShiftTab();if(v.target!==v.currentTarget)return;const h=function(E,y,w){const T=function(R,A){return A!=="rtl"?R:R==="ArrowLeft"?"ArrowRight":R==="ArrowRight"?"ArrowLeft":R}(E.key,w);return y==="vertical"&&["ArrowLeft","ArrowRight"].includes(T)||y==="horizontal"&&["ArrowUp","ArrowDown"].includes(T)?void 0:Lv[T]}(v,c.orientation,c.dir);if(h!==void 0){v.preventDefault();let E=a().filter(y=>y.focusable).map(y=>y.ref.current);if(h==="last")E.reverse();else if(h==="prev"||h==="next"){h==="prev"&&E.reverse();const y=E.indexOf(v.currentTarget);E=c.loop?(m=y+1,(p=E).map((w,T)=>p[(m+T)%p.length])):E.slice(y+1)}setTimeout(()=>bl(E))}var p,m})})))}),Lv={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function bl(e){const r=document.activeElement;for(const n of e)if(n===r||(n.focus(),document.activeElement!==r))return}const Uv=Mv,kv=bv;var Nn=new WeakMap,Tr=new WeakMap,Ar={},nc=0,Ll=function(e){return e&&(e.host||Ll(e.parentNode))},Pv=function(e,r,n,t){var o=function(a,s){return s.map(function(u){if(a.contains(u))return u;var v=Ll(u);return v&&a.contains(v)?v:(console.error("aria-hidden",u,"in not contained inside",a,". Doing nothing"),null)}).filter(function(u){return!!u})}(r,Array.isArray(e)?e:[e]);Ar[n]||(Ar[n]=new WeakMap);var f=Ar[n],l=[],g=new Set,d=new Set(o),c=function(a){a&&!g.has(a)&&(g.add(a),c(a.parentNode))};o.forEach(c);var i=function(a){a&&!d.has(a)&&Array.prototype.forEach.call(a.children,function(s){if(g.has(s))i(s);else{var u=s.getAttribute(t),v=u!==null&&u!=="false",h=(Nn.get(s)||0)+1,p=(f.get(s)||0)+1;Nn.set(s,h),f.set(s,p),l.push(s),h===1&&v&&Tr.set(s,!0),p===1&&s.setAttribute(n,"true"),v||s.setAttribute(t,"true")}})};return i(r),g.clear(),nc++,function(){l.forEach(function(a){var s=Nn.get(a)-1,u=f.get(a)-1;Nn.set(a,s),f.set(a,u),s||(Tr.has(a)||a.removeAttribute(t),Tr.delete(a)),u||a.removeAttribute(n)}),--nc||(Nn=new WeakMap,Nn=new WeakMap,Tr=new WeakMap,Ar={})}},Sv=function(e,r,n){n===void 0&&(n="data-aria-hidden");var t=Array.from(Array.isArray(e)?e:[e]),o=function(f){return typeof document>"u"?null:(Array.isArray(f)?f[0]:f).ownerDocument.body}(e);return o?(t.push.apply(t,Array.from(o.querySelectorAll("[aria-live]"))),Pv(t,o,n,"aria-hidden")):function(){return null}},_t=function(){return _t=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++)for(var o in r=arguments[n])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e},_t.apply(this,arguments)};function Ul(e,r){var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.indexOf(t)<0&&(n[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(t=Object.getOwnPropertySymbols(e);o<t.length;o++)r.indexOf(t[o])<0&&Object.prototype.propertyIsEnumerable.call(e,t[o])&&(n[t[o]]=e[t[o]])}return n}var Dr="right-scroll-bar-position",Vr="width-before-scroll-bar";function mi(e,r){return typeof e=="function"?e(r):e&&(e.current=r),e}var rc=new WeakMap;function Fv(e,r){var n,t,o,f=(n=null,t=function(l){return e.forEach(function(g){return mi(g,l)})},(o=N.useState(function(){return{value:n,callback:t,facade:{get current(){return o.value},set current(l){var g=o.value;g!==l&&(o.value=l,o.callback(l,g))}}}})[0]).callback=t,o.facade);return N.useLayoutEffect(function(){var l=rc.get(f);if(l){var g=new Set(l),d=new Set(e),c=f.current;g.forEach(function(i){d.has(i)||mi(i,null)}),d.forEach(function(i){g.has(i)||mi(i,c)})}rc.set(f,e)},[e]),f}function Bv(e){return e}var kl=function(e){var r=e.sideCar,n=Ul(e,["sideCar"]);if(!r)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var t=r.read();if(!t)throw new Error("Sidecar medium not found");return N.createElement(t,_t({},n))};kl.isSideCarExport=!0;var Pl=function(e){e===void 0&&(e={});var r=function(n,t){t===void 0&&(t=Bv);var o=[],f=!1;return{read:function(){if(f)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return o.length?o[o.length-1]:n},useMedium:function(l){var g=t(l,f);return o.push(g),function(){o=o.filter(function(d){return d!==g})}},assignSyncMedium:function(l){for(f=!0;o.length;){var g=o;o=[],g.forEach(l)}o={push:function(d){return l(d)},filter:function(){return o}}},assignMedium:function(l){f=!0;var g=[];if(o.length){var d=o;o=[],d.forEach(l),g=o}var c=function(){var a=g;g=[],a.forEach(l)},i=function(){return Promise.resolve().then(c)};i(),o={push:function(a){g.push(a),i()},filter:function(a){return g=g.filter(a),o}}}}}(null);return r.options=_t({async:!0,ssr:!1},e),r}(),gi=function(){},oo=N.forwardRef(function(e,r){var n=N.useRef(null),t=N.useState({onScrollCapture:gi,onWheelCapture:gi,onTouchMoveCapture:gi}),o=t[0],f=t[1],l=e.forwardProps,g=e.children,d=e.className,c=e.removeScrollBar,i=e.enabled,a=e.shards,s=e.sideCar,u=e.noIsolation,v=e.inert,h=e.allowPinchZoom,p=e.as,m=p===void 0?"div":p,E=Ul(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),y=s,w=Fv([n,r]),T=_t(_t({},E),o);return N.createElement(N.Fragment,null,i&&N.createElement(y,{sideCar:Pl,removeScrollBar:c,shards:a,noIsolation:u,inert:v,setCallbacks:f,allowPinchZoom:!!h,lockRef:n}),l?N.cloneElement(N.Children.only(g),_t(_t({},T),{ref:w})):N.createElement(m,_t({},T,{className:d,ref:w}),g))});oo.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},oo.classNames={fullWidth:Vr,zeroRight:Dr};function Dv(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var r=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__}();return r&&e.setAttribute("nonce",r),e}var Vv=function(){var e=0,r=null;return{add:function(n){var t,o;e==0&&(r=Dv())&&(o=n,(t=r).styleSheet?t.styleSheet.cssText=o:t.appendChild(document.createTextNode(o)),function(f){(document.head||document.getElementsByTagName("head")[0]).appendChild(f)}(r)),e++},remove:function(){!--e&&r&&(r.parentNode&&r.parentNode.removeChild(r),r=null)}}},Sl=function(){var e,r=(e=Vv(),function(n,t){N.useEffect(function(){return e.add(n),function(){e.remove()}},[n&&t])});return function(n){var t=n.styles,o=n.dynamic;return r(t,o),null}},Gv={left:0,top:0,right:0,gap:0},Ei=function(e){return parseInt(e||"",10)||0},Wv=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Gv;var r=function(o){var f=window.getComputedStyle(document.body),l=f[o==="padding"?"paddingLeft":"marginLeft"],g=f[o==="padding"?"paddingTop":"marginTop"],d=f[o==="padding"?"paddingRight":"marginRight"];return[Ei(l),Ei(g),Ei(d)]}(e),n=document.documentElement.clientWidth,t=window.innerWidth;return{left:r[0],top:r[1],right:r[2],gap:Math.max(0,t-n+r[2]-r[0])}},Hv=Sl(),Mn="data-scroll-locked",$v=function(e,r,n,t){var o=e.left,f=e.top,l=e.right,g=e.gap;return n===void 0&&(n="margin"),`
  .`.concat("with-scroll-bars-hidden",` {
   overflow: hidden `).concat(t,`;
   padding-right: `).concat(g,"px ").concat(t,`;
  }
  body[`).concat(Mn,`] {
    overflow: hidden `).concat(t,`;
    overscroll-behavior: contain;
    `).concat([r&&"position: relative ".concat(t,";"),n==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(f,`px;
    padding-right: `).concat(l,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(g,"px ").concat(t,`;
    `),n==="padding"&&"padding-right: ".concat(g,"px ").concat(t,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Dr,` {
    right: `).concat(g,"px ").concat(t,`;
  }
  
  .`).concat(Vr,` {
    margin-right: `).concat(g,"px ").concat(t,`;
  }
  
  .`).concat(Dr," .").concat(Dr,` {
    right: 0 `).concat(t,`;
  }
  
  .`).concat(Vr," .").concat(Vr,` {
    margin-right: 0 `).concat(t,`;
  }
  
  body[`).concat(Mn,`] {
    `).concat("--removed-body-scroll-bar-size",": ").concat(g,`px;
  }
`)},oc=function(){var e=parseInt(document.body.getAttribute(Mn)||"0",10);return isFinite(e)?e:0},qv=function(e){var r=e.noRelative,n=e.noImportant,t=e.gapMode,o=t===void 0?"margin":t;N.useEffect(function(){return document.body.setAttribute(Mn,(oc()+1).toString()),function(){var l=oc()-1;l<=0?document.body.removeAttribute(Mn):document.body.setAttribute(Mn,l.toString())}},[]);var f=N.useMemo(function(){return Wv(o)},[o]);return N.createElement(Hv,{styles:$v(f,!r,o,n?"":"!important")})},zi=!1;if(typeof window<"u")try{var Cr=Object.defineProperty({},"passive",{get:function(){return zi=!0,!0}});window.addEventListener("test",Cr,Cr),window.removeEventListener("test",Cr,Cr)}catch{zi=!1}var Tn=!!zi&&{passive:!1},ic=function(e,r){var n=window.getComputedStyle(e);return n[r]!=="hidden"&&!(n.overflowY===n.overflowX&&!function(t){return t.tagName==="TEXTAREA"}(e)&&n[r]==="visible")},ac=function(e,r){var n=r;do{if(typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host),Fl(e,n)){var t=Bl(e,n);if(t[1]>t[2])return!0}n=n.parentNode}while(n&&n!==document.body);return!1},Fl=function(e,r){return e==="v"?function(n){return ic(n,"overflowY")}(r):function(n){return ic(n,"overflowX")}(r)},Bl=function(e,r){return e==="v"?[(n=r).scrollTop,n.scrollHeight,n.clientHeight]:function(t){return[t.scrollLeft,t.scrollWidth,t.clientWidth]}(r);var n},Or=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},sc=function(e){return[e.deltaX,e.deltaY]},cc=function(e){return e&&"current"in e?e.current:e},zv=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Kv=0,An=[],uc,Yv=(uc=function(e){var r=N.useRef([]),n=N.useRef([0,0]),t=N.useRef(),o=N.useState(Kv++)[0],f=N.useState(function(){return Sl()})[0],l=N.useRef(e);N.useEffect(function(){l.current=e},[e]),N.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(o));var h=function(p,m,E){for(var y,w=0,T=m.length;w<T;w++)!y&&w in m||(y||(y=Array.prototype.slice.call(m,0,w)),y[w]=m[w]);return p.concat(y||Array.prototype.slice.call(m))}([e.lockRef.current],(e.shards||[]).map(cc)).filter(Boolean);return h.forEach(function(p){return p.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),h.forEach(function(p){return p.classList.remove("allow-interactivity-".concat(o))})}}},[e.inert,e.lockRef.current,e.shards]);var g=N.useCallback(function(h,p){if("touches"in h&&h.touches.length===2)return!l.current.allowPinchZoom;var m,E=Or(h),y=n.current,w="deltaX"in h?h.deltaX:y[0]-E[0],T="deltaY"in h?h.deltaY:y[1]-E[1],R=h.target,A=Math.abs(w)>Math.abs(T)?"h":"v";if("touches"in h&&A==="h"&&R.type==="range")return!1;var O=ac(A,R);if(!O)return!0;if(O?m=A:(m=A==="v"?"h":"v",O=ac(A,R)),!O)return!1;if(!t.current&&"changedTouches"in h&&(w||T)&&(t.current=m),!m)return!0;var M=t.current||m;return function(b,k,F,$,Y){var W=function(x,z){return x==="h"&&z==="rtl"?-1:1}(b,window.getComputedStyle(k).direction),S=W*$,H=F.target,J=k.contains(H),ee=!1,D=S>0,Z=0,I=0;do{var _=Bl(b,H),C=_[0],P=_[1]-_[2]-W*C;(C||P)&&Fl(b,H)&&(Z+=P,I+=C),H=H.parentNode}while(!J&&H!==document.body||J&&(k.contains(H)||k===H));return(!D||Z!==0&&Y)&&(D||I!==0&&Y)||(ee=!0),ee}(M,p,h,M==="h"?w:T,!0)},[]),d=N.useCallback(function(h){var p=h;if(An.length&&An[An.length-1]===f){var m="deltaY"in p?sc(p):Or(p),E=r.current.filter(function(w){return w.name===p.type&&w.target===p.target&&(T=w.delta,R=m,T[0]===R[0]&&T[1]===R[1]);var T,R})[0];if(E&&E.should)p.cancelable&&p.preventDefault();else if(!E){var y=(l.current.shards||[]).map(cc).filter(Boolean).filter(function(w){return w.contains(p.target)});(y.length>0?g(p,y[0]):!l.current.noIsolation)&&p.cancelable&&p.preventDefault()}}},[]),c=N.useCallback(function(h,p,m,E){var y={name:h,delta:p,target:m,should:E};r.current.push(y),setTimeout(function(){r.current=r.current.filter(function(w){return w!==y})},1)},[]),i=N.useCallback(function(h){n.current=Or(h),t.current=void 0},[]),a=N.useCallback(function(h){c(h.type,sc(h),h.target,g(h,e.lockRef.current))},[]),s=N.useCallback(function(h){c(h.type,Or(h),h.target,g(h,e.lockRef.current))},[]);N.useEffect(function(){return An.push(f),e.setCallbacks({onScrollCapture:a,onWheelCapture:a,onTouchMoveCapture:s}),document.addEventListener("wheel",d,Tn),document.addEventListener("touchmove",d,Tn),document.addEventListener("touchstart",i,Tn),function(){An=An.filter(function(h){return h!==f}),document.removeEventListener("wheel",d,Tn),document.removeEventListener("touchmove",d,Tn),document.removeEventListener("touchstart",i,Tn)}},[]);var u=e.removeScrollBar,v=e.inert;return N.createElement(N.Fragment,null,v?N.createElement(f,{styles:zv(o)}):null,u?N.createElement(qv,{gapMode:"margin"}):null)},Pl.useMedium(uc),kl),Dl=N.forwardRef(function(e,r){return N.createElement(oo,_t({},e,{ref:r,sideCar:Yv}))});Dl.classNames=oo.classNames;const Xv=["Enter"," "],Vl=["ArrowUp","PageDown","End"],Qv=["ArrowDown","PageUp","Home",...Vl],Co="Menu",[Ki,Zv,Jv]=cl(Co),[wn,Gl]=kn(Co,[Jv,Ao,xl]),Ca=Ao(),Wl=xl(),[jv,lr]=wn(Co),[em,Oa]=wn(Co),tm=N.forwardRef((e,r)=>{const{__scopeMenu:n,...t}=e,o=Ca(n);return N.createElement(Ol,pe({},o,t,{ref:r}))}),Hl="MenuPortal",[nm,rm]=wn(Hl,{forceMount:void 0}),Jt="MenuContent",[om,$l]=wn(Jt),im=N.forwardRef((e,r)=>{const n=rm(Jt,e.__scopeMenu),{forceMount:t=n.forceMount,...o}=e,f=lr(Jt,e.__scopeMenu),l=Oa(Jt,e.__scopeMenu);return N.createElement(Ki.Provider,{scope:e.__scopeMenu},N.createElement(ur,{present:t||f.open},N.createElement(Ki.Slot,{scope:e.__scopeMenu},l.modal?N.createElement(am,pe({},o,{ref:r})):N.createElement(sm,pe({},o,{ref:r})))))}),am=N.forwardRef((e,r)=>{const n=lr(Jt,e.__scopeMenu),t=N.useRef(null),o=nt(r,t);return N.useEffect(()=>{const f=t.current;if(f)return Sv(f)},[]),N.createElement(ql,pe({},e,{ref:o,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Re(e.onFocusOutside,f=>f.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)}))}),sm=N.forwardRef((e,r)=>{const n=lr(Jt,e.__scopeMenu);return N.createElement(ql,pe({},e,{ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)}))}),ql=N.forwardRef((e,r)=>{const{__scopeMenu:n,loop:t=!1,trapFocus:o,onOpenAutoFocus:f,onCloseAutoFocus:l,disableOutsidePointerEvents:g,onEntryFocus:d,onEscapeKeyDown:c,onPointerDownOutside:i,onFocusOutside:a,onInteractOutside:s,onDismiss:u,disableOutsideScroll:v,...h}=e,p=lr(Jt,n),m=Oa(Jt,n),E=Ca(n),y=Wl(n),w=Zv(n),[T,R]=N.useState(null),A=N.useRef(null),O=nt(r,A,p.onContentChange),M=N.useRef(0),b=N.useRef(""),k=N.useRef(0),F=N.useRef(null),$=N.useRef("right"),Y=N.useRef(0),W=v?Dl:N.Fragment,S=v?{as:Yn,allowPinchZoom:!0}:void 0,H=D=>{var Z,I;const _=b.current+D,C=w().filter(V=>!V.disabled),P=document.activeElement,x=(Z=C.find(V=>V.ref.current===P))===null||Z===void 0?void 0:Z.textValue,z=function(V,te,j){const ne=te.length>1&&Array.from(te).every(ae=>ae===te[0]),ie=ne?te[0]:te,he=j?V.indexOf(j):-1;let ce=(Ae=V,we=Math.max(he,0),Ae.map((ae,me)=>Ae[(we+me)%Ae.length]));var Ae,we;ie.length===1&&(ce=ce.filter(ae=>ae!==j));const de=ce.find(ae=>ae.toLowerCase().startsWith(ie.toLowerCase()));return de!==j?de:void 0}(C.map(V=>V.textValue),_,x),L=(I=C.find(V=>V.textValue===z))===null||I===void 0?void 0:I.ref.current;(function V(te){b.current=te,window.clearTimeout(M.current),te!==""&&(M.current=window.setTimeout(()=>V(""),1e3))})(_),L&&setTimeout(()=>L.focus())};N.useEffect(()=>()=>window.clearTimeout(M.current),[]),N.useEffect(()=>{var D,Z;const I=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(D=I[0])!==null&&D!==void 0?D:Vs()),document.body.insertAdjacentElement("beforeend",(Z=I[1])!==null&&Z!==void 0?Z:Vs()),fi++,()=>{fi===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(_=>_.remove()),fi--}},[]);const J=N.useCallback(D=>{var Z,I;return $.current===((Z=F.current)===null||Z===void 0?void 0:Z.side)&&function(_,C){if(!C)return!1;const P={x:_.clientX,y:_.clientY};return function(x,z){const{x:L,y:V}=x;let te=!1;for(let j=0,ne=z.length-1;j<z.length;ne=j++){const ie=z[j].x,he=z[j].y,ce=z[ne].x,Ae=z[ne].y;he>V!=Ae>V&&L<(ce-ie)*(V-he)/(Ae-he)+ie&&(te=!te)}return te}(P,C)}(D,(I=F.current)===null||I===void 0?void 0:I.area)},[]);return N.createElement(om,{scope:n,searchRef:b,onItemEnter:N.useCallback(D=>{J(D)&&D.preventDefault()},[J]),onItemLeave:N.useCallback(D=>{var Z;J(D)||((Z=A.current)===null||Z===void 0||Z.focus(),R(null))},[J]),onTriggerLeave:N.useCallback(D=>{J(D)&&D.preventDefault()},[J]),pointerGraceTimerRef:k,onPointerGraceIntentChange:N.useCallback(D=>{F.current=D},[])},N.createElement(W,S,N.createElement(qp,{asChild:!0,trapped:o,onMountAutoFocus:Re(f,D=>{var Z;D.preventDefault(),(Z=A.current)===null||Z===void 0||Z.focus()}),onUnmountAutoFocus:l},N.createElement(ll,{asChild:!0,disableOutsidePointerEvents:g,onEscapeKeyDown:c,onPointerDownOutside:i,onFocusOutside:a,onInteractOutside:s,onDismiss:u},N.createElement(Uv,pe({asChild:!0},y,{dir:m.dir,orientation:"vertical",loop:t,currentTabStopId:T,onCurrentTabStopIdChange:R,onEntryFocus:Re(d,D=>{m.isUsingKeyboardRef.current||D.preventDefault()})}),N.createElement(Il,pe({role:"menu","aria-orientation":"vertical","data-state":(ee=p.open,ee?"open":"closed"),"data-radix-menu-content":"",dir:m.dir},E,h,{ref:O,style:{outline:"none",...h.style},onKeyDown:Re(h.onKeyDown,D=>{const Z=D.target.closest("[data-radix-menu-content]")===D.currentTarget,I=D.ctrlKey||D.altKey||D.metaKey,_=D.key.length===1;Z&&(D.key==="Tab"&&D.preventDefault(),!I&&_&&H(D.key));const C=A.current;if(D.target!==C||!Qv.includes(D.key))return;D.preventDefault();const P=w().filter(x=>!x.disabled).map(x=>x.ref.current);Vl.includes(D.key)&&P.reverse(),function(x){const z=document.activeElement;for(const L of x)if(L===z||(L.focus(),document.activeElement!==z))return}(P)}),onBlur:Re(e.onBlur,D=>{D.currentTarget.contains(D.target)||(window.clearTimeout(M.current),b.current="")}),onPointerMove:Re(e.onPointerMove,Xi(D=>{const Z=D.target,I=Y.current!==D.clientX;if(D.currentTarget.contains(Z)&&I){const _=D.clientX>Y.current?"right":"left";$.current=_,Y.current=D.clientX}}))})))))));var ee}),Yi="MenuItem",lc="menu.itemSelect",cm=N.forwardRef((e,r)=>{const{disabled:n=!1,onSelect:t,...o}=e,f=N.useRef(null),l=Oa(Yi,e.__scopeMenu),g=$l(Yi,e.__scopeMenu),d=nt(r,f),c=N.useRef(!1);return N.createElement(um,pe({},o,{ref:d,disabled:n,onClick:Re(e.onClick,()=>{const i=f.current;if(!n&&i){const a=new CustomEvent(lc,{bubbles:!0,cancelable:!0});i.addEventListener(lc,s=>t==null?void 0:t(s),{once:!0}),sl(i,a),a.defaultPrevented?c.current=!1:l.onClose()}}),onPointerDown:i=>{var a;(a=e.onPointerDown)===null||a===void 0||a.call(e,i),c.current=!0},onPointerUp:Re(e.onPointerUp,i=>{var a;c.current||(a=i.currentTarget)===null||a===void 0||a.click()}),onKeyDown:Re(e.onKeyDown,i=>{const a=g.searchRef.current!=="";n||a&&i.key===" "||Xv.includes(i.key)&&(i.currentTarget.click(),i.preventDefault())})}))}),um=N.forwardRef((e,r)=>{const{__scopeMenu:n,disabled:t=!1,textValue:o,...f}=e,l=$l(Yi,n),g=Wl(n),d=N.useRef(null),c=nt(r,d),[i,a]=N.useState(!1),[s,u]=N.useState("");return N.useEffect(()=>{const v=d.current;var h;v&&u(((h=v.textContent)!==null&&h!==void 0?h:"").trim())},[f.children]),N.createElement(Ki.ItemSlot,{scope:n,disabled:t,textValue:o??s},N.createElement(kv,pe({asChild:!0},g,{focusable:!t}),N.createElement(mt.div,pe({role:"menuitem","data-highlighted":i?"":void 0,"aria-disabled":t||void 0,"data-disabled":t?"":void 0},f,{ref:c,onPointerMove:Re(e.onPointerMove,Xi(v=>{t?l.onItemLeave(v):(l.onItemEnter(v),!v.defaultPrevented&&v.currentTarget.focus())})),onPointerLeave:Re(e.onPointerLeave,Xi(v=>l.onItemLeave(v))),onFocus:Re(e.onFocus,()=>a(!0)),onBlur:Re(e.onBlur,()=>a(!1))}))))});wn("MenuRadioGroup",{value:void 0,onValueChange:()=>{}});wn("MenuItemIndicator",{checked:!1});function Xi(e){return r=>r.pointerType==="mouse"?e(r):void 0}wn("MenuSub");const lm=e=>{const{__scopeMenu:r,open:n=!1,children:t,dir:o,onOpenChange:f,modal:l=!0}=e,g=Ca(r),[d,c]=N.useState(null),i=N.useRef(!1),a=xt(f),s=ul(o);return N.useEffect(()=>{const u=()=>{i.current=!0,document.addEventListener("pointerdown",v,{capture:!0,once:!0}),document.addEventListener("pointermove",v,{capture:!0,once:!0})},v=()=>i.current=!1;return document.addEventListener("keydown",u,{capture:!0}),()=>{document.removeEventListener("keydown",u,{capture:!0}),document.removeEventListener("pointerdown",v,{capture:!0}),document.removeEventListener("pointermove",v,{capture:!0})}},[]),N.createElement(Cl,g,N.createElement(jv,{scope:r,open:n,onOpenChange:a,content:d,onContentChange:c},N.createElement(em,{scope:r,onClose:N.useCallback(()=>a(!1),[a]),isUsingKeyboardRef:i,dir:s,modal:l},t)))},fm=tm,dm=e=>{const{__scopeMenu:r,forceMount:n,children:t,container:o}=e,f=lr(Hl,r);return N.createElement(nm,{scope:r,forceMount:n},N.createElement(ur,{present:n||f.open},N.createElement(_l,{asChild:!0,container:o},t)))},hm=im,pm=cm,zl="DropdownMenu",[vm,bE]=kn(zl,[Gl]),fr=Gl(),[mm,Kl]=vm(zl),gm=e=>{const{__scopeDropdownMenu:r,children:n,dir:t,open:o,defaultOpen:f,onOpenChange:l,modal:g=!0}=e,d=fr(r),c=N.useRef(null),[i=!1,a]=Ea({prop:o,defaultProp:f,onChange:l});return N.createElement(mm,{scope:r,triggerId:eo(),triggerRef:c,contentId:eo(),open:i,onOpenChange:a,onOpenToggle:N.useCallback(()=>a(s=>!s),[a]),modal:g},N.createElement(lm,pe({},d,{open:i,onOpenChange:a,dir:t,modal:g}),n))},Em=N.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,disabled:t=!1,...o}=e,f=Kl("DropdownMenuTrigger",n),l=fr(n);return N.createElement(fm,pe({asChild:!0},l),N.createElement(mt.button,pe({type:"button",id:f.triggerId,"aria-haspopup":"menu","aria-expanded":f.open,"aria-controls":f.open?f.contentId:void 0,"data-state":f.open?"open":"closed","data-disabled":t?"":void 0,disabled:t},o,{ref:ga(r,f.triggerRef),onPointerDown:Re(e.onPointerDown,g=>{t||g.button!==0||g.ctrlKey!==!1||(f.onOpenToggle(),f.open||g.preventDefault())}),onKeyDown:Re(e.onKeyDown,g=>{t||(["Enter"," "].includes(g.key)&&f.onOpenToggle(),g.key==="ArrowDown"&&f.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(g.key)&&g.preventDefault())})})))}),ym=e=>{const{__scopeDropdownMenu:r,...n}=e,t=fr(r);return N.createElement(dm,pe({},t,n))},wm=N.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...t}=e,o=Kl("DropdownMenuContent",n),f=fr(n),l=N.useRef(!1);return N.createElement(hm,pe({id:o.contentId,"aria-labelledby":o.triggerId},f,t,{ref:r,onCloseAutoFocus:Re(e.onCloseAutoFocus,g=>{var d;l.current||(d=o.triggerRef.current)===null||d===void 0||d.focus(),l.current=!1,g.preventDefault()}),onInteractOutside:Re(e.onInteractOutside,g=>{const d=g.detail.originalEvent,c=d.button===0&&d.ctrlKey===!0,i=d.button===2||c;o.modal&&!i||(l.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),Rm=N.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...t}=e,o=fr(n);return N.createElement(pm,pe({},o,t,{ref:r}))});function ye(e){return typeof e=="string"&&e.length>0}var Nm={panel:"Dropdown-module_panel__6PJ1F"};Ge(`.Dropdown-module_panel__6PJ1F {
  background-color: var(--white);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
  border-radius: var(--border-radius-medium);
}
`);const Tm=N.forwardRef((e,r)=>{const{size:n="medium",trigger:t,open:o,onOpenChange:f,children:l,className:g,...d}=e,c=[Nm.panel,`p-${n}`,g].filter(ye);return G.jsxs(gm,{open:o,onOpenChange:f,children:[G.jsx(Em,{asChild:!0,children:t}),G.jsx(ym,{children:G.jsx(wm,{className:c.join(" "),...d,ref:r,children:l})})]})});Tm.displayName="Dropdown";const Am=N.forwardRef((e,r)=>{const{className:n,children:t,...o}=e,f=["app-card--title",n].filter(ye);return G.jsx("h1",{...o,ref:r,className:f.join(" "),children:t})});Am.displayName="AppCardTitle";var Cm={tags:"AppCardTags-module_tags__ep-F0"};Ge(`.AppCardTags-module_tags__ep-F0 span.tag:not(:last-child) {
  margin-right: var(--space-xsmall);
}
`);const Om=N.forwardRef((e,r)=>{const{className:n,children:t,...o}=e,f=["app-card--tags",Cm.tags,n].filter(ye);return G.jsx("div",{...o,ref:r,className:f.join(" "),children:t})});Om.displayName="AppCardTags";const Im=N.forwardRef((e,r)=>{const{className:n,children:t,...o}=e,f=["app-card--description","p-medium",n].filter(ye);return G.jsx("h1",{...o,ref:r,className:f.join(" "),children:t})});Im.displayName="AppCardDescription";const _m=N.forwardRef((e,r)=>{const{className:n,children:t,...o}=e,f=["app-card--body",n].filter(ye);return G.jsx("div",{...o,ref:r,className:f.join(" "),children:t})});_m.displayName="AppCardBody";const Mm=N.forwardRef((e,r)=>{const{accentColor:n="var(--blue700)",className:t,children:o,style:f={},...l}=e,g=["app-card",t].filter(ye);return G.jsx("div",{...l,ref:r,className:g.join(" "),style:{...f,"--accent-color":n},children:o})});Mm.displayName="AppCard";var Ia={button:"Button-module_button__2ZuB7","button-loading":"Button-module_button-loading__UQNwF",gap:"Button-module_gap__kCOx4"};function xm(e){switch(e){case"small":return"button-small";case"medium":return"button-medium";case"large":return""}}function bm(e){switch(e){case"primary":return"button-primary";case"secondary":return"button-secondary";case"tertiary":return"button-tertiary";case"danger":return"button-danger"}}function Lm(e){return e?`button-loading ${Ia["button-loading"]}`:""}function Um(e){return e?Ia.gap:""}Ge(`.Button-module_button__2ZuB7 {
  place-content: center;
}

.Button-module_button__2ZuB7:nth-child(n) {
    margin: 0;
  }

.Button-module_button__2ZuB7 span.icon {
    pointer-events: none;
  }

.Button-module_button__2ZuB7 [class*='p-'] {
    font-size: inherit;
  }

.Button-module_button-loading__UQNwF.Button-module_button-loading__UQNwF.Button-module_button-loading__UQNwF > span.icon {
    filter: opacity(0);
  }

.Button-module_gap__kCOx4.Button-module_gap__kCOx4 {
    gap: var(--gap);
  }
`);const Yl=N.forwardRef((e,r)=>{const{size:n="medium",variant:t="primary",isDisabled:o=!1,isLoading:f=!1,gap:l,children:g,className:d,style:c={},...i}=e,a=["button",Ia.button,xm(n),bm(t),Lm(f),Um(l),d].filter(ye);let s={...c};return l!==void 0&&(s={...s,"--gap":l}),G.jsx("button",{...i,ref:r,className:a.join(" "),disabled:o,style:s,children:g})});Yl.displayName="Button";var fc={container:"Checkbox-module_container__aV9qz","empty-label":"Checkbox-module_empty-label__OKclI"};Ge(`.Checkbox-module_container__aV9qz {
  margin-bottom: 0;
}

.checkbox span.Checkbox-module_empty-label__OKclI {
  margin: 0;
}
`);const km=N.forwardRef((e,r)=>{const{label:n,value:t,onChange:o,className:f,...l}=e;return G.jsxs("label",{className:["checkbox",fc.container].join(" "),children:[G.jsx("input",{...l,ref:r,className:f,type:"checkbox",checked:t,onChange:g=>o==null?void 0:o(g.target.checked)}),G.jsx("span",n?{children:n}:{className:fc["empty-label"]})]})});km.displayName="Checkbox";const Pm=N.forwardRef((e,r)=>{const{className:n,...t}=e;return G.jsx("hr",{...t,ref:r,className:n})});function Sm(e){switch(e){case"small":return"form-group-small";case"medium":return"form-group"}}function Fm(e){return e?"form-group__disabled":""}Pm.displayName="Divider";const Bm=N.forwardRef((e,r)=>{const{size:n="medium",status:t,isDisabled:o,className:f,children:l,...g}=e,d=[Sm(n),Fm(o),t,f].filter(ye);return G.jsx("div",{...g,ref:r,className:d.join(" "),children:l})});Bm.displayName="FormGroup";var Dm={xxsmall:"Icon-module_xxsmall__pOzU3",xsmall:"Icon-module_xsmall__tQp11",small:"Icon-module_small__mDMog",medium:"Icon-module_medium__P78uD",large:"Icon-module_large__95dqp",xlarge:"Icon-module_xlarge__w4sTG",xxlarge:"Icon-module_xxlarge__aiAIs"};Ge(`.Icon-module_xxsmall__pOzU3 {
  background-size: calc(var(--icon-size) / 3);
  height: calc(var(--icon-size) / 3);
  width: calc(var(--icon-size) / 3);
}

.Icon-module_xsmall__tQp11 {
  background-size: calc(var(--icon-size) / 2);
  height: calc(var(--icon-size) / 2);
  width: calc(var(--icon-size) / 2);
}

.Icon-module_small__mDMog {
  background-size: calc(var(--icon-size) / 1.5);
  height: calc(var(--icon-size) / 1.5);
  width: calc(var(--icon-size) / 1.5);
}

.Icon-module_medium__P78uD {
  background-size: var(--icon-size);
  height: var(--icon-size);
  width: var(--icon-size);
}

.Icon-module_large__95dqp {
  background-size: calc(var(--icon-size) * 1.5);
  height: calc(var(--icon-size) * 1.5);
  width: calc(var(--icon-size) * 1.5);
}

.Icon-module_xlarge__w4sTG {
  background-size: calc(var(--icon-size) * 2);
  height: calc(var(--icon-size) * 2);
  width: calc(var(--icon-size) * 2);
}

.Icon-module_xxlarge__aiAIs {
  background-size: calc(var(--icon-size) * 3);
  height: calc(var(--icon-size) * 3);
  width: calc(var(--icon-size) * 3);
}
`);const _a=N.forwardRef((e,r)=>{const{size:n="medium",name:t,className:o,...f}=e,l=["icon",`icon-${t}`,Dm[n],o].filter(ye);return G.jsx("span",{...f,ref:r,className:l.join(" ")})});_a.displayName="Icon";function Vm(e){switch(e){case"small":return"input-small";case"medium":return""}}function Gm(e){return e?"border-left":""}function Wm(e){return e?"border-right":""}function Xl(e){switch(e){case"1/4":return"one-fourth";case"2/4":return"two-fourth";case"3/4":return"three-fourth";case"4/4":return""}}const Hm=N.forwardRef((e,r)=>{const{value:n,onChange:t,size:o="medium",isDisabled:f=!1,isReadOnly:l=!1,flexModifier:g="4/4",className:d,...c}=e,i=["input",d,Vm(o),Xl(g)].filter(ye);return G.jsx("input",{ref:r,...c,className:i.join(" "),value:n,onChange:a=>t==null?void 0:t(a.target.value),disabled:f,readOnly:l})});Hm.displayName="Input";const $m=N.forwardRef((e,r)=>{const{className:n,children:t,borderLeft:o=!1,borderRight:f=!1,flexModifier:l="4/4",...g}=e,d=["input-decoration",Gm(o),Wm(f),Xl(l),n].filter(ye);return G.jsx("span",{ref:r,...g,className:d.join(" "),children:t})});$m.displayName="InputDecoration";const qm=N.forwardRef((e,r)=>{const{className:n,children:t,...o}=e,f=["input-group",n].filter(ye);return G.jsx("div",{ref:r,...o,className:f.join(" "),children:t})});qm.displayName="InputGroup";const zm=N.forwardRef((e,r)=>{const{className:n,children:t,...o}=e;return G.jsx("label",{...o,ref:r,className:n,children:t})});zm.displayName="InputLabel";const Km=N.forwardRef((e,r)=>{const{className:n,children:t,...o}=e,f=["status-text",n].filter(ye);return G.jsx("div",{ref:r,...o,className:f.join(" "),children:t})});Km.displayName="InputStatusText";const Ym=N.forwardRef((e,r)=>{const{className:n,children:t,variant:o="info",...f}=e,l=["label",`label-${o}`,n].filter(ye);return G.jsx("span",{...f,ref:r,className:l.join(" "),children:t})});Ym.displayName="Label";const Xm=N.forwardRef((e,r)=>{const{className:n,children:t,variant:o="info",...f}=e,l=["link",`link-${o}`,n].filter(ye);return G.jsx("a",{...f,ref:r,className:l.join(" "),children:t})});Xm.displayName="Link";var dc={container:"RadioButton-module_container__6QkHV","empty-label":"RadioButton-module_empty-label__ykvRF"};Ge(`.RadioButton-module_container__6QkHV {
  margin-bottom: 0;
}

.radiobutton span.RadioButton-module_empty-label__ykvRF {
  margin: 0;
}
`);const Qm=N.forwardRef((e,r)=>{const{label:n,value:t,onChange:o,className:f,...l}=e;return G.jsxs("label",{className:["radiobutton",dc.container].join(" "),children:[G.jsx("input",{...l,ref:r,className:f,type:"radio",checked:t,onChange:g=>o==null?void 0:o(g.target.checked)}),G.jsx("span",n?{children:n}:{className:dc["empty-label"]})]})});function Zm(e){switch(e){case"small":return"select-small";case"medium":return""}}Qm.displayName="RadioButton";const Jm=N.forwardRef((e,r)=>{const{value:n,onChange:t,size:o="medium",isDisabled:f=!1,className:l,...g}=e,d=["select",Zm(o),l].filter(ye);return G.jsx("select",{...g,ref:r,className:d.join(" "),value:n,onChange:c=>t==null?void 0:t(c.target.value),disabled:f,children:e.children})});Jm.displayName="Select";const jm=N.forwardRef((e,r)=>{const{className:n,...t}=e;return G.jsx("option",{...t,ref:r,className:n,children:e.children})});jm.displayName="SelectOption";var yi={spinner:"Spinner-module_spinner__GpFZS",spin:"Spinner-module_spin__LFfLH","spinner-small":"Spinner-module_spinner-small__Zfd0D","spinner-medium":"Spinner-module_spinner-medium__sX5Is","spinner-large":"Spinner-module_spinner-large__DIjyj",circle:"Spinner-module_circle__zdwi7",animate:"Spinner-module_animate__FmeJ9",circleAnimation:"Spinner-module_circleAnimation__6o-Ny"};function eg(e){switch(e){case"small":return"spinner-small";case"medium":return"spinner-medium";case"large":return"spinner-large"}}Ge(`.Spinner-module_spinner__GpFZS {
  display: block;
  animation: 2s linear 0s infinite normal none running Spinner-module_spin__LFfLH;
  transform-origin: center center;
  stroke: currentcolor;
  color: var(--spinner-color);
}

.Spinner-module_spinner-small__Zfd0D {
  width: calc(var(--icon-size) / 1.5);
  height: calc(var(--icon-size) / 1.5);
}

.Spinner-module_spinner-medium__sX5Is {
  width: var(--icon-size);
  height: var(--icon-size);
}

.Spinner-module_spinner-large__DIjyj {
  width: calc(var(--icon-size) * 1.5);
  height: calc(var(--icon-size) * 1.5);
}

@keyframes Spinner-module_spin__LFfLH {
  100% {
    transform: rotate(360deg);
  }
}

.Spinner-module_circle__zdwi7 {
  stroke-width: 4;
  fill: none;
  stroke-miterlimit: 10;
  stroke-dasharray: 89, 200;
  stroke-dashoffset: 0;
  animation: 1.5s ease-in-out 0s infinite normal none running Spinner-module_animate__FmeJ9;
  stroke-linecap: round;
}

@media (prefers-reduced-motion: no-preference) {

.Spinner-module_circle__zdwi7 {
    animation-name: Spinner-module_circleAnimation__6o-Ny;
}
  }

@keyframes Spinner-module_circleAnimation__6o-Ny {
  0% {
    stroke-dasharray: 1, 200;
    stroke-dashoffset: 0;
  }
  50% {
    stroke-dasharray: 89, 200;
    stroke-dashoffset: -35px;
  }
  100% {
    stroke-dasharray: 89, 200;
    stroke-dashoffset: -124px;
  }
}
`);const Ql=N.forwardRef((e,r)=>{const{className:n,spinnerColor:t="var(--indigo700)",size:o="medium",style:f={}}=e,l=[yi.spinner,yi[eg(o)],n];return G.jsx("svg",{ref:r,role:"progressbar",className:l.join(" "),viewBox:"25 25 50 50",style:{...f,"--spinner-color":t},children:G.jsx("circle",{className:yi.circle,cx:"50",cy:"50",r:"20"})})});function tg(e){return e?"":"table__no-sticky-headers"}Ql.displayName="Spinner";const ng=N.forwardRef((e,r)=>{const{className:n,children:t,headIsSticky:o=!0,...f}=e,l=["table",tg(o),n];return G.jsx("table",{...f,ref:r,className:l.join(" "),children:t})});ng.displayName="Table";const rg=N.forwardRef((e,r)=>{const{className:n,children:t,...o}=e;return G.jsx("thead",{...o,ref:r,className:n,children:t})});rg.displayName="TableHead";const og=N.forwardRef((e,r)=>{const{className:n,children:t,...o}=e;return G.jsx("th",{...o,ref:r,className:n,children:t})});og.displayName="TableHeadCell";const ig=N.forwardRef((e,r)=>{const{className:n,children:t,...o}=e;return G.jsx("tbody",{...o,ref:r,className:n,children:t})});ig.displayName="TableBody";const ag=N.forwardRef((e,r)=>{const{className:n,children:t,...o}=e;return G.jsx("td",{...o,ref:r,className:n,children:t})});ag.displayName="TableCell";const sg=N.forwardRef((e,r)=>{const{className:n,children:t,...o}=e;return G.jsx("tr",{...o,ref:r,className:n,children:t})});sg.displayName="TableRow";const cg=N.forwardRef((e,r)=>{const{className:n,tabs:t,activeIndex:o,onClick:f,...l}=e,g=["tabs",n].filter(ye);return G.jsx("div",{...l,ref:r,className:g.join(" "),children:G.jsx("div",{className:"tabs-header-list",children:t.map((d,c)=>{const i=["tab",(a=o===c,a?"tab-active":""),n].filter(ye);var a;const s=["tab-text",d.badge?"tab-badge":void 0].filter(ye);return G.jsx("div",{className:i.join(" "),tabIndex:0,onClick:()=>f==null?void 0:f(c),children:G.jsx("div",{className:s.join(" "),"data-badge":d.badge,children:d.children})},d.id)})})})});function Zl(e){return e?`icon icon-${e}`:""}cg.displayName="Tabs";const ug=N.forwardRef((e,r)=>{const{icon:n,textColor:t="var(--black)",backgroundColor:o="var(--indigo50)",className:f,children:l,style:g={},...d}=e,c=["tag",Zl(n),f].filter(ye);return G.jsx("a",{...d,ref:r,className:c.join(" "),style:{...g,"--color":t,"--background":o},children:l})});ug.displayName="LinkTag";const lg=N.forwardRef((e,r)=>{const{icon:n,textColor:t="var(--black)",backgroundColor:o="var(--indigo50)",className:f,children:l,...g}=e,d=["tag",Zl(n),f].filter(ye);return G.jsx("span",{...g,ref:r,className:d.join(" "),style:{"--color":t,"--background":o},children:l})});lg.displayName="Tag";const fg=N.forwardRef((e,r)=>{const{icon:n,className:t,...o}=e,f=["icon",`icon-${n}`,t].filter(ye);return G.jsx("button",{...o,type:"button",ref:r,className:f.join(" ")})});fg.displayName="TagButton";const dg=N.forwardRef((e,r)=>{const{className:n,...t}=e,o=["tag-image",n].filter(ye);return G.jsx("img",{...t,ref:r,className:o.join(" ")})});function hg(e){switch(e){case"small":return"textarea-small";case"medium":return""}}dg.displayName="TagImage";const pg=N.forwardRef((e,r)=>{const{value:n,onChange:t,size:o="medium",isDisabled:f=!1,isReadOnly:l=!1,className:g,...d}=e,c=["textarea",g,hg(o)].filter(ye);return G.jsx("textarea",{ref:r,...d,className:c.join(" "),onChange:i=>t==null?void 0:t(i.target.value),disabled:f,readOnly:l})});pg.displayName="TextArea";var hc={container:"Toggle-module_container__ftUHq","empty-label":"Toggle-module_empty-label__4ncg-"};Ge(`.Toggle-module_container__ftUHq {
  margin-bottom: 0;
}

.toggle span.Toggle-module_empty-label__4ncg- {
  padding: 0;
}
`);const vg=N.forwardRef((e,r)=>{const{label:n,value:t,onChange:o,className:f,...l}=e;return G.jsxs("label",{className:["toggle",hc.container].join(" "),children:[G.jsx("input",{...l,ref:r,className:f,type:"checkbox",checked:t,onChange:g=>o==null?void 0:o(g.target.checked)}),G.jsx("span",n?{children:n}:{className:hc["empty-label"]})]})});vg.displayName="Toggle";var mg="DropdownButton-module_icon__Z24l-";Ge(`.DropdownButton-module_icon__Z24l- {
  pointer-events: none;
}
`);const gg=N.forwardRef((e,r)=>{const{children:n,...t}=e;return G.jsxs(Yl,{ref:r,...t,children:[n,G.jsx(_a,{name:"arrow-down",className:mg})]})});gg.displayName="DropdownButton";var Eg={divider:"DropdownDivider-module_divider__utvAL"};Ge(`.DropdownDivider-module_divider__utvAL {
  margin: var(--space-xxsmall) 0;
}
`);const yg=N.forwardRef((e,r)=>{const{className:n,...t}=e,o=[Eg.divider,n].filter(ye);return G.jsx("hr",{...t,ref:r,className:o.join(" ")})});yg.displayName="DropdownDivider";var wg={"menu-item":"DropdownItem-module_menu-item__HkFBl"};Ge(`.DropdownItem-module_menu-item__HkFBl {
  padding: var(--space-xsmall) var(--space-small);
}

.DropdownItem-module_menu-item__HkFBl:hover {
  background-color: var(--blue100);
  cursor: pointer;
}

.DropdownItem-module_menu-item__HkFBl:focus-visible {
  outline: none;
}
`);const Rg=N.forwardRef((e,r)=>{const{className:n,disableCloseOnSelect:t=!1,onSelect:o,...f}=e,l=[wg["menu-item"],n].filter(ye);return G.jsx(Rm,{className:l.join(" "),...f,ref:r,onSelect:g=>{t&&g.preventDefault(),o==null||o()}})});Rg.displayName="DropdownItem";var pc={badge:"DismissableBadge-module_badge__NiWYc","close-button":"DismissableBadge-module_close-button__-TAbm"};Ge(`.DismissableBadge-module_badge__NiWYc {
  display: flex;
  align-items: center;
  gap: var(--space-xsmall);
  padding: var(--space-xsmall) var(--space-xsmall) var(--space-xsmall) calc(var(--space-xsmall) * 1.5);
  border: var(--border);
  border-radius: var(--border-radius);
  background-color: var(--background-color);
  color: var(--color);
}

.DismissableBadge-module_close-button__-TAbm {
  border-radius: var(--border-radius);
  height: unset;
  padding: var(--space-xxsmall);
  background-color: unset;
  border: none;
}

.DismissableBadge-module_close-button__-TAbm:hover {
    background-color: var(--hover-background-color);
    cursor: pointer;
  }

.DismissableBadge-module_close-button__-TAbm span.icon-close {
    background-size: calc(var(--icon-size) / 1.25);
    height: calc(var(--icon-size) / 1.25);
    width: calc(var(--icon-size) / 1.25);
    pointer-events: none;
    filter: var(--icon-filter);
  }
`);const ct={color:{primaryText:"var(--primary-text-color)",primaryActionColor:"var(--primary-action-color)",blue:{300:"var(--blue300)",600:"var(--blue600)"},indigo:{50:"var(--indigo50)",300:"var(--indigo300)"},white:"var(--white)"},typography:{fontSize:{small:"var(--font-size-small)",medium:"var(--font-size-medium)",large:"var(--font-size-large)",xlarge:"var(--font-size-xlarge)",xxlarge:"var(--font-size-xxlarge)",xxxlarge:"var(--font-size-xxxlarge)"}},borderRadius:{medium:"var(--border-radius-medium)",xxlarge:"var(--border-radius-xxlarge)"}};function Ng(e){return e?ct.borderRadius.xxlarge:ct.borderRadius.medium}function Tg(e){switch(e){case"primary":return ct.color.white;case"secondary":return ct.color.indigo[50]}}function Ag(e){switch(e){case"primary":return`1.5px solid ${ct.color.blue[600]}`;case"secondary":return"none"}}function Cg(e){switch(e){case"primary":return ct.color.primaryActionColor;case"secondary":return ct.color.primaryText}}function Og(e){return e?ct.borderRadius.xxlarge:ct.borderRadius.medium}function Ig(e){switch(e){case"primary":return ct.color.blue[300];case"secondary":return ct.color.indigo[300]}}function _g(e){switch(e){case"primary":return"brightness(0) saturate(100%) invert(47%) sepia(74%) saturate(5653%) hue-rotate(221deg) brightness(98%) contrast(106%)";case"secondary":return"brightness(0) saturate(100%) invert(38%) sepia(8%) saturate(1583%) hue-rotate(206deg) brightness(92%) contrast(88%)"}}const Mg=N.forwardRef((e,r)=>{const{className:n,children:t,rounded:o=!1,variant:f="primary",onClose:l,style:g,...d}=e,c=[pc.badge,"p-medium",n].filter(ye);return G.jsxs("div",{...d,ref:r,className:c.join(" "),style:{...g,"--border-radius":Ng(o),"--background-color":Tg(f),"--border":Ag(f),"--color":Cg(f)},children:[t,G.jsx("button",{className:pc["close-button"],style:{"--border-radius":Og(o),"--hover-background-color":Ig(f),"--icon-filter":_g(f)},onClick:l,children:G.jsx(_a,{name:"close"})})]})});Mg.displayName="DismissableBadge";const xg=N.forwardRef((e,r)=>N.createElement(mt.span,pe({},e,{ref:r,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}))),[Oo,LE]=kn("Tooltip",[Ao]),Io=Ao(),bg=700,Qi="tooltip.open",[Lg,Ma]=Oo("TooltipProvider"),Ug=e=>{const{__scopeTooltip:r,delayDuration:n=bg,skipDelayDuration:t=300,disableHoverableContent:o=!1,children:f}=e,[l,g]=N.useState(!0),d=N.useRef(!1),c=N.useRef(0);return N.useEffect(()=>{const i=c.current;return()=>window.clearTimeout(i)},[]),N.createElement(Lg,{scope:r,isOpenDelayed:l,delayDuration:n,onOpen:N.useCallback(()=>{window.clearTimeout(c.current),g(!1)},[]),onClose:N.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>g(!0),t)},[t]),isPointerInTransitRef:d,onPointerInTransitChange:N.useCallback(i=>{d.current=i},[]),disableHoverableContent:o},f)},xa="Tooltip",[kg,dr]=Oo(xa),vc="TooltipTrigger",Pg=N.forwardRef((e,r)=>{const{__scopeTooltip:n,...t}=e,o=dr(vc,n),f=Ma(vc,n),l=Io(n),g=nt(r,N.useRef(null),o.onTriggerChange),d=N.useRef(!1),c=N.useRef(!1),i=N.useCallback(()=>d.current=!1,[]);return N.useEffect(()=>()=>document.removeEventListener("pointerup",i),[i]),N.createElement(Ol,pe({asChild:!0},l),N.createElement(mt.button,pe({"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute},t,{ref:g,onPointerMove:Re(e.onPointerMove,a=>{a.pointerType!=="touch"&&(c.current||f.isPointerInTransitRef.current||(o.onTriggerEnter(),c.current=!0))}),onPointerLeave:Re(e.onPointerLeave,()=>{o.onTriggerLeave(),c.current=!1}),onPointerDown:Re(e.onPointerDown,()=>{d.current=!0,document.addEventListener("pointerup",i,{once:!0})}),onFocus:Re(e.onFocus,()=>{d.current||o.onOpen()}),onBlur:Re(e.onBlur,o.onClose),onClick:Re(e.onClick,o.onClose)})))}),Jl="TooltipPortal",[Sg,Fg]=Oo(Jl,{forceMount:void 0}),Jn="TooltipContent",Bg=N.forwardRef((e,r)=>{const n=Fg(Jn,e.__scopeTooltip),{forceMount:t=n.forceMount,side:o="top",...f}=e,l=dr(Jn,e.__scopeTooltip);return N.createElement(ur,{present:t||l.open},l.disableHoverableContent?N.createElement(jl,pe({side:o},f,{ref:r})):N.createElement(Dg,pe({side:o},f,{ref:r})))}),Dg=N.forwardRef((e,r)=>{const n=dr(Jn,e.__scopeTooltip),t=Ma(Jn,e.__scopeTooltip),o=N.useRef(null),f=nt(r,o),[l,g]=N.useState(null),{trigger:d,onClose:c}=n,i=o.current,{onPointerInTransitChange:a}=t,s=N.useCallback(()=>{g(null),a(!1)},[a]),u=N.useCallback((v,h)=>{const p=v.currentTarget,m={x:v.clientX,y:v.clientY},E=function(w,T,R=5){const A=[];switch(T){case"top":A.push({x:w.x-R,y:w.y+R},{x:w.x+R,y:w.y+R});break;case"bottom":A.push({x:w.x-R,y:w.y-R},{x:w.x+R,y:w.y-R});break;case"left":A.push({x:w.x+R,y:w.y-R},{x:w.x+R,y:w.y+R});break;case"right":A.push({x:w.x-R,y:w.y-R},{x:w.x-R,y:w.y+R})}return A}(m,function(w,T){const R=Math.abs(T.top-w.y),A=Math.abs(T.bottom-w.y),O=Math.abs(T.right-w.x),M=Math.abs(T.left-w.x);switch(Math.min(R,A,O,M)){case M:return"left";case O:return"right";case R:return"top";case A:return"bottom";default:throw new Error("unreachable")}}(m,p.getBoundingClientRect())),y=function(w){const T=w.slice();return T.sort((R,A)=>R.x<A.x?-1:R.x>A.x?1:R.y<A.y?-1:R.y>A.y?1:0),function(R){if(R.length<=1)return R.slice();const A=[];for(let M=0;M<R.length;M++){const b=R[M];for(;A.length>=2;){const k=A[A.length-1],F=A[A.length-2];if(!((k.x-F.x)*(b.y-F.y)>=(k.y-F.y)*(b.x-F.x)))break;A.pop()}A.push(b)}A.pop();const O=[];for(let M=R.length-1;M>=0;M--){const b=R[M];for(;O.length>=2;){const k=O[O.length-1],F=O[O.length-2];if(!((k.x-F.x)*(b.y-F.y)>=(k.y-F.y)*(b.x-F.x)))break;O.pop()}O.push(b)}return O.pop(),A.length===1&&O.length===1&&A[0].x===O[0].x&&A[0].y===O[0].y?A:A.concat(O)}(T)}([...E,...function(w){const{top:T,right:R,bottom:A,left:O}=w;return[{x:O,y:T},{x:R,y:T},{x:R,y:A},{x:O,y:A}]}(h.getBoundingClientRect())]);g(y),a(!0)},[a]);return N.useEffect(()=>()=>s(),[s]),N.useEffect(()=>{if(d&&i){const v=p=>u(p,i),h=p=>u(p,d);return d.addEventListener("pointerleave",v),i.addEventListener("pointerleave",h),()=>{d.removeEventListener("pointerleave",v),i.removeEventListener("pointerleave",h)}}},[d,i,u,s]),N.useEffect(()=>{if(l){const v=h=>{const p=h.target,m={x:h.clientX,y:h.clientY},E=(d==null?void 0:d.contains(p))||(i==null?void 0:i.contains(p)),y=!function(w,T){const{x:R,y:A}=w;let O=!1;for(let M=0,b=T.length-1;M<T.length;b=M++){const k=T[M].x,F=T[M].y,$=T[b].x,Y=T[b].y;F>A!=Y>A&&R<($-k)*(A-F)/(Y-F)+k&&(O=!O)}return O}(m,l);E?s():y&&(s(),c())};return document.addEventListener("pointermove",v),()=>document.removeEventListener("pointermove",v)}},[d,i,l,c,s]),N.createElement(jl,pe({},e,{ref:f}))}),[Vg,Gg]=Oo(xa,{isInside:!1}),jl=N.forwardRef((e,r)=>{const{__scopeTooltip:n,children:t,"aria-label":o,onEscapeKeyDown:f,onPointerDownOutside:l,...g}=e,d=dr(Jn,n),c=Io(n),{onClose:i}=d;return N.useEffect(()=>(document.addEventListener(Qi,i),()=>document.removeEventListener(Qi,i)),[i]),N.useEffect(()=>{if(d.trigger){const a=s=>{const u=s.target;u!=null&&u.contains(d.trigger)&&i()};return window.addEventListener("scroll",a,{capture:!0}),()=>window.removeEventListener("scroll",a,{capture:!0})}},[d.trigger,i]),N.createElement(ll,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:f,onPointerDownOutside:l,onFocusOutside:a=>a.preventDefault(),onDismiss:i},N.createElement(Il,pe({"data-state":d.stateAttribute},c,g,{ref:r,style:{...g.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"}}),N.createElement(al,null,t),N.createElement(Vg,{scope:n,isInside:!0},N.createElement(xg,{id:d.contentId,role:"tooltip"},o||t))))}),Wg=e=>{const{__scopeTooltip:r,children:n,open:t,defaultOpen:o=!1,onOpenChange:f,disableHoverableContent:l,delayDuration:g}=e,d=Ma(xa,e.__scopeTooltip),c=Io(r),[i,a]=N.useState(null),s=eo(),u=N.useRef(0),v=l??d.disableHoverableContent,h=g??d.delayDuration,p=N.useRef(!1),[m=!1,E]=Ea({prop:t,defaultProp:o,onChange:A=>{A?(d.onOpen(),document.dispatchEvent(new CustomEvent(Qi))):d.onClose(),f==null||f(A)}}),y=N.useMemo(()=>m?p.current?"delayed-open":"instant-open":"closed",[m]),w=N.useCallback(()=>{window.clearTimeout(u.current),p.current=!1,E(!0)},[E]),T=N.useCallback(()=>{window.clearTimeout(u.current),E(!1)},[E]),R=N.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>{p.current=!0,E(!0)},h)},[h,E]);return N.useEffect(()=>()=>window.clearTimeout(u.current),[]),N.createElement(Cl,c,N.createElement(kg,{scope:r,contentId:s,open:m,stateAttribute:y,trigger:i,onTriggerChange:a,onTriggerEnter:N.useCallback(()=>{d.isOpenDelayed?R():w()},[d.isOpenDelayed,R,w]),onTriggerLeave:N.useCallback(()=>{v?T():window.clearTimeout(u.current)},[T,v]),onOpen:w,onClose:T,disableHoverableContent:v},n))},Hg=Pg,$g=e=>{const{__scopeTooltip:r,forceMount:n,children:t,container:o}=e,f=dr(Jl,r);return N.createElement(Sg,{scope:r,forceMount:n},N.createElement(ur,{present:n||f.open},N.createElement(_l,{asChild:!0,container:o},t)))},qg=Bg,zg=N.forwardRef((e,r)=>{const{__scopeTooltip:n,...t}=e,o=Io(n);return Gg("TooltipArrow",n).isInside?null:N.createElement(Tv,pe({},o,t,{ref:r}))});var Kg={content:"Tooltip-module_content__puu8c"};Ge(`.Tooltip-module_content__puu8c {
  color: var(--white);
  background-color: var(--black);
  padding: 10px;
  border-radius: var(--space-xxsmall);
}
`);const Yg=N.forwardRef((e,r)=>{const{delayDuration:n=500,disableCloseOnOutside:t=!1,trigger:o,open:f,onOpenChange:l,size:g="medium",children:d,className:c,...i}=e,a=[Kg.content,`p-${g}`,c].filter(ye);return G.jsx(Ug,{delayDuration:n,children:G.jsxs(Wg,{onOpenChange:l,open:f,children:[G.jsx(Hg,{asChild:!0,children:o}),G.jsx($g,{children:G.jsxs(qg,{...i,className:a.join(" "),ref:r,onPointerDownOutside:s=>{t&&s.preventDefault()},children:[d,G.jsx(zg,{})]})})]})})});Yg.displayName="Tooltip";const Xg=N.forwardRef((e,r)=>{const{className:n,children:t,...o}=e,f=["centered",n].filter(ye);return G.jsx("div",{...o,ref:r,className:f.join(" "),children:t})});Xg.displayName="Centered";var Pt={flex:"Flex-module_flex__2ZbG8","align-content":"Flex-module_align-content__kSz6F","align-items":"Flex-module_align-items__mWuQZ","column-gap":"Flex-module_column-gap__61s52","flex-direction":"Flex-module_flex-direction__zt-FE","flex-flow":"Flex-module_flex-flow__eOs9U","flex-wrap":"Flex-module_flex-wrap__N3vns",gap:"Flex-module_gap__IxNhW","justify-content":"Flex-module_justify-content__syvR6","row-gap":"Flex-module_row-gap__0EHtg"};function Qg(e){return e?Pt["align-content"]:""}function Zg(e){return e?Pt["align-items"]:""}function Jg(e){return e?Pt["column-gap"]:""}function jg(e){return e?Pt["flex-direction"]:""}function e1(e){return e?Pt["flex-flow"]:""}function t1(e){return e?Pt["flex-wrap"]:""}function n1(e){return e?Pt.gap:""}function r1(e){return e?Pt["justify-content"]:""}function o1(e){return e?Pt["row-gap"]:""}Ge(`.Flex-module_flex__2ZbG8 {
  display: flex;
}

.Flex-module_align-content__kSz6F {
  align-content: var(--align-content);
}

.Flex-module_align-items__mWuQZ {
  align-items: var(--align-items);
}

.Flex-module_column-gap__61s52 {
  -moz-column-gap: var(--column-gap);
       column-gap: var(--column-gap);
}

.Flex-module_flex-direction__zt-FE {
  flex-direction: var(--flex-direction);
}

.Flex-module_flex-flow__eOs9U {
  flex-flow: var(--flex-flow);
}

.Flex-module_flex-wrap__N3vns {
  flex-wrap: var(--flex-wrap);
}

.Flex-module_gap__IxNhW {
  gap: var(--gap);
}

.Flex-module_justify-content__syvR6 {
  justify-content: var(--justify-content);
}

.Flex-module_row-gap__0EHtg {
  row-gap: var(--row-gap);
}
`);const i1=N.forwardRef((e,r)=>{const{className:n,alignContent:t,alignItems:o,columnGap:f,flexDirection:l,flexFlow:g,flexWrap:d,gap:c,justifyContent:i,rowGap:a,style:s={},...u}=e,v=[Pt.flex,Qg(t),Zg(o),Jg(f),jg(l),e1(g),t1(d),n1(c),r1(i),o1(a),n].filter(ye);let h={...s};return t!==void 0&&(h={...h,"--align-content":t}),o!==void 0&&(h={...h,"--align-items":o}),f!==void 0&&(h={...h,"--column-gap":f}),l!==void 0&&(h={...h,"--flex-direction":l}),g!==void 0&&(h={...h,"--flex-flow":g}),d!==void 0&&(h={...h,"--flex-wrap":d}),c!==void 0&&(h={...h,"--gap":c}),i!==void 0&&(h={...h,"--justify-content":i}),a!==void 0&&(h={...h,"--row-gap":a}),G.jsx("div",{...u,ref:r,className:v.join(" "),style:h})});i1.displayName="Flex";const a1=N.forwardRef((e,r)=>{const{className:n,children:t,...o}=e,f=["grid",n].filter(ye);return G.jsx("div",{...o,ref:r,className:f.join(" "),children:t})});a1.displayName="Grid";const s1=N.forwardRef((e,r)=>{const{className:n,children:t,colStart:o,colEnd:f,...l}=e,g=[`cs${o}`,`ce${f}`,n].filter(ye);return G.jsx("div",{...l,ref:r,className:g.join(" "),children:t})});s1.displayName="GridItem";var c1={heading:"Heading-module_heading__MEFIt"};Ge(`.Heading-module_heading__MEFIt {
  color: var(--font-color);
}
`);const u1=N.forwardRef((e,r)=>{const{className:n,children:t,level:o=1,fontColor:f,style:l={},...g}=e,d=[`h${o}`,c1.heading,n].filter(ye);let c={...l};switch(f!==void 0&&(c={...c,"--font-color":f}),o){case 1:return G.jsx("h1",{...g,ref:r,className:d.join(" "),style:c,children:t});case 2:return G.jsx("h2",{...g,ref:r,className:d.join(" "),style:c,children:t});case 3:return G.jsx("h3",{...g,ref:r,className:d.join(" "),style:c,children:t});case 4:return G.jsx("h4",{...g,ref:r,className:d.join(" "),style:c,children:t})}});u1.displayName="Heading";var l1={paragraph:"Paragraph-module_paragraph__EOOM8"};Ge(`.Paragraph-module_paragraph__EOOM8 {
  font-size: var(--font-size);
  font-weight: var(--font-weight);
  color: var(--font-color);
}
`);const f1=N.forwardRef((e,r)=>{const{className:n,children:t,size:o="medium",fontWeight:f,fontColor:l,style:g={},...d}=e,c=[l1.paragraph,n].filter(ye);let i={...g};return i={...i,"--font-size":ct.typography.fontSize[o]},f!==void 0&&(i={...i,"--font-weight":f}),l!==void 0&&(i={...i,"--font-color":l}),console.log("paragraphStyle",i),G.jsx("p",{...d,ref:r,className:c.join(" "),style:i,children:t})});f1.displayName="Paragraph";var d1={text:"Text-module_text__7yIVD"};Ge(`.Text-module_text__7yIVD {
  font-size: var(--font-size);
  font-weight: var(--font-weight);
  color: var(--font-color);
}
`);const h1=N.forwardRef((e,r)=>{const{className:n,children:t,size:o="medium",fontWeight:f,fontColor:l,style:g={},...d}=e,c=[d1.text,n].filter(ye);let i={...g};return i={...i,"--font-size":ct.typography.fontSize[o]},f!==void 0&&(i={...i,"--font-weight":f}),l!==void 0&&(i={...i,"--font-color":l}),G.jsx("span",{...d,ref:r,className:c.join(" "),style:i,children:t})});h1.displayName="Text";function UE(){return G.jsx("div",{style:{position:"fixed",width:"100%",height:"100%",top:0,left:0,zIndex:1e3,background:"rgba(0, 0, 0, .5)"},children:G.jsx(Ql,{size:"large",spinnerColor:"var(--whiteAlpha80)",style:{position:"absolute",top:"50%",left:"50%"}})})}const p1=e=>e.message?e.message:e.error?e.error.message:"Unexpected error.";function kE(){const e=N.useContext(il);if(!e)throw new Error("MessageContext is not provided");const{message:r,setMessage:n}=e;N.useEffect(()=>{var l;(r!=null&&r.message||r!=null&&r.error)&&((l=t.current)==null||l.showModal())},[r]);const t=N.useRef(null),o=N.useRef(null),f=l=>{var g,d;(g=o.current)!=null&&g.contains(l.target)||(n({}),(d=t.current)==null||d.close())};return G.jsx(G.Fragment,{children:((r==null?void 0:r.message)||(r==null?void 0:r.error))&&G.jsx("div",{children:G.jsx("dialog",{ref:t,onClick:f,children:G.jsx("div",{ref:o,children:p1(r)})})})})}const v1=N.memo(({column:e,label:r,updateLabel:n})=>{const[t,o]=N.useState((r==null?void 0:r.toString())||String.fromCharCode(e+65)),[f,l]=N.useState(!1),[g,d]=N.useState(!1),c=N.useRef(null),i=()=>{d(!0)},a=N.useCallback(()=>{d(!1)},[]),s=N.useCallback(()=>{l(!0)},[]);N.useEffect(()=>{f&&c.current&&c.current.focus()},[f]);const u=N.useCallback(p=>{o(p.currentTarget.value)},[]),v=N.useCallback(()=>{n(e,t),l(!1)},[n,e,t]),h=N.useCallback(p=>{!g&&p.key==="Enter"?v():p.key==="Backspace"&&(p.preventDefault(),o(t.slice(0,-1)))},[g,t]);return f?G.jsx("th",{className:"Spreadsheet__data-editor",children:G.jsx("input",{ref:c,type:"text",value:t,onKeyDown:h,onChange:u,onBlur:v,onCompositionStart:i,onCompositionEnd:a,size:5})}):G.jsx("th",{onClick:s,className:"Spreadsheet__header",children:G.jsx("span",{children:t})})});function m1(){const e=N.useContext(er);if(!e)throw new Error("ChartDataContext is not provided");const{data:r,columns:n,setData:t,setColumns:o}=e,f=N.useCallback((c,i)=>{const a=[...n];a.length>c?a[c]=i:a.push(i),o(a)},[n]),l=N.useCallback(c=>G.jsx(G.Fragment,{children:G.jsx(v1,{...c,updateLabel:f})}),[f]),g=N.useCallback(()=>{const c=[...n];c.push(String(c.length+1)),o(c)},[n]),d=N.useCallback(()=>{const c=[...n];c.pop(),o(c);const i=c.length;t(r.map(a=>Array.isArray(a)?a.slice(0,i):a))},[n,r]);return G.jsx(G.Fragment,{children:G.jsx("div",{children:r&&n&&G.jsxs("div",{className:"",style:{display:"flex",alignContent:"start"},children:[G.jsx(Fp,{data:r,onChange:t,columnLabels:n,ColumnIndicator:l}),G.jsx("div",{children:G.jsxs("div",{className:"",style:{display:"flex"},children:[G.jsx("button",{className:"button button-secondary button-small",style:{height:30,marginTop:2,marginLeft:4,marginRight:1},"aria-label":"plus",onClick:g,children:G.jsx("span",{className:"icon icon-plus"})}),G.jsx("button",{className:"button button-secondary button-small",style:{height:30,marginTop:2,marginLeft:1,marginRight:15},"aria-label":"minus",onClick:d,children:G.jsx("span",{className:"icon icon-minus"})})]})})]})})})}function g1(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function mc(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,t)}return n}function gc(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?mc(Object(n),!0).forEach(function(t){g1(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mc(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function E1(e,r){if(e==null)return{};var n={},t=Object.keys(e),o,f;for(f=0;f<t.length;f++)o=t[f],!(r.indexOf(o)>=0)&&(n[o]=e[o]);return n}function y1(e,r){if(e==null)return{};var n=E1(e,r),t,o;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(o=0;o<f.length;o++)t=f[o],!(r.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function w1(e,r){return R1(e)||N1(e,r)||T1(e,r)||A1()}function R1(e){if(Array.isArray(e))return e}function N1(e,r){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],t=!0,o=!1,f=void 0;try{for(var l=e[Symbol.iterator](),g;!(t=(g=l.next()).done)&&(n.push(g.value),!(r&&n.length===r));t=!0);}catch(d){o=!0,f=d}finally{try{!t&&l.return!=null&&l.return()}finally{if(o)throw f}}return n}}function T1(e,r){if(e){if(typeof e=="string")return Ec(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ec(e,r)}}function Ec(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function A1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function C1(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function yc(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,t)}return n}function wc(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?yc(Object(n),!0).forEach(function(t){C1(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yc(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function O1(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return function(t){return r.reduceRight(function(o,f){return f(o)},t)}}function Vn(e){return function r(){for(var n=this,t=arguments.length,o=new Array(t),f=0;f<t;f++)o[f]=arguments[f];return o.length>=e.length?e.apply(this,o):function(){for(var l=arguments.length,g=new Array(l),d=0;d<l;d++)g[d]=arguments[d];return r.apply(n,[].concat(o,g))}}}function io(e){return{}.toString.call(e).includes("Object")}function I1(e){return!Object.keys(e).length}function jn(e){return typeof e=="function"}function _1(e,r){return Object.prototype.hasOwnProperty.call(e,r)}function M1(e,r){return io(r)||jt("changeType"),Object.keys(r).some(function(n){return!_1(e,n)})&&jt("changeField"),r}function x1(e){jn(e)||jt("selectorType")}function b1(e){jn(e)||io(e)||jt("handlerType"),io(e)&&Object.values(e).some(function(r){return!jn(r)})&&jt("handlersType")}function L1(e){e||jt("initialIsRequired"),io(e)||jt("initialType"),I1(e)&&jt("initialContent")}function U1(e,r){throw new Error(e[r]||e.default)}var k1={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},jt=Vn(U1)(k1),Ir={changes:M1,selector:x1,handler:b1,initial:L1};function P1(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ir.initial(e),Ir.handler(r);var n={current:e},t=Vn(B1)(n,r),o=Vn(F1)(n),f=Vn(Ir.changes)(e),l=Vn(S1)(n);function g(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(i){return i};return Ir.selector(c),c(n.current)}function d(c){O1(t,o,f,l)(c)}return[g,d]}function S1(e,r){return jn(r)?r(e.current):r}function F1(e,r){return e.current=wc(wc({},e.current),r),r}function B1(e,r,n){return jn(r)?r(e.current):Object.keys(n).forEach(function(t){var o;return(o=r[t])===null||o===void 0?void 0:o.call(r,e.current[t])}),n}var D1={create:P1},V1={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function G1(e){return function r(){for(var n=this,t=arguments.length,o=new Array(t),f=0;f<t;f++)o[f]=arguments[f];return o.length>=e.length?e.apply(this,o):function(){for(var l=arguments.length,g=new Array(l),d=0;d<l;d++)g[d]=arguments[d];return r.apply(n,[].concat(o,g))}}}function W1(e){return{}.toString.call(e).includes("Object")}function H1(e){return e||Rc("configIsRequired"),W1(e)||Rc("configType"),e.urls?($1(),{paths:{vs:e.urls.monacoBase}}):e}function $1(){console.warn(ef.deprecation)}function q1(e,r){throw new Error(e[r]||e.default)}var ef={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},Rc=G1(q1)(ef),z1={config:H1},K1=function(){for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return function(o){return n.reduceRight(function(f,l){return l(f)},o)}};function tf(e,r){return Object.keys(r).forEach(function(n){r[n]instanceof Object&&e[n]&&Object.assign(r[n],tf(e[n],r[n]))}),gc(gc({},e),r)}var Y1={type:"cancelation",msg:"operation is manually canceled"};function wi(e){var r=!1,n=new Promise(function(t,o){e.then(function(f){return r?o(Y1):t(f)}),e.catch(o)});return n.cancel=function(){return r=!0},n}var X1=D1.create({config:V1,isInitialized:!1,resolve:null,reject:null,monaco:null}),nf=w1(X1,2),hr=nf[0],_o=nf[1];function Q1(e){var r=z1.config(e),n=r.monaco,t=y1(r,["monaco"]);_o(function(o){return{config:tf(o.config,t),monaco:n}})}function Z1(){var e=hr(function(r){var n=r.monaco,t=r.isInitialized,o=r.resolve;return{monaco:n,isInitialized:t,resolve:o}});if(!e.isInitialized){if(_o({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),wi(Ri);if(window.monaco&&window.monaco.editor)return rf(window.monaco),e.resolve(window.monaco),wi(Ri);K1(J1,eE)(tE)}return wi(Ri)}function J1(e){return document.body.appendChild(e)}function j1(e){var r=document.createElement("script");return e&&(r.src=e),r}function eE(e){var r=hr(function(t){var o=t.config,f=t.reject;return{config:o,reject:f}}),n=j1("".concat(r.config.paths.vs,"/loader.js"));return n.onload=function(){return e()},n.onerror=r.reject,n}function tE(){var e=hr(function(n){var t=n.config,o=n.resolve,f=n.reject;return{config:t,resolve:o,reject:f}}),r=window.require;r.config(e.config),r(["vs/editor/editor.main"],function(n){rf(n),e.resolve(n)},function(n){e.reject(n)})}function rf(e){hr().monaco||_o({monaco:e})}function nE(){return hr(function(e){var r=e.monaco;return r})}var Ri=new Promise(function(e,r){return _o({resolve:e,reject:r})}),of={config:Q1,init:Z1,__getMonacoInstance:nE},rE={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},Ni=rE,oE={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},iE=oE;function aE({children:e}){return qe.createElement("div",{style:iE.container},e)}var sE=aE,cE=sE;function uE({width:e,height:r,isEditorReady:n,loading:t,_ref:o,className:f,wrapperProps:l}){return qe.createElement("section",{style:{...Ni.wrapper,width:e,height:r},...l},!n&&qe.createElement(cE,null,t),qe.createElement("div",{ref:o,style:{...Ni.fullWidth,...!n&&Ni.hide},className:f}))}var lE=uE,af=N.memo(lE);function fE(e){N.useEffect(e,[])}var sf=fE;function dE(e,r,n=!0){let t=N.useRef(!0);N.useEffect(t.current||!n?()=>{t.current=!1}:e,r)}var rt=dE;function Wn(){}function Cn(e,r,n,t){return hE(e,t)||pE(e,r,n,t)}function hE(e,r){return e.editor.getModel(cf(e,r))}function pE(e,r,n,t){return e.editor.createModel(r,n,t?cf(e,t):void 0)}function cf(e,r){return e.Uri.parse(r)}function vE({original:e,modified:r,language:n,originalLanguage:t,modifiedLanguage:o,originalModelPath:f,modifiedModelPath:l,keepCurrentOriginalModel:g=!1,keepCurrentModifiedModel:d=!1,theme:c="light",loading:i="Loading...",options:a={},height:s="100%",width:u="100%",className:v,wrapperProps:h={},beforeMount:p=Wn,onMount:m=Wn}){let[E,y]=N.useState(!1),[w,T]=N.useState(!0),R=N.useRef(null),A=N.useRef(null),O=N.useRef(null),M=N.useRef(m),b=N.useRef(p),k=N.useRef(!1);sf(()=>{let W=of.init();return W.then(S=>(A.current=S)&&T(!1)).catch(S=>(S==null?void 0:S.type)!=="cancelation"&&console.error("Monaco initialization: error:",S)),()=>R.current?Y():W.cancel()}),rt(()=>{if(R.current&&A.current){let W=R.current.getOriginalEditor(),S=Cn(A.current,e||"",t||n||"text",f||"");S!==W.getModel()&&W.setModel(S)}},[f],E),rt(()=>{if(R.current&&A.current){let W=R.current.getModifiedEditor(),S=Cn(A.current,r||"",o||n||"text",l||"");S!==W.getModel()&&W.setModel(S)}},[l],E),rt(()=>{let W=R.current.getModifiedEditor();W.getOption(A.current.editor.EditorOption.readOnly)?W.setValue(r||""):r!==W.getValue()&&(W.executeEdits("",[{range:W.getModel().getFullModelRange(),text:r||"",forceMoveMarkers:!0}]),W.pushUndoStop())},[r],E),rt(()=>{var W,S;(S=(W=R.current)==null?void 0:W.getModel())==null||S.original.setValue(e||"")},[e],E),rt(()=>{let{original:W,modified:S}=R.current.getModel();A.current.editor.setModelLanguage(W,t||n||"text"),A.current.editor.setModelLanguage(S,o||n||"text")},[n,t,o],E),rt(()=>{var W;(W=A.current)==null||W.editor.setTheme(c)},[c],E),rt(()=>{var W;(W=R.current)==null||W.updateOptions(a)},[a],E);let F=N.useCallback(()=>{var H;if(!A.current)return;b.current(A.current);let W=Cn(A.current,e||"",t||n||"text",f||""),S=Cn(A.current,r||"",o||n||"text",l||"");(H=R.current)==null||H.setModel({original:W,modified:S})},[n,r,o,e,t,f,l]),$=N.useCallback(()=>{var W;!k.current&&O.current&&(R.current=A.current.editor.createDiffEditor(O.current,{automaticLayout:!0,...a}),F(),(W=A.current)==null||W.editor.setTheme(c),y(!0),k.current=!0)},[a,c,F]);N.useEffect(()=>{E&&M.current(R.current,A.current)},[E]),N.useEffect(()=>{!w&&!E&&$()},[w,E,$]);function Y(){var S,H,J,ee;let W=(S=R.current)==null?void 0:S.getModel();g||((H=W==null?void 0:W.original)==null||H.dispose()),d||((J=W==null?void 0:W.modified)==null||J.dispose()),(ee=R.current)==null||ee.dispose()}return qe.createElement(af,{width:u,height:s,isEditorReady:E,loading:i,_ref:O,className:v,wrapperProps:h})}var mE=vE;N.memo(mE);function gE(e){let r=N.useRef();return N.useEffect(()=>{r.current=e},[e]),r.current}var EE=gE,_r=new Map;function yE({defaultValue:e,defaultLanguage:r,defaultPath:n,value:t,language:o,path:f,theme:l="light",line:g,loading:d="Loading...",options:c={},overrideServices:i={},saveViewState:a=!0,keepCurrentModel:s=!1,width:u="100%",height:v="100%",className:h,wrapperProps:p={},beforeMount:m=Wn,onMount:E=Wn,onChange:y,onValidate:w=Wn}){let[T,R]=N.useState(!1),[A,O]=N.useState(!0),M=N.useRef(null),b=N.useRef(null),k=N.useRef(null),F=N.useRef(E),$=N.useRef(m),Y=N.useRef(),W=N.useRef(t),S=EE(f),H=N.useRef(!1),J=N.useRef(!1);sf(()=>{let Z=of.init();return Z.then(I=>(M.current=I)&&O(!1)).catch(I=>(I==null?void 0:I.type)!=="cancelation"&&console.error("Monaco initialization: error:",I)),()=>b.current?D():Z.cancel()}),rt(()=>{var I,_,C,P;let Z=Cn(M.current,e||t||"",r||o||"",f||n||"");Z!==((I=b.current)==null?void 0:I.getModel())&&(a&&_r.set(S,(_=b.current)==null?void 0:_.saveViewState()),(C=b.current)==null||C.setModel(Z),a&&((P=b.current)==null||P.restoreViewState(_r.get(f))))},[f],T),rt(()=>{var Z;(Z=b.current)==null||Z.updateOptions(c)},[c],T),rt(()=>{!b.current||t===void 0||(b.current.getOption(M.current.editor.EditorOption.readOnly)?b.current.setValue(t):t!==b.current.getValue()&&(J.current=!0,b.current.executeEdits("",[{range:b.current.getModel().getFullModelRange(),text:t,forceMoveMarkers:!0}]),b.current.pushUndoStop(),J.current=!1))},[t],T),rt(()=>{var I,_;let Z=(I=b.current)==null?void 0:I.getModel();Z&&o&&((_=M.current)==null||_.editor.setModelLanguage(Z,o))},[o],T),rt(()=>{var Z;g!==void 0&&((Z=b.current)==null||Z.revealLine(g))},[g],T),rt(()=>{var Z;(Z=M.current)==null||Z.editor.setTheme(l)},[l],T);let ee=N.useCallback(()=>{var Z;if(!(!k.current||!M.current)&&!H.current){$.current(M.current);let I=f||n,_=Cn(M.current,t||e||"",r||o||"",I||"");b.current=(Z=M.current)==null?void 0:Z.editor.create(k.current,{model:_,automaticLayout:!0,...c},i),a&&b.current.restoreViewState(_r.get(I)),M.current.editor.setTheme(l),g!==void 0&&b.current.revealLine(g),R(!0),H.current=!0}},[e,r,n,t,o,f,c,i,a,l,g]);N.useEffect(()=>{T&&F.current(b.current,M.current)},[T]),N.useEffect(()=>{!A&&!T&&ee()},[A,T,ee]),W.current=t,N.useEffect(()=>{var Z,I;T&&y&&((Z=Y.current)==null||Z.dispose(),Y.current=(I=b.current)==null?void 0:I.onDidChangeModelContent(_=>{J.current||y(b.current.getValue(),_)}))},[T,y]),N.useEffect(()=>{if(T){let Z=M.current.editor.onDidChangeMarkers(I=>{var C;let _=(C=b.current.getModel())==null?void 0:C.uri;if(_&&I.find(P=>P.path===_.path)){let P=M.current.editor.getModelMarkers({resource:_});w==null||w(P)}});return()=>{Z==null||Z.dispose()}}return()=>{}},[T,w]);function D(){var Z,I;(Z=Y.current)==null||Z.dispose(),s?a&&_r.set(f,b.current.saveViewState()):(I=b.current.getModel())==null||I.dispose(),b.current.dispose()}return qe.createElement(af,{width:u,height:v,isEditorReady:T,loading:d,_ref:k,className:h,wrapperProps:p})}var wE=yE,RE=N.memo(wE),NE=RE;function TE(){const e=N.useContext(er);if(!e)throw new Error("ChartDataContext is not provided");const{spec:r,setSpec:n}=e,[t,o]=N.useState(r);return N.useEffect(()=>{const f=setTimeout(()=>{t&&n(t)},1e3);return()=>clearTimeout(f)},[t]),G.jsx("div",{children:G.jsx("div",{style:{padding:0},children:G.jsx(NE,{height:"90vh",defaultLanguage:"json",defaultValue:"{}",value:t,options:{minimap:{enabled:!1}},onChange:f=>o(f||""),beforeMount:f=>{f.languages.json.jsonDefaults.setDiagnosticsOptions({allowComments:!1,enableSchemaRequest:!0,validate:!0})}})})})}function AE(){const e=N.useId(),r=N.useContext(er);if(!r)throw new Error("ChartDataContext is not provided");const{data:n,columns:t,spec:o}=r,[f,l]=N.useState();return N.useEffect(()=>{e&&t&&n&&o&&(async()=>{try{await new df().showChart(CSS.escape(`vega_${e}`),t,n,o)}catch{l("Vega-Lite specification is invalid.")}})()},[t,n,o]),G.jsx("div",{id:`vega_${e}`,children:f})}const CE=N.memo(()=>G.jsx(AE,{}));function PE(){if(!N.useContext(er))throw new Error("ChartDataContext is not provided");const[r,n]=N.useState("data"),t=N.useCallback(o=>r===o?"tab tab-active":"tab",[r]);return G.jsxs("div",{className:"grid",children:[G.jsxs("div",{className:"cs1 ce6",children:[G.jsxs("div",{className:"tabs",children:[G.jsxs("div",{className:"tabs-header-list",style:{paddingBottom:2},children:[G.jsx("div",{className:t("data"),style:{fontWeight:"bold"},onClick:()=>n("data"),children:G.jsx("div",{className:"tab-text tab-badge",children:"Data"})}),G.jsx("div",{className:t("chart"),style:{fontWeight:"bold"},onClick:()=>n("chart"),children:G.jsx("div",{className:"tab-text tab-badge",children:"Vega-Lite"})})]}),G.jsxs("div",{style:{height:"80vh",overflow:"scroll"},children:[r==="data"&&G.jsx("div",{children:G.jsx(m1,{})}),r==="chart"&&G.jsx("div",{children:G.jsx(TE,{})})]})]}),G.jsxs("div",{style:{display:"flex",padding:2},children:[G.jsx("span",{className:"icon icon-help-question"}),G.jsx("div",{style:{paddingLeft:3},children:G.jsx("a",{href:"https://vega.github.io/vega-lite/",target:"_blank",children:"Vega-Lite Docs"})}),G.jsx("div",{children:"（Supported: Vega-Lite 5.23.0）"})]})]}),G.jsx("div",{className:"cs7 ce12",style:{height:"80vh",overflow:"scroll"},children:G.jsx(CE,{})})]})}export{er as C,il as M,UE as O,xE as a,kE as b,ME as c,_E as d,PE as e};
